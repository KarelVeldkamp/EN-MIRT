Script started on 2023-06-15 10:24:09+02:00
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT[kveldkamp49@int5 EN-MIRT]$ cd scripts/
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ ;s [K[K[Kls [K
catscript.R  fitscript.R  mlfitscript.R
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ vim fitscript.R 
[?2004h[?1049h[22;0;0t[?1h=[?2004h[1;76r[?12h[?12l[27m[23m[29m[m[H[2J[?25l[76;1H"fitscript.R" 195L, 6924C[2;1Hâ–½[6n[2;1H  [1;1H[>c]10;?]11;?[1;1H[34m# read command line arguments[m
args [38;5;130m=[m [36mcommandArgs[m[35m([mtrailingOnly[38;5;130m=[m[31mTRUE[m[35m)[m
lambda1 [38;5;130m=[m [36mas.numeric[m[35m([margs[35m[[m[31m1[m[35m])[m   [34m# l1 penalty [m
lambda2 [38;5;130m=[m [36mas.numeric[m[35m([margs[35m[[m[31m2[m[35m])[m   [34m# l2 penalty[m
ndim [38;5;130m=[m [36mas.numeric[m[35m([margs[35m[[m[31m3[m[35m])[m      [34m# number of latent dimensions[m
iteration [38;5;130m=[m [36mas.numeric[m[35m([margs[35m[[m[31m4[m[35m])[m [34m# number of the current iteration[m
sparsity [38;5;130m=[m [36mas.numeric[m[35m([margs[35m[[m[31m5[m[35m])[m  [34m# sparsity of the dataset 

# load adapted version of mirt library (rgmirt)[m
[35mlibrary[m[35m([mmirt[35m)[m

[34m# predict probabilities based on mirt parameters[m
predict.mirt [38;5;130m<-[m [32mfunction[m[35m([ma[35m,[m d[35m,[m theta[35m)
{[m
  prob [38;5;130m<-[m [36mt[m[35m([m[36mexp[m[35m([ma [38;5;130m%*%[m [36mt[m[35m([mtheta[35m)[m [38;5;130m+[md[35m)[m [38;5;130m/[m [35m([m[31m1[m [38;5;130m+[m [36mexp[m[35m([ma [38;5;130m%*%[m [36mt[m[35m([mtheta[35m)[m[38;5;130m+[md[35m)))[m

  [38;5;130mreturn[m[35m([mprob[35m)
}[m

[34m# function that inserts NA rows at each index specified in m[m
insertEmptyRows [38;5;130m<-[m [32mfunction[m[35m([mm[35m,[m rs[35m){[m
  new [38;5;130m=[m [32mmatrix[m[35m([m[31mNA[m[35m,[m nrow[38;5;130m=[m[36mnrow[m[35m([mm[35m)[m[38;5;130m+[m[36mlength[m[35m([mrs[35m),[m ncol[38;5;130m=[m[36mncol[m[35m([mm[35m))[m
  new[35m[[m[38;5;130m-[mrs[35m,][m [38;5;130m<-[m m
  [38;5;130mreturn[m[35m([mnew[35m)
}[m
[34m# function that inserts NA rows at each index specified in m[m
insertEmptyCols [38;5;130m<-[m [32mfunction[m[35m([mm[35m,[m cs[35m){[m
  new [38;5;130m=[m [32mmatrix[m[35m([m[31mNA[m[35m,[m nrow[38;5;130m=[m[36mnrow[m[35m([mm[35m),[m ncol[38;5;130m=[m[36mncol[m[35m([mm[35m)[m[38;5;130m+[m[36mlength[m[35m([mcs[35m))[m
  new[35m[[m[38;5;130m-[mcs[35m,][m [38;5;130m<-[m m
  [38;5;130mreturn[m[35m([mnew[35m)
}[m

[34m# Root mean square error[m
RMSE [38;5;130m<-[m [32mfunction[m[35m([mpar[35m,[m est[35m)
{[m
  [36msqrt[m[35m([m[36msum[m[35m(([mest[38;5;130m-[mpar[35m)[m[38;5;130m^[m[31m2[m[35m)[m [38;5;130m/[m [36mlength[m[35m([mpar[35m))
}[m

[34m# bias [m
bias [38;5;130m<-[m [32mfunction[m[35m([mpar[35m,[m est[35m)
{[m
  [36mmean[m[35m([mest[38;5;130m-[mpar[35m)
}[m

F1 [38;5;130m<-[m [32mfunction[m[35m([mtrue[35m,[m est[35m)[m [35m{[m
  [34m# Flatten matrices into vectors[m
  true [38;5;130m<-[m [36mas.vector[m[35m([mtrue[35m)[m
  est [38;5;130m<-[m [36mas.vector[m[35m([mest[35m)[m

  [34m# Calculate true positives, false positives, and false negatives[m
  tp [38;5;130m<-[m [36msum[m[35m([mtrue [38;5;130m==[m [31m1[m [38;5;130m&[m est [38;5;130m==[m [31m1[m[35m)[m
  fp [38;5;130m<-[m [36msum[m[35m([mtrue [38;5;130m==[m [31m0[m [38;5;130m&[m est [38;5;130m==[m [31m1[m[35m)[m
  fn [38;5;130m<-[m [36msum[m[35m([mtrue [38;5;130m==[m [31m1[m [38;5;130m&[m est [38;5;130m==[m [31m0[m[35m)[m

  [34m# Calculate precision, recall, and F1 score[m
  precision [38;5;130m<-[m tp [38;5;130m/[m [35m([mtp [38;5;130m+[m fp[35m)[m
  recall [38;5;130m<-[m tp [38;5;130m/[m [35m([mtp [38;5;130m+[m fn[35m)[m
  f1_score [38;5;130m<-[m [31m2[m [38;5;130m*[m precision [38;5;130m*[m recall [38;5;130m/[m [35m([mprecision [38;5;130m+[m recall[35m)[m

  [38;5;130mreturn[m[35m([mf1_score[35m)
}[m


[34m# Function that fits rgmirt model using cross validation and returns the average RMSE and average bias[m
cv.mirt [38;5;130m<-[m [32mfunction[m[35m([mdata[35m,[m[10C[34m# matrix of responses[m[66;21Hmodel[35m,[m[9C[34m# model to be passed to mirt, can be number of dimensions[m[67;21Hmethod[35m,[m[8C[34m# method of esitmation, e.g. EM[m[68;21Hrandompars[35m,[m    [34m# mirt argument for whether to use random paramters values[m[69;21Hk [38;5;130m=[m [36mc[m[35m([m[31m3[m[35m,[m[31m2[m[35m),[m    [34m# number of folds for 2d cross validation[m[70;21Hlambda[35m,[m[8C[34m# l1 and l2 penalty[m[71;21Ha_true[35m,[m[8C[34m# true parameter values[m[72;21Hd_true[35m,[m[8C[34m# true parameter values[m[73;21Htheta_true[35m,[m    [34m# true parameter values[m[74;21Hpars[35m)[m[10C[34m# parameters object from mirt[m
[35m{[m[76;253H1,1[11CTop[1;1H[?25h[27m[23m[29m[m[H[2J[?25l[1;1H[96m# read command line arguments[m
args [93m=[m [1m[96mcommandArgs[m[38;5;224m([mtrailingOnly[93m=[m[95mTRUE[m[38;5;224m)[m
lambda1 [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m1[m[38;5;224m])[m   [96m# l1 penalty [m
lambda2 [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m2[m[38;5;224m])[m   [96m# l2 penalty[m
ndim [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m3[m[38;5;224m])[m      [96m# number of latent dimensions[m
iteration [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m4[m[38;5;224m])[m [96m# number of the current iteration[m
sparsity [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m5[m[38;5;224m])[m  [96m# sparsity of the dataset 

# load adapted version of mirt library (rgmirt)[m
[38;5;81mlibrary[m[38;5;224m([mmirt[38;5;224m)[m

[96m# predict probabilities based on mirt parameters[m
predict.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)
{[m
  prob [93m<-[m [1m[96mt[m[38;5;224m([m[1m[96mexp[m[38;5;224m([ma [93m%*%[m [1m[96mt[m[38;5;224m([mtheta[38;5;224m)[m [93m+[md[38;5;224m)[m [93m/[m [38;5;224m([m[95m1[m [93m+[m [1m[96mexp[m[38;5;224m([ma [93m%*%[m [1m[96mt[m[38;5;224m([mtheta[38;5;224m)[m[93m+[md[38;5;224m)))[m

  [93mreturn[m[38;5;224m([mprob[38;5;224m)
}[m

[96m# function that inserts NA rows at each index specified in m[m
insertEmptyRows [93m<-[m [38;5;121mfunction[m[38;5;224m([mm[38;5;224m,[m rs[38;5;224m){[m
  new [93m=[m [38;5;121mmatrix[m[38;5;224m([m[95mNA[m[38;5;224m,[m nrow[93m=[m[1m[96mnrow[m[38;5;224m([mm[38;5;224m)[m[93m+[m[1m[96mlength[m[38;5;224m([mrs[38;5;224m),[m ncol[93m=[m[1m[96mncol[m[38;5;224m([mm[38;5;224m))[m
  new[38;5;224m[[m[93m-[mrs[38;5;224m,][m [93m<-[m m
  [93mreturn[m[38;5;224m([mnew[38;5;224m)
}[m
[96m# function that inserts NA rows at each index specified in m[m
insertEmptyCols [93m<-[m [38;5;121mfunction[m[38;5;224m([mm[38;5;224m,[m cs[38;5;224m){[m
  new [93m=[m [38;5;121mmatrix[m[38;5;224m([m[95mNA[m[38;5;224m,[m nrow[93m=[m[1m[96mnrow[m[38;5;224m([mm[38;5;224m),[m ncol[93m=[m[1m[96mncol[m[38;5;224m([mm[38;5;224m)[m[93m+[m[1m[96mlength[m[38;5;224m([mcs[38;5;224m))[m
  new[38;5;224m[[m[93m-[mcs[38;5;224m,][m [93m<-[m m
  [93mreturn[m[38;5;224m([mnew[38;5;224m)
}[m

[96m# Root mean square error[m
RMSE [93m<-[m [38;5;121mfunction[m[38;5;224m([mpar[38;5;224m,[m est[38;5;224m)
{[m
  [1m[96msqrt[m[38;5;224m([m[1m[96msum[m[38;5;224m(([mest[93m-[mpar[38;5;224m)[m[93m^[m[95m2[m[38;5;224m)[m [93m/[m [1m[96mlength[m[38;5;224m([mpar[38;5;224m))
}[m

[96m# bias [m
bias [93m<-[m [38;5;121mfunction[m[38;5;224m([mpar[38;5;224m,[m est[38;5;224m)
{[m
  [1m[96mmean[m[38;5;224m([mest[93m-[mpar[38;5;224m)
}[m

F1 [93m<-[m [38;5;121mfunction[m[38;5;224m([mtrue[38;5;224m,[m est[38;5;224m)[m [38;5;224m{[m
  [96m# Flatten matrices into vectors[m
  true [93m<-[m [1m[96mas.vector[m[38;5;224m([mtrue[38;5;224m)[m
  est [93m<-[m [1m[96mas.vector[m[38;5;224m([mest[38;5;224m)[m

  [96m# Calculate true positives, false positives, and false negatives[m
  tp [93m<-[m [1m[96msum[m[38;5;224m([mtrue [93m==[m [95m1[m [93m&[m est [93m==[m [95m1[m[38;5;224m)[m
  fp [93m<-[m [1m[96msum[m[38;5;224m([mtrue [93m==[m [95m0[m [93m&[m est [93m==[m [95m1[m[38;5;224m)[m
  fn [93m<-[m [1m[96msum[m[38;5;224m([mtrue [93m==[m [95m1[m [93m&[m est [93m==[m [95m0[m[38;5;224m)[m

  [96m# Calculate precision, recall, and F1 score[m
  precision [93m<-[m tp [93m/[m [38;5;224m([mtp [93m+[m fp[38;5;224m)[m
  recall [93m<-[m tp [93m/[m [38;5;224m([mtp [93m+[m fn[38;5;224m)[m
  f1_score [93m<-[m [95m2[m [93m*[m precision [93m*[m recall [93m/[m [38;5;224m([mprecision [93m+[m recall[38;5;224m)[m

  [93mreturn[m[38;5;224m([mf1_score[38;5;224m)
}[m


[96m# Function that fits rgmirt model using cross validation and returns the average RMSE and average bias[m
cv.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([mdata[38;5;224m,[m[10C[96m# matrix of responses[m[66;21Hmodel[38;5;224m,[m[9C[96m# model to be passed to mirt, can be number of dimensions[m[67;21Hmethod[38;5;224m,[m[8C[96m# method of esitmation, e.g. EM[m[68;21Hrandompars[38;5;224m,[m    [96m# mirt argument for whether to use random paramters values[m[69;21Hk [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m    [96m# number of folds for 2d cross validation[m[70;21Hlambda[38;5;224m,[m[8C[96m# l1 and l2 penalty[m[71;21Ha_true[38;5;224m,[m[8C[96m# true parameter values[m[72;21Hd_true[38;5;224m,[m[8C[96m# true parameter values[m[73;21Htheta_true[38;5;224m,[m    [96m# true parameter values[m[74;21Hpars[38;5;224m)[m[10C[96m# parameters object from mirt[m
[38;5;224m{[m[76;253H1,1[11CTop"fitscript.R" 195L, 6924C[1;1H[?25h[?25l[76;243H~@k[1;1H[76;243H   [2;1H[76;253H2[2;1H[?25h[?25l[76;243H~@k[2;1H[76;243H   [3;1H[76;253H3[3;1H[?25h[?25l[76;253H4[4;1H[?25h[?25l[76;253H5[5;1H[?25h[?25l[76;243H~@k[5;1H[76;243H   [6;1H[76;253H6[6;1H[?25h[?25l[76;253H7[7;1H[?25h[?25l[76;243H~@k[7;1H[76;243H   [8;1H[76;253H8,0-1[8;1H[?25h[?25l[76;243H~@k[8;1H[76;243H   [9;1H[76;253H9,1  [9;1H[?25h[?25l[76;253H10,1[10;1H[?25h[?25l[76;254H1,0-1[11;1H[?25h[?25l[76;243H~@k[11;1H[76;243H   [12;1H[76;254H2,1  [12;1H[?25h[?25l[76;243H~@k[12;1H[76;243H   [13;1H[76;254H3[13;1H[?25h[?25l
[38;5;224m[46m{[18;1H}[m[76;254H4[14;1H[?25h[?25l[38;5;224m{[18;1H}[m[76;254H5[15;1H[?25h[?25l[76;254H6[16;1H[?25h[?25l[76;254H7[17;1H[?25h[?25l[76;243H~@k[17;1H[76;243H   [18;1H[14;1H[38;5;224m[46m{[18;1H}[m[76;254H8[18;1H[?25h[?25l[14;1H[38;5;224m{[18;1H}[m[76;254H9,0-1[19;1H[?25h[?25l[76;253H20,1  [20;1H[?25h[?25l[76;243H~@k[20;1H[76;243H   [21;1H[76;254H1[21;1H[?25h[?25l[76;254H2[22;1H[?25h[?25l[76;254H3[23;1H[?25h[?25l[76;243H~@k[23;1H[76;243H   [24;1H[76;254H4[24;1H[?25h[?25l[76;243H~@k[24;1H[76;243H   [25;1H[21;35H[38;5;224m[46m{[25;1H}[m[76;254H5[25;1H[?25h[?25l[76;243H~@k[25;1H[76;243H   [26;1H[21;35H[38;5;224m{[25;1H}[m[76;254H6[26;1H[?25h[?25l[76;243H~@k[26;1H[76;243H   [27;1H[76;254H7[27;1H[?25h[?25l[76;243H~@k[27;1H[76;243H   [28;1H[76;254H8[28;1H[?25h[?25l[76;243H~@k[28;1H[76;243H   [29;1H[76;254H9[29;1H[?25h[?25l[76;243H~@k[29;1H[76;243H   [30;1H[76;253H30[30;1H[?25h[?25l[76;253H29[29;1H[?25h[?25l[76;254H8[28;1H[?25h[?25l[76;254H7[27;1H[?25h[?25l[76;243H~@k[27;1H[76;243H   [26;1H[76;254H6[26;1H[?25h[?25l[76;254H7[27;1H[?25h[?25l[76;254H8[28;1H[?25h[?25l[76;243H~@k[28;1H[76;243H   [29;1H[76;254H9[29;1H[?25h[?25l[76;243H~@k[29;1H[76;243H   [30;1H[76;253H30[30;1H[?25h[?25l[27;35H[38;5;224m[46m{[31;1H}[m[76;254H1[31;1H[?25h[?25l[27;35H[38;5;224m{[31;1H}[m[76;254H2,0-1[32;1H[?25h[?25l[76;243H~@k[32;1H[76;243H   [33;1H[76;254H3,1  [33;1H[?25h[?25l[76;254H4[34;1H[?25h[?25l
[38;5;224m[46m{

}[m[76;254H5[35;1H[?25h[?25l[38;5;224m{

}[m[76;254H6[36;1H[?25h[?25l[35;1H[38;5;224m[46m{

}[m[76;254H7[37;1H[?25h[?25l[35;1H[38;5;224m{

}[m[76;254H8,0-1[38;1H[?25h[?25l[76;243H~@k[38;1H[76;243H   [39;1H[76;254H9,1  [39;1H[?25h[?25l[76;253H40[40;1H[?25h[?25l
[38;5;224m[46m{

}[m[76;254H1[41;1H[?25h[?25l[38;5;224m{

}[m[76;254H2[42;1H[?25h[?25l[41;1H[38;5;224m[46m{

}[m[76;254H3[43;1H[?25h[?25l[41;1H[38;5;224m{

}[m[76;254H4,0-1[44;1H[?25h[?25l[76;243H~@k[44;1H[76;243H   [45;1H[76;254H5,1  [45;1H[?25h[?25l[76;243H~@k[45;1H[76;243H   [46;1H[76;254H6[46;1H[?25h[?25l[76;254H7[47;1H[?25h[?25l[76;243H~@k[47;1H[76;243H   [48;1H[76;254H8[48;1H[?25h[?25l[76;254H9[49;1H[?25h[?25l[76;253H50[50;1H[?25h[?25l[76;254H1[51;1H[?25h[?25l[76;243H~@k[51;1H[76;243H   [52;1H[76;254H2[52;1H[?25h[?25l[76;254H3[53;1H[?25h[?25l[76;254H4[54;1H[?25h[?25l[76;243H~@k[54;1H[76;243H   [55;1H[76;254H5[55;1H[?25h[?25l[76;254H6[56;1H[?25h[?25l[76;254H7[57;1H[?25h[?25l[76;254H8[58;1H[?25h[?25l[76;243H~@k[58;1H[76;243H   [59;1H[76;254H9[59;1H[?25h[?25l[76;243H~@k[59;1H[76;243H   [60;1H[76;253H60[60;1H[?25h[?25l[76;243H~@k[60;1H[76;243H   [61;1H[45;27H[38;5;224m[46m{[61;1H}[m[76;254H1[61;1H[?25h[?25l[45;27H[38;5;224m{[61;1H}[m[76;254H2,0-1[62;1H[?25h[?25l[76;254H3[63;1H[?25h[?25l[76;243H~@k[63;1H[76;243H   [64;1H[76;254H4,1  [64;1H[?25h[?25l[76;254H5[65;1H[?25h[?25l[76;254H6[66;1H[?25h[?25l[76;254H7[67;1H[?25h[?25l[76;243H~@k[67;1H[76;243H   [68;1H[76;254H8[68;1H[?25h[?25l[76;243H~@k[68;1H[76;243H   [69;1H[76;254H9[69;1H[?25h[?25l[76;253H70[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;1H[K[76;253H71,1[11C0%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3H[96m# calculate to which fold each person and item belongs[m[76;253H[K[76;253H72,1[11C1%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hfolds.persons [93m<-[m  [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mnrow[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m1[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[76;253H[K[76;253H73,1[11C2%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hfolds.items [93m<-[m [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mncol[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m2[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[76;253H[K[76;253H74,1[11C3%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[76;253H[K[76;253H75,1[11C4%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hrmses [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H76,1[11C5%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hbiases [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H77,1[11C5%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;3Haccuracies [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H78,1[11C6%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hf1s [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H79,1[11C7%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H80,0-1[9C8%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;3H[96m# loop though cross validation folds[m[76;253H[K[76;253H81,1[11C9%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;3H[93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H82,1[10C10%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;3H[38;5;224m{[m[76;253H[K[76;253H83,1[10C10%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;5H[93mfor[m [38;5;224m([mj [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H84,1[10C11%[70;1H[?25h[?25l[76;254H3[69;1H[?25h[?25l[76;254H2[68;1H[?25h[?25l[76;254H1[67;1H[?25h[?25l[76;243H~@k[67;1H[76;243H   [66;1H[76;254H0,0-1[66;1H[?25h[?25l[76;243H~@k[66;1H[76;243H   [67;1H[76;254H1,1  [67;1H[?25h[?25l[76;254H2[68;1H[?25h[?25l[76;254H3[69;1H[?25h[?25l[76;243H~@k[69;1H[76;243H   [70;1H[76;254H4[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;5H[38;5;224m{[m[76;253H[K[76;253H85,1[10C12%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# save the persons and items that belong to the hold out test set[m[76;253H[K[76;253H86,1[10C13%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7Hper.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.persons[93m==[mi[38;5;224m)[m[76;253H[K[76;253H87,1[10C14%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7Hitem.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.items[93m==[mj[38;5;224m)[m[76;253H[K[76;253H88,1[10C15%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H89,1[10C15%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7H[96m# create train and test folds[m[76;253H[K[76;253H90,1[10C16%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htest [93m<-[m data[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m][m[76;253H[K[76;253H91,1[10C17%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htrain [93m<-[m data[76;253H[K[76;253H92,1[10C18%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7Htrain[38;5;224m[[mper.ind[38;5;224m,[mitem.ind[38;5;224m][m [93m<-[m [95mNA[m[76;253H[K[76;253H93,1[10C19%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[76;253H[K[76;253H94,1[10C20%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# [m[30m[103mif[m[96m some rows contain no responses after the leave out set, remove them from the training set, and adjust person indices accordingly[m[76;253H[K[76;253H95,1[10C20%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hemptyrows [93m=[m [1m[96mrowSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mncol[m[38;5;224m([mtrain[38;5;224m)[m[76;253H[K[76;253H96,1[10C21%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hemptycols [93m=[m [1m[96mcolSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mnrow[m[38;5;224m([mtrain[38;5;224m)[m[76;253H[K[76;253H97,1[10C22%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H98,1[10C23%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Htrain [93m=[m train[38;5;224m[[m[93m![memptyrows[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H99,1[10C24%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;9Hper.ind [93m=[m per.ind[38;5;224m[[m[93m![mper.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m)][m[76;253H[K[76;253H100,1[9C25%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H101,1[9C25%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7H[96m# do the same for columns[m[76;253H[K[76;253H102,1[9C26%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H103,1[9C27%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Htrain [93m=[m train[38;5;224m[,[m[93m![memptycols[38;5;224m][m[76;253H[K[76;253H104,1[9C28%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Hitem.ind [93m=[m item.ind[38;5;224m[[m[93m![mitem.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m)][m[76;253H[K[76;253H105,1[9C29%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H106,1[9C30%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[76;253H[K[76;253H107,1[9C30%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# fit model[m[76;253H[K[76;253H108,1[9C31%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hfit [93m<-[m [1m[96mmirt[m[38;5;224m([mtrain[38;5;224m,[m model[38;5;224m,[m [95m'2PL'[m[38;5;224m,[m method[93m=[mmethod[38;5;224m,[m GenRandomPars[93m=[mrandompars[38;5;224m,[m lambda[93m=[mlambda[38;5;224m,[m pars[93m=[mpars[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m())[m[76;253H[K[76;253H109,1[9C32%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# save parameters[m[76;253H[K[76;253H110,1[9C33%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hitempars [93m<-[m [1m[96mcoef[m[38;5;224m([mfit[38;5;224m,[m simplify [93m=[m [95mTRUE[m[38;5;224m)$[mitems[76;253H[K[76;253H111,1[9C34%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Ha [93m<-[m itempars[38;5;224m[,[m[95m1[m[38;5;224m:([m[1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m3[m[38;5;224m)][m[76;253H[K[76;253H112,1[9C35%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hd [93m<-[m itempars[38;5;224m[,[m [1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m2[m[38;5;224m][m[76;253H[K[76;253H113,1[9C35%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7Htheta [93m<-[m [1m[96mfscores[m[38;5;224m([mfit[38;5;224m)[m[76;253H[K[76;253H114,1[9C36%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[76;253H[K[76;253H115,1[9C37%[70;1H[?25h[?25l[76;255H4[69;1H[?25h[?25l[76;243H~@k[69;1H[76;243H   [68;1H[76;255H3[68;1H[?25h[?25l[76;255H2[67;1H[?25h[?25l[76;243H~@k[67;1H[76;243H   [66;1H[76;255H1[66;1H[?25h[?25l[76;255H2[67;1H[?25h[?25l[76;255H3[68;1H[?25h[?25l[76;255H4[69;1H[?25h[?25l[76;255H5[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7H[96m# calculate true and predicted probablities[m[76;253H[K[76;253H116,1[9C38%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hp.pred [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)[m[76;253H[K[76;253H117,1[9C39%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hp.true [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma_true[38;5;224m,[m [1m[96mas.vector[m[38;5;224m([md_true[38;5;224m),[m theta_true[38;5;224m)[m[76;253H[K[76;253H118,1[9C40%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[76;253H[K[76;253H119,1[9C40%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# [m[30m[103mif[m[96m there are rows without responses, they have no theta estimates, so we have to fill in some empty rows to make the dimensions correct[m[76;253H[K[76;253H120,1[9C41%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H121,1[9C42%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Hp.pred [93m=[m [1m[96minsertEmptyRows[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m))[m[76;253H[K[76;253H122,1[9C43%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H123,1[9C44%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H124,1[9C45%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;9Hp.pred [93m=[m [1m[96minsertEmptyCols[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m))[m[76;253H[K[76;253H125,1[9C45%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H126,1[9C46%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# calculate true and predicted responses[m[76;253H[K[76;253H127,1[9C47%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hresp.pred [93m=[m [1m[96mround[m[38;5;224m([mp.pred[38;5;224m,[m [95m0[m[38;5;224m)[m[76;253H[K[76;253H128,1[9C48%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7Hresp.true [93m=[m [1m[96mround[m[38;5;224m([mp.true[38;5;224m,[m [95m0[m[38;5;224m)[m[76;253H[K[76;253H129,1[9C49%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H130,1[9C50%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7H[96m# add [m[76;253H[K[76;253H131,1[9C50%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7Hrmses [93m<-[m [1m[96mc[m[38;5;224m([mrmses[38;5;224m,[m [1m[96mRMSE[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[76;253H[K[76;253H132,1[9C51%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7Hbiases [93m<-[m [1m[96mc[m[38;5;224m([mbiases[38;5;224m,[m [1m[96mbias[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[76;253H[K[76;253H133,1[9C52%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Haccuracies [93m<-[m [1m[96mc[m[38;5;224m([maccuracies[38;5;224m,[m [1m[96mmean[m[38;5;224m([mresp.pred[93m==[mresp.true[38;5;224m))[m[76;253H[K[76;253H134,1[9C53%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hf1s [93m<-[m [1m[96mc[m[38;5;224m([mf1s[38;5;224m,[m [1m[96mF1[m[38;5;224m([mtrue[93m=[mresp.true[38;5;224m,[m est[93m=[mresp.pred[38;5;224m))[m[76;253H[K[76;253H135,1[9C54%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H136,1[9C55%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;5H[38;5;224m}[m[76;253H[K[76;253H137,1[9C55%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;3H[38;5;224m}[m[76;253H[K[76;253H138,1[9C56%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([m[1m[96mmean[m[38;5;224m([mrmses[38;5;224m),[m [1m[96mmean[m[38;5;224m([mbiases[38;5;224m)))[m[76;253H[K[76;253H139,1[9C57%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m[76;253H[K[76;253H140,1[9C58%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H141,1[9C59%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# read appropriate data file[m[76;253H[K[76;253H142,1[9C60%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1Hdata1 [93m=[m [1m[96mread.csv[m[38;5;224m([m[1m[96mpaste[m[38;5;224m([m[95m'~/data_parameters/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[76;253H[K[76;253H143,1[9C60%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H144,1[9C61%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;1H[96m# load true parameter values[m[76;253H[K[76;253H145,1[9C62%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;1H[1m[96mload[m[38;5;224m([mfile[93m=[m[1m[96mpaste[m[38;5;224m([m[95m'~/data_parameters/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m))[m[76;253H[K[76;253H146,0-1[7C63%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[76;253H[K[76;253H147,1[9C64%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;1H[96m# initialize paramters[m[76;253H[K[76;253H148,1[9C65%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[1m[96mprint[m[38;5;224m([m[95m'initializing pars...'[m[38;5;224m)[m[76;253H[K[76;253H149,0-1[7C65%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1Hpars [93m<-[m [1m[96mmirt[m[38;5;224m([mdata1[38;5;224m,[mndim[38;5;224m,[m pars [93m=[m [95m'values'[m[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m())[m[76;253H[K[76;253H150,1[9C66%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[76;253H[K[76;253H151,1[9C67%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# set some loadings to zero[m[76;253H[K[76;253H152,1[9C68%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[30m[103mif[m[38;5;224m([mndim[93m==[m[95m1[m[38;5;224m){[m[76;253H[K[76;253H153,1[9C69%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H154,1[9C70%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H155,1[9C70%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m [93melse[m [30m[103mif[m [38;5;224m([mndim[93m==[m[95m2[m[38;5;224m){[m[76;253H[K[76;253H156,0-1[7C71%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m5[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H157,1[9C72%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m5[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H158,1[9C73%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m6[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H159,1[9C74%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m6[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H160,1[9C75%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[67;12H[38;5;224m[46m{


}[m[75;1H[38;5;224m}[m[93melse[m [30m[103mif[m [38;5;224m([mndim[93m==[m[95m3[m[38;5;224m){[m[76;253H[K[76;253H161,1[9C75%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[66;12H[38;5;224m{


}[m[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H162,1[9C76%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H163,1[9C77%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m11[m[38;5;224m:[m[95m20[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H164,1[9C78%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m11[m[38;5;224m:[m[95m20[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H165,1[9C79%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[65;20H[38;5;224m[46m{[70;1H}[m[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a3'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m21[m[38;5;224m:[m[95m30[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H166,1[9C80%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[64;20H[38;5;224m{[69;1H}[m[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a3'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m21[m[38;5;224m:[m[95m30[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H167,1[9C80%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m[76;253H[K[76;253H168,1[9C81%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H169,1[9C82%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# fit model[m[76;253H[K[76;253H170,1[9C83%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[1m[96mprint[m[38;5;224m([m[95m'fitting model...'[m[38;5;224m)[m[76;253H[K[76;253H171,1[9C84%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;1Hstart [93m=[m [1m[96mSys.time[m[38;5;224m()[m[76;253H[K[76;253H172,1[9C85%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [69;1H[76;255H1[69;1H[?25h[?25l[76;243H~@k[69;1H[76;243H   [68;1H[76;255H0[68;1H[?25h[?25l[76;243H~@k[68;1H[76;243H   [67;1H[76;254H69[67;1H[?25h[?25l[76;243H~@k[67;1H[76;243H   [66;1H[76;255H8[66;1H[?25h[?25l[76;243H~@k[66;1H[76;243H   [65;1H[76;255H7[65;1H[?25h[?25l[76;243H~@k[65;1H[76;243H   [64;1H[59;20H[38;5;224m[46m{[64;1H}[m[76;255H6[64;1H[?25h[?25l[76;243H~@k[64;1H[76;243H   [63;1H[59;20H[38;5;224m{[64;1H}[m[76;255H5[63;1H[?25h[?25l[76;243H~@k[63;1H[76;243H   [62;1H[76;255H4[62;1H[?25h[?25l[76;243H~@k[62;1H[76;243H   [61;1H[76;255H3[61;1H[?25h[?25l[76;243H~@k[61;1H[76;243H   [60;1H[76;255H2[60;1H[?25h[?25l[76;243H~@k[60;1H[76;243H   [59;1H[56;12H[38;5;224m[46m{


}[m[76;255H1[59;1H[?25h[?25l[76;243H~@k[59;1H[76;243H   [58;1H[56;12H[38;5;224m{


}[m[76;255H0[58;1H[?25h[?25l[76;243H~@k[58;1H[76;243H   [57;1H[76;254H59[57;1H[?25h[?25l[76;243H~@k[57;1H[76;243H   [56;1H[76;255H8[56;1H[?25h[?25l[76;243H~@k[56;1H[76;243H   [55;1H[76;255H7[55;1H[?25h[?25l[76;243H~@k[55;1H[76;243H   [54;1H[76;255H6,0-1[54;1H[?25h[?25l[76;243H~@k[54;1H[76;243H   [53;1H[76;255H5,1  [53;1H[?25h[?25l[76;243H~@k[53;1H[76;243H   [52;1H[76;255H4[52;1H[?25h[?25l[76;243H~@k[52;1H[76;243H   [51;1H[76;255H3[51;1H[?25h[?25l[76;243H~@k[51;1H[76;243H   [50;1H[76;255H2[50;1H[?25h[?25l[76;243H~@k[50;1H[76;243H   [49;1H[76;255H1[49;1H[?25h[?25l[76;243H~@k[49;1H[76;243H   [48;1H[76;255H0[48;1H[?25h[?25l[76;243H~@k[48;1H[76;243H   [47;1H[76;254H49,0-1[47;1H[?25h[?25l[76;243H~@k[47;1H[76;243H   [46;1H[76;255H8,1  [46;1H[?25h[?25l[76;243H~@k[46;1H[76;243H   [46;2H[76;257H2[46;2H[?25h[?25l[76;243H~@k[46;2H[76;243H   [46;3H[76;257H3[46;3H[?25h[?25l[76;243H~@k[46;3H[76;243H   [46;4H[76;257H4[46;4H[?25h[?25l[76;243H~@k[46;4H[76;243H   [46;5H[76;257H5[46;5H[?25h[?25l[76;243H~@k[46;5H[76;243H   [46;6H[76;257H6[46;6H[?25h[?25l[76;243H~@k[46;6H[76;243H   [46;7H[76;257H7[46;7H[?25h[?25l[76;243H~@k[46;7H[76;243H   [46;8H[76;257H8[46;8H[?25h[?25l[76;243H~@k[46;8H[76;243H   [46;9H[76;257H9[46;9H[?25h[?25l[76;243H~@k[46;9H[76;243H   [46;10H[76;257H10[46;10H[?25h[?25l[76;243H~@k[46;10H[76;243H   [46;11H[76;258H1[46;11H[?25h[?25l[76;243H~@k[46;11H[76;243H   [46;12H[76;258H2[46;12H[?25h[?25l[76;243H~@k[46;12H[76;243H   [46;13H[76;258H3[46;13H[?25h[?25l[76;243H~@k[46;13H[76;243H   [46;14H[76;258H4[46;14H[?25h[?25l[76;243H~@k[46;14H[76;243H   [46;15H[76;258H5[46;15H[?25h[?25l[76;243H~@k[46;15H[76;243H   [46;16H[76;258H6[46;16H[?25h[?25l[76;243H~@k[46;16H[76;243H   [46;17H[38;5;224m[46m([89C)[m[76;258H7[46;17H[?25h[?25l[76;243H~@k[46;17H[76;243H   [46;18H[38;5;224m([89C)[m[76;258H8[46;18H[?25h[?25l[76;243H~@k[46;18H[76;243H   [46;19H[76;258H9[46;19H[?25h[?25l[76;243H~@k[46;19H[76;243H   [46;20H[76;257H20[46;20H[?25h[?25l[76;243H~@k[46;20H[76;243H   [46;21H[76;258H1[46;21H[?25h[?25l[76;243H~@k[46;21H[76;243H   [46;22H[76;258H2[46;22H[?25h[?25l[76;243H~@k[46;22H[76;243H   [46;23H[38;5;224m[46m([69C)[m[76;258H3[46;23H[?25h[?25l[76;243H~@k[46;23H[76;243H   [46;24H[38;5;224m([69C)[m[76;258H4[46;24H[?25h[?25l[76;243H~@k[46;24H[76;243H   [46;25H[76;258H5[46;25H[?25h[?25l[76;243H~@k[46;25H[76;243H   [46;26H[76;258H6[46;26H[?25h[?25l[76;243H~@k[46;26H[76;243H   [46;27H[76;258H7[46;27H[?25h[?25l[76;243H~@k[46;27H[76;243H   [46;28H[76;258H8[46;28H[?25h[?25l[76;243H~@k[46;28H[76;243H   [46;27H[76;258H7[46;27H[?25h[?25l[76;243H~@k[46;27H[76;243H   [46;28H[76;258H8[46;28H[?25h[?25l[76;243H~@k[46;28H[76;243H   [46;29H[76;258H9[46;29H[?25h[?25l[76;243H~@k[46;29H[76;243H   [46;30H[76;257H30[46;30H[?25h[?25l[76;243H~@k[46;30H[76;243H   [46;31H[76;258H1[46;31H[?25h[?25l[76;243H~@k[46;31H[76;243H   [46;32H[76;258H2[46;32H[?25h[?25l[76;243H~@k[46;32H[76;243H   [46;33H[76;258H3[46;33H[?25h[?25l[76;243H~@k[46;33H[76;243H   [46;34H[76;258H4[46;34H[?25h[?25l[76;243H~@k[46;34H[76;243H   [46;35H[76;258H5[46;35H[?25h[?25l[76;243H~@k[46;35H[76;243H   [46;36H[76;258H6[46;36H[?25h[?25l[76;243H~@k[46;36H[76;243H   [46;37H[76;258H7[46;37H[?25h[?25l[76;243H~@k[46;37H[76;243H   [46;38H[76;258H8[46;38H[?25h[?25l[76;243H~@k[46;38H[76;243H   [46;39H[76;258H9[46;39H[?25h[?25l[76;243H~@k[46;39H[76;243H   [46;40H[76;257H40[46;40H[?25h[?25l[76;243H~@k[46;40H[76;243H   [46;41H[76;258H1[46;41H[?25h[?25l[76;243H~@k[46;41H[76;243H   [46;42H[76;258H2[46;42H[?25h[?25l[76;243H~@k[46;42H[76;243H   [46;41H[76;258H1[46;41H[?25h[?25l[76;243H~@k[46;41H[76;243H   [46;40H[76;258H0[46;40H[?25h[?25l[76;243Hi[46;40H[76;243H [46;40H[76;1H[1m-- INSERT --[m[76;253H[K[76;253H148,40[8C85%[46;40H[?25h[?25l[76;258H1[46;41H[?25h[?25l[95ms/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[46;107H[K[76;258H0[46;40H[?25h[?25l[95ms/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[46;106H[K[76;257H39[46;39H[?25h[?25l[95ms/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[46;105H[K[76;258H8[46;38H[?25h[?25l[95ms/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[46;104H[K[76;258H7[46;37H[?25h[?25l[95ms/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[46;103H[K[76;258H6[46;36H[?25h[?25l[95ms/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[46;102H[K[76;258H5[46;35H[?25h[?25l[95ms/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[46;101H[K[76;258H4[46;34H[?25h[?25l[95ms/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[46;100H[K[76;258H3[46;33H[?25h[?25l[95ms/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[46;99H[K[76;258H2[46;32H[?25h[?25l[95ms/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[46;98H[K[76;258H1[46;31H[?25h[?25l[95ms/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[46;97H[K[76;258H0[46;30H[?25h[?25l[95ms/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[46;96H[K[76;257H29[46;29H[?25h[?25l[95ms/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[46;95H[K[76;258H8[46;28H[?25h[?25l[95ms/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[46;94H[K[76;258H7[46;27H[?25h[?25l[95mrs/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[76;258H8[46;28H[?25h[?25l[95mgs/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[76;258H9[46;29H[?25h[?25l[95mms/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[76;257H30[46;30H[?25h[?25l[95mis/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[76;258H1[46;31H[?25h[?25l[95mrs/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[76;258H2[46;32H[?25h[?25l[95mts/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[76;258H3[46;33H[?25h[?25l[95m s/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[76;258H4[46;34H[?25h[?25l[95ms/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[46;100H[K[76;258H3[46;33H[?25h[?25l[76;255H9,1 [47;1H[?25h[?25l[76;254H50,29[48;29H[?25h[?25l[76;255H1,33[49;33H[?25h[?25l[76;258H4[49;34H[?25h[?25l[76;258H5[49;35H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[49;104H[K[76;258H4[49;34H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[49;103H[K[76;258H3[49;33H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[49;102H[K[76;258H2[49;32H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[49;101H[K[76;258H1[49;31H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[49;100H[K[76;258H0[49;30H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[49;99H[K[76;257H29[49;29H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[49;98H[K[76;258H8[49;28H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[49;97H[K[76;258H7[49;27H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[49;96H[K[76;258H6[49;26H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[49;95H[K[76;258H5[49;25H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[49;94H[K[76;258H4[49;24H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[49;93H[K[76;258H3[49;23H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[49;92H[K[76;258H2[49;22H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[49;91H[K[76;258H1[49;21H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[49;90H[K[76;258H0[49;20H[?25h[?25l[95mr/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[1C[38;5;224m)[m[76;258H1[49;21H[?25h[?25l[95mg/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[1C[38;5;224m)[m[76;258H2[49;22H[?25h[?25l[95mm/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[1C[38;5;224m)[m[76;258H3[49;23H[?25h[?25l[95mi/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[1C[38;5;224m)[m[76;258H4[49;24H[?25h[?25l[95mr/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[1C[38;5;224m)[m[76;258H5[49;25H[?25h[?25l[95mt/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[1C[38;5;224m)[m[76;258H6[49;26H[?25h[?25l[95m /parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[1C[38;5;224m)[m[76;258H7[49;27H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[49;96H[K[76;258H6[49;26H[?25h[?25l[76;255H2,7 [50;7H[?25h[?25l[76;255H3,23[51;23H[?25h[?25l[76;255H4,26[52;26H[?25h[?25l[76;255H5[53;26H[?25h[?25l[76;255H6,1 [54;1H[?25h[?25l[76;255H7,26[55;26H[?25h[?25l[56;12H[38;5;224m[46m{


}[m[76;255H8,13[56;13H[?25h[?25l[38;5;224m{


}[m[76;255H9,26[57;26H[?25h[?25l[76;254H60[58;26H[?25h[?25l[59;20H[38;5;224m[46m{[64;1H}[m[76;255H1,21[59;21H[?25h[?25l[38;5;224m{[64;1H}[m[76;255H2,26[60;26H[?25h[?25l[76;255H3[61;26H[?25h[?25l[76;255H4[62;26H[?25h[?25l[76;255H5[63;26H[?25h[?25l[76;255H8[66;26H[?25h[?25l[76;254H71[69;26H[?25h[?25l[1;75r[1;1H[2M[1;76r[74;1Hmetrics [93m<-[m [1m[96mcv.mirt[m[38;5;224m([mdata1[38;5;224m,[m ndim[38;5;224m,[m[75;17Hmethod [93m=[m [95m'EM'[m[38;5;224m,[m[76;253H[K[76;253H174,1[9C86%[70;1H[?25h[?25l[1;75r[1;1H[4M[1;76r[72;17Hrandompars [93m=[m [95mF[m[38;5;224m,[m k [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m[73;17Hlambda [93m=[m [1m[96mc[m[38;5;224m([mlambda1[38;5;224m,[mlambda2[38;5;224m),[m[74;17Ha_true [93m=[m a1[38;5;224m,[m[75;17Hd_true [93m=[m d1[38;5;224m,[m[76;253H[K[76;253H178,26[8C90%[70;26H[?25h[?25l[1;75r[75;1H
[1;76r[75;17Htheta_true [93m=[m theta1[38;5;224m,[m[76;253H[K[76;253H179,26[8C90%[70;26H[?25h[?25l[1;75r[75;1H
[1;76r[75;17Hpars [93m=[m pars[38;5;224m)[m[76;253H[K[76;253H180,26[8C91%[70;26H[?25h[?25l[1;75r[1;1H[2M[1;76r[74;1Hend [93m=[m [1m[96mSys.time[m[38;5;224m()[m
time [93m=[m end[93m-[mstart[76;253H[K[76;253H182,26[8C93%[70;26H[?25h[?25l[1;75r[1;1H[2M[1;76r[74;1H[1m[96mprint[m[38;5;224m([mtime[38;5;224m)[m[76;253H[K[76;253H184,26[8C95%[70;26H[?25h[?25l[1;75r[1;1H[3M[1;76r[73;1H[96m# save results[m
fileConn[93m<-[m[1m[96mfile[m[38;5;224m([m[1m[96mpaste0[m[38;5;224m([m[95m'~/results/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[38;5;224m))[m
[1m[96mwriteLines[m[38;5;224m([m[1m[96mc[m[38;5;224m([m[1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m1[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m2[m[38;5;224m])),[m fileConn[38;5;224m)[m[76;253H[K[76;253H187,17[8C97%[70;17H[?25h[?25l[1;75r[1;1H[3M[1;76r[73;1H[1m[96mclose[m[38;5;224m([mfileConn[38;5;224m)[m[76;253H[K[76;253H191,26[8CBot[71;26H[?25h[?25l[76;255H5,1 [75;1H[?25h[?25l[76;255H4[74;1H[?25h[?25l[73;6H[38;5;224m[46m([8C)[m[76;255H3,16[73;16H[?25h[?25l[72;26H[38;5;224m[46m([10C)[m[73;6H[38;5;224m([8C)[m[76;255H2,2[72;26H[?25h[?25l[38;5;224m([10C)[m[76;255H1[71;26H[?25h[?25l[76;258H5[71;25H[?25h[?25l[1C[95m/results/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[1C[38;5;224m)[m[76;258H6[71;26H[?25h[?25l[95mr/results/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[1C[38;5;224m)[m[76;258H7[71;27H[?25h[?25l[95mg/results/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[1C[38;5;224m)[m[76;258H8[71;28H[?25h[?25l[95mm/results/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[1C[38;5;224m)[m[76;258H9[71;29H[?25h[?25l[95mi/results/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[1C[38;5;224m)[m[76;257H30[71;30H[?25h[?25l[95mr/results/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[1C[38;5;224m)[m[76;258H1[71;31H[?25h[?25l[95mt/results/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[1C[38;5;224m)[m[76;258H2[71;32H[?25h[?25l[95m /results/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[1C[38;5;224m)[m[76;258H3[71;33H[?25h[?25l[95m/results/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[38;5;224m)[m[71;111H[K[76;258H2[71;32H[?25h[?25l[1C[95m/results/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[1C[38;5;224m)[m[76;258H3[71;33H[?25h[?25l[95mresults/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[38;5;224m)[m[71;111H[K[76;258H2[71;32H[?25h[76;1H[K[71;31H[?25l[76;243H^[[71;31H[76;243H  [71;32H[76;253H191,31[8CBot[71;31H[?25h[?25l[76;243H:[71;31H[76;243H[K[76;1H:[?2004h[?25hw[?25l[?25h[?25l [?25h[?25l[?25h[?25l"fitscript.R" 195L, 6914C written[71;31H[76;253H191,31[8CBot[76;253H[K[76;253H191,31[8CBot[71;31H[?25h[?25l[76;243H:[71;31H[76;1H[K[76;1H:[?2004h[?25hq[?25l[?25h[?25l [?25h[?25l[?25h[?25l[?2004l[76;1H[K[76;1H[?2004l[?1l>[?25h[?1049l[23;0;0t]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ cd ../..
]0;kveldkamp49@int5:~/rgmirt[kveldkamp49@int5 rgmirt]$ ;s [K[K[Kls[K 
bash: l: command not found
]0;kveldkamp49@int5:~/rgmirt[kveldkamp49@int5 rgmirt]$ ls [K
[0m[38;5;33mdata[0m  [38;5;33mEN-MIRT[0m  [38;5;33mparameters[0m
]0;kveldkamp49@int5:~/rgmirt[kveldkamp49@int5 rgmirt]$ mkdr[Kir results [K
]0;kveldkamp49@int5:~/rgmirt[kveldkamp49@int5 rgmirt]$ vim W[KEN-MIRT/scripts/fitscript.R 
[?2004h[?1049h[22;0;0t[?1h=[?2004h[1;76r[?12h[?12l[27m[23m[29m[m[H[2J[?25l[76;1H"EN-MIRT/scripts/fitscript.R" 195L, 6914C[2;1Hâ–½[6n[2;1H  [1;1H[>c]10;?]11;?[1;7H[34m# calculate true and predicted probablities[m[2;7Hp.pred [38;5;130m<-[m [36mpredict.mirt[m[35m([ma[35m,[m d[35m,[m theta[35m)[m[3;7Hp.true [38;5;130m<-[m [36mpredict.mirt[m[35m([ma_true[35m,[m [36mas.vector[m[35m([md_true[35m),[m theta_true[35m)[m[5;7H[34m# [m[34m[103mif[m[34m there are rows without responses, they have no theta estimates, so we have to fill in some empty rows to make the dimensions correct[m[6;7H[38;5;130m[103mif[m[35m([m[36msum[m[35m([memptyrows[35m)[m[38;5;130m>[m[31m0[m[35m){[m[7;9Hp.pred [38;5;130m=[m [36minsertEmptyRows[m[35m([mp.pred[35m,[m [36mwhich[m[35m([memptyrows[35m))[8;7H}[m[9;7H[38;5;130m[103mif[m[35m([m[36msum[m[35m([memptycols[35m)[m[38;5;130m>[m[31m0[m[35m){[m[10;9Hp.pred [38;5;130m=[m [36minsertEmptyCols[m[35m([mp.pred[35m,[m [36mwhich[m[35m([memptycols[35m))[11;7H}[m[12;7H[34m# calculate true and predicted responses[m[13;7Hresp.pred [38;5;130m=[m [36mround[m[35m([mp.pred[35m,[m [31m0[m[35m)[m[14;7Hresp.true [38;5;130m=[m [36mround[m[35m([mp.true[35m,[m [31m0[m[35m)[m[16;7H[34m# add [m[17;7Hrmses [38;5;130m<-[m [36mc[m[35m([mrmses[35m,[m [36mRMSE[m[35m([mest[38;5;130m=[mp.pred[35m[[mper.ind[35m,[m item.ind[35m],[m par[38;5;130m=[mp.true[35m[[mper.ind[35m,[m item.ind[35m]))[m[18;7Hbiases [38;5;130m<-[m [36mc[m[35m([mbiases[35m,[m [36mbias[m[35m([mest[38;5;130m=[mp.pred[35m[[mper.ind[35m,[m item.ind[35m],[m par[38;5;130m=[mp.true[35m[[mper.ind[35m,[m item.ind[35m]))[m[19;7Haccuracies [38;5;130m<-[m [36mc[m[35m([maccuracies[35m,[m [36mmean[m[35m([mresp.pred[38;5;130m==[mresp.true[35m))[m[20;7Hf1s [38;5;130m<-[m [36mc[m[35m([mf1s[35m,[m [36mF1[m[35m([mtrue[38;5;130m=[mresp.true[35m,[m est[38;5;130m=[mresp.pred[35m))[22;5H}
[m  [35m}[m
  [38;5;130mreturn[m[35m([m[36mc[m[35m([m[36mmean[m[35m([mrmses[35m),[m [36mmean[m[35m([mbiases[35m)))
}[m

[34m# read appropriate data file[m
data1 [38;5;130m=[m [36mread.csv[m[35m([m[36mpaste[m[35m([m[31m'~/rgmirts/data/'[m[35m,[m ndim[35m,[m iteration[35m,[m sparsity[35m,[m [31m'.csv'[m[35m,[m sep[38;5;130m=[m[31m'_'[m[35m),[m row.names[38;5;130m=[m[31m1[m[35m)[m

[34m# load true parameter values[m
[36mload[m[35m([mfile[38;5;130m=[m[36mpaste[m[35m([m[31m'~/rgmirt/parameters/true/true'[m[35m,[m ndim[35m,[m iteration[35m,[m sparsity[35m,[m [31m'.RData'[m[35m,[m sep[38;5;130m=[m[31m'_'[m[35m))[m

[34m# initialize paramters[m
[36mprint[m[35m([m[31m'initializing pars...'[m[35m)[m
pars [38;5;130m<-[m [36mmirt[m[35m([mdata1[35m,[mndim[35m,[m pars [38;5;130m=[m [31m'values'[m[35m,[m technical [38;5;130m=[m [32mlist[m[35m())[m

[34m# set some loadings to zero[m
[38;5;130m[103mif[m[35m([mndim[38;5;130m==[m[31m1[m[35m){[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
[35m}[m [38;5;130melse[m [38;5;130m[103mif[m [35m([mndim[38;5;130m==[m[31m2[m[35m){[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m:[m[31m5[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m:[m[31m5[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a2'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m6[m[35m:[m[31m10[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a2'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m6[m[35m:[m[31m10[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
[35m}[m[38;5;130melse[m [38;5;130m[103mif[m [35m([mndim[38;5;130m==[m[31m3[m[35m){[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m:[m[31m10[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m:[m[31m10[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a2'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m11[m[35m:[m[31m20[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a2'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m11[m[35m:[m[31m20[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a3'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m21[m[35m:[m[31m30[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a3'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m21[m[35m:[m[31m30[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
[35m}[m

[34m# fit model[m
[36mprint[m[35m([m[31m'fitting model...'[m[35m)[m
start [38;5;130m=[m [36mSys.time[m[35m()[m
metrics [38;5;130m<-[m [36mcv.mirt[m[35m([mdata1[35m,[m ndim[35m,[m[59;17Hmethod [38;5;130m=[m [31m'EM'[m[35m,[m[60;17Hrandompars [38;5;130m=[m [31mF[m[35m,[m k [38;5;130m=[m [36mc[m[35m([m[31m3[m[35m,[m[31m2[m[35m),[m[61;17Hlambda [38;5;130m=[m [36mc[m[35m([mlambda1[35m,[mlambda2[35m),[m[62;17Ha_true [38;5;130m=[m a1[35m,[m[63;17Hd_true [38;5;130m=[m d1[35m,[m[64;17Htheta_true [38;5;130m=[m theta1[35m,[m[65;17Hpars [38;5;130m=[m pars[35m)[m
end [38;5;130m=[m [36mSys.time[m[35m()[m
time [38;5;130m=[m end[38;5;130m-[mstart
[36mprint[m[35m([mtime[35m)[m

[34m# save results[m
fileConn[38;5;130m<-[m[36mfile[m[35m([m[36mpaste0[m[35m([m[31m'~/rgmirt/results/'[m[35m,[m lambda1[35m,[m[31m'_'[m[35m,[mlambda2[35m,[m[31m'_'[m[35m,[mndim[35m,[m [31m'_'[m[35m,[miteration[35m,[m[31m'_'[m[35m,[m sparsity[35m,[m [31m'.txt'[m[35m))[m
[36mwriteLines[m[35m([m[36mc[m[35m([m[36mas.character[m[35m([mmetrics[35m[[m[31m1[m[35m]),[m [36mas.character[m[35m([mmetrics[35m[[m[31m2[m[35m])),[m fileConn[35m)[m
[36mclose[m[35m([mfileConn[35m)[m[76;253H191,31[8CBot[71;31H[?25h[27m[23m[29m[m[H[2J[?25l[1;7H[96m# calculate true and predicted probablities[m[2;7Hp.pred [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)[m[3;7Hp.true [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma_true[38;5;224m,[m [1m[96mas.vector[m[38;5;224m([md_true[38;5;224m),[m theta_true[38;5;224m)[m[5;7H[96m# [m[30m[103mif[m[96m there are rows without responses, they have no theta estimates, so we have to fill in some empty rows to make the dimensions correct[m[6;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[7;9Hp.pred [93m=[m [1m[96minsertEmptyRows[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m))[8;7H}[m[9;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[10;9Hp.pred [93m=[m [1m[96minsertEmptyCols[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m))[11;7H}[m[12;7H[96m# calculate true and predicted responses[m[13;7Hresp.pred [93m=[m [1m[96mround[m[38;5;224m([mp.pred[38;5;224m,[m [95m0[m[38;5;224m)[m[14;7Hresp.true [93m=[m [1m[96mround[m[38;5;224m([mp.true[38;5;224m,[m [95m0[m[38;5;224m)[m[16;7H[96m# add [m[17;7Hrmses [93m<-[m [1m[96mc[m[38;5;224m([mrmses[38;5;224m,[m [1m[96mRMSE[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[18;7Hbiases [93m<-[m [1m[96mc[m[38;5;224m([mbiases[38;5;224m,[m [1m[96mbias[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[19;7Haccuracies [93m<-[m [1m[96mc[m[38;5;224m([maccuracies[38;5;224m,[m [1m[96mmean[m[38;5;224m([mresp.pred[93m==[mresp.true[38;5;224m))[m[20;7Hf1s [93m<-[m [1m[96mc[m[38;5;224m([mf1s[38;5;224m,[m [1m[96mF1[m[38;5;224m([mtrue[93m=[mresp.true[38;5;224m,[m est[93m=[mresp.pred[38;5;224m))[22;5H}
[m  [38;5;224m}[m
  [93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([m[1m[96mmean[m[38;5;224m([mrmses[38;5;224m),[m [1m[96mmean[m[38;5;224m([mbiases[38;5;224m)))
}[m

[96m# read appropriate data file[m
data1 [93m=[m [1m[96mread.csv[m[38;5;224m([m[1m[96mpaste[m[38;5;224m([m[95m'~/rgmirts/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m

[96m# load true parameter values[m
[1m[96mload[m[38;5;224m([mfile[93m=[m[1m[96mpaste[m[38;5;224m([m[95m'~/rgmirt/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m))[m

[96m# initialize paramters[m
[1m[96mprint[m[38;5;224m([m[95m'initializing pars...'[m[38;5;224m)[m
pars [93m<-[m [1m[96mmirt[m[38;5;224m([mdata1[38;5;224m,[mndim[38;5;224m,[m pars [93m=[m [95m'values'[m[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m())[m

[96m# set some loadings to zero[m
[30m[103mif[m[38;5;224m([mndim[93m==[m[95m1[m[38;5;224m){[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
[38;5;224m}[m [93melse[m [30m[103mif[m [38;5;224m([mndim[93m==[m[95m2[m[38;5;224m){[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m5[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m5[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m6[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m6[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
[38;5;224m}[m[93melse[m [30m[103mif[m [38;5;224m([mndim[93m==[m[95m3[m[38;5;224m){[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m11[m[38;5;224m:[m[95m20[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m11[m[38;5;224m:[m[95m20[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a3'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m21[m[38;5;224m:[m[95m30[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a3'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m21[m[38;5;224m:[m[95m30[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
[38;5;224m}[m

[96m# fit model[m
[1m[96mprint[m[38;5;224m([m[95m'fitting model...'[m[38;5;224m)[m
start [93m=[m [1m[96mSys.time[m[38;5;224m()[m
metrics [93m<-[m [1m[96mcv.mirt[m[38;5;224m([mdata1[38;5;224m,[m ndim[38;5;224m,[m[59;17Hmethod [93m=[m [95m'EM'[m[38;5;224m,[m[60;17Hrandompars [93m=[m [95mF[m[38;5;224m,[m k [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m[61;17Hlambda [93m=[m [1m[96mc[m[38;5;224m([mlambda1[38;5;224m,[mlambda2[38;5;224m),[m[62;17Ha_true [93m=[m a1[38;5;224m,[m[63;17Hd_true [93m=[m d1[38;5;224m,[m[64;17Htheta_true [93m=[m theta1[38;5;224m,[m[65;17Hpars [93m=[m pars[38;5;224m)[m
end [93m=[m [1m[96mSys.time[m[38;5;224m()[m
time [93m=[m end[93m-[mstart
[1m[96mprint[m[38;5;224m([mtime[38;5;224m)[m

[96m# save results[m
fileConn[93m<-[m[1m[96mfile[m[38;5;224m([m[1m[96mpaste0[m[38;5;224m([m[95m'~/rgmirt/results/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[38;5;224m))[m
[1m[96mwriteLines[m[38;5;224m([m[1m[96mc[m[38;5;224m([m[1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m1[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m2[m[38;5;224m])),[m fileConn[38;5;224m)[m
[1m[96mclose[m[38;5;224m([mfileConn[38;5;224m)[m[76;253H191,31[8CBot"EN-MIRT/scripts/fitscript.R" 195L, 6914C[71;31H[?25h[?25l[76;243H~@k[71;31H[76;243H   [72;31H[76;255H2[72;31H[?25h[?25l[76;243H~@k[72;31H[76;243H   [73;15H[73;6H[38;5;224m[46m([8C)[m[76;255H3,15[73;15H[?25h[?25l[73;6H[38;5;224m([8C)[m[76;255H4,0-1[74;1H[?25h[?25l[76;255H5[75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [74;1H[76;255H4[74;1H[?25h[?25l[76;243H~@k[74;1H[76;243H   [73;15H[73;6H[38;5;224m[46m([8C)[m[76;255H3,15 [73;15H[?25h[?25l[76;243H~@k[73;15H[76;243H   [72;31H[73;6H[38;5;224m([8C)[m[76;255H2,31[72;31H[?25h[?25l[76;243H:[72;31H[76;1H[K[76;1H:[?2004h[?25hq[?25l[?25h[?25l [?25h[?25l[?25h[?25l[?2004l[76;1H[K[76;1H[?2004l[?1l>[?25h[?1049l[23;0;0t]0;kveldkamp49@int5:~/rgmirt[kveldkamp49@int5 rgmirt]$ cd EN-MIRT/
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT[kveldkamp49@int5 EN-MIRT]$ git pull [K
remote: Enumerating objects: 7, done.[K
remote: Counting objects:  14% (1/7)[Kremote: Counting objects:  28% (2/7)[Kremote: Counting objects:  42% (3/7)[Kremote: Counting objects:  57% (4/7)[Kremote: Counting objects:  71% (5/7)[Kremote: Counting objects:  85% (6/7)[Kremote: Counting objects: 100% (7/7)[Kremote: Counting objects: 100% (7/7), done.[K
remote: Compressing objects:  50% (1/2)[Kremote: Compressing objects: 100% (2/2)[Kremote: Compressing objects: 100% (2/2), done.[K
remote: Total 4 (delta 2), reused 4 (delta 2), pack-reused 0[K
Unpacking objects:  25% (1/4)Unpacking objects:  50% (2/4)Unpacking objects:  75% (3/4)Unpacking objects: 100% (4/4)Unpacking objects: 100% (4/4), 1008 bytes | 72.00 KiB/s, done.
From https://github.com/KarelVeldkamp/EN-MIRT
   c456264..ad58ffd  main       -> origin/main
Updating c456264..ad58ffd
error: Your local changes to the following files would be overwritten by merge:
	scripts/fitscript.R
Please commit your changes or stash them before you merge.
Aborting
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT[kveldkamp49@int5 EN-MIRT]$ git stash [K
Saved working directory and index state WIP on main: c456264 added accuracy and f1 metrics to simulation
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT[kveldkamp49@int5 EN-MIRT]$ git pull [K
Updating c456264..ad58ffd
Fast-forward
 scripts/fitscript.R | 61 [32m+++++++++++++++++++++++++++++++++++++++++++[m[31m------------------[m
 1 file changed, 43 insertions(+), 18 deletions(-)
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT[kveldkamp49@int5 EN-MIRT]$ vim EN-[K[K[K[K[K[K[Kvim [K[K[K[Kcd scripts/
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ vim fitscript.R 
[?2004h[?1049h[22;0;0t[?1h=[?2004h[1;76r[?12h[?12l[27m[23m[29m[m[H[2J[?25l[76;1H"fitscript.R" 220L, 8046C[2;1Hâ–½[6n[2;1H  [1;1H[>c]10;?]11;?[1;7H[34m# [m[34m[103mif[m[34m there are rows without responses, they have no theta estimates, so we have to fill in some empty rows to make the dimensions correct[m[2;7H[38;5;130m[103mif[m[35m([m[36msum[m[35m([memptyrows[35m)[m[38;5;130m>[m[31m0[m[35m){[m[3;9Hp.pred [38;5;130m=[m [36minsertEmptyRows[m[35m([mp.pred[35m,[m [36mwhich[m[35m([memptyrows[35m))[4;7H}[m[5;7H[38;5;130m[103mif[m[35m([m[36msum[m[35m([memptycols[35m)[m[38;5;130m>[m[31m0[m[35m){[m[6;9Hp.pred [38;5;130m=[m [36minsertEmptyCols[m[35m([mp.pred[35m,[m [36mwhich[m[35m([memptycols[35m))[7;7H}[m[8;7H[34m# calculate true and predicted responses[m[9;7Hresp.pred [38;5;130m=[m [36mround[m[35m([mp.pred[35m,[m [31m0[m[35m)[m[10;7Hresp.true [38;5;130m=[m [36mround[m[35m([mp.true[35m,[m [31m0[m[35m)[m[12;7H[34m# calculate metrics and save them[m[13;7Hrmses [38;5;130m<-[m [36mc[m[35m([mrmses[35m,[m [36mRMSE[m[35m([mest[38;5;130m=[mp.pred[35m[[mper.ind[35m,[m item.ind[35m],[m par[38;5;130m=[mp.true[35m[[mper.ind[35m,[m item.ind[35m]))[m[14;7Hbiases [38;5;130m<-[m [36mc[m[35m([mbiases[35m,[m [36mbias[m[35m([mest[38;5;130m=[mp.pred[35m[[mper.ind[35m,[m item.ind[35m],[m par[38;5;130m=[mp.true[35m[[mper.ind[35m,[m item.ind[35m]))[m[15;7Htop10 [38;5;130m<-[m [36macc_f1_at_n[m[35m([mtrue[38;5;130m=[mresp.true[35m,[m pred[38;5;130m=[mresp.predm[35m,[m n[38;5;130m=[m[31m10[m[35m)[m[16;7Htop20 [38;5;130m<-[m [36macc_f1_at_n[m[35m([mtrue[38;5;130m=[mresp.true[35m,[m pred[38;5;130m=[mresp.predm[35m,[m n[38;5;130m=[m[31m20[m[35m)[m[17;7Hacc10 [38;5;130m<-[m [36mc[m[35m([macc10[35m,[m top10[35m[[m[31m1[m[35m])[m[18;7Hf110 [38;5;130m<-[m [36mc[m[35m([mf110[35m,[m top10[35m[[m[31m2[m[35m])[m[19;7Hacc20 [38;5;130m<-[m [36mc[m[35m([macc20[35m,[m top20[35m[[m[31m1[m[35m])[m[20;7Hf120 [38;5;130m<-[m [36mc[m[35m([mf120[35m,[m top20[35m[[m[31m2[m[35m])[22;5H}
[m  [35m}[m
  [38;5;130mreturn[m[35m([m[36mc[m[35m([m[36mmean[m[35m([mrmses[35m),[m [36mmean[m[35m([mbiases[35m),[m [36mmean[m[35m([macc10[35m),[m [36mmean[m[35m([macc20[35m),[m [36mmean[m[35m([mf110[35m),[m [36mmean[m[35m([mf120[35m)))
}[m

[34m# read appropriate data file[m
data1 [38;5;130m=[m [36mread.csv[m[35m([m[36mpaste[m[35m([m[31m'~/data_parameters/data/'[m[35m,[m ndim[35m,[m iteration[35m,[m sparsity[35m,[m [31m'.csv'[m[35m,[m sep[38;5;130m=[m[31m'_'[m[35m),[m row.names[38;5;130m=[m[31m1[m[35m)[m

[34m# load true parameter values[m
[36mload[m[35m([mfile[38;5;130m=[m[36mpaste[m[35m([m[31m'~/data_parameters/parameters/true/true'[m[35m,[m ndim[35m,[m iteration[35m,[m sparsity[35m,[m [31m'.RData'[m[35m,[m sep[38;5;130m=[m[31m'_'[m[35m))[m

[34m# initialize paramters[m
[36mprint[m[35m([m[31m'initializing pars...'[m[35m)[m
pars [38;5;130m<-[m [36mmirt[m[35m([mdata1[35m,[mndim[35m,[m pars [38;5;130m=[m [31m'values'[m[35m,[m technical [38;5;130m=[m [32mlist[m[35m())[m

[34m# set some loadings to zero[m
[38;5;130m[103mif[m[35m([mndim[38;5;130m==[m[31m1[m[35m){[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
[35m}[m [38;5;130melse[m [38;5;130m[103mif[m [35m([mndim[38;5;130m==[m[31m2[m[35m){[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m:[m[31m5[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m:[m[31m5[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a2'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m6[m[35m:[m[31m10[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a2'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m6[m[35m:[m[31m10[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
[35m}[m[38;5;130melse[m [38;5;130m[103mif[m [35m([mndim[38;5;130m==[m[31m3[m[35m){[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m:[m[31m10[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m:[m[31m10[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a2'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m11[m[35m:[m[31m20[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a2'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m11[m[35m:[m[31m20[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a3'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m21[m[35m:[m[31m30[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a3'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m21[m[35m:[m[31m30[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
[35m}[m

[34m# fit model[m
[36mprint[m[35m([m[31m'fitting model...'[m[35m)[m
start [38;5;130m=[m [36mSys.time[m[35m()[m
metrics [38;5;130m<-[m [36mcv.mirt[m[35m([mdata1[35m,[m ndim[35m,[m[59;17Hmethod [38;5;130m=[m [31m'EM'[m[35m,[m[60;17Hrandompars [38;5;130m=[m [31mF[m[35m,[m k [38;5;130m=[m [36mc[m[35m([m[31m3[m[35m,[m[31m2[m[35m),[m[61;17Hlambda [38;5;130m=[m [36mc[m[35m([mlambda1[35m,[mlambda2[35m),[m[62;17Ha_true [38;5;130m=[m a1[35m,[m[63;17Hd_true [38;5;130m=[m d1[35m,[m[64;17Htheta_true [38;5;130m=[m theta1[35m,[m[65;17Hpars [38;5;130m=[m pars[35m)[m
end [38;5;130m=[m [36mSys.time[m[35m()[m
time [38;5;130m=[m end[38;5;130m-[mstart
[36mprint[m[35m([mtime[35m)[m

[34m# save results[m
fileConn[38;5;130m<-[m[36mfile[m[35m([m[36mpaste0[m[35m([m[31m'~/results/'[m[35m,[m lambda1[35m,[m[31m'_'[m[35m,[mlambda2[35m,[m[31m'_'[m[35m,[mndim[35m,[m [31m'_'[m[35m,[miteration[35m,[m[31m'_'[m[35m,[m sparsity[35m,[m [31m'.txt'[m[35m))[m
[36mwriteLines[m[35m([m[36mc[m[35m([m[36mas.character[m[35m([mmetrics[35m[[m[31m1[m[35m]),[m [36mas.character[m[35m([mmetrics[35m[[m[31m2[m[35m]),[m [36mas.character[m[35m([mmetrics[35m[[m[31m3[m[35m]),[m [36mas.character[m[35m([mmetrics[35m[[m[31m4[m[35m]),[m [36mas.character[m[35m([mmetrics[35m[[m[31m5[m[35m]),[m [36mas.character[m[35m([mmetrics[35m[[m[31m6[m[35m])),[m fileConn[35m)[m
[36mclose[m[35m([mfileConn[35m)[m[76;253H192,31[8CBot[47;31H[?25h[27m[23m[29m[m[H[2J[?25l[1;7H[96m# [m[30m[103mif[m[96m there are rows without responses, they have no theta estimates, so we have to fill in some empty rows to make the dimensions correct[m[2;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[3;9Hp.pred [93m=[m [1m[96minsertEmptyRows[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m))[4;7H}[m[5;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[6;9Hp.pred [93m=[m [1m[96minsertEmptyCols[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m))[7;7H}[m[8;7H[96m# calculate true and predicted responses[m[9;7Hresp.pred [93m=[m [1m[96mround[m[38;5;224m([mp.pred[38;5;224m,[m [95m0[m[38;5;224m)[m[10;7Hresp.true [93m=[m [1m[96mround[m[38;5;224m([mp.true[38;5;224m,[m [95m0[m[38;5;224m)[m[12;7H[96m# calculate metrics and save them[m[13;7Hrmses [93m<-[m [1m[96mc[m[38;5;224m([mrmses[38;5;224m,[m [1m[96mRMSE[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[14;7Hbiases [93m<-[m [1m[96mc[m[38;5;224m([mbiases[38;5;224m,[m [1m[96mbias[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[15;7Htop10 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mtrue[93m=[mresp.true[38;5;224m,[m pred[93m=[mresp.predm[38;5;224m,[m n[93m=[m[95m10[m[38;5;224m)[m[16;7Htop20 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mtrue[93m=[mresp.true[38;5;224m,[m pred[93m=[mresp.predm[38;5;224m,[m n[93m=[m[95m20[m[38;5;224m)[m[17;7Hacc10 [93m<-[m [1m[96mc[m[38;5;224m([macc10[38;5;224m,[m top10[38;5;224m[[m[95m1[m[38;5;224m])[m[18;7Hf110 [93m<-[m [1m[96mc[m[38;5;224m([mf110[38;5;224m,[m top10[38;5;224m[[m[95m2[m[38;5;224m])[m[19;7Hacc20 [93m<-[m [1m[96mc[m[38;5;224m([macc20[38;5;224m,[m top20[38;5;224m[[m[95m1[m[38;5;224m])[m[20;7Hf120 [93m<-[m [1m[96mc[m[38;5;224m([mf120[38;5;224m,[m top20[38;5;224m[[m[95m2[m[38;5;224m])[22;5H}
[m  [38;5;224m}[m
  [93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([m[1m[96mmean[m[38;5;224m([mrmses[38;5;224m),[m [1m[96mmean[m[38;5;224m([mbiases[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc10[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc20[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf110[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf120[38;5;224m)))
}[m

[96m# read appropriate data file[m
data1 [93m=[m [1m[96mread.csv[m[38;5;224m([m[1m[96mpaste[m[38;5;224m([m[95m'~/data_parameters/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m

[96m# load true parameter values[m
[1m[96mload[m[38;5;224m([mfile[93m=[m[1m[96mpaste[m[38;5;224m([m[95m'~/data_parameters/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m))[m

[96m# initialize paramters[m
[1m[96mprint[m[38;5;224m([m[95m'initializing pars...'[m[38;5;224m)[m
pars [93m<-[m [1m[96mmirt[m[38;5;224m([mdata1[38;5;224m,[mndim[38;5;224m,[m pars [93m=[m [95m'values'[m[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m())[m

[96m# set some loadings to zero[m
[30m[103mif[m[38;5;224m([mndim[93m==[m[95m1[m[38;5;224m){[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
[38;5;224m}[m [93melse[m [30m[103mif[m [38;5;224m([mndim[93m==[m[95m2[m[38;5;224m){[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m5[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m5[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m6[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m6[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
[38;5;224m}[m[93melse[m [30m[103mif[m [38;5;224m([mndim[93m==[m[95m3[m[38;5;224m){[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m11[m[38;5;224m:[m[95m20[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m11[m[38;5;224m:[m[95m20[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a3'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m21[m[38;5;224m:[m[95m30[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a3'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m21[m[38;5;224m:[m[95m30[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
[38;5;224m}[m

[96m# fit model[m
[1m[96mprint[m[38;5;224m([m[95m'fitting model...'[m[38;5;224m)[m
start [93m=[m [1m[96mSys.time[m[38;5;224m()[m
metrics [93m<-[m [1m[96mcv.mirt[m[38;5;224m([mdata1[38;5;224m,[m ndim[38;5;224m,[m[59;17Hmethod [93m=[m [95m'EM'[m[38;5;224m,[m[60;17Hrandompars [93m=[m [95mF[m[38;5;224m,[m k [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m[61;17Hlambda [93m=[m [1m[96mc[m[38;5;224m([mlambda1[38;5;224m,[mlambda2[38;5;224m),[m[62;17Ha_true [93m=[m a1[38;5;224m,[m[63;17Hd_true [93m=[m d1[38;5;224m,[m[64;17Htheta_true [93m=[m theta1[38;5;224m,[m[65;17Hpars [93m=[m pars[38;5;224m)[m
end [93m=[m [1m[96mSys.time[m[38;5;224m()[m
time [93m=[m end[93m-[mstart
[1m[96mprint[m[38;5;224m([mtime[38;5;224m)[m

[96m# save results[m
fileConn[93m<-[m[1m[96mfile[m[38;5;224m([m[1m[96mpaste0[m[38;5;224m([m[95m'~/results/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[38;5;224m))[m
[1m[96mwriteLines[m[38;5;224m([m[1m[96mc[m[38;5;224m([m[1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m1[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m2[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m3[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m4[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m5[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m6[m[38;5;224m])),[m fileConn[38;5;224m)[m
[1m[96mclose[m[38;5;224m([mfileConn[38;5;224m)[m[76;253H192,31[8CBot"fitscript.R" 220L, 8046C[47;31H[?25h[?25l[76;243H~@k[47;31H[76;243H   [46;19H[38;5;224m[46m{[53;1H}[m[76;255H1,19[46;19H[?25h[?25l[76;243H~@k[46;19H[76;243H   [45;19H[46;19H[38;5;224m{[53;1H}[m[76;255H0[45;19H[?25h[?25l[76;254H89[44;19H[?25h[?25l[76;255H8[43;19H[?25h[?25l[76;243H~@k[43;19H[76;243H   [42;19H[76;255H7[42;19H[?25h[?25l[41;11H[38;5;224m[46m([7C)[m[76;255H6[41;19H[?25h[?25l[41;11H[38;5;224m([7C)[m[76;255H5[40;19H[?25h[?25l[76;255H4[39;19H[?25h[?25l[38;12H[38;5;224m[46m{


}[m[76;255H3,12[38;12H[?25h[?25l[76;243H~@k[38;12H[76;243H   [37;19H[38;12H[38;5;224m{


}[m[76;255H2,19[37;19H[?25h[?25l[76;255H1,0-1[36;1H[?25h[?25l[76;255H0,19 [35;19H[?25h[?25l[76;243H~@k[35;19H[76;243H   [34;19H[76;254H79[34;19H[?25h[?25l[76;255H8[33;19H[?25h[?25l[76;255H7,6 [32;6H[?25h[?25l[76;243H~@k[32;6H[76;243H   [31;19H[76;255H6,19[31;19H[?25h[?25l[76;243H~@k[31;19H[76;243H   [30;19H[76;255H5[30;19H[?25h[?25l[76;243H~@k[30;19H[76;243H   [29;1H[76;255H4,0-1[29;1H[?25h[?25l[76;243H~@k[29;1H[76;243H   [28;19H[76;255H3,19 [28;19H[?25h[?25l[76;255H2[27;19H[?25h[?25l[76;255H1,0-1[26;1H[?25h[?25l[76;255H0,1  [25;1H[?25h[?25l[76;254H69,19[24;19H[?25h[?25l[76;254H70,1 [25;1H[?25h[?25l[76;255H1,0-1[26;1H[?25h[?25l[76;255H2,19 [27;19H[?25h[?25l[76;255H3[28;19H[?25h[?25l[76;243H~@k[28;19H[76;243H   [29;1H[76;255H4,0-1[29;1H[?25h[?25l[76;255H3,19 [28;19H[?25h[?25l[76;255H2[27;19H[?25h[?25l[76;255H1,0-1[26;1H[?25h[?25l[76;255H0,1  [25;1H[?25h[?25l[76;243H~@k[25;1H[76;243H   [24;19H[76;254H69,19[24;19H[?25h[?25l[76;255H8,3 [23;3H[?25h[?25l[76;255H7,5[22;5H[?25h[?25l[76;255H6,6[21;6H[?25h[?25l[76;255H5,19[20;19H[?25h[?25l[76;243H~@k[20;19H[76;243H   [19;19H[76;255H4[19;19H[?25h[?25l[76;255H3[18;19H[?25h[?25l[76;255H2[17;19H[?25h[?25l[76;255H1[16;19H[?25h[?25l[76;255H0[15;19H[?25h[?25l[76;254H59[14;19H[?25h[?25l[76;255H8[13;19H[?25h[?25l[76;243H~@k[13;19H[76;243H   [12;19H[76;255H7[12;19H[?25h[?25l[76;255H6,6 [11;6H[?25h[?25l[76;255H5,19[10;19H[?25h[?25l[76;255H4[9;19H[?25h[?25l[76;255H3[8;19H[?25h[?25l[76;243H~@k[8;19H[76;243H   [7;7H[5;27H[38;5;224m[46m{[7;7H}[m[76;255H2,7 [7;7H[?25h[?25l[5;27H[38;5;224m{[7;7H}[m[76;255H1,19[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[76;1H[K[76;253H150,19[8C99%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;7H[1;75r[1;1H[L[1;76r[1;7Hp.true [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma_true[38;5;224m,[m [1m[96mas.vector[m[38;5;224m([md_true[38;5;224m),[m theta_true[38;5;224m)[m[4;27H[38;5;224m[46m{[6;7H}[m[76;253H[K[76;253H149,7[9C98%[6;7H[?25h[?25l[4;27H[38;5;224m{[6;7H}[m[76;254H50,19[7;19H[?25h[?25l[76;255H1[8;19H[?25h[?25l[7;27H[38;5;224m[46m{[9;7H}[m[76;255H2,7 [9;7H[?25h[?25l[76;243H~@k[9;7H[76;243H   [10;19H[7;27H[38;5;224m{[9;7H}[m[76;255H3,19[10;19H[?25h[?25l[7;27H[38;5;224m[46m{[9;7H}[m[76;255H2,7 [9;7H[?25h[?25l[7;27H[38;5;224m{[9;7H}[m[76;255H1,19[8;19H[?25h[?25l[76;255H0[7;19H[?25h[?25l[4;27H[38;5;224m[46m{[6;7H}[m[76;254H49,7 [6;7H[?25h[?25l[76;243H~@k[6;7H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;7Hp.pred [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)[5;27H{[7;7H}[m[76;253H[K[76;253H148,19[8C97%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[96m# calculate true and predicted probablities[m[76;253H[K[76;253H147,19[8C97%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H146,19[8C96%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Htheta [93m<-[m [1m[96mfscores[m[38;5;224m([mfit[38;5;224m)[m[76;253H[K[76;253H145,6[9C95%[6;6H[?25h[?25l[76;243H~@k[6;6H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;7Hd [93m<-[m itempars[38;5;224m[,[m [1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m2[m[38;5;224m][m[76;253H[K[76;253H144,19[8C95%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Ha [93m<-[m itempars[38;5;224m[,[m[95m1[m[38;5;224m:([m[1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m3[m[38;5;224m)][m[76;253H[K[76;253H143,19[8C94%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hitempars [93m<-[m [1m[96mcoef[m[38;5;224m([mfit[38;5;224m,[m simplify [93m=[m [95mTRUE[m[38;5;224m)$[mitems[76;253H[K[76;253H142,19[8C93%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[96m# save parameters[m[76;253H[K[76;253H141,6[9C93%[6;6H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hfit [93m<-[m [1m[96mmirt[m[38;5;224m([mtrain[38;5;224m,[m model[38;5;224m,[m [95m'2PL'[m[38;5;224m,[m method[93m=[mmethod[38;5;224m,[m GenRandomPars[93m=[mrandompars[38;5;224m,[m lambda[93m=[mlambda[38;5;224m,[m pars[93m=[mpars[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m())[m[76;253H[K[76;253H140,19[8C92%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[96m# fit model[m[76;253H[K[76;253H139,19[8C91%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H138,19[8C91%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[38;5;224m}[m[76;253H[K[76;253H137,19[8C90%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;9Hitem.ind [93m=[m item.ind[38;5;224m[[m[93m![mitem.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m)][m[76;253H[K[76;253H136,19[8C89%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;9Htrain [93m=[m train[38;5;224m[,[m[93m![memptycols[38;5;224m][m[76;253H[K[76;253H135,19[8C88%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H134,17[8C88%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[96m# do the same for columns[m[76;253H[K[76;253H133,6[9C87%[6;6H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[38;5;224m}[m[3;27H[38;5;224m[46m{[6;7H}[m[76;253H[K[76;253H132,7[9C86%[6;7H[?25h[?25l[1;75r[1;1H[L[1;76r[1;9Hper.ind [93m=[m per.ind[38;5;224m[[m[93m![mper.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m)][4;27H{[7;7H}[m[76;253H[K[76;253H131,19[8C86%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;9Htrain [93m=[m train[38;5;224m[[m[93m![memptyrows[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H130,19[8C85%[6;19H[?25h[?25l[76;255H1[7;19H[?25h[?25l[5;27H[38;5;224m[46m{[8;7H}[m[76;255H2,7 [8;7H[?25h[?25l[5;27H[38;5;224m{[8;7H}[m[76;255H3,6[9;6H[?25h[?25l[76;243H~@k[9;6H[76;243H   [10;17H[76;255H4,17[10;17H[?25h[?25l[76;255H3,6 [9;6H[?25h[?25l[5;27H[38;5;224m[46m{[8;7H}[m[76;255H2,7[8;7H[?25h[?25l[5;27H[38;5;224m{[8;7H}[m[76;255H1,19[7;19H[?25h[?25l[76;243H~@k[7;19H[76;243H   [6;19H[76;255H0[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H129,19[8C84%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hemptycols [93m=[m [1m[96mcolSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mnrow[m[38;5;224m([mtrain[38;5;224m)[m[76;253H[K[76;253H128,19[8C84%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hemptyrows [93m=[m [1m[96mrowSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mncol[m[38;5;224m([mtrain[38;5;224m)[m[3;27H[38;5;224m[46m{[6;7H}[m[76;253H[K[76;253H127,7[9C83%[6;7H[?25h[?25l[76;243H~@k[6;7H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;7H[96m# [m[30m[103mif[m[96m some rows contain no responses after the leave out set, remove them from the training set, and adjust person indices accordingly[m[4;27H[38;5;224m{[7;7H}[m[76;253H[K[76;253H126,19[8C82%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H125,19[8C82%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;7Htrain[38;5;224m[[mper.ind[38;5;224m,[mitem.ind[38;5;224m][m [93m<-[m [95mNA[m[76;253H[K[76;253H124,19[8C81%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Htrain [93m<-[m data[76;253H[K[76;253H123,19[8C80%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Htest [93m<-[m data[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m][m[76;253H[K[76;253H122,19[8C80%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[96m# create train and test folds[m[76;253H[K[76;253H121,19[8C79%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;6H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H120,6[9C78%[6;6H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hitem.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.items[93m==[mj[38;5;224m)[m[76;253H[K[76;253H119,19[8C77%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hper.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.persons[93m==[mi[38;5;224m)[m[76;253H[K[76;253H118,19[8C77%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[96m# save the persons and items that belong to the hold out test set[m[6;19H[38;5;224m[46m[[17C][m[76;253H[K[76;253H117,19[8C76%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[38;5;224m{[7;19H[[17C][m[76;253H[K[76;253H116,19[8C75%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[93mfor[m [38;5;224m([mj [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H115,6[9C75%[6;6H[?25h[?25l[76;243H~@k[6;6H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;3H[38;5;224m{[m[76;253H[K[76;253H114,19[8C74%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H113,19[8C73%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[96m# loop though cross validation folds[m[76;253H[K[76;253H112,19[8C73%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[6;5H[38;5;224m[46m{[62;5H}[m[76;253H[K[76;253H111,5[9C72%[6;5H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hf1s [93m=[m [1m[96mc[m[38;5;224m()[7;5H{[63;5H}[m[76;253H[K[76;253H110,19[8C71%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Haccuracies [93m=[m [1m[96mc[m[38;5;224m()[m[6;3H[38;5;224m[46m{[65;3H}[m[76;253H[K[76;253H109,3[9C71%[6;3H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hbiases [93m=[m [1m[96mc[m[38;5;224m()[m[6;7H[38;5;224m[46m([11C)[m
  [38;5;224m{[66;3H}[m[76;253H[K[76;253H108,19[8C70%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hrmses [93m=[m [1m[96mc[m[38;5;224m()[7;7H([11C)[m[76;253H[K[76;253H107,19[8C69%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H106,2[9C68%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hfolds.items [93m<-[m [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mncol[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m2[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[6;10H[38;5;224m[46m()[m[76;253H[K[76;253H105,11[8C68%[6;11H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hfolds.persons [93m<-[m  [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mnrow[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m1[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[6;17H[38;5;224m[46m()[m[7;10H[38;5;224m()[m[76;253H[K[76;253H104,18[8C67%[6;18H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[96m# calculate to which fold each person and item belongs[m[6;13H[38;5;224m[46m()[m[7;17H[38;5;224m()[m[76;253H[K[76;253H103,14[8C66%[6;14H[?25h[?25l[1;75r[1;1H[L[1;76r[6;12H[38;5;224m[46m()[m[7;13H[38;5;224m()[m[76;253H[K[76;253H102,13[8C66%[6;13H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m{[7;12H()[m[76;253H[K[76;253H101,0-1[7C65%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hpars[38;5;224m)[m[10C[96m# parameters object from mirt[m[76;253H[K[76;253H100,19[8C64%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Htheta_true[38;5;224m,[m    [96m# true parameter values[m[76;253H[K[76;253H99,19[9C64%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hd_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H98,19[9C63%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Ha_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H97,2[10C62%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hlambda[38;5;224m,[m[8C[96m# l1 and l2 penalty[m[76;253H[K[76;253H96,1[10C62%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hk [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m    [96m# number of folds for 2d cross validation[m[76;253H[K[76;253H95,19[9C61%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;21Hrandompars[38;5;224m,[m    [96m# mirt argument for whether to use random paramters values[m[76;253H[K[76;253H94,19[9C60%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;21Hmethod[38;5;224m,[m[8C[96m# method of esitmation, e.g. EM[m[76;253H[K[76;253H93,19[9C60%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;21Hmodel[38;5;224m,[m[9C[96m# model to be passed to mirt, can be number of dimensions[m[76;253H[K[76;253H92,19[9C59%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hcv.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([mdata[38;5;224m,[m[10C[96m# matrix of responses[m[76;253H[K[76;253H91,19[9C58%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# Function that fits rgmirt model using cross validation and returns the average RMSE and average bias[m[76;253H[K[76;253H90,19[9C57%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H89,19[9C57%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H88,19[9C56%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[m[76;253H[K[76;253H87,19[9C55%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([mavg_topn_accuracy[38;5;224m,[m avg_topn_f1_score[38;5;224m))[m[76;253H[K[76;253H86,19[9C55%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H85,19[9C54%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Havg_topn_f1_score [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_f1_scores[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H84,0-1[8C53%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Havg_topn_accuracy [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_accuracies[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H83,0-1[8C53%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;3H[96m# Calculate the average top-n accuracy and top-n F1 score across all users[m[76;253H[K[76;253H82,1[10C52%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H81,19[9C51%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[38;5;224m}[m[76;253H[K[76;253H80,2[10C51%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htopn_f1_scores[38;5;224m[[mi[38;5;224m][m [93m<-[m f1_score[76;253H[K[76;253H79,19[9C50%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htopn_accuracies[38;5;224m[[mi[38;5;224m][m [93m<-[m topn_accuracy[76;253H[K[76;253H78,19[9C49%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H77,19[9C48%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;2H[1;75r[1;1H[L[1;76r[1;5Hf1_score [93m<-[m [95m2[m [93m*[m precision [93m*[m recall [93m/[m [38;5;224m([mprecision [93m+[m recall[38;5;224m)[m[76;253H[K[76;253H76,2[10C48%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H75,3[10C47%[6;3H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hrecall [93m<-[m true_positives [93m/[m actual_positives[6;19H[38;5;224m[46m[[mi[38;5;224m[46m][m[76;253H[K[76;253H74,19[9C46%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hprecision [93m<-[m true_positives [93m/[m predicted_positives[7;19H[38;5;224m[[mi[38;5;224m][m[76;253H[K[76;253H73,19[9C46%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H72,4[10C45%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hactual_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m[76;253H[K[76;253H71,19[9C44%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hpredicted_positives [93m<-[m [1m[96msum[m[38;5;224m([mpred_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m[76;253H[K[76;253H70,4[10C44%[6;4H[?25h[?25l[76;243H~@k[6;4H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;5Htrue_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m[76;253H[K[76;253H69,19[9C43%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[96m# Calculate the top-n F1 score for the current user[m[76;253H[K[76;253H68,19[9C42%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H67,4[10C42%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htopn_accuracy [93m<-[m [1m[96msum[m[38;5;224m([mtrue_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m [93m/[m n[76;253H[K[76;253H66,19[9C41%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[96m# Calculate the top-n accuracy for the current user[m[76;253H[K[76;253H65,19[9C40%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H64,19[9C40%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htopn_indices [93m<-[m [1m[96morder[m[38;5;224m([m[93m-[mpred_relevance[38;5;224m)[[m[95m1[m[38;5;224m:[mn[38;5;224m][m[76;253H[K[76;253H63,19[9C39%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;4H[1;75r[1;1H[L[1;76r[1;5H[96m# Get the indices of the top-n predicted relevance[m[76;253H[K[76;253H62,4[10C38%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H61,19[9C37%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hpred_relevance [93m<-[m pred[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H60,19[9C37%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htrue_relevance [93m<-[m true[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H59,4[10C36%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mnum_users[38;5;224m)[m [38;5;224m{[m[76;253H[K[76;253H58,19[9C35%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H57,19[9C35%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Htopn_f1_scores [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m[76;253H[K[76;253H56,4[10C34%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Htopn_accuracies [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m[76;253H[K[76;253H55,19[9C33%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H54,19[9C33%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hnum_movies [93m<-[m [1m[96mdim[m[38;5;224m([mtrue[38;5;224m)[[m[95m2[m[38;5;224m][m[76;253H[K[76;253H53,19[9C32%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hnum_users [93m<-[m [1m[96mdim[m[38;5;224m([mtrue[38;5;224m)[[m[95m1[m[38;5;224m][m[76;253H[K[76;253H52,2[10C31%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H51,19[9C31%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hacc_f1_at_n [93m<-[m [38;5;121mfunction[m[38;5;224m([mtrue[38;5;224m,[m pred[38;5;224m,[m n[38;5;224m)[m [38;5;224m{[m[76;253H[K[76;253H50,19[9C30%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H49,2[10C29%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[m[76;253H[K[76;253H48,19[9C28%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[1m[96mmean[m[38;5;224m([mest[93m-[mpar[38;5;224m)[m[6;19H[38;5;224m[46m([mtrue[38;5;224m[46m)[m[76;253H[K[76;253H47,19[9C28%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m{[7;19H([mtrue[38;5;224m)[m[76;253H[K[76;253H46,0-1[8C27%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;1Hbias [93m<-[m [38;5;121mfunction[m[38;5;224m([mpar[38;5;224m,[m est[38;5;224m)[m[76;253H[K[76;253H45,19[9C26%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;1H[96m# bias [m[76;253H[K[76;253H44,0-1[8C26%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[4;1H[38;5;224m[46m{

}[m[76;253H[K[76;253H43,1[10C25%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[5;1H{[m[6;7H[38;5;224m[46m([7C)[m
[38;5;224m}[m[76;253H[K[76;253H42,15[9C24%[6;15H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[1m[96msqrt[m[38;5;224m([m[1m[96msum[m[38;5;224m(([mest[93m-[mpar[38;5;224m)[m[93m^[m[95m2[m[38;5;224m)[m [93m/[m [1m[96mlength[m[38;5;224m([mpar[38;5;224m))[m[6;1H[38;5;224m[46m{[m[7;7H[38;5;224m([7C)[m
[38;5;224m[46m}[m[76;253H[K[76;253H41,1[10C24%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m{[7;1H{

}[m[76;253H[K[76;253H40,19[9C23%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;7H[1;75r[1;1H[L[1;76r[1;1HRMSE [93m<-[m [38;5;121mfunction[m[38;5;224m([mpar[38;5;224m,[m est[38;5;224m)[m[76;253H[K[76;253H39,7[10C22%[6;7H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# Root mean square error[m[76;253H[K[76;253H38,0-1[8C22%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[4;1H[38;5;224m[46m{

}[m[76;253H[K[76;253H37,1[10C21%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[5;1H{

}[m[76;253H[K[76;253H36,19[9C20%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mreturn[m[38;5;224m([mnew[38;5;224m)[m[6;1H[38;5;224m[46m{

}[m[76;253H[K[76;253H35,1[10C20%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hnew[38;5;224m[[m[93m-[mcs[38;5;224m,][m [93m<-[m m[7;1H[38;5;224m{

}[m[76;253H[K[76;253H34,19[9C19%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;3Hnew [93m=[m [38;5;121mmatrix[m[38;5;224m([m[95mNA[m[38;5;224m,[m nrow[93m=[m[1m[96mnrow[m[38;5;224m([mm[38;5;224m),[m ncol[93m=[m[1m[96mncol[m[38;5;224m([mm[38;5;224m)[m[93m+[m[1m[96mlength[m[38;5;224m([mcs[38;5;224m))[m[76;253H[K[76;253H33,19[9C18%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1HinsertEmptyCols [93m<-[m [38;5;121mfunction[m[38;5;224m([mm[38;5;224m,[m cs[38;5;224m){[m[76;253H[K[76;253H32,0-1[8C17%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# function that inserts NA rows at each index specified in m[m[2;35H[38;5;224m[46m{[6;1H}[m[76;253H[K[76;253H31,1[10C17%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[3;35H{[m[6;9H[38;5;224m[46m([mnew[38;5;224m[46m)[m
[38;5;224m}[m[76;253H[K[76;253H30,13[9C16%[6;13H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mreturn[m[38;5;224m([mnew[38;5;224m)[7;9H([mnew[38;5;224m)[m[76;253H[K[76;253H29,16[9C15%[6;16H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hnew[38;5;224m[[m[93m-[mrs[38;5;224m,][m [93m<-[m m[76;253H[K[76;253H28,19[9C15%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hnew [93m=[m [38;5;121mmatrix[m[38;5;224m([m[95mNA[m[38;5;224m,[m nrow[93m=[m[1m[96mnrow[m[38;5;224m([mm[38;5;224m)[m[93m+[m[1m[96mlength[m[38;5;224m([mrs[38;5;224m),[m ncol[93m=[m[1m[96mncol[m[38;5;224m([mm[38;5;224m))[m[76;253H[K[76;253H27,19[9C14%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;1HinsertEmptyRows [93m<-[m [38;5;121mfunction[m[38;5;224m([mm[38;5;224m,[m rs[38;5;224m){[m[76;253H[K[76;253H26,19[9C13%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# function that inserts NA rows at each index specified in m[m[2;35H[38;5;224m[46m{[6;1H}[m[76;253H[K[76;253H25,1[10C13%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[3;35H[38;5;224m{[m[6;9H[38;5;224m[46m([mnew[38;5;224m[46m)[m
[38;5;224m}[m[76;253H[K[76;253H24,13[9C12%[6;13H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[7;9H([mnew[38;5;224m)[m[76;253H[K[76;253H23,16[9C11%[6;16H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mreturn[m[38;5;224m([mprob[38;5;224m)[m[76;253H[K[76;253H22,19[9C11%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H21,19[9C10%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hprob [93m<-[m [1m[96mt[m[38;5;224m([m[1m[96mexp[m[38;5;224m([ma [93m%*%[m [1m[96mt[m[38;5;224m([mtheta[38;5;224m)[m [93m+[md[38;5;224m)[m [93m/[m [38;5;224m([m[95m1[m [93m+[m [1m[96mexp[m[38;5;224m([ma [93m%*%[m [1m[96mt[m[38;5;224m([mtheta[38;5;224m)[m[93m+[md[38;5;224m)))[m[76;253H[K[76;253H20,19[10C9%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;1H[38;5;224m{[m[76;253H[K[76;253H19,0-1[9C8%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hpredict.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)[m
[38;5;224m[46m{[6;1H}[m[76;253H[K[76;253H18,1[11C8%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# predict probabilities based on mirt parameters[m

[38;5;224m{[m[6;9H[38;5;224m[46m([mprob[38;5;224m[46m)[m
[38;5;224m}[m[76;253H[K[76;253H17,14[10C7%[6;14H[?25h[?25l[1;75r[1;1H[L[1;76r[7;9H[38;5;224m([mprob[38;5;224m)[m[76;253H[K[76;253H16,2[11C6%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;81mlibrary[m[38;5;224m([mmirt[38;5;224m)[m[76;253H[K[76;253H15,19[10C6%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# load adapted version of mirt library (rgmirt)[m[6;1H[38;5;224m[46m{[10;1H}[m[76;253H[K[76;253H14,1[11C5%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[7;1H[38;5;224m{[11;1H}[m[76;253H[K[76;253H13,19[10C4%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;1Hsparsity [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m5[m[38;5;224m])[m  [96m# sparsity of the dataset [m[76;253H[K[76;253H12,19[10C4%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;1Hiteration [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m4[m[38;5;224m])[m [96m# number of the current iteration[m[76;253H[K[76;253H11,0-1[9C3%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;13H[1;75r[1;1H[L[1;76r[1;1Hndim [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m3[m[38;5;224m])[m      [96m# number of latent dimensions[m[6;8H[38;5;224m[46m([mmirt[38;5;224m[46m)[m[76;253H[K[76;253H10,13[10C2%[6;13H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hlambda2 [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m2[m[38;5;224m])[m   [96m# l2 penalty[m[7;8H[38;5;224m([mmirt[38;5;224m)[m[76;253H[K[76;253H9,19[11C2%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hlambda1 [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m1[m[38;5;224m])[m   [96m# l1 penalty [m[76;253H[K[76;253H8,0-1[10C1%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hargs [93m=[m [1m[96mcommandArgs[m[38;5;224m([mtrailingOnly[93m=[m[95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H7,19[11C0%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;1H[96m# read command line arguments[m[76;253H[K[76;253H6,19[10CTop[6;19H[?25h[?25l[76;253H5[5;19H[?25h[?25l[76;253H4[4;19H[?25h[?25l[76;253H3[3;19H[?25h[?25l[76;243H~@k[3;19H[76;243H   [2;19H[38;5;224m[46m([17C)[m[76;253H2[2;19H[?25h[?25l[76;243H~@k[2;19H[76;243H   [1;19H[2;19H[38;5;224m([17C)[m[76;253H1[1;19H[?25h[?25l[76;243H~@k[1;19H[76;243H   [1;19H[?25h[?25l[76;243H~@k[1;19H[76;243H   [1;19H[?25h[?25l[76;243H~@k[1;19H[76;243H   [1;19H[?25h[?25l[76;243H~@k[1;19H[76;243H   [1;19H[?25h[?25l[76;243H~@k[1;19H[76;243H   [1;19H[?25h[?25l[76;243H~@k[1;19H[76;243H   [1;19H[?25h[?25l[2;19H[38;5;224m[46m([17C)[m[76;253H2[2;19H[?25h[?25l[38;5;224m([17C)[m[76;253H3[3;19H[?25h[?25l[76;243H~@k[3;19H[76;243H   [4;19H[76;253H4[4;19H[?25h[?25l[76;243H~@k[4;19H[76;243H   [5;19H[76;253H5[5;19H[?25h[?25l[76;243H~@k[5;19H[76;243H   [6;19H[76;253H6[6;19H[?25h[?25l[76;253H7[7;19H[?25h[?25l[76;253H8,0-1[8;1H[?25h[?25l[76;243H~@k[8;1H[76;243H   [9;19H[76;253H9,19 [9;19H[?25h[?25l[10;8H[38;5;224m[46m([mmirt[38;5;224m[46m)[m[76;253H10,13[10;13H[?25h[?25l[38;5;224m([mmirt[38;5;224m)[m[76;254H1,0-1[11;1H[?25h[?25l[76;254H2,19 [12;19H[?25h[?25l[76;243H~@k[12;19H[76;243H   [13;19H[76;254H3[13;19H[?25h[?25l
[38;5;224m[46m{[18;1H}[m[76;254H4,1 [14;1H[?25h[?25l[38;5;224m{[18;1H}[m[76;254H5,19[15;19H[?25h[?25l[76;254H6,2 [16;2H[?25h[?25l[17;9H[38;5;224m[46m([mprob[38;5;224m[46m)[m[76;254H7,14[17;14H[?25h[?25l[76;243H~@k[17;14H[76;243H   [18;1H[14;1H[38;5;224m[46m{[m[17;9H[38;5;224m([mprob[38;5;224m)[m
[38;5;224m[46m}[m[76;254H8,1 [18;1H[?25h[?25l[14;1H[38;5;224m{[18;1H}[m[76;254H9,0-1[19;1H[?25h[?25l[76;253H20,19 [20;19H[?25h[?25l[76;243H~@k[20;19H[76;243H   [21;19H[76;254H1[21;19H[?25h[?25l[76;254H2[22;19H[?25h[?25l[76;243H~@k[22;19H[76;243H   [23;16H[76;254H3,16[23;16H[?25h[?25l[24;9H[38;5;224m[46m([mnew[38;5;224m[46m)[m[76;254H4,13[24;13H[?25h[?25l[21;35H[38;5;224m[46m{[m[24;9H[38;5;224m([mnew[38;5;224m)[m
[38;5;224m[46m}[m[76;254H5,1 [25;1H[?25h[?25l[21;35H[38;5;224m{[25;1H}[m[76;254H6,19[26;19H[?25h[?25l[76;254H7[27;19H[?25h[?25l[76;243H~@k[27;19H[76;243H   [28;19H[76;254H8[28;19H[?25h[?25l[76;243H~@k[28;19H[76;243H   [29;16H[76;254H9,16[29;16H[?25h[?25l[76;243H~@k[29;16H[76;243H   [30;13H[38;5;224m[46m([mnew[38;5;224m[46m)[m[76;253H30,13[30;13H[?25h[?25l[76;243H~@k[30;13H[76;243H   [31;1H[27;35H[38;5;224m[46m{[m[30;9H[38;5;224m([mnew[38;5;224m)[m
[38;5;224m[46m}[m[76;254H1,1 [31;1H[?25h[?25l[76;243H~@k[31;1H[76;243H   [32;1H[27;35H[38;5;224m{[31;1H}[m[76;254H2,0-1[32;1H[?25h[?25l[76;243H~@k[32;1H[76;243H   [33;19H[76;254H3,19 [33;19H[?25h[?25l[76;254H4[34;19H[?25h[?25l
[38;5;224m[46m{

}[m[76;254H5,1 [35;1H[?25h[?25l[38;5;224m{

}[m[76;254H6,19[36;19H[?25h[?25l[35;1H[38;5;224m[46m{

}[m[76;254H7,1 [37;1H[?25h[?25l[76;243H~@k[37;1H[76;243H   [38;1H[35;1H[38;5;224m{

}[m[76;254H8,0-1[38;1H[?25h[?25l[76;254H9,7  [39;7H[?25h[?25l[76;253H40,19[40;19H[?25h[?25l[76;243H~@k[40;19H[76;243H   [41;1H[38;5;224m[46m{

}[m[76;254H1,1 [41;1H[?25h[?25l[38;5;224m{[m[42;7H[38;5;224m[46m([7C)[m
[38;5;224m}[m[76;254H2,15[42;15H[?25h[?25l[41;1H[38;5;224m[46m{[m[42;7H[38;5;224m([7C)[m
[38;5;224m[46m}[m[76;254H3,1 [43;1H[?25h[?25l[76;243H~@k[43;1H[76;243H   [44;1H[41;1H[38;5;224m{

}[m[76;254H4,0-1[44;1H[?25h[?25l[76;254H5,19 [45;19H[?25h[?25l[76;254H6,0-1[46;1H[?25h[?25l[47;19H[38;5;224m[46m([mtrue[38;5;224m[46m)[m[76;254H7,19 [47;19H[?25h[?25l[38;5;224m([mtrue[38;5;224m)[m[76;254H8[48;19H[?25h[?25l[76;254H9,2 [49;2H[?25h[?25l[76;253H50,19[50;19H[?25h[?25l[76;243H~@k[50;19H[76;243H   [51;19H[76;254H1[51;19H[?25h[?25l[76;254H2,2 [52;2H[?25h[?25l[76;254H3,19[53;19H[?25h[?25l[76;243H~@k[53;19H[76;243H   [54;19H[76;254H4[54;19H[?25h[?25l[76;254H5[55;19H[?25h[?25l[76;254H6,4 [56;4H[?25h[?25l[76;254H7,19[57;19H[?25h[?25l[76;243H~@k[57;19H[76;243H   [58;19H[76;254H8[58;19H[?25h[?25l[76;243H~@k[58;19H[76;243H   [59;4H[76;254H9,4 [59;4H[?25h[?25l[76;254H8,19[58;19H[?25h[?25l[76;254H7[57;19H[?25h[?25l[76;254H6,4 [56;4H[?25h[?25l[76;243H~@k[56;4H[76;243H   [55;19H[76;254H5,19[55;19H[?25h[?25l[76;254H6,4 [56;4H[?25h[?25l[76;254H7,19[57;19H[?25h[?25l[76;254H8[58;19H[?25h[?25l[76;254H9,4 [59;4H[?25h[?25l[76;243H~@k[59;4H[76;243H   [60;19H[76;253H60,19[60;19H[?25h[?25l[76;254H1[61;19H[?25h[?25l[76;254H2,4 [62;4H[?25h[?25l[76;243H~@k[62;4H[76;243H   [63;19H[76;254H3,19[63;19H[?25h[?25l[76;243H~@k[63;19H[76;243H   [64;19H[76;254H4[64;19H[?25h[?25l[76;254H3[63;19H[?25h[?25l[76;254H2,4 [62;4H[?25h[?25l[76;254H1,19[61;19H[?25h[?25l[76;243H~@k[61;19H[76;243H   [60;19H[76;254H0[60;19H[?25h[?25l[76;254H1[61;19H[?25h[?25l[76;254H2,4 [62;4H[?25h[?25l[76;254H3,19[63;19H[?25h[?25l[76;243H~@k[63;19H[76;243H   [64;19H[76;254H4[64;19H[?25h[?25l[76;254H5[65;19H[?25h[?25l[76;254H6[66;19H[?25h[?25l[76;243H~@k[66;19H[76;243H   [67;4H[76;254H7,4 [67;4H[?25h[?25l[76;243H~@k[67;4H[76;243H   [68;19H[76;254H8,19[68;19H[?25h[?25l[76;254H9[69;19H[?25h[?25l[76;243H~@k[69;19H[76;243H   [70;4H[76;253H70,4 [70;4H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H71,19[10C0%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;3H[96m# Calculate the average top-n accuracy and top-n F1 score across all users[m[76;253H[K[76;253H72,4[11C1%[70;4H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Havg_topn_accuracy [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_accuracies[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H73,19[10C2%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[70;19H[38;5;224m[46m[[mi[38;5;224m[46m][m[75;3Havg_topn_f1_score [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_f1_scores[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H74,19[10C2%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[48;26H[38;5;224m[46m{[m[69;19H[38;5;224m[[mi[38;5;224m][m
  [38;5;224m[46m}[m[76;253H[K[76;253H75,3[11C3%[70;3H[?25h[?25l[1;75r[75;1H
[1;76r[47;26H[38;5;224m{[69;3H}[m[75;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([mavg_topn_accuracy[38;5;224m,[m avg_topn_f1_score[38;5;224m))[m[76;253H[K[76;253H76,2[11C4%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m[76;253H[K[76;253H77,19[10C4%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H78,19[10C5%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H79,19[10C6%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# Function that fits rgmirt model using cross validation and returns the average RMSE and average bias[m[76;253H[K[76;253H80,2[11C6%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;1Hcv.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([mdata[38;5;224m,[m[10C[96m# matrix of responses[m[76;253H[K[76;253H81,19[10C7%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[33;40H[38;5;224m[46m{[70;1H}[m[75;21Hmodel[38;5;224m,[m[9C[96m# model to be passed to mirt, can be number of dimensions[m[76;253H[K[76;253H82,1[11C8%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[32;40H[38;5;224m{[69;1H}[m[75;21Hmethod[38;5;224m,[m[8C[96m# method of esitmation, e.g. EM[m[76;253H[K[76;253H83,0-1[9C8%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;21Hrandompars[38;5;224m,[m    [96m# mirt argument for whether to use random paramters values[m[76;253H[K[76;253H84,0-1[9C9%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;21Hk [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m    [96m# number of folds for 2d cross validation[m[76;253H[K[76;253H85,19[9C10%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;21Hlambda[38;5;224m,[m[8C[96m# l1 and l2 penalty[m[76;253H[K[76;253H86,19[9C11%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;21Ha_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H87,19[9C11%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;21Hd_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H88,19[9C12%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;21Htheta_true[38;5;224m,[m    [96m# true parameter values[m[76;253H[K[76;253H89,19[9C13%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;21Hpars[38;5;224m)[m[10C[96m# parameters object from mirt[m[76;253H[K[76;253H90,19[9C13%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[38;5;224m{[m[76;253H[K[76;253H91,19[9C14%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H92,19[9C15%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;3H[96m# calculate to which fold each person and item belongs[m[76;253H[K[76;253H93,19[9C15%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hfolds.persons [93m<-[m  [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mnrow[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m1[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[76;253H[K[76;253H94,19[9C16%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hfolds.items [93m<-[m [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mncol[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m2[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[76;253H[K[76;253H95,19[9C17%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H96,1[10C17%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;3Hrmses [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H97,2[10C18%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;3Hbiases [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H98,19[9C19%[70;19H[?25h[?25l[76;254H7,2 [69;2H[?25h[?25l[76;254H6,1[68;1H[?25h[?25l[76;243H~@k[68;1H[76;243H   [67;19H[76;254H5,19[67;19H[?25h[?25l[76;254H6,1 [68;1H[?25h[?25l[76;254H7,2[69;2H[?25h[?25l[76;254H8,19[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;3Haccuracies [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H99,19[9C20%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hf1s [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H100,19[8C20%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H101,0-1[7C21%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;13H[1;75r[75;1H
[1;76r[70;12H[38;5;224m[46m()[m[75;3H[96m# loop though cross validation folds[m[76;253H[K[76;253H102,13[8C22%[70;13H[?25h[?25l[76;243H~@k[70;13H[76;243H   [70;14H[1;75r[75;1H
[1;76r[69;12H[38;5;224m()[m[70;13H[38;5;224m[46m()[m[75;3H[93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H103,14[8C22%[70;14H[?25h[?25l[1;75r[75;1H
[1;76r[69;13H[38;5;224m()[m[70;17H[38;5;224m[46m()[m[75;3H[38;5;224m{[m[76;253H[K[76;253H104,18[8C23%[70;18H[?25h[?25l[1;75r[75;1H
[1;76r[69;17H[38;5;224m()[m[70;10H[38;5;224m[46m()[m[75;5H[93mfor[m [38;5;224m([mj [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H105,11[8C24%[70;11H[?25h[?25l[1;75r[75;1H
[1;76r[69;10H[38;5;224m()[75;5H{[m[76;253H[K[76;253H106,2[9C24%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# save the persons and items that belong to the hold out test set[m[76;253H[K[76;253H107,19[8C25%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[70;7H[38;5;224m[46m([11C)[m[75;7Hper.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.persons[93m==[mi[38;5;224m)[m[76;253H[K[76;253H108,19[8C26%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;3H[1;75r[75;1H
[1;76r[69;7H[38;5;224m([11C)[m[75;7Hitem.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.items[93m==[mj[38;5;224m)[m[76;253H[K[76;253H109,3[9C26%[70;3H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H110,19[8C27%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# create train and test folds[m[76;253H[K[76;253H111,5[9C28%[70;5H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htest [93m<-[m data[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m][m[76;253H[K[76;253H112,19[8C28%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htrain [93m<-[m data[76;253H[K[76;253H113,19[8C29%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htrain[38;5;224m[[mper.ind[38;5;224m,[mitem.ind[38;5;224m][m [93m<-[m [95mNA[m[76;253H[K[76;253H114,19[8C30%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;6H[1;75r[75;1H
[1;76r[76;253H[K[76;253H115,6[9C31%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# [m[30m[103mif[m[96m some rows contain no responses after the leave out set, remove them from the training set, and adjust person indices accordingly[m[76;253H[K[76;253H116,19[8C31%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[70;19H[38;5;224m[46m[[17C][m[75;7Hemptyrows [93m=[m [1m[96mrowSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mncol[m[38;5;224m([mtrain[38;5;224m)[m[76;253H[K[76;253H117,19[8C32%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[69;19H[38;5;224m[[17C][m[75;7Hemptycols [93m=[m [1m[96mcolSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mnrow[m[38;5;224m([mtrain[38;5;224m)[m[76;253H[K[76;253H118,19[8C33%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H119,19[8C33%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Htrain [93m=[m train[38;5;224m[[m[93m![memptyrows[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H120,6[9C34%[70;6H[?25h[?25l[76;243H~@k[70;6H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;9Hper.ind [93m=[m per.ind[38;5;224m[[m[93m![mper.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m)][m[76;253H[K[76;253H121,19[8C35%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H122,19[8C35%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# do the same for columns[m[76;253H[K[76;253H123,19[8C36%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H124,19[8C37%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Htrain [93m=[m train[38;5;224m[,[m[93m![memptycols[38;5;224m][m[76;253H[K[76;253H125,19[8C37%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Hitem.ind [93m=[m item.ind[38;5;224m[[m[93m![mitem.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m)][m[76;253H[K[76;253H126,19[8C38%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;7H[1;75r[75;1H
[1;76r[67;27H[38;5;224m[46m{[70;7H}[m[75;7H[38;5;224m}[m[76;253H[K[76;253H127,7[9C39%[70;7H[?25h[?25l[1;75r[75;1H
[1;76r[66;27H[38;5;224m{[69;7H}[m[76;253H[K[76;253H128,19[8C40%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# fit model[m[76;253H[K[76;253H129,19[8C40%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hfit [93m<-[m [1m[96mmirt[m[38;5;224m([mtrain[38;5;224m,[m model[38;5;224m,[m [95m'2PL'[m[38;5;224m,[m method[93m=[mmethod[38;5;224m,[m GenRandomPars[93m=[mrandompars[38;5;224m,[m lambda[93m=[mlambda[38;5;224m,[m pars[93m=[mpars[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m())[m[76;253H[K[76;253H130,19[8C41%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# save parameters[m[76;253H[K[76;253H131,19[8C42%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[67;27H[38;5;224m[46m{[70;7H}[m[75;7Hitempars [93m<-[m [1m[96mcoef[m[38;5;224m([mfit[38;5;224m,[m simplify [93m=[m [95mTRUE[m[38;5;224m)$[mitems[76;253H[K[76;253H132,7[9C42%[70;7H[?25h[?25l[1;75r[75;1H
[1;76r[66;27H[38;5;224m{[69;7H}[m[75;7Ha [93m<-[m itempars[38;5;224m[,[m[95m1[m[38;5;224m:([m[1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m3[m[38;5;224m)][m[76;253H[K[76;253H133,6[9C43%[70;6H[?25h[?25l[76;243H~@k[70;6H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;7Hd [93m<-[m itempars[38;5;224m[,[m [1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m2[m[38;5;224m][m[76;253H[K[76;253H134,17[8C44%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;7Htheta [93m<-[m [1m[96mfscores[m[38;5;224m([mfit[38;5;224m)[m[76;253H[K[76;253H135,19[8C44%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[76;253H[K[76;253H136,19[8C45%[70;19H[?25h[?25l[76;255H5[69;19H[?25h[?25l[76;255H4,17[68;17H[?25h[?25l[76;255H3,6 [67;6H[?25h[?25l[76;243H~@k[67;6H[76;243H   [66;7H[63;27H[38;5;224m[46m{[66;7H}[m[76;255H2,7[66;7H[?25h[?25l[63;27H[38;5;224m{[66;7H}[m[76;255H3,6[67;6H[?25h[?25l[76;255H4,17[68;17H[?25h[?25l[76;255H5,19[69;19H[?25h[?25l[76;255H6[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;7H[96m# calculate true and predicted probablities[m[76;253H[K[76;253H137,19[8C46%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hp.pred [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)[m[76;253H[K[76;253H138,19[8C46%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hp.true [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma_true[38;5;224m,[m [1m[96mas.vector[m[38;5;224m([md_true[38;5;224m),[m theta_true[38;5;224m)[m[76;253H[K[76;253H139,19[8C47%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H140,19[8C48%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;6H[1;75r[75;1H
[1;76r[75;7H[96m# [m[30m[103mif[m[96m there are rows without responses, they have no theta estimates, so we have to fill in some empty rows to make the dimensions correct[m[76;253H[K[76;253H141,6[9C48%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H142,19[8C49%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Hp.pred [93m=[m [1m[96minsertEmptyRows[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m))[m[76;253H[K[76;253H143,19[8C50%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H144,19[8C51%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H145,6[9C51%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Hp.pred [93m=[m [1m[96minsertEmptyCols[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m))[m[76;253H[K[76;253H146,19[8C52%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H147,19[8C53%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# calculate true and predicted responses[m[76;253H[K[76;253H148,19[8C53%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[68;27H[38;5;224m[46m{[70;7H}[m[75;7Hresp.pred [93m=[m [1m[96mround[m[38;5;224m([mp.pred[38;5;224m,[m [95m0[m[38;5;224m)[m[76;253H[K[76;253H149,7[9C54%[70;7H[?25h[?25l[1;75r[75;1H
[1;76r[67;27H[38;5;224m{[69;7H}[m[75;7Hresp.true [93m=[m [1m[96mround[m[38;5;224m([mp.true[38;5;224m,[m [95m0[m[38;5;224m)[m[76;253H[K[76;253H150,19[8C55%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H151,19[8C55%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[68;27H[38;5;224m[46m{[70;7H}[m[75;7H[96m# calculate metrics and save them[m[76;253H[K[76;253H152,7[9C56%[70;7H[?25h[?25l[1;75r[75;1H
[1;76r[67;27H[38;5;224m{[69;7H}[m[75;7Hrmses [93m<-[m [1m[96mc[m[38;5;224m([mrmses[38;5;224m,[m [1m[96mRMSE[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[76;253H[K[76;253H153,19[8C57%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;7Hbiases [93m<-[m [1m[96mc[m[38;5;224m([mbiases[38;5;224m,[m [1m[96mbias[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[76;253H[K[76;253H154,19[8C57%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htop10 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mtrue[93m=[mresp.true[38;5;224m,[m pred[93m=[mresp.predm[38;5;224m,[m n[93m=[m[95m10[m[38;5;224m)[m[76;253H[K[76;253H155,19[8C58%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htop20 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mtrue[93m=[mresp.true[38;5;224m,[m pred[93m=[mresp.predm[38;5;224m,[m n[93m=[m[95m20[m[38;5;224m)[m[76;253H[K[76;253H156,6[9C59%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hacc10 [93m<-[m [1m[96mc[m[38;5;224m([macc10[38;5;224m,[m top10[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H157,19[8C60%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hf110 [93m<-[m [1m[96mc[m[38;5;224m([mf110[38;5;224m,[m top10[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H158,19[8C60%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hacc20 [93m<-[m [1m[96mc[m[38;5;224m([macc20[38;5;224m,[m top20[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H159,19[8C61%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hf120 [93m<-[m [1m[96mc[m[38;5;224m([mf120[38;5;224m,[m top20[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H160,19[8C62%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[76;253H[K[76;253H161,19[8C62%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;5H[38;5;224m}[m[76;253H[K[76;253H162,19[8C63%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;3H[38;5;224m}[m[76;253H[K[76;253H163,19[8C64%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([m[1m[96mmean[m[38;5;224m([mrmses[38;5;224m),[m [1m[96mmean[m[38;5;224m([mbiases[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc10[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc20[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf110[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf120[38;5;224m)))[m[76;253H[K[76;253H164,19[8C64%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m[76;253H[K[76;253H165,19[8C65%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;6H[1;75r[75;1H
[1;76r[76;253H[K[76;253H166,6[9C66%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[14;5H[38;5;224m[46m{[70;5H}[m[75;1H[96m# read appropriate data file[m[76;253H[K[76;253H167,5[9C66%[70;5H[?25h[?25l[1;75r[75;1H
[1;76r[11;3H[38;5;224m[46m{[m[13;5H[38;5;224m{[69;5H}[m
  [38;5;224m[46m}[m[75;1Hdata1 [93m=[m [1m[96mread.csv[m[38;5;224m([m[1m[96mpaste[m[38;5;224m([m[95m'~/data_parameters/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[76;253H[K[76;253H168,3[9C67%[70;3H[?25h[?25l[1;75r[75;1H
[1;76r[10;3H[38;5;224m{[69;3H}[m[76;253H[K[76;253H169,19[8C68%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# load true parameter values[m[76;253H[K[76;253H170,1[9C68%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[1m[96mload[m[38;5;224m([mfile[93m=[m[1m[96mpaste[m[38;5;224m([m[95m'~/data_parameters/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m))[m[76;253H[K[76;253H171,0-1[7C69%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H172,19[8C70%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# initialize paramters[m[76;253H[K[76;253H173,19[8C71%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[1m[96mprint[m[38;5;224m([m[95m'initializing pars...'[m[38;5;224m)[m[76;253H[K[76;253H174,0-1[7C71%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;1Hpars [93m<-[m [1m[96mmirt[m[38;5;224m([mdata1[38;5;224m,[mndim[38;5;224m,[m pars [93m=[m [95m'values'[m[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m())[m[76;253H[K[76;253H175,19[8C72%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[76;253H[K[76;253H176,19[8C73%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;6H[1;75r[75;1H
[1;76r[75;1H[96m# set some loadings to zero[m[76;253H[K[76;253H177,6[9C73%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[30m[103mif[m[38;5;224m([mndim[93m==[m[95m1[m[38;5;224m){[m[76;253H[K[76;253H178,19[8C74%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H179,19[8C75%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H180,19[8C75%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m [93melse[m [30m[103mif[m [38;5;224m([mndim[93m==[m[95m2[m[38;5;224m){[m[76;253H[K[76;253H181,0-1[7C76%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m5[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H182,19[8C77%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[70;12H[38;5;224m[46m{


}[m

  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m5[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H183,12[8C77%[70;12H[?25h[?25l[1;75r[75;1H
[1;76r[69;12H[38;5;224m{


}[m[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m6[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H184,19[8C78%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m6[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H185,19[8C79%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[70;11H[38;5;224m[46m([7C)[m[75;1H[38;5;224m}[m[93melse[m [30m[103mif[m [38;5;224m([mndim[93m==[m[95m3[m[38;5;224m){[m[76;253H[K[76;253H186,19[8C80%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[69;11H[38;5;224m([7C)[m[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H187,19[8C80%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H188,19[8C81%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m11[m[38;5;224m:[m[95m20[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H189,19[8C82%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m11[m[38;5;224m:[m[95m20[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H190,19[8C82%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a3'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m21[m[38;5;224m:[m[95m30[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H191,19[8C83%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [69;19H[76;255H0[69;19H[?25h[?25l[76;243H~@k[69;19H[76;243H   [68;19H[76;254H89[68;19H[?25h[?25l[76;243H~@k[68;19H[76;243H   [67;19H[76;255H8[67;19H[?25h[?25l[76;255H7[66;19H[?25h[?25l[65;11H[38;5;224m[46m([7C)[m[76;255H6[65;19H[?25h[?25l[76;243H~@k[65;19H[76;243H   [64;19H[65;11H[38;5;224m([7C)[m[76;255H5[64;19H[?25h[?25l[76;243H~@k[64;19H[76;243H   [63;19H[76;255H4[63;19H[?25h[?25l[62;12H[38;5;224m[46m{


}[m[76;255H3,12[62;12H[?25h[?25l[38;5;224m{


}[m[76;255H2,19[61;19H[?25h[?25l[76;255H1,0-1[60;1H[?25h[?25l[76;255H0,19 [59;19H[?25h[?25l[76;243H~@k[59;19H[76;243H   [58;19H[76;254H79[58;19H[?25h[?25l[76;255H8[57;19H[?25h[?25l[76;255H7,6 [56;6H[?25h[?25l[76;255H6,19[55;19H[?25h[?25l[76;255H5[54;19H[?25h[?25l[76;255H4,0-1[53;1H[?25h[?25l[76;243H~@k[53;1H[76;243H   [52;19H[76;255H3,19 [52;19H[?25h[?25l[76;255H2[51;19H[?25h[?25l[76;255H1,0-1[50;1H[?25h[?25l[76;255H0,1  [49;1H[?25h[?25l[76;254H69,19[48;19H[?25h[?25l[76;255H8,3 [47;3H[?25h[?25l[76;255H7,5[46;5H[?25h[?25l[76;243H~@k[46;5H[76;243H   [45;6H[76;255H6,6[45;6H[?25h[?25l[76;255H5,19[44;19H[?25h[?25l[76;255H4[43;19H[?25h[?25l[76;243H~@k[43;19H[76;243H   [42;19H[76;255H3[42;19H[?25h[?25l[76;255H2[41;19H[?25h[?25l[76;255H1[40;19H[?25h[?25l[76;255H0[39;19H[?25h[?25l[76;243H~@k[39;19H[76;243H   [38;19H[76;254H59[38;19H[?25h[?25l[76;243H~@k[38;19H[76;243H   [37;19H[76;255H8[37;19H[?25h[?25l[76;243H~@k[37;19H[76;243H   [36;19H[76;255H7[36;19H[?25h[?25l[76;255H6,6 [35;6H[?25h[?25l[76;255H5,19[34;19H[?25h[?25l[76;255H4[33;19H[?25h[?25l[76;243H~@k[33;19H[76;243H   [32;19H[76;255H3[32;19H[?25h[?25l[29;27H[38;5;224m[46m{[31;7H}[m[76;255H2,7 [31;7H[?25h[?25l[29;27H[38;5;224m{[31;7H}[m[76;255H1,19[30;19H[?25h[?25l[76;255H0[29;19H[?25h[?25l[26;27H[38;5;224m[46m{[28;7H}[m[76;254H49,7 [28;7H[?25h[?25l[26;27H[38;5;224m{[28;7H}[m[76;255H8,19[27;19H[?25h[?25l[76;243H~@k[27;19H[76;243H   [26;19H[76;255H7[26;19H[?25h[?25l[76;255H6[25;19H[?25h[?25l[76;255H5,6 [24;6H[?25h[?25l[76;255H4,19[23;19H[?25h[?25l[76;255H3[22;19H[?25h[?25l[76;243H~@k[22;19H[76;243H   [21;19H[76;255H2[21;19H[?25h[?25l[76;255H1,6 [20;6H[?25h[?25l[76;243H~@k[20;6H[76;243H   [19;19H[76;255H0,19[19;19H[?25h[?25l[76;254H39[18;19H[?25h[?25l[76;255H8[17;19H[?25h[?25l[76;255H7[16;19H[?25h[?25l[76;255H6[15;19H[?25h[?25l[76;255H5[14;19H[?25h[?25l[76;255H4,17[13;17H[?25h[?25l[76;243H~@k[13;17H[76;243H   [12;6H[76;255H3,6 [12;6H[?25h[?25l[8;27H[38;5;224m[46m{[11;7H}[m[76;255H2,7[11;7H[?25h[?25l[8;27H[38;5;224m{[11;7H}[m[76;255H1,19[10;19H[?25h[?25l[76;255H0[9;19H[?25h[?25l[76;254H29[8;19H[?25h[?25l[76;255H8[7;19H[?25h[?25l[3;27H[38;5;224m[46m{[6;7H}[m[76;255H7,7 [6;7H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[96m# [m[30m[103mif[m[96m some rows contain no responses after the leave out set, remove them from the training set, and adjust person indices accordingly[m[4;27H[38;5;224m{[7;7H}[m[76;253H[K[76;253H126,19[8C82%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H125,19[8C82%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Htrain[38;5;224m[[mper.ind[38;5;224m,[mitem.ind[38;5;224m][m [93m<-[m [95mNA[m[76;253H[K[76;253H124,19[8C81%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Htrain [93m<-[m data[76;253H[K[76;253H123,19[8C80%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Htest [93m<-[m data[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m][m[76;253H[K[76;253H122,19[8C80%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[96m# create train and test folds[m[76;253H[K[76;253H121,19[8C79%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H120,6[9C78%[6;6H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hitem.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.items[93m==[mj[38;5;224m)[m[76;253H[K[76;253H119,19[8C77%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hper.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.persons[93m==[mi[38;5;224m)[m[76;253H[K[76;253H118,19[8C77%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;7H[96m# save the persons and items that belong to the hold out test set[m[6;19H[38;5;224m[46m[[17C][m[76;253H[K[76;253H117,19[8C76%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;5H[38;5;224m{[7;19H[[17C][m[76;253H[K[76;253H116,19[8C75%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;6H[1;75r[1;1H[L[1;76r[1;5H[93mfor[m [38;5;224m([mj [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H115,6[9C75%[6;6H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[38;5;224m{[m[76;253H[K[76;253H114,19[8C74%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H113,19[8C73%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[96m# loop though cross validation folds[m[76;253H[K[76;253H112,19[8C73%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;5H[1;75r[1;1H[L[1;76r[6;5H[38;5;224m[46m{[62;5H}[m[76;253H[K[76;253H111,5[9C72%[6;5H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hf1s [93m=[m [1m[96mc[m[38;5;224m()[7;5H{[63;5H}[m[76;253H[K[76;253H110,19[8C71%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Haccuracies [93m=[m [1m[96mc[m[38;5;224m()[m[6;3H[38;5;224m[46m{[65;3H}[m[76;253H[K[76;253H109,3[9C71%[6;3H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hbiases [93m=[m [1m[96mc[m[38;5;224m()[m[6;7H[38;5;224m[46m([11C)[m
  [38;5;224m{[66;3H}[m[76;253H[K[76;253H108,19[8C70%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hrmses [93m=[m [1m[96mc[m[38;5;224m()[7;7H([11C)[m[76;253H[K[76;253H107,19[8C69%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H106,2[9C68%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hfolds.items [93m<-[m [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mncol[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m2[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[6;10H[38;5;224m[46m()[m[76;253H[K[76;253H105,11[8C68%[6;11H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hfolds.persons [93m<-[m  [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mnrow[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m1[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[6;17H[38;5;224m[46m()[m[7;10H[38;5;224m()[m[76;253H[K[76;253H104,18[8C67%[6;18H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[96m# calculate to which fold each person and item belongs[m[6;13H[38;5;224m[46m()[m[7;17H[38;5;224m()[m[76;253H[K[76;253H103,14[8C66%[6;14H[?25h[?25l[1;75r[1;1H[L[1;76r[6;12H[38;5;224m[46m()[m[7;13H[38;5;224m()[m[76;253H[K[76;253H102,13[8C66%[6;13H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m{[7;12H()[m[76;253H[K[76;253H101,0-1[7C65%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;21Hpars[38;5;224m)[m[10C[96m# parameters object from mirt[m[76;253H[K[76;253H100,19[8C64%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Htheta_true[38;5;224m,[m    [96m# true parameter values[m[76;253H[K[76;253H99,19[9C64%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hd_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H98,19[9C63%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Ha_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H97,2[10C62%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hlambda[38;5;224m,[m[8C[96m# l1 and l2 penalty[m[76;253H[K[76;253H96,1[10C62%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hk [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m    [96m# number of folds for 2d cross validation[m[76;253H[K[76;253H95,19[9C61%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hrandompars[38;5;224m,[m    [96m# mirt argument for whether to use random paramters values[m[76;253H[K[76;253H94,19[9C60%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;21Hmethod[38;5;224m,[m[8C[96m# method of esitmation, e.g. EM[m[76;253H[K[76;253H93,19[9C60%[6;19H[?25h[?25l[76;254H4[7;19H[?25h[?25l[76;254H5[8;19H[?25h[?25l[76;254H6,1 [9;1H[?25h[?25l[76;243H~@k[9;1H[76;243H   [10;2H[76;254H7,2[10;2H[?25h[?25l[76;243H~@k[10;2H[76;243H   [9;1H[76;254H6,1[9;1H[?25h[?25l[76;243H~@k[9;1H[76;243H   [8;19H[76;254H5,19[8;19H[?25h[?25l[76;254H4[7;19H[?25h[?25l[76;254H3[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;21Hmodel[38;5;224m,[m[9C[96m# model to be passed to mirt, can be number of dimensions[m[76;253H[K[76;253H92,19[9C59%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hcv.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([mdata[38;5;224m,[m[10C[96m# matrix of responses[m[76;253H[K[76;253H91,19[9C58%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# Function that fits rgmirt model using cross validation and returns the average RMSE and average bias[m[76;253H[K[76;253H90,19[9C57%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H89,19[9C57%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H88,19[9C56%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[m[76;253H[K[76;253H87,19[9C55%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([mavg_topn_accuracy[38;5;224m,[m avg_topn_f1_score[38;5;224m))[m[76;253H[K[76;253H86,19[9C55%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H85,19[9C54%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;3Havg_topn_f1_score [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_f1_scores[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H84,0-1[8C53%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Havg_topn_accuracy [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_accuracies[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H83,0-1[8C53%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[96m# Calculate the average top-n accuracy and top-n F1 score across all users[m[76;253H[K[76;253H82,1[10C52%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H81,19[9C51%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[38;5;224m}[m[76;253H[K[76;253H80,2[10C51%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htopn_f1_scores[38;5;224m[[mi[38;5;224m][m [93m<-[m f1_score[76;253H[K[76;253H79,19[9C50%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htopn_accuracies[38;5;224m[[mi[38;5;224m][m [93m<-[m topn_accuracy[76;253H[K[76;253H78,19[9C49%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H77,19[9C48%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hf1_score [93m<-[m [95m2[m [93m*[m precision [93m*[m recall [93m/[m [38;5;224m([mprecision [93m+[m recall[38;5;224m)[m[76;253H[K[76;253H76,2[10C48%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H75,3[10C47%[6;3H[?25h[?25l[76;243H~@k[6;3H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;5Hrecall [93m<-[m true_positives [93m/[m actual_positives[6;19H[38;5;224m[46m[[mi[38;5;224m[46m][m[76;253H[K[76;253H74,19[9C46%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hprecision [93m<-[m true_positives [93m/[m predicted_positives[7;19H[38;5;224m[[mi[38;5;224m][m[76;253H[K[76;253H73,19[9C46%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H72,4[10C45%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hactual_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m[76;253H[K[76;253H71,19[9C44%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hpredicted_positives [93m<-[m [1m[96msum[m[38;5;224m([mpred_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m[76;253H[K[76;253H70,4[10C44%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htrue_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m[76;253H[K[76;253H69,19[9C43%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[96m# Calculate the top-n F1 score for the current user[m[76;253H[K[76;253H68,19[9C42%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;4H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H67,4[10C42%[6;4H[?25h[?25l[76;243H~@k[6;4H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;5Htopn_accuracy [93m<-[m [1m[96msum[m[38;5;224m([mtrue_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m [93m/[m n[76;253H[K[76;253H66,19[9C41%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;5H[96m# Calculate the top-n accuracy for the current user[m[76;253H[K[76;253H65,19[9C40%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H64,19[9C40%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htopn_indices [93m<-[m [1m[96morder[m[38;5;224m([m[93m-[mpred_relevance[38;5;224m)[[m[95m1[m[38;5;224m:[mn[38;5;224m][m[76;253H[K[76;253H63,19[9C39%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;4H[1;75r[1;1H[L[1;76r[1;5H[96m# Get the indices of the top-n predicted relevance[m[76;253H[K[76;253H62,4[10C38%[6;4H[?25h[?25l[76;243H~@k[6;4H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H61,19[9C37%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hpred_relevance [93m<-[m pred[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H60,19[9C37%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htrue_relevance [93m<-[m true[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H59,4[10C36%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mnum_users[38;5;224m)[m [38;5;224m{[m[76;253H[K[76;253H58,19[9C35%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H57,19[9C35%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;4H[1;75r[1;1H[L[1;76r[1;3Htopn_f1_scores [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m[76;253H[K[76;253H56,4[10C34%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Htopn_accuracies [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m[76;253H[K[76;253H55,19[9C33%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H54,19[9C33%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;3Hnum_movies [93m<-[m [1m[96mdim[m[38;5;224m([mtrue[38;5;224m)[[m[95m2[m[38;5;224m][m[76;253H[K[76;253H53,19[9C32%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hnum_users [93m<-[m [1m[96mdim[m[38;5;224m([mtrue[38;5;224m)[[m[95m1[m[38;5;224m][m[76;253H[K[76;253H52,2[10C31%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H51,19[9C31%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;1Hacc_f1_at_n [93m<-[m [38;5;121mfunction[m[38;5;224m([mtrue[38;5;224m,[m pred[38;5;224m,[m n[38;5;224m)[m [38;5;224m{[m[76;253H[K[76;253H50,19[9C30%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H49,2[10C29%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[m[76;253H[K[76;253H48,19[9C28%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[1m[96mmean[m[38;5;224m([mest[93m-[mpar[38;5;224m)[m[6;19H[38;5;224m[46m([mtrue[38;5;224m[46m)[m[76;253H[K[76;253H47,19[9C28%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m{[7;19H([mtrue[38;5;224m)[m[76;253H[K[76;253H46,0-1[8C27%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hbias [93m<-[m [38;5;121mfunction[m[38;5;224m([mpar[38;5;224m,[m est[38;5;224m)[m[76;253H[K[76;253H45,19[9C26%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;1H[96m# bias [m[76;253H[K[76;253H44,0-1[8C26%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[4;1H[38;5;224m[46m{

}[m[76;253H[K[76;253H43,1[10C25%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;15H[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[5;1H{[m[6;7H[38;5;224m[46m([7C)[m
[38;5;224m}[m[76;253H[K[76;253H42,15[9C24%[6;15H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[1m[96msqrt[m[38;5;224m([m[1m[96msum[m[38;5;224m(([mest[93m-[mpar[38;5;224m)[m[93m^[m[95m2[m[38;5;224m)[m [93m/[m [1m[96mlength[m[38;5;224m([mpar[38;5;224m))[m[6;1H[38;5;224m[46m{[m[7;7H[38;5;224m([7C)[m
[38;5;224m[46m}[m[76;253H[K[76;253H41,1[10C24%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m{[7;1H{

}[m[76;253H[K[76;253H40,19[9C23%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1HRMSE [93m<-[m [38;5;121mfunction[m[38;5;224m([mpar[38;5;224m,[m est[38;5;224m)[m[76;253H[K[76;253H39,7[10C22%[6;7H[?25h[?25l[76;243H~@k[6;7H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;1H[96m# Root mean square error[m[76;253H[K[76;253H38,0-1[8C22%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[4;1H[38;5;224m[46m{

}[m[76;253H[K[76;253H37,1[10C21%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[5;1H{

}[m[76;253H[K[76;253H36,19[9C20%[6;19H[?25h[?25l[5;1H[38;5;224m[46m{

}[m[76;254H7,1 [7;1H[?25h[?25l[5;1H[38;5;224m{

}[m[76;254H8,0-1[8;1H[?25h[?25l[76;254H9,7  [9;7H[?25h[?25l[76;253H40,19[10;19H[?25h[?25l[76;243H~@k[10;19H[76;243H   [11;1H[38;5;224m[46m{

}[m[76;254H1,1 [11;1H[?25h[?25l[38;5;224m{

}[m[76;254H0,19[10;19H[?25h[?25l[76;253H39,7 [9;7H[?25h[?25l[76;254H8,0-1[8;1H[?25h[?25l[76;243H~@k[8;1H[76;243H   [7;1H[5;1H[38;5;224m[46m{

}[m[76;254H7,1  [7;1H[?25h[?25l[5;1H[38;5;224m{

}[m[76;254H6,19[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mreturn[m[38;5;224m([mnew[38;5;224m)[m[6;1H[38;5;224m[46m{

}[m[76;253H[K[76;253H35,1[10C20%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;3Hnew[38;5;224m[[m[93m-[mcs[38;5;224m,][m [93m<-[m m[7;1H[38;5;224m{

}[m[76;253H[K[76;253H34,19[9C19%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hnew [93m=[m [38;5;121mmatrix[m[38;5;224m([m[95mNA[m[38;5;224m,[m nrow[93m=[m[1m[96mnrow[m[38;5;224m([mm[38;5;224m),[m ncol[93m=[m[1m[96mncol[m[38;5;224m([mm[38;5;224m)[m[93m+[m[1m[96mlength[m[38;5;224m([mcs[38;5;224m))[m[76;253H[K[76;253H33,19[9C18%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1HinsertEmptyCols [93m<-[m [38;5;121mfunction[m[38;5;224m([mm[38;5;224m,[m cs[38;5;224m){[m[76;253H[K[76;253H32,0-1[8C17%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;1H[96m# function that inserts NA rows at each index specified in m[m[2;35H[38;5;224m[46m{[6;1H}[m[76;253H[K[76;253H31,1[10C17%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[3;35H{[m[6;9H[38;5;224m[46m([mnew[38;5;224m[46m)[m
[38;5;224m}[m[76;253H[K[76;253H30,13[9C16%[6;13H[?25h[?25l[76;243H~@k[6;13H[76;243H   [6;16H[1;75r[1;1H[L[1;76r[1;3H[93mreturn[m[38;5;224m([mnew[38;5;224m)[7;9H([mnew[38;5;224m)[m[76;253H[K[76;253H29,16[9C15%[6;16H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hnew[38;5;224m[[m[93m-[mrs[38;5;224m,][m [93m<-[m m[76;253H[K[76;253H28,19[9C15%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hnew [93m=[m [38;5;121mmatrix[m[38;5;224m([m[95mNA[m[38;5;224m,[m nrow[93m=[m[1m[96mnrow[m[38;5;224m([mm[38;5;224m)[m[93m+[m[1m[96mlength[m[38;5;224m([mrs[38;5;224m),[m ncol[93m=[m[1m[96mncol[m[38;5;224m([mm[38;5;224m))[m[76;253H[K[76;253H27,19[9C14%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1HinsertEmptyRows [93m<-[m [38;5;121mfunction[m[38;5;224m([mm[38;5;224m,[m rs[38;5;224m){[m[76;253H[K[76;253H26,19[9C13%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# function that inserts NA rows at each index specified in m[m[2;35H[38;5;224m[46m{[6;1H}[m[76;253H[K[76;253H25,1[10C13%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;13H[1;75r[1;1H[L[1;76r[3;35H[38;5;224m{[m[6;9H[38;5;224m[46m([mnew[38;5;224m[46m)[m
[38;5;224m}[m[76;253H[K[76;253H24,13[9C12%[6;13H[?25h[?25l[76;243H~@k[6;13H[76;243H   [6;16H[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[7;9H([mnew[38;5;224m)[m[76;253H[K[76;253H23,16[9C11%[6;16H[?25h[?25l[76;243H~@k[6;16H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;3H[93mreturn[m[38;5;224m([mprob[38;5;224m)[m[76;253H[K[76;253H22,19[9C11%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H21,19[9C10%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hprob [93m<-[m [1m[96mt[m[38;5;224m([m[1m[96mexp[m[38;5;224m([ma [93m%*%[m [1m[96mt[m[38;5;224m([mtheta[38;5;224m)[m [93m+[md[38;5;224m)[m [93m/[m [38;5;224m([m[95m1[m [93m+[m [1m[96mexp[m[38;5;224m([ma [93m%*%[m [1m[96mt[m[38;5;224m([mtheta[38;5;224m)[m[93m+[md[38;5;224m)))[m[76;253H[K[76;253H20,19[10C9%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m{[m[76;253H[K[76;253H19,0-1[9C8%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;1Hpredict.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)[m
[38;5;224m[46m{[6;1H}[m[76;253H[K[76;253H18,1[11C8%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# predict probabilities based on mirt parameters[m

[38;5;224m{[m[6;9H[38;5;224m[46m([mprob[38;5;224m[46m)[m
[38;5;224m}[m[76;253H[K[76;253H17,14[10C7%[6;14H[?25h[?25l[1;75r[1;1H[L[1;76r[7;9H[38;5;224m([mprob[38;5;224m)[m[76;253H[K[76;253H16,2[11C6%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;81mlibrary[m[38;5;224m([mmirt[38;5;224m)[m[76;253H[K[76;253H15,19[10C6%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# load adapted version of mirt library (rgmirt)[m[6;1H[38;5;224m[46m{[10;1H}[m[76;253H[K[76;253H14,1[11C5%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[7;1H[38;5;224m{[11;1H}[m[76;253H[K[76;253H13,19[10C4%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;1Hsparsity [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m5[m[38;5;224m])[m  [96m# sparsity of the dataset [m[76;253H[K[76;253H12,19[10C4%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hiteration [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m4[m[38;5;224m])[m [96m# number of the current iteration[m[76;253H[K[76;253H11,0-1[9C3%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hndim [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m3[m[38;5;224m])[m      [96m# number of latent dimensions[m[6;8H[38;5;224m[46m([mmirt[38;5;224m[46m)[m[76;253H[K[76;253H10,13[10C2%[6;13H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hlambda2 [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m2[m[38;5;224m])[m   [96m# l2 penalty[m[7;8H[38;5;224m([mmirt[38;5;224m)[m[76;253H[K[76;253H9,19[11C2%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hlambda1 [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m1[m[38;5;224m])[m   [96m# l1 penalty [m[76;253H[K[76;253H8,0-1[10C1%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hargs [93m=[m [1m[96mcommandArgs[m[38;5;224m([mtrailingOnly[93m=[m[95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H7,19[11C0%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;1H[96m# read command line arguments[m[76;253H[K[76;253H6,19[10CTop[6;19H[?25h[?25l[76;253H5[5;19H[?25h[?25l[76;253H4[4;19H[?25h[?25l[76;253H3[3;19H[?25h[?25l[76;243H~@k[3;19H[76;243H   [2;19H[38;5;224m[46m([17C)[m[76;253H2[2;19H[?25h[?25l[38;5;224m([17C)[m[76;253H1[1;19H[?25h[?25l[76;243H~@k[1;19H[76;243H   [1;19H[?25h[?25l[76;243H~@k[1;19H[76;243H   [1;19H[?25h[?25l[76;243H~@k[1;19H[76;243H   [1;19H[?25h[?25l[76;243H~@k[1;19H[76;243H   [1;19H[?25h[?25l[76;243H~@k[1;19H[76;243H   [1;19H[?25h[?25l[76;243H~@k[1;19H[76;243H   [1;19H[?25h[?25l[76;243H:[1;19H[76;243H[K[76;1H:[?2004h[?25hq[?25l[?25h[?25l [?25h[?25l[?25h[?25l[?2004l[76;1H[K[76;1H[?2004l[?1l>[?25h[?1049l[23;0;0t]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ vim fitscript.R 
[?2004h[?1049h[22;0;0t[?1h=[?2004h[1;76r[?12h[?12l[27m[23m[29m[m[H[2J[?25l[76;1H"fitscript.R" 220L, 8046C[2;1Hâ–½[6n[2;1H  [1;1H[>c]10;?]11;?[1;1H[34m# read command line arguments[m
args [38;5;130m=[m [36mcommandArgs[m[35m([mtrailingOnly[38;5;130m=[m[31mTRUE[m[35m)[m
lambda1 [38;5;130m=[m [36mas.numeric[m[35m([margs[35m[[m[31m1[m[35m])[m   [34m# l1 penalty [m
lambda2 [38;5;130m=[m [36mas.numeric[m[35m([margs[35m[[m[31m2[m[35m])[m   [34m# l2 penalty[m
ndim [38;5;130m=[m [36mas.numeric[m[35m([margs[35m[[m[31m3[m[35m])[m      [34m# number of latent dimensions[m
iteration [38;5;130m=[m [36mas.numeric[m[35m([margs[35m[[m[31m4[m[35m])[m [34m# number of the current iteration[m
sparsity [38;5;130m=[m [36mas.numeric[m[35m([margs[35m[[m[31m5[m[35m])[m  [34m# sparsity of the dataset 

# load adapted version of mirt library (rgmirt)[m
[35mlibrary[m[35m([mmirt[35m)[m

[34m# predict probabilities based on mirt parameters[m
predict.mirt [38;5;130m<-[m [32mfunction[m[35m([ma[35m,[m d[35m,[m theta[35m)
{[m
  prob [38;5;130m<-[m [36mt[m[35m([m[36mexp[m[35m([ma [38;5;130m%*%[m [36mt[m[35m([mtheta[35m)[m [38;5;130m+[md[35m)[m [38;5;130m/[m [35m([m[31m1[m [38;5;130m+[m [36mexp[m[35m([ma [38;5;130m%*%[m [36mt[m[35m([mtheta[35m)[m[38;5;130m+[md[35m)))[m

  [38;5;130mreturn[m[35m([mprob[35m)
}[m

[34m# function that inserts NA rows at each index specified in m[m
insertEmptyRows [38;5;130m<-[m [32mfunction[m[35m([mm[35m,[m rs[35m){[m
  new [38;5;130m=[m [32mmatrix[m[35m([m[31mNA[m[35m,[m nrow[38;5;130m=[m[36mnrow[m[35m([mm[35m)[m[38;5;130m+[m[36mlength[m[35m([mrs[35m),[m ncol[38;5;130m=[m[36mncol[m[35m([mm[35m))[m
  new[35m[[m[38;5;130m-[mrs[35m,][m [38;5;130m<-[m m
  [38;5;130mreturn[m[35m([mnew[35m)
}[m
[34m# function that inserts NA rows at each index specified in m[m
insertEmptyCols [38;5;130m<-[m [32mfunction[m[35m([mm[35m,[m cs[35m){[m
  new [38;5;130m=[m [32mmatrix[m[35m([m[31mNA[m[35m,[m nrow[38;5;130m=[m[36mnrow[m[35m([mm[35m),[m ncol[38;5;130m=[m[36mncol[m[35m([mm[35m)[m[38;5;130m+[m[36mlength[m[35m([mcs[35m))[m
  new[35m[[m[38;5;130m-[mcs[35m,][m [38;5;130m<-[m m
  [38;5;130mreturn[m[35m([mnew[35m)
}[m

[34m# Root mean square error[m
RMSE [38;5;130m<-[m [32mfunction[m[35m([mpar[35m,[m est[35m)
{[m
  [36msqrt[m[35m([m[36msum[m[35m(([mest[38;5;130m-[mpar[35m)[m[38;5;130m^[m[31m2[m[35m)[m [38;5;130m/[m [36mlength[m[35m([mpar[35m))
}[m

[34m# bias [m
bias [38;5;130m<-[m [32mfunction[m[35m([mpar[35m,[m est[35m)
{[m
  [36mmean[m[35m([mest[38;5;130m-[mpar[35m)
}[m

acc_f1_at_n [38;5;130m<-[m [32mfunction[m[35m([mtrue[35m,[m pred[35m,[m n[35m)[m [35m{[m

  num_users [38;5;130m<-[m [36mdim[m[35m([mtrue[35m)[[m[31m1[m[35m][m
  num_movies [38;5;130m<-[m [36mdim[m[35m([mtrue[35m)[[m[31m2[m[35m][m

  topn_accuracies [38;5;130m<-[m [32mvector[m[35m([m[31m"numeric"[m[35m,[m num_users[35m)[m
  topn_f1_scores [38;5;130m<-[m [32mvector[m[35m([m[31m"numeric"[m[35m,[m num_users[35m)[m

  [38;5;130mfor[m [35m([mi [38;5;130min[m [31m1[m[35m:[mnum_users[35m)[m [35m{[m
    true_relevance [38;5;130m<-[m true[35m[[mi[35m,[m [35m][m
    pred_relevance [38;5;130m<-[m pred[35m[[mi[35m,[m [35m][m[57;5H[34m# Get the indices of the top-n predicted relevance[m
    topn_indices [38;5;130m<-[m [36morder[m[35m([m[38;5;130m-[mpred_relevance[35m)[[m[31m1[m[35m:[mn[35m][m[60;5H[34m# Calculate the top-n accuracy for the current user[m
    topn_accuracy [38;5;130m<-[m [36msum[m[35m([mtrue_relevance[35m[[mtopn_indices[35m])[m [38;5;130m/[m n[63;5H[34m# Calculate the top-n F1 score for the current user[m
    true_positives [38;5;130m<-[m [36msum[m[35m([mtrue_relevance[35m[[mtopn_indices[35m])[m
    predicted_positives [38;5;130m<-[m [36msum[m[35m([mpred_relevance[35m[[mtopn_indices[35m])[m
    actual_positives [38;5;130m<-[m [36msum[m[35m([mtrue_relevance[35m[[mtopn_indices[35m])[m[68;5Hprecision [38;5;130m<-[m true_positives [38;5;130m/[m predicted_positives
    recall [38;5;130m<-[m true_positives [38;5;130m/[m actual_positives[71;5Hf1_score [38;5;130m<-[m [31m2[m [38;5;130m*[m precision [38;5;130m*[m recall [38;5;130m/[m [35m([mprecision [38;5;130m+[m recall[35m)[m[73;5Htopn_accuracies[35m[[mi[35m][m [38;5;130m<-[m topn_accuracy
    topn_f1_scores[35m[[mi[35m][m [38;5;130m<-[m f1_score
  [35m}[m[76;253H1,19[10CTop[1;19H[?25h[27m[23m[29m[m[H[2J[?25l[1;1H[96m# read command line arguments[m
args [93m=[m [1m[96mcommandArgs[m[38;5;224m([mtrailingOnly[93m=[m[95mTRUE[m[38;5;224m)[m
lambda1 [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m1[m[38;5;224m])[m   [96m# l1 penalty [m
lambda2 [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m2[m[38;5;224m])[m   [96m# l2 penalty[m
ndim [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m3[m[38;5;224m])[m      [96m# number of latent dimensions[m
iteration [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m4[m[38;5;224m])[m [96m# number of the current iteration[m
sparsity [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m5[m[38;5;224m])[m  [96m# sparsity of the dataset 

# load adapted version of mirt library (rgmirt)[m
[38;5;81mlibrary[m[38;5;224m([mmirt[38;5;224m)[m

[96m# predict probabilities based on mirt parameters[m
predict.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)
{[m
  prob [93m<-[m [1m[96mt[m[38;5;224m([m[1m[96mexp[m[38;5;224m([ma [93m%*%[m [1m[96mt[m[38;5;224m([mtheta[38;5;224m)[m [93m+[md[38;5;224m)[m [93m/[m [38;5;224m([m[95m1[m [93m+[m [1m[96mexp[m[38;5;224m([ma [93m%*%[m [1m[96mt[m[38;5;224m([mtheta[38;5;224m)[m[93m+[md[38;5;224m)))[m

  [93mreturn[m[38;5;224m([mprob[38;5;224m)
}[m

[96m# function that inserts NA rows at each index specified in m[m
insertEmptyRows [93m<-[m [38;5;121mfunction[m[38;5;224m([mm[38;5;224m,[m rs[38;5;224m){[m
  new [93m=[m [38;5;121mmatrix[m[38;5;224m([m[95mNA[m[38;5;224m,[m nrow[93m=[m[1m[96mnrow[m[38;5;224m([mm[38;5;224m)[m[93m+[m[1m[96mlength[m[38;5;224m([mrs[38;5;224m),[m ncol[93m=[m[1m[96mncol[m[38;5;224m([mm[38;5;224m))[m
  new[38;5;224m[[m[93m-[mrs[38;5;224m,][m [93m<-[m m
  [93mreturn[m[38;5;224m([mnew[38;5;224m)
}[m
[96m# function that inserts NA rows at each index specified in m[m
insertEmptyCols [93m<-[m [38;5;121mfunction[m[38;5;224m([mm[38;5;224m,[m cs[38;5;224m){[m
  new [93m=[m [38;5;121mmatrix[m[38;5;224m([m[95mNA[m[38;5;224m,[m nrow[93m=[m[1m[96mnrow[m[38;5;224m([mm[38;5;224m),[m ncol[93m=[m[1m[96mncol[m[38;5;224m([mm[38;5;224m)[m[93m+[m[1m[96mlength[m[38;5;224m([mcs[38;5;224m))[m
  new[38;5;224m[[m[93m-[mcs[38;5;224m,][m [93m<-[m m
  [93mreturn[m[38;5;224m([mnew[38;5;224m)
}[m

[96m# Root mean square error[m
RMSE [93m<-[m [38;5;121mfunction[m[38;5;224m([mpar[38;5;224m,[m est[38;5;224m)
{[m
  [1m[96msqrt[m[38;5;224m([m[1m[96msum[m[38;5;224m(([mest[93m-[mpar[38;5;224m)[m[93m^[m[95m2[m[38;5;224m)[m [93m/[m [1m[96mlength[m[38;5;224m([mpar[38;5;224m))
}[m

[96m# bias [m
bias [93m<-[m [38;5;121mfunction[m[38;5;224m([mpar[38;5;224m,[m est[38;5;224m)
{[m
  [1m[96mmean[m[38;5;224m([mest[93m-[mpar[38;5;224m)
}[m

acc_f1_at_n [93m<-[m [38;5;121mfunction[m[38;5;224m([mtrue[38;5;224m,[m pred[38;5;224m,[m n[38;5;224m)[m [38;5;224m{[m

  num_users [93m<-[m [1m[96mdim[m[38;5;224m([mtrue[38;5;224m)[[m[95m1[m[38;5;224m][m
  num_movies [93m<-[m [1m[96mdim[m[38;5;224m([mtrue[38;5;224m)[[m[95m2[m[38;5;224m][m

  topn_accuracies [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m
  topn_f1_scores [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m

  [93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mnum_users[38;5;224m)[m [38;5;224m{[m
    true_relevance [93m<-[m true[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m
    pred_relevance [93m<-[m pred[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m[57;5H[96m# Get the indices of the top-n predicted relevance[m
    topn_indices [93m<-[m [1m[96morder[m[38;5;224m([m[93m-[mpred_relevance[38;5;224m)[[m[95m1[m[38;5;224m:[mn[38;5;224m][m[60;5H[96m# Calculate the top-n accuracy for the current user[m
    topn_accuracy [93m<-[m [1m[96msum[m[38;5;224m([mtrue_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m [93m/[m n[63;5H[96m# Calculate the top-n F1 score for the current user[m
    true_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m
    predicted_positives [93m<-[m [1m[96msum[m[38;5;224m([mpred_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m
    actual_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m[68;5Hprecision [93m<-[m true_positives [93m/[m predicted_positives
    recall [93m<-[m true_positives [93m/[m actual_positives[71;5Hf1_score [93m<-[m [95m2[m [93m*[m precision [93m*[m recall [93m/[m [38;5;224m([mprecision [93m+[m recall[38;5;224m)[m[73;5Htopn_accuracies[38;5;224m[[mi[38;5;224m][m [93m<-[m topn_accuracy
    topn_f1_scores[38;5;224m[[mi[38;5;224m][m [93m<-[m f1_score
  [38;5;224m}[m[76;253H1,19[10CTop"fitscript.R" 220L, 8046C[1;19H[?25h[?25l[76;243H~@k[1;19H[76;243H   [2;19H[38;5;224m[46m([17C)[m[76;253H2[2;19H[?25h[?25l[76;243H~@k[2;19H[76;243H   [3;19H[2;19H[38;5;224m([17C)[m[76;253H3[3;19H[?25h[?25l[76;253H4[4;19H[?25h[?25l[76;253H5[5;19H[?25h[?25l[76;243H~@k[5;19H[76;243H   [6;19H[76;253H6[6;19H[?25h[?25l[76;253H7[7;19H[?25h[?25l[76;253H8,0-1[8;1H[?25h[?25l[76;253H9,19 [9;19H[?25h[?25l[76;243H~@k[9;19H[76;243H   [10;13H[38;5;224m[46m([mmirt[38;5;224m[46m)[m[76;253H10,13[10;13H[?25h[?25l[76;243H~@k[10;13H[76;243H   [11;1H[10;8H[38;5;224m([mmirt[38;5;224m)[m[76;254H1,0-1[11;1H[?25h[?25l[76;254H2,19 [12;19H[?25h[?25l[76;254H3[13;19H[?25h[?25l[76;243H~@k[13;19H[76;243H   [14;1H[38;5;224m[46m{[18;1H}[m[76;254H4,1 [14;1H[?25h[?25l[38;5;224m{[18;1H}[m[76;254H5,19[15;19H[?25h[?25l[76;254H6,2 [16;2H[?25h[?25l[76;243H~@k[16;2H[76;243H   [17;14H[38;5;224m[46m([mprob[38;5;224m[46m)[m[76;254H7,14[17;14H[?25h[?25l[14;1H[38;5;224m[46m{[m[17;9H[38;5;224m([mprob[38;5;224m)[m
[38;5;224m[46m}[m[76;254H8,1 [18;1H[?25h[?25l[14;1H[38;5;224m{[18;1H}[m[76;254H9,0-1[19;1H[?25h[?25l[76;253H20,19 [20;19H[?25h[?25l[76;254H1[21;19H[?25h[?25l[76;254H2[22;19H[?25h[?25l[76;243H~@k[22;19H[76;243H   [23;16H[76;254H3,16[23;16H[?25h[?25l[76;243H~@k[23;16H[76;243H   [24;13H[38;5;224m[46m([mnew[38;5;224m[46m)[m[76;254H4,13[24;13H[?25h[?25l[76;243H~@k[24;13H[76;243H   [25;1H[21;35H[38;5;224m[46m{[m[24;9H[38;5;224m([mnew[38;5;224m)[m
[38;5;224m[46m}[m[76;254H5,1 [25;1H[?25h[?25l[21;35H[38;5;224m{[25;1H}[m[76;254H6,19[26;19H[?25h[?25l[76;243H~@k[26;19H[76;243H   [27;19H[76;254H7[27;19H[?25h[?25l[76;254H8[28;19H[?25h[?25l[76;254H9,16[29;16H[?25h[?25l[30;9H[38;5;224m[46m([mnew[38;5;224m[46m)[m[76;253H30,13[30;13H[?25h[?25l[76;243H~@k[30;13H[76;243H   [31;1H[27;35H[38;5;224m[46m{[m[30;9H[38;5;224m([mnew[38;5;224m)[m
[38;5;224m[46m}[m[76;254H1,1 [31;1H[?25h[?25l[27;35H[38;5;224m{[31;1H}[m[76;254H2,0-1[32;1H[?25h[?25l[76;254H3,19 [33;19H[?25h[?25l[76;254H4[34;19H[?25h[?25l
[38;5;224m[46m{

}[m[76;254H5,1 [35;1H[?25h[?25l[76;243H~@k[35;1H[76;243H   [36;19H[35;1H[38;5;224m{

}[m[76;254H6,19[36;19H[?25h[?25l[76;243H~@k[36;19H[76;243H   [37;1H[35;1H[38;5;224m[46m{

}[m[76;254H7,1 [37;1H[?25h[?25l[76;243H~@k[37;1H[76;243H   [38;1H[35;1H[38;5;224m{

}[m[76;254H8,0-1[38;1H[?25h[?25l[76;243H~@k[38;1H[76;243H   [37;1H[35;1H[38;5;224m[46m{

}[m[76;254H7,1  [37;1H[?25h[?25l[35;1H[38;5;224m{

}[m[76;254H6,19[36;19H[?25h[?25l[35;1H[38;5;224m[46m{

}[m[76;254H5,1 [35;1H[?25h[?25l[76;243H~@k[35;1H[76;243H   [34;19H
[38;5;224m{

}[m[76;254H4,19[34;19H[?25h[?25l
[38;5;224m[46m{

}[m[76;254H5,1 [35;1H[?25h[?25l[38;5;224m{

}[m[76;254H6,19[36;19H[?25h[?25l[35;1H[38;5;224m[46m{

}[m[76;254H7,1 [37;1H[?25h[?25l[76;243H~@k[37;1H[76;243H   [38;1H[35;1H[38;5;224m{

}[m[76;254H8,0-1[38;1H[?25h[?25l[76;254H9,7  [39;7H[?25h[?25l[76;253H40,19[40;19H[?25h[?25l[76;243H~@k[40;19H[76;243H   [41;1H[38;5;224m[46m{

}[m[76;254H1,1 [41;1H[?25h[?25l[38;5;224m{[m[42;7H[38;5;224m[46m([7C)[m
[38;5;224m}[m[76;254H2,15[42;15H[?25h[?25l[41;1H[38;5;224m[46m{[m[42;7H[38;5;224m([7C)[m
[38;5;224m[46m}[m[76;254H3,1 [43;1H[?25h[?25l[41;1H[38;5;224m{

}[m[76;254H4,0-1[44;1H[?25h[?25l[76;254H5,19 [45;19H[?25h[?25l[76;254H6,0-1[46;1H[?25h[?25l[76;243H~@k[46;1H[76;243H   [47;19H[38;5;224m[46m([mtrue[38;5;224m[46m)[m[76;254H7,19 [47;19H[?25h[?25l[38;5;224m([mtrue[38;5;224m)[m[76;254H8[48;19H[?25h[?25l[76;254H9,2 [49;2H[?25h[?25l[76;253H50,19[50;19H[?25h[?25l[76;254H1[51;19H[?25h[?25l[76;254H2,2 [52;2H[?25h[?25l[76;243H~@k[52;2H[76;243H   [53;19H[76;254H3,19[53;19H[?25h[?25l[76;254H4[54;19H[?25h[?25l[76;254H5[55;19H[?25h[?25l[76;243H~@k[55;19H[76;243H   [56;4H[76;254H6,4 [56;4H[?25h[?25l[76;254H7,19[57;19H[?25h[?25l[76;254H8[58;19H[?25h[?25l[76;254H9,4 [59;4H[?25h[?25l[76;243H~@k[59;4H[76;243H   [60;19H[76;253H60,19[60;19H[?25h[?25l[76;243H~@k[60;19H[76;243H   [61;19H[76;254H1[61;19H[?25h[?25l[76;243H~@k[61;19H[76;243H   [62;4H[76;254H2,4 [62;4H[?25h[?25l[76;254H3,19[63;19H[?25h[?25l[76;254H4[64;19H[?25h[?25l[76;243H~@k[64;19H[76;243H   [65;19H[76;254H5[65;19H[?25h[?25l[76;243H~@k[65;19H[76;243H   [66;19H[76;254H6[66;19H[?25h[?25l[76;254H7,4 [67;4H[?25h[?25l[76;254H8,19[68;19H[?25h[?25l[76;254H9[69;19H[?25h[?25l[76;253H70,4 [70;4H[?25h[?25l[76;243H~@k[70;4H[76;243H   [70;19H[1;75r[75;1H
[1;76r[76;1H[K[76;253H71,19[10C0%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;3H[96m# Calculate the average top-n accuracy and top-n F1 score across all users[m[76;253H[K[76;253H72,4[11C1%[70;4H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Havg_topn_accuracy [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_accuracies[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H73,19[10C2%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[70;19H[38;5;224m[46m[[mi[38;5;224m[46m][m[75;3Havg_topn_f1_score [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_f1_scores[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H74,19[10C2%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[48;26H[38;5;224m[46m{[m[69;19H[38;5;224m[[mi[38;5;224m][m
  [38;5;224m[46m}[m[76;253H[K[76;253H75,3[11C3%[70;3H[?25h[?25l[1;75r[75;1H
[1;76r[47;26H[38;5;224m{[69;3H}[m[75;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([mavg_topn_accuracy[38;5;224m,[m avg_topn_f1_score[38;5;224m))[m[76;253H[K[76;253H76,2[11C4%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m[76;253H[K[76;253H77,19[10C4%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H78,19[10C5%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[76;253H[K[76;253H79,19[10C6%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# Function that fits rgmirt model using cross validation and returns the average RMSE and average bias[m[76;253H[K[76;253H80,2[11C6%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;1Hcv.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([mdata[38;5;224m,[m[10C[96m# matrix of responses[m[76;253H[K[76;253H81,19[10C7%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[33;40H[38;5;224m[46m{[70;1H}[m[75;21Hmodel[38;5;224m,[m[9C[96m# model to be passed to mirt, can be number of dimensions[m[76;253H[K[76;253H82,1[11C8%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[32;40H[38;5;224m{[69;1H}[m[75;21Hmethod[38;5;224m,[m[8C[96m# method of esitmation, e.g. EM[m[76;253H[K[76;253H83,0-1[9C8%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;21Hrandompars[38;5;224m,[m    [96m# mirt argument for whether to use random paramters values[m[76;253H[K[76;253H84,0-1[9C9%[70;1H[?25h[?25l[76;254H3[69;1H[?25h[?25l[31;40H[38;5;224m[46m{[68;1H}[m[76;254H2,1  [68;1H[?25h[?25l[76;243H~@k[68;1H[76;243H   [67;19H[31;40H[38;5;224m{[68;1H}[m[76;254H1,19[67;19H[?25h[?25l[31;40H[38;5;224m[46m{[68;1H}[m[76;254H2,1 [68;1H[?25h[?25l[31;40H[38;5;224m{[68;1H}[m[76;254H3,0-1[69;1H[?25h[?25l[76;254H4[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;21Hk [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m    [96m# number of folds for 2d cross validation[m[76;253H[K[76;253H85,19[9C10%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;21Hlambda[38;5;224m,[m[8C[96m# l1 and l2 penalty[m[76;253H[K[76;253H86,19[9C11%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;21Ha_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H87,19[9C11%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;21Hd_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H88,19[9C12%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;21Htheta_true[38;5;224m,[m    [96m# true parameter values[m[76;253H[K[76;253H89,19[9C13%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;21Hpars[38;5;224m)[m[10C[96m# parameters object from mirt[m[76;253H[K[76;253H90,19[9C13%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[38;5;224m{[m[76;253H[K[76;253H91,19[9C14%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H92,19[9C15%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;3H[96m# calculate to which fold each person and item belongs[m[76;253H[K[76;253H93,19[9C15%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hfolds.persons [93m<-[m  [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mnrow[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m1[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[76;253H[K[76;253H94,19[9C16%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;3Hfolds.items [93m<-[m [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mncol[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m2[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[76;253H[K[76;253H95,19[9C17%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;1H[1;75r[75;1H
[1;76r[76;253H[K[76;253H96,1[10C17%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;3Hrmses [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H97,2[10C18%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hbiases [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H98,19[9C19%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;3Haccuracies [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H99,19[9C20%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hf1s [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H100,19[8C20%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H101,0-1[7C21%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;13H[1;75r[75;1H
[1;76r[70;12H[38;5;224m[46m()[m[75;3H[96m# loop though cross validation folds[m[76;253H[K[76;253H102,13[8C22%[70;13H[?25h[?25l[76;243H~@k[70;13H[76;243H   [70;14H[1;75r[75;1H
[1;76r[69;12H[38;5;224m()[m[70;13H[38;5;224m[46m()[m[75;3H[93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H103,14[8C22%[70;14H[?25h[?25l[1;75r[75;1H
[1;76r[69;13H[38;5;224m()[m[70;17H[38;5;224m[46m()[m[75;3H[38;5;224m{[m[76;253H[K[76;253H104,18[8C23%[70;18H[?25h[?25l[1;75r[75;1H
[1;76r[69;17H[38;5;224m()[m[70;10H[38;5;224m[46m()[m[75;5H[93mfor[m [38;5;224m([mj [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H105,11[8C24%[70;11H[?25h[?25l[1;75r[75;1H
[1;76r[69;10H[38;5;224m()[75;5H{[m[76;253H[K[76;253H106,2[9C24%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# save the persons and items that belong to the hold out test set[m[76;253H[K[76;253H107,19[8C25%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[70;7H[38;5;224m[46m([11C)[m[75;7Hper.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.persons[93m==[mi[38;5;224m)[m[76;253H[K[76;253H108,19[8C26%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[69;7H[38;5;224m([11C)[m[75;7Hitem.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.items[93m==[mj[38;5;224m)[m[76;253H[K[76;253H109,3[9C26%[70;3H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H110,19[8C27%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# create train and test folds[m[76;253H[K[76;253H111,5[9C28%[70;5H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htest [93m<-[m data[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m][m[76;253H[K[76;253H112,19[8C28%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htrain [93m<-[m data[76;253H[K[76;253H113,19[8C29%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;7Htrain[38;5;224m[[mper.ind[38;5;224m,[mitem.ind[38;5;224m][m [93m<-[m [95mNA[m[76;253H[K[76;253H114,19[8C30%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H115,6[9C31%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# [m[30m[103mif[m[96m some rows contain no responses after the leave out set, remove them from the training set, and adjust person indices accordingly[m[76;253H[K[76;253H116,19[8C31%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[70;19H[38;5;224m[46m[[17C][m[75;7Hemptyrows [93m=[m [1m[96mrowSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mncol[m[38;5;224m([mtrain[38;5;224m)[m[76;253H[K[76;253H117,19[8C32%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[69;19H[38;5;224m[[17C][m[75;7Hemptycols [93m=[m [1m[96mcolSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mnrow[m[38;5;224m([mtrain[38;5;224m)[m[76;253H[K[76;253H118,19[8C33%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H119,19[8C33%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;6H[1;75r[75;1H
[1;76r[75;9Htrain [93m=[m train[38;5;224m[[m[93m![memptyrows[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H120,6[9C34%[70;6H[?25h[?25l[76;243H~@k[70;6H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;9Hper.ind [93m=[m per.ind[38;5;224m[[m[93m![mper.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m)][m[76;253H[K[76;253H121,19[8C35%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H122,19[8C35%[70;19H[?25h[?25l[76;255H1[69;19H[?25h[?25l[76;255H0,6 [68;6H[?25h[?25l[76;254H19,19[67;19H[?25h[?25l[76;243H~@k[67;19H[76;243H   [66;19H[76;255H8[66;19H[?25h[?25l[76;255H9[67;19H[?25h[?25l[76;254H20,6 [68;6H[?25h[?25l[76;243H~@k[68;6H[76;243H   [69;19H[76;255H1,19[69;19H[?25h[?25l[76;243H~@k[69;19H[76;243H   [70;19H[76;255H2[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;7H[96m# do the same for columns[m[76;253H[K[76;253H123,19[8C36%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H124,19[8C37%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Htrain [93m=[m train[38;5;224m[,[m[93m![memptycols[38;5;224m][m[76;253H[K[76;253H125,19[8C37%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Hitem.ind [93m=[m item.ind[38;5;224m[[m[93m![mitem.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m)][m[76;253H[K[76;253H126,19[8C38%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;7H[1;75r[75;1H
[1;76r[67;27H[38;5;224m[46m{[70;7H}[m[75;7H[38;5;224m}[m[76;253H[K[76;253H127,7[9C39%[70;7H[?25h[?25l[76;243H~@k[70;7H[76;243H   [70;19H[1;75r[75;1H
[1;76r[66;27H[38;5;224m{[69;7H}[m[76;253H[K[76;253H128,19[8C40%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# fit model[m[76;253H[K[76;253H129,19[8C40%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hfit [93m<-[m [1m[96mmirt[m[38;5;224m([mtrain[38;5;224m,[m model[38;5;224m,[m [95m'2PL'[m[38;5;224m,[m method[93m=[mmethod[38;5;224m,[m GenRandomPars[93m=[mrandompars[38;5;224m,[m lambda[93m=[mlambda[38;5;224m,[m pars[93m=[mpars[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m())[m[76;253H[K[76;253H130,19[8C41%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# save parameters[m[76;253H[K[76;253H131,19[8C42%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[67;27H[38;5;224m[46m{[70;7H}[m[75;7Hitempars [93m<-[m [1m[96mcoef[m[38;5;224m([mfit[38;5;224m,[m simplify [93m=[m [95mTRUE[m[38;5;224m)$[mitems[76;253H[K[76;253H132,7[9C42%[70;7H[?25h[?25l[1;75r[75;1H
[1;76r[66;27H[38;5;224m{[69;7H}[m[75;7Ha [93m<-[m itempars[38;5;224m[,[m[95m1[m[38;5;224m:([m[1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m3[m[38;5;224m)][m[76;253H[K[76;253H133,6[9C43%[70;6H[?25h[?25l[76;243H~@k[70;6H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;7Hd [93m<-[m itempars[38;5;224m[,[m [1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m2[m[38;5;224m][m[76;253H[K[76;253H134,17[8C44%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htheta [93m<-[m [1m[96mfscores[m[38;5;224m([mfit[38;5;224m)[m[76;253H[K[76;253H135,19[8C44%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H136,19[8C45%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# calculate true and predicted probablities[m[76;253H[K[76;253H137,19[8C46%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hp.pred [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)[m[76;253H[K[76;253H138,19[8C46%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hp.true [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma_true[38;5;224m,[m [1m[96mas.vector[m[38;5;224m([md_true[38;5;224m),[m theta_true[38;5;224m)[m[76;253H[K[76;253H139,19[8C47%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H140,19[8C48%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;6H[1;75r[75;1H
[1;76r[75;7H[96m# [m[30m[103mif[m[96m there are rows without responses, they have no theta estimates, so we have to fill in some empty rows to make the dimensions correct[m[76;253H[K[76;253H141,6[9C48%[70;6H[?25h[?25l[76;243H~@k[70;6H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H142,19[8C49%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;9Hp.pred [93m=[m [1m[96minsertEmptyRows[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m))[m[76;253H[K[76;253H143,19[8C50%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H144,19[8C51%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H145,6[9C51%[70;6H[?25h[?25l[76;243H~@k[70;6H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;9Hp.pred [93m=[m [1m[96minsertEmptyCols[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m))[m[76;253H[K[76;253H146,19[8C52%[70;19H[?25h[?25l[76;255H5,6 [69;6H[?25h[?25l[76;255H4,19[68;19H[?25h[?25l[76;243H~@k[68;19H[76;243H   [67;19H[76;255H3[67;19H[?25h[?25l[76;255H2[66;19H[?25h[?25l[76;243H~@k[66;19H[76;243H   [65;6H[76;255H1,6 [65;6H[?25h[?25l[76;255H2,19[66;19H[?25h[?25l[76;255H3[67;19H[?25h[?25l[76;255H4[68;19H[?25h[?25l[76;255H5,6 [69;6H[?25h[?25l[76;243H~@k[69;6H[76;243H   [70;19H[76;255H6,19[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H147,19[8C53%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# calculate true and predicted responses[m[76;253H[K[76;253H148,19[8C53%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;7H[1;75r[75;1H
[1;76r[68;27H[38;5;224m[46m{[70;7H}[m[75;7Hresp.pred [93m=[m [1m[96mround[m[38;5;224m([mp.pred[38;5;224m,[m [95m0[m[38;5;224m)[m[76;253H[K[76;253H149,7[9C54%[70;7H[?25h[?25l[76;243H~@k[70;7H[76;243H   [70;19H[1;75r[75;1H
[1;76r[67;27H[38;5;224m{[69;7H}[m[75;7Hresp.true [93m=[m [1m[96mround[m[38;5;224m([mp.true[38;5;224m,[m [95m0[m[38;5;224m)[m[76;253H[K[76;253H150,19[8C55%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[76;253H[K[76;253H151,19[8C55%[70;19H[?25h[?25l[76;255H0[69;19H[?25h[?25l[66;27H[38;5;224m[46m{[68;7H}[m[76;254H49,7 [68;7H[?25h[?25l[76;243H~@k[68;7H[76;243H   [67;19H[66;27H[38;5;224m{[68;7H}[m[76;255H8,19[67;19H[?25h[?25l[76;243H~@k[67;19H[76;243H   [68;7H[66;27H[38;5;224m[46m{[68;7H}[m[76;255H9,7 [68;7H[?25h[?25l[76;243H~@k[68;7H[76;243H   [69;19H[66;27H[38;5;224m{[68;7H}[m[76;254H50,19[69;19H[?25h[?25l[76;255H1[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[68;27H[38;5;224m[46m{[70;7H}[m[75;7H[96m# calculate metrics and save them[m[76;253H[K[76;253H152,7[9C56%[70;7H[?25h[?25l[1;75r[75;1H
[1;76r[67;27H[38;5;224m{[69;7H}[m[75;7Hrmses [93m<-[m [1m[96mc[m[38;5;224m([mrmses[38;5;224m,[m [1m[96mRMSE[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[76;253H[K[76;253H153,19[8C57%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;7Hbiases [93m<-[m [1m[96mc[m[38;5;224m([mbiases[38;5;224m,[m [1m[96mbias[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[76;253H[K[76;253H154,19[8C57%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htop10 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mtrue[93m=[mresp.true[38;5;224m,[m pred[93m=[mresp.predm[38;5;224m,[m n[93m=[m[95m10[m[38;5;224m)[m[76;253H[K[76;253H155,19[8C58%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htop20 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mtrue[93m=[mresp.true[38;5;224m,[m pred[93m=[mresp.predm[38;5;224m,[m n[93m=[m[95m20[m[38;5;224m)[m[76;253H[K[76;253H156,6[9C59%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hacc10 [93m<-[m [1m[96mc[m[38;5;224m([macc10[38;5;224m,[m top10[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H157,19[8C60%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hf110 [93m<-[m [1m[96mc[m[38;5;224m([mf110[38;5;224m,[m top10[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H158,19[8C60%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hacc20 [93m<-[m [1m[96mc[m[38;5;224m([macc20[38;5;224m,[m top20[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H159,19[8C61%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;7Hf120 [93m<-[m [1m[96mc[m[38;5;224m([mf120[38;5;224m,[m top20[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H160,19[8C62%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H161,19[8C62%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;5H[38;5;224m}[m[76;253H[K[76;253H162,19[8C63%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;3H[38;5;224m}[m[76;253H[K[76;253H163,19[8C64%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([m[1m[96mmean[m[38;5;224m([mrmses[38;5;224m),[m [1m[96mmean[m[38;5;224m([mbiases[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc10[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc20[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf110[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf120[38;5;224m)))[m[76;253H[K[76;253H164,19[8C64%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m[76;253H[K[76;253H165,19[8C65%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H166,6[9C66%[70;6H[?25h[?25l[76;243H~@k[70;6H[76;243H   [70;5H[1;75r[75;1H
[1;76r[14;5H[38;5;224m[46m{[70;5H}[m[75;1H[96m# read appropriate data file[m[76;253H[K[76;253H167,5[9C66%[70;5H[?25h[?25l[1;75r[75;1H
[1;76r[11;3H[38;5;224m[46m{[m[13;5H[38;5;224m{[69;5H}[m
  [38;5;224m[46m}[m[75;1Hdata1 [93m=[m [1m[96mread.csv[m[38;5;224m([m[1m[96mpaste[m[38;5;224m([m[95m'~/data_parameters/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[76;253H[K[76;253H168,3[9C67%[70;3H[?25h[?25l[1;75r[75;1H
[1;76r[10;3H[38;5;224m{[69;3H}[m[76;253H[K[76;253H169,19[8C68%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# load true parameter values[m[76;253H[K[76;253H170,1[9C68%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[1m[96mload[m[38;5;224m([mfile[93m=[m[1m[96mpaste[m[38;5;224m([m[95m'~/data_parameters/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m))[m[76;253H[K[76;253H171,0-1[7C69%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H172,19[8C70%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# initialize paramters[m[76;253H[K[76;253H173,19[8C71%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;1H[1m[96mprint[m[38;5;224m([m[95m'initializing pars...'[m[38;5;224m)[m[76;253H[K[76;253H174,0-1[7C71%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;1Hpars [93m<-[m [1m[96mmirt[m[38;5;224m([mdata1[38;5;224m,[mndim[38;5;224m,[m pars [93m=[m [95m'values'[m[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m())[m[76;253H[K[76;253H175,19[8C72%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[76;253H[K[76;253H176,19[8C73%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# set some loadings to zero[m[76;253H[K[76;253H177,6[9C73%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[30m[103mif[m[38;5;224m([mndim[93m==[m[95m1[m[38;5;224m){[m[76;253H[K[76;253H178,19[8C74%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H179,19[8C75%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H180,19[8C75%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m [93melse[m [30m[103mif[m [38;5;224m([mndim[93m==[m[95m2[m[38;5;224m){[m[76;253H[K[76;253H181,0-1[7C76%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m5[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H182,19[8C77%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[70;12H[38;5;224m[46m{


}[m

  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m5[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H183,12[8C77%[70;12H[?25h[?25l[1;75r[75;1H
[1;76r[69;12H[38;5;224m{


}[m[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m6[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H184,19[8C78%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m6[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H185,19[8C79%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[70;11H[38;5;224m[46m([7C)[m[75;1H[38;5;224m}[m[93melse[m [30m[103mif[m [38;5;224m([mndim[93m==[m[95m3[m[38;5;224m){[m[76;253H[K[76;253H186,19[8C80%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[69;11H[38;5;224m([7C)[m[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H187,19[8C80%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H188,19[8C81%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m11[m[38;5;224m:[m[95m20[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H189,19[8C82%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m11[m[38;5;224m:[m[95m20[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H190,19[8C82%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a3'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m21[m[38;5;224m:[m[95m30[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H191,19[8C83%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a3'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m21[m[38;5;224m:[m[95m30[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H192,19[8C84%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m[76;253H[K[76;253H193,19[8C84%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H194,19[8C85%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# fit model[m[76;253H[K[76;253H195,19[8C86%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[1m[96mprint[m[38;5;224m([m[95m'fitting model...'[m[38;5;224m)[m[76;253H[K[76;253H196,19[8C86%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;1Hstart [93m=[m [1m[96mSys.time[m[38;5;224m()[m[76;253H[K[76;253H197,19[8C87%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[63;19H[38;5;224m[46m{[70;1H}[m[75;1Hmetrics [93m<-[m [1m[96mcv.mirt[m[38;5;224m([mdata1[38;5;224m,[m ndim[38;5;224m,[m[76;253H[K[76;253H198,1[9C88%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[62;19H[38;5;224m{[69;1H}[m[75;17Hmethod [93m=[m [95m'EM'[m[38;5;224m,[m[76;253H[K[76;253H199,0-1[7C88%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;17Hrandompars [93m=[m [95mF[m[38;5;224m,[m k [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m[76;253H[K[76;253H200,11[8C89%[70;11H[?25h[?25l[1;75r[75;1H
[1;76r[75;17Hlambda [93m=[m [1m[96mc[m[38;5;224m([mlambda1[38;5;224m,[mlambda2[38;5;224m),[m[76;253H[K[76;253H201,19[8C90%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[70;17H[38;5;224m[46m()[m[75;17Ha_true [93m=[m a1[38;5;224m,[m[76;253H[K[76;253H202,18[8C91%[70;18H[?25h[?25l[1;75r[75;1H
[1;76r[69;17H[38;5;224m()[m[75;17Hd_true [93m=[m d1[38;5;224m,[m[76;253H[K[76;253H203,19[8C91%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;17Htheta_true [93m=[m theta1[38;5;224m,[m[76;253H[K[76;253H204,19[8C92%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;17Hpars [93m=[m pars[38;5;224m)[m[76;253H[K[76;253H205,19[8C93%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;1Hend [93m=[m [1m[96mSys.time[m[38;5;224m()[m[76;253H[K[76;253H206,19[8C93%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;1Htime [93m=[m end[93m-[mstart[76;253H[K[76;253H207,19[8C94%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[1m[96mprint[m[38;5;224m([mtime[38;5;224m)[m[76;253H[K[76;253H208,19[8C95%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[76;253H[K[76;253H209,19[8C95%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;19H[1;75r[75;1H
[1;76r[75;1H[96m# save results[m[76;253H[K[76;253H210,19[8C96%[70;19H[?25h[?25l[76;243H~@k[70;19H[76;243H   [70;16H[1;75r[75;1H
[1;76r[70;15H[38;5;224m[46m()[m[75;1HfileConn[93m<-[m[1m[96mfile[m[38;5;224m([m[1m[96mpaste0[m[38;5;224m([m[95m'~/results/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[38;5;224m))[m[76;253H[K[76;253H211,16[8C97%[70;16H[?25h[?25l[1;75r[75;1H
[1;76r[69;15H[38;5;224m()[m[75;1H[1m[96mwriteLines[m[38;5;224m([m[1m[96mc[m[38;5;224m([m[1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m1[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m2[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m3[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m4[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m5[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m6[m[38;5;224m])),[m fileConn[38;5;224m)[m[76;253H[K[76;253H212,16[8C97%[70;16H[?25h[?25l[1;75r[75;1H
[1;76r[70;6H[38;5;224m[46m([mtime[38;5;224m[46m)[m[75;1H[1m[96mclose[m[38;5;224m([mfileConn[38;5;224m)[m[76;253H[K[76;253H213,11[8C98%[70;11H[?25h[?25l[1;75r[75;1H
[1;76r[69;6H[38;5;224m([mtime[38;5;224m)[m[76;253H[K[76;253H214,0-1[7C99%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;14H[1;75r[75;1H
[1;76r[76;253H[K[76;253H215,14[8CBot[70;14H[?25h[?25l[76;243H~@k[70;14H[76;243H   [71;19H[76;255H6,19[71;19H[?25h[?25l[76;243H~@k[71;19H[76;243H   [72;19H[76;255H7[72;19H[?25h[?25l[76;243H~@k[72;19H[76;243H   [73;15H[73;6H[38;5;224m[46m([8C)[m[76;255H8,15[73;15H[?25h[?25l[76;243H~@k[73;15H[76;243H   [74;1H[73;6H[38;5;224m([8C)[m[76;255H9,0-1[74;1H[?25h[?25l[76;243H~@k[74;1H[76;243H   [75;1H[76;254H20[75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;254H19[74;1H[?25h[?25l[73;6H[38;5;224m[46m([8C)[m[76;255H8,15 [73;15H[?25h[?25l[73;6H[38;5;224m([8C)[m[76;255H7,19[72;19H[?25h[?25l[76;243H~@k[72;19H[76;243H   [71;19H[76;255H6[71;19H[?25h[?25l[76;255H7[72;19H[?25h[?25l[73;6H[38;5;224m[46m([8C)[m[76;255H8,15[73;15H[?25h[?25l[76;243H~@k[73;15H[76;243H   [74;1H[73;6H[38;5;224m([8C)[m[76;255H9,0-1[74;1H[?25h[?25l[73;6H[38;5;224m[46m([8C)[m[76;255H8,15 [73;15H[?25h[?25l[73;6H[38;5;224m([8C)[m[76;255H7,19[72;19H[?25h[?25l[76;255H6[71;19H[?25h[?25l[76;255H5,14[70;14H[?25h[?25l[76;243H~@k[70;14H[76;243H   [69;1H[76;255H4,0-1[69;1H[?25h[?25l[68;6H[38;5;224m[46m([mtime[38;5;224m[46m)[m[76;255H3,11 [68;11H[?25h[?25l[38;5;224m([mtime[38;5;224m)[m[76;255H2,16[67;16H[?25h[?25l[66;15H[38;5;224m[46m()[m[76;255H1[66;16H[?25h[?25l[76;243H~@k[66;16H[76;243H   [65;19H[66;15H[38;5;224m()[m[76;255H0,19[65;19H[?25h[?25l[76;243H~@k[65;19H[76;243H   [66;16H[38;5;224m[46m()[m[76;255H1,16[66;16H[?25h[?25l[76;243H~@k[66;16H[76;243H   [67;16H[66;15H[38;5;224m()[m[76;255H2[67;16H[?25h[?25l[68;6H[38;5;224m[46m([mtime[38;5;224m[46m)[m[76;255H3,11[68;11H[?25h[?25l[76;243H~@k[68;11H[76;243H   [69;1H[68;6H[38;5;224m([mtime[38;5;224m)[m[76;255H4,0-1[69;1H[?25h[?25l[68;6H[38;5;224m[46m([mtime[38;5;224m[46m)[m[76;255H3,11 [68;11H[?25h[?25l[76;243H~@k[68;11H[76;243H   [67;16H[68;6H[38;5;224m([mtime[38;5;224m)[m[76;255H2,16[67;16H[?25h[?25l[66;15H[38;5;224m[46m()[m[76;255H1[66;16H[?25h[?25l[76;243H~@k[66;16H[76;243H   [65;19H[66;15H[38;5;224m()[m[76;255H0,19[65;19H[?25h[?25l[76;243H~@k[65;19H[76;243H   [64;19H[76;254H09[64;19H[?25h[?25l[76;255H8[63;19H[?25h[?25l[76;243H~@k[63;19H[76;243H   [62;19H[76;255H7[62;19H[?25h[?25l[76;255H6[61;19H[?25h[?25l[76;255H5[60;19H[?25h[?25l[76;255H4[59;19H[?25h[?25l[76;243H~@k[59;19H[76;243H   [58;19H[38;5;224m[46m([65;28H)[m[76;255H3[58;19H[?25h[?25l[57;17H[38;5;224m[46m()[m[58;19H[38;5;224m([65;28H)[m[76;255H2,18[57;18H[?25h[?25l[38;5;224m()[m[76;255H1,19[56;19H[?25h[?25l[76;255H0,11[55;11H[?25h[?25l[76;253H199,0-1[54;1H[?25h[?25l[76;243H~@k[54;1H[76;243H   [53;1H[46;19H[38;5;224m[46m{[53;1H}[m[76;255H8,1  [53;1H[?25h[?25l[46;19H[38;5;224m{[53;1H}[m[76;255H7,19[52;19H[?25h[?25l[76;255H6[51;19H[?25h[?25l[76;255H5[50;19H[?25h[?25l[76;255H4[49;19H[?25h[?25l[76;255H3[48;19H[?25h[?25l[76;243H~@k[48;19H[76;243H   [47;19H[76;255H2[47;19H[?25h[?25l[76;243H~@k[47;19H[76;243H   [46;19H[38;5;224m[46m{[53;1H}[m[76;255H1[46;19H[?25h[?25l[38;5;224m{[53;1H}[m[76;255H0[45;19H[?25h[?25l[76;254H89[44;19H[?25h[?25l[76;255H8[43;19H[?25h[?25l[76;255H7[42;19H[?25h[?25l[41;11H[38;5;224m[46m([7C)[m[76;255H6[41;19H[?25h[?25l[76;243H~@k[41;19H[76;243H   [40;19H[41;11H[38;5;224m([7C)[m[76;255H5[40;19H[?25h[?25l[76;255H4[39;19H[?25h[?25l[38;12H[38;5;224m[46m{


}[m[76;255H3,12[38;12H[?25h[?25l[38;5;224m{


}[m[76;255H2,19[37;19H[?25h[?25l[76;255H1,0-1[36;1H[?25h[?25l[76;255H0,19 [35;19H[?25h[?25l[76;254H79[34;19H[?25h[?25l[76;243H~@k[34;19H[76;243H   [33;19H[76;255H8[33;19H[?25h[?25l[76;243H~@k[33;19H[76;243H   [32;6H[76;255H7,6 [32;6H[?25h[?25l[76;255H6,19[31;19H[?25h[?25l[76;243H~@k[31;19H[76;243H   [30;19H[76;255H5[30;19H[?25h[?25l[76;255H4,0-1[29;1H[?25h[?25l[76;255H3,19 [28;19H[?25h[?25l[76;243H~@k[28;19H[76;243H   [27;19H[76;255H2[27;19H[?25h[?25l[76;255H1,0-1[26;1H[?25h[?25l[76;255H0,1  [25;1H[?25h[?25l[76;254H69,19[24;19H[?25h[?25l[76;255H8,3 [23;3H[?25h[?25l[76;243H~@k[23;3H[76;243H   [22;5H[76;255H7,5[22;5H[?25h[?25l[76;243H~@k[22;5H[76;243H   [21;6H[76;255H6,6[21;6H[?25h[?25l[76;255H5,19[20;19H[?25h[?25l[76;255H4[19;19H[?25h[?25l[76;243H~@k[19;19H[76;243H   [18;19H[76;255H3[18;19H[?25h[?25l[76;255H2[17;19H[?25h[?25l[76;243H~@k[17;19H[76;243H   [16;19H[76;255H1[16;19H[?25h[?25l[76;255H0[15;19H[?25h[?25l[76;254H59[14;19H[?25h[?25l[76;255H8[13;19H[?25h[?25l[76;255H7[12;19H[?25h[?25l[76;243H~@k[12;19H[76;243H   [11;6H[76;255H6,6 [11;6H[?25h[?25l[76;243H~@k[11;6H[76;243H   [10;19H[76;255H5,19[10;19H[?25h[?25l[76;243H~@k[10;19H[76;243H   [9;19H[76;255H4[9;19H[?25h[?25l[76;255H3[8;19H[?25h[?25l[5;27H[38;5;224m[46m{[7;7H}[m[76;255H2,7 [7;7H[?25h[?25l[76;243H~@k[7;7H[76;243H   [6;19H[5;27H[38;5;224m{[7;7H}[m[76;255H1,19[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H150,19[8C99%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hp.true [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma_true[38;5;224m,[m [1m[96mas.vector[m[38;5;224m([md_true[38;5;224m),[m theta_true[38;5;224m)[m[4;27H[38;5;224m[46m{[6;7H}[m[76;253H[K[76;253H149,7[9C98%[6;7H[?25h[?25l[76;243H~@k[6;7H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;7Hp.pred [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)[5;27H{[7;7H}[m[76;253H[K[76;253H148,19[8C97%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[96m# calculate true and predicted probablities[m[76;253H[K[76;253H147,19[8C97%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H146,19[8C96%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Htheta [93m<-[m [1m[96mfscores[m[38;5;224m([mfit[38;5;224m)[m[76;253H[K[76;253H145,6[9C95%[6;6H[?25h[?25l[76;243H~@k[6;6H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;7Hd [93m<-[m itempars[38;5;224m[,[m [1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m2[m[38;5;224m][m[76;253H[K[76;253H144,19[8C95%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Ha [93m<-[m itempars[38;5;224m[,[m[95m1[m[38;5;224m:([m[1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m3[m[38;5;224m)][m[76;253H[K[76;253H143,19[8C94%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hitempars [93m<-[m [1m[96mcoef[m[38;5;224m([mfit[38;5;224m,[m simplify [93m=[m [95mTRUE[m[38;5;224m)$[mitems[76;253H[K[76;253H142,19[8C93%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[96m# save parameters[m[76;253H[K[76;253H141,6[9C93%[6;6H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hfit [93m<-[m [1m[96mmirt[m[38;5;224m([mtrain[38;5;224m,[m model[38;5;224m,[m [95m'2PL'[m[38;5;224m,[m method[93m=[mmethod[38;5;224m,[m GenRandomPars[93m=[mrandompars[38;5;224m,[m lambda[93m=[mlambda[38;5;224m,[m pars[93m=[mpars[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m())[m[76;253H[K[76;253H140,19[8C92%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;7H[96m# fit model[m[76;253H[K[76;253H139,19[8C91%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H138,19[8C91%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[38;5;224m}[m[76;253H[K[76;253H137,19[8C90%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;9Hitem.ind [93m=[m item.ind[38;5;224m[[m[93m![mitem.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m)][m[76;253H[K[76;253H136,19[8C89%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;9Htrain [93m=[m train[38;5;224m[,[m[93m![memptycols[38;5;224m][m[76;253H[K[76;253H135,19[8C88%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H134,17[8C88%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;6H[1;75r[1;1H[L[1;76r[1;7H[96m# do the same for columns[m[76;253H[K[76;253H133,6[9C87%[6;6H[?25h[?25l[76;243H~@k[6;6H[76;243H   [6;7H[1;75r[1;1H[L[1;76r[1;7H[38;5;224m}[m[3;27H[38;5;224m[46m{[6;7H}[m[76;253H[K[76;253H132,7[9C86%[6;7H[?25h[?25l[76;243H~@k[6;7H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;9Hper.ind [93m=[m per.ind[38;5;224m[[m[93m![mper.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m)][4;27H{[7;7H}[m[76;253H[K[76;253H131,19[8C86%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;9Htrain [93m=[m train[38;5;224m[[m[93m![memptyrows[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H130,19[8C85%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H129,19[8C84%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;7Hemptycols [93m=[m [1m[96mcolSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mnrow[m[38;5;224m([mtrain[38;5;224m)[m[76;253H[K[76;253H128,19[8C84%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hemptyrows [93m=[m [1m[96mrowSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mncol[m[38;5;224m([mtrain[38;5;224m)[m[3;27H[38;5;224m[46m{[6;7H}[m[76;253H[K[76;253H127,7[9C83%[6;7H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[96m# [m[30m[103mif[m[96m some rows contain no responses after the leave out set, remove them from the training set, and adjust person indices accordingly[m[4;27H[38;5;224m{[7;7H}[m[76;253H[K[76;253H126,19[8C82%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H125,19[8C82%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Htrain[38;5;224m[[mper.ind[38;5;224m,[mitem.ind[38;5;224m][m [93m<-[m [95mNA[m[76;253H[K[76;253H124,19[8C81%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Htrain [93m<-[m data[76;253H[K[76;253H123,19[8C80%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Htest [93m<-[m data[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m][m[76;253H[K[76;253H122,19[8C80%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;7H[96m# create train and test folds[m[76;253H[K[76;253H121,19[8C79%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H120,6[9C78%[6;6H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hitem.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.items[93m==[mj[38;5;224m)[m[76;253H[K[76;253H119,19[8C77%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hper.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.persons[93m==[mi[38;5;224m)[m[76;253H[K[76;253H118,19[8C77%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;7H[96m# save the persons and items that belong to the hold out test set[m[6;19H[38;5;224m[46m[[17C][m[76;253H[K[76;253H117,19[8C76%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[38;5;224m{[7;19H[[17C][m[76;253H[K[76;253H116,19[8C75%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[93mfor[m [38;5;224m([mj [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H115,6[9C75%[6;6H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[38;5;224m{[m[76;253H[K[76;253H114,19[8C74%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;3H[93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H113,19[8C73%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[96m# loop though cross validation folds[m[76;253H[K[76;253H112,19[8C73%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[6;5H[38;5;224m[46m{[62;5H}[m[76;253H[K[76;253H111,5[9C72%[6;5H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hf1s [93m=[m [1m[96mc[m[38;5;224m()[7;5H{[63;5H}[m[76;253H[K[76;253H110,19[8C71%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;3H[1;75r[1;1H[L[1;76r[1;3Haccuracies [93m=[m [1m[96mc[m[38;5;224m()[m[6;3H[38;5;224m[46m{[65;3H}[m[76;253H[K[76;253H109,3[9C71%[6;3H[?25h[?25l[76;243H~@k[6;3H[76;243H   [7;19H[6;3H[38;5;224m{[65;3H}[m[76;254H10,19[7;19H[?25h[?25l[76;243H~@k[7;19H[76;243H   [8;5H[38;5;224m[46m{[64;5H}[m[76;255H1,5 [8;5H[?25h[?25l[76;243H~@k[8;5H[76;243H   [9;19H[8;5H[38;5;224m{[64;5H}[m[76;255H2,19[9;19H[?25h[?25l[76;243H~@k[9;19H[76;243H   [10;19H[76;255H3[10;19H[?25h[?25l[76;243H~@k[10;19H[76;243H   [11;19H[76;255H4[11;19H[?25h[?25l[76;243H~@k[11;19H[76;243H   [12;6H[76;255H5,6 [12;6H[?25h[?25l[76;243H~@k[12;6H[76;243H   [13;19H[76;255H6,19[13;19H[?25h[?25l[76;243H~@k[13;19H[76;243H   [14;19H[38;5;224m[46m[[17C][m[76;255H7[14;19H[?25h[?25l[76;243H~@k[14;19H[76;243H   [15;19H[14;19H[38;5;224m[[17C][m[76;255H8[15;19H[?25h[?25l[76;243H~@k[15;19H[76;243H   [16;19H[76;255H9[16;19H[?25h[?25l[76;243H~@k[16;19H[76;243H   [17;6H[76;254H20,6 [17;6H[?25h[?25l[76;243H~@k[17;6H[76;243H   [18;19H[76;255H1,19[18;19H[?25h[?25l[76;243H~@k[18;19H[76;243H   [19;19H[76;255H2[19;19H[?25h[?25l[76;243H~@k[19;19H[76;243H   [20;19H[76;255H3[20;19H[?25h[?25l[76;243H~@k[20;19H[76;243H   [21;19H[76;255H4[21;19H[?25h[?25l[76;243H~@k[21;19H[76;243H   [22;19H[76;255H5[22;19H[?25h[?25l[76;243H~@k[22;19H[76;243H   [23;19H[76;255H6[23;19H[?25h[?25l[76;243H~@k[23;19H[76;243H   [24;7H[21;27H[38;5;224m[46m{[24;7H}[m[76;255H7,7 [24;7H[?25h[?25l[76;243H~@k[24;7H[76;243H   [25;19H[21;27H[38;5;224m{[24;7H}[m[76;255H8,19[25;19H[?25h[?25l[76;243H~@k[25;19H[76;243H   [26;19H[76;255H9[26;19H[?25h[?25l[76;243H~@k[26;19H[76;243H   [27;19H[76;254H30[27;19H[?25h[?25l[76;243H~@k[27;19H[76;243H   [28;19H[76;255H1[28;19H[?25h[?25l[76;243H~@k[28;19H[76;243H   [29;7H[26;27H[38;5;224m[46m{[29;7H}[m[76;255H2,7 [29;7H[?25h[?25l[76;243H~@k[29;7H[76;243H   [30;6H[26;27H[38;5;224m{[29;7H}[m[76;255H3,6[30;6H[?25h[?25l[76;243H~@k[30;6H[76;243H   [31;17H[76;255H4,17[31;17H[?25h[?25l[76;243H~@k[31;17H[76;243H   [32;19H[76;255H5,19[32;19H[?25h[?25l[76;243H~@k[32;19H[76;243H   [32;20H[76;257H20[32;20H[?25h[?25l[76;243H~@k[32;20H[76;243H   [32;21H[76;258H1[32;21H[?25h[?25l[76;243H~@k[32;21H[76;243H   [32;22H[76;258H2[32;22H[?25h[?25l[76;243H~@k[32;22H[76;243H   [32;23H[76;258H3[32;23H[?25h[?25l[76;243H~@k[32;23H[76;243H   [32;24H[76;258H4[32;24H[?25h[?25l[76;243H~@k[32;24H[76;243H   [32;25H[76;258H5[32;25H[?25h[?25l[76;243H~@k[32;25H[76;243H   [31;17H[76;255H4,17[31;17H[?25h[?25l[76;243H~@k[31;17H[76;243H   [31;17H[?25h[?25l[76;243H~@k[31;17H[76;243H   [30;6H[76;255H3,6 [30;6H[?25h[?25l[76;243H~@k[30;6H[76;243H   [30;6H[?25h[?25l[76;243H~@k[30;6H[76;243H   [30;6H[?25h[?25l[76;243H~@k[30;6H[76;243H   [29;7H[26;27H[38;5;224m[46m{[29;7H}[m[76;255H2,7[29;7H[?25h[?25l[76;243H~@k[29;7H[76;243H   [29;7H[?25h[?25l[76;243H~@k[29;7H[76;243H   [30;6H[26;27H[38;5;224m{[29;7H}[m[76;255H3,6[30;6H[?25h[?25l[76;243H~@k[30;6H[76;243H   [30;6H[?25h[?25l[76;243H~@k[30;6H[76;243H   [30;6H[?25h[?25l[76;243H~@k[30;6H[76;243H   [31;17H[76;255H4,17[31;17H[?25h[?25l[76;243H~@k[31;17H[76;243H   [31;17H[?25h[?25l[76;243H~@k[31;17H[76;243H   [31;17H[?25h[?25l[76;243H~@k[31;17H[76;243H   [31;17H[?25h[?25l[76;243H~@k[31;17H[76;243H   [32;25H[76;255H5,25[32;25H[?25h[?25l[76;243H~@k[32;25H[76;243H   [32;26H[76;258H6[32;26H[?25h[?25l[76;243H~@k[32;26H[76;243H   [32;27H[76;258H7[32;27H[?25h[?25l[76;243H~@k[32;27H[76;243H   [32;28H[76;258H8[32;28H[?25h[?25l[76;243H~@k[32;28H[76;243H   [32;29H[76;258H9[32;29H[?25h[?25l[76;243H~@k[32;29H[76;243H   [32;30H[76;257H30[32;30H[?25h[?25l[76;243H~@k[32;30H[76;243H   [32;31H[76;258H1[32;31H[?25h[?25l[76;243H~@k[32;31H[76;243H   [32;32H[76;258H2[32;32H[?25h[?25l[76;243H~@k[32;32H[76;243H   [32;33H[76;258H3[32;33H[?25h[?25l[76;243H~@k[32;33H[76;243H   [32;34H[76;258H4[32;34H[?25h[?25l[76;243H~@k[32;34H[76;243H   [32;35H[76;258H5[32;35H[?25h[?25l[76;243H~@k[32;35H[76;243H   [32;36H[76;258H6[32;36H[?25h[?25l[76;243H~@k[32;36H[76;243H   [32;37H[76;258H7[32;37H[?25h[?25l[76;243H~@k[32;37H[76;243H   [32;38H[76;258H8[32;38H[?25h[?25l[76;243H~@k[32;38H[76;243H   [32;39H[76;258H9[32;39H[?25h[?25l[76;243H~@k[32;39H[76;243H   [32;40H[76;257H40[32;40H[?25h[?25l[76;243H~@k[32;40H[76;243H   [32;41H[76;258H1[32;41H[?25h[?25l[76;243H~@k[32;41H[76;243H   [32;42H[76;258H2[32;42H[?25h[?25l[76;243H~@k[32;42H[76;243H   [32;43H[76;258H3[32;43H[?25h[?25l[76;243H~@k[32;43H[76;243H   [32;44H[76;258H4[32;44H[?25h[?25l[76;243H~@k[32;44H[76;243H   [32;45H[76;258H5[32;45H[?25h[?25l[76;243H~@k[32;45H[76;243H   [32;46H[76;258H6[32;46H[?25h[?25l[76;243H~@k[32;46H[76;243H   [32;47H[76;258H7[32;47H[?25h[?25l[76;243H~@k[32;47H[76;243H   [32;48H[76;258H8[32;48H[?25h[?25l[76;243H~@k[32;48H[76;243H   [32;49H[76;258H9[32;49H[?25h[?25l[76;243H~@k[32;49H[76;243H   [32;50H[76;257H50[32;50H[?25h[?25l[76;243H~@k[32;50H[76;243H   [32;51H[76;258H1[32;51H[?25h[?25l[76;243H~@k[32;51H[76;243H   [32;52H[76;258H2[32;52H[?25h[?25l[76;243H~@k[32;52H[76;243H   [32;53H[76;258H3[32;53H[?25h[?25l[76;243H~@k[32;53H[76;243H   [32;54H[76;258H4[32;54H[?25h[?25l[76;243H~@k[32;54H[76;243H   [32;55H[76;258H5[32;55H[?25h[?25l[76;243H~@k[32;55H[76;243H   [32;56H[76;258H6[32;56H[?25h[?25l[76;243H~@k[32;56H[76;243H   [32;57H[76;258H7[32;57H[?25h[?25l[76;243H~@k[32;57H[76;243H   [32;58H[76;258H8[32;58H[?25h[?25l[76;243H~@k[32;58H[76;243H   [32;59H[76;258H9[32;59H[?25h[?25l[76;243H~@k[32;59H[76;243H   [32;60H[76;257H60[32;60H[?25h[?25l[76;243H~@k[32;60H[76;243H   [32;61H[76;258H1[32;61H[?25h[?25l[76;243H~@k[32;61H[76;243H   [32;62H[76;258H2[32;62H[?25h[?25l[76;243H~@k[32;62H[76;243H   [32;63H[76;258H3[32;63H[?25h[?25l[76;243H~@k[32;63H[76;243H   [32;64H[76;258H4[32;64H[?25h[?25l[76;243H~@k[32;64H[76;243H   [32;65H[76;258H5[32;65H[?25h[?25l[76;243H~@k[32;65H[76;243H   [32;66H[76;258H6[32;66H[?25h[?25l[76;243H~@k[32;66H[76;243H   [32;67H[76;258H7[32;67H[?25h[?25l[76;243H~@k[32;67H[76;243H   [32;68H[76;258H8[32;68H[?25h[?25l[76;243H~@k[32;68H[76;243H   [32;69H[76;258H9[32;69H[?25h[?25l[76;243H~@k[32;69H[76;243H   [32;70H[76;257H70[32;70H[?25h[?25l[76;243H~@k[32;70H[76;243H   [32;71H[76;258H1[32;71H[?25h[?25l[76;243H~@k[32;71H[76;243H   [32;72H[76;258H2[32;72H[?25h[?25l[76;243H~@k[32;72H[76;243H   [32;73H[76;258H3[32;73H[?25h[?25l[76;243H~@k[32;73H[76;243H   [32;74H[76;258H4[32;74H[?25h[?25l[76;243H~@k[32;74H[76;243H   [32;75H[76;258H5[32;75H[?25h[?25l[76;243H~@k[32;75H[76;243H   [32;76H[76;258H6[32;76H[?25h[?25l[76;243H~@k[32;76H[76;243H   [32;77H[76;258H7[32;77H[?25h[?25l[76;243H~@k[32;77H[76;243H   [32;78H[76;258H8[32;78H[?25h[?25l[76;243H~@k[32;78H[76;243H   [32;79H[76;258H9[32;79H[?25h[?25l[76;243H~@k[32;79H[76;243H   [32;80H[76;257H80[32;80H[?25h[?25l[76;243H~@k[32;80H[76;243H   [32;81H[76;258H1[32;81H[?25h[?25l[76;243H~@k[32;81H[76;243H   [32;82H[76;258H2[32;82H[?25h[?25l[76;243H~@k[32;82H[76;243H   [32;83H[76;258H3[32;83H[?25h[?25l[76;243H~@k[32;83H[76;243H   [32;84H[76;258H4[32;84H[?25h[?25l[76;243H~@k[32;84H[76;243H   [32;85H[76;258H5[32;85H[?25h[?25l[76;243H~@k[32;85H[76;243H   [32;86H[76;258H6[32;86H[?25h[?25l[76;243H~@k[32;86H[76;243H   [32;87H[76;258H7[32;87H[?25h[?25l[76;243H~@k[32;87H[76;243H   [32;88H[76;258H8[32;88H[?25h[?25l[76;243H~@k[32;88H[76;243H   [32;89H[76;258H9[32;89H[?25h[?25l[76;243H~@k[32;89H[76;243H   [32;90H[76;257H90[32;90H[?25h[?25l[76;243H~@k[32;90H[76;243H   [32;91H[76;258H1[32;91H[?25h[?25l[76;243H~@k[32;91H[76;243H   [32;92H[76;258H2[32;92H[?25h[?25l[76;243H~@k[32;92H[76;243H   [32;93H[76;258H3[32;93H[?25h[?25l[76;243H~@k[32;93H[76;243H   [32;94H[76;258H4[32;94H[?25h[?25l[76;243H~@k[32;94H[76;243H   [32;95H[76;258H5[32;95H[?25h[?25l[76;243H~@k[32;95H[76;243H   [32;96H[76;258H6[32;96H[?25h[?25l[76;243H~@k[32;96H[76;243H   [32;97H[76;258H7[32;97H[?25h[?25l[76;243H~@k[32;97H[76;243H   [32;98H[76;258H8[32;98H[?25h[?25l[76;243H~@k[32;98H[76;243H   [32;99H[76;258H9[32;99H[?25h[?25l[76;243H~@k[32;99H[76;243H   [32;100H[76;257H100[32;100H[?25h[?25l[76;243H~@k[32;100H[76;243H   [32;101H[76;259H1[32;101H[?25h[?25l[76;243H~@k[32;101H[76;243H   [32;102H[76;259H2[32;102H[?25h[?25l[76;243H~@k[32;102H[76;243H   [32;103H[76;259H3[32;103H[?25h[?25l[76;243H~@k[32;103H[76;243H   [32;104H[76;259H4[32;104H[?25h[?25l[76;243H~@k[32;104H[76;243H   [32;105H[76;259H5[32;105H[?25h[?25l[76;243H~@k[32;105H[76;243H   [32;106H[76;259H6[32;106H[?25h[?25l[76;243H~@k[32;106H[76;243H   [32;107H[76;259H7[32;107H[?25h[?25l[76;243H~@k[32;107H[76;243H   [32;108H[76;259H8[32;108H[?25h[?25l[76;243H~@k[32;108H[76;243H   [32;109H[76;259H9[32;109H[?25h[?25l[76;243H~@k[32;109H[76;243H   [32;110H[76;258H10[32;110H[?25h[?25l[76;243H~@k[32;110H[76;243H   [32;111H[76;259H1[32;111H[?25h[?25l[76;243H~@k[32;111H[76;243H   [32;112H[76;259H2[32;112H[?25h[?25l[76;243H~@k[32;112H[76;243H   [32;113H[76;259H3[32;113H[?25h[?25l[76;243H~@k[32;113H[76;243H   [32;114H[76;259H4[32;114H[?25h[?25l[76;243H~@k[32;114H[76;243H   [32;115H[76;259H5[32;115H[?25h[?25l[76;243H~@k[32;115H[76;243H   [32;116H[76;259H6[32;116H[?25h[?25l[76;243H~@k[32;116H[76;243H   [32;117H[76;259H7[32;117H[?25h[?25l[76;243H~@k[32;117H[76;243H   [32;118H[76;259H8[32;118H[?25h[?25l[76;243H~@k[32;118H[76;243H   [32;119H[76;259H9[32;119H[?25h[?25l[76;243H~@k[32;119H[76;243H   [32;120H[76;258H20[32;120H[?25h[?25l[76;243H~@k[32;120H[76;243H   [32;121H[76;259H1[32;121H[?25h[?25l[76;243H~@k[32;121H[76;243H   [32;122H[76;259H2[32;122H[?25h[?25l[76;243H~@k[32;122H[76;243H   [32;123H[38;5;224m[46m()[m[76;259H3[32;123H[?25h[?25l[76;243H~@k[32;123H[76;243H   [32;124H[76;259H4[32;124H[?25h[?25l[76;243H~@k[32;124H[76;243H   [32;123H[76;259H3[32;123H[?25h[?25l[76;243HN[32;123H[76;1H?\<if\>[76;243H[K[76;1H[26;7H[32;123H[38;5;224m()[m[76;253H129,7[9C71%[26;7H[?25h[?25l[76;243H~@k[26;7H[76;243H   [27;7H[76;254H30[27;7H[?25h[?25l[76;243H~@k[27;7H[76;243H   [28;7H[76;255H1[28;7H[?25h[?25l[76;243H~@k[28;7H[76;243H   [29;7H[26;27H[38;5;224m[46m{[29;7H}[m[76;255H2[29;7H[?25h[?25l[76;243H~@k[29;7H[76;243H   [30;6H[26;27H[38;5;224m{[29;7H}[m[76;255H3,6[30;6H[?25h[?25l[76;243H~@k[30;6H[76;243H   [31;7H[76;255H4,7[31;7H[?25h[?25l[76;243H~@k[31;7H[76;243H   [32;7H[76;255H5[32;7H[?25h[?25l[76;243H~@k[32;7H[76;243H   [32;8H[76;257H8[32;8H[?25h[?25l[76;243H~@k[32;8H[76;243H   [32;9H[76;257H9[32;9H[?25h[?25l[76;243H~@k[32;9H[76;243H   [32;10H[76;257H10[32;10H[?25h[?25l[76;243H~@k[32;10H[76;243H   [32;11H[76;258H1[32;11H[?25h[?25l[76;243H~@k[32;11H[76;243H   [32;12H[76;258H2[32;12H[?25h[?25l[76;243H~@k[32;12H[76;243H   [32;13H[76;258H3[32;13H[?25h[?25l[76;243H~@k[32;13H[76;243H   [32;14H[76;258H4[32;14H[?25h[?25l[76;243H~@k[32;14H[76;243H   [32;15H[76;258H5[32;15H[?25h[?25l[76;243H~@k[32;15H[76;243H   [32;16H[76;258H6[32;16H[?25h[?25l[76;243H~@k[32;16H[76;243H   [32;17H[76;258H7[32;17H[?25h[?25l[76;243H~@k[32;17H[76;243H   [32;18H[38;5;224m[46m([106C)[m[76;258H8[32;18H[?25h[?25l[76;243H~@k[32;18H[76;243H   [32;19H[38;5;224m([106C)[m[76;258H9[32;19H[?25h[?25l[76;243H~@k[32;19H[76;243H   [32;20H[76;257H20[32;20H[?25h[?25l[76;243H~@k[32;20H[76;243H   [32;21H[76;258H1[32;21H[?25h[?25l[76;243H~@k[32;21H[76;243H   [32;22H[76;258H2[32;22H[?25h[?25l[76;243H~@k[32;22H[76;243H   [32;23H[76;258H3[32;23H[?25h[?25l[76;243H~@k[32;23H[76;243H   [32;24H[76;258H4[32;24H[?25h[?25l[76;243H~@k[32;24H[76;243H   [32;25H[76;258H5[32;25H[?25h[?25l[76;243H~@k[32;25H[76;243H   [32;26H[76;258H6[32;26H[?25h[?25l[76;243H~@k[32;26H[76;243H   [32;27H[76;258H7[32;27H[?25h[?25l[76;243H~@k[32;27H[76;243H   [32;28H[76;258H8[32;28H[?25h[?25l[76;243H~@k[32;28H[76;243H   [32;29H[76;258H9[32;29H[?25h[?25l[76;243H~@k[32;29H[76;243H   [32;30H[76;257H30[32;30H[?25h[?25l[76;243H~@k[32;30H[76;243H   [32;31H[76;258H1[32;31H[?25h[?25l[76;243H~@k[32;31H[76;243H   [32;32H[76;258H2[32;32H[?25h[?25l[76;243H~@k[32;32H[76;243H   [32;33H[76;258H3[32;33H[?25h[?25l[76;243H~@k[32;33H[76;243H   [32;34H[76;258H4[32;34H[?25h[?25l[76;243H~@k[32;34H[76;243H   [32;35H[76;258H5[32;35H[?25h[?25l[76;243H~@k[32;35H[76;243H   [32;36H[76;258H6[32;36H[?25h[?25l[76;243H~@k[32;36H[76;243H   [32;37H[76;258H7[32;37H[?25h[?25l[76;243H~@k[32;37H[76;243H   [32;38H[76;258H8[32;38H[?25h[?25l[76;243H~@k[32;38H[76;243H   [32;39H[76;258H9[32;39H[?25h[?25l[76;243H~@k[32;39H[76;243H   [32;40H[76;257H40[32;40H[?25h[?25l[76;243H~@k[32;40H[76;243H   [32;41H[76;258H1[32;41H[?25h[?25l[76;243H~@k[32;41H[76;243H   [32;42H[76;258H2[32;42H[?25h[?25l[76;243H~@k[32;42H[76;243H   [32;43H[76;258H3[32;43H[?25h[?25l[76;243H~@k[32;43H[76;243H   [32;44H[76;258H4[32;44H[?25h[?25l[76;243H~@k[32;44H[76;243H   [32;45H[76;258H5[32;45H[?25h[?25l[76;243H~@k[32;45H[76;243H   [32;46H[76;258H6[32;46H[?25h[?25l[76;243H~@k[32;46H[76;243H   [32;47H[76;258H7[32;47H[?25h[?25l[76;243H~@k[32;47H[76;243H   [32;48H[76;258H8[32;48H[?25h[?25l[76;243H~@k[32;48H[76;243H   [32;49H[76;258H9[32;49H[?25h[?25l[76;243H~@k[32;49H[76;243H   [32;50H[76;257H50[32;50H[?25h[?25l[76;243H~@k[32;50H[76;243H   [32;51H[76;258H1[32;51H[?25h[?25l[76;243H~@k[32;51H[76;243H   [32;52H[76;258H2[32;52H[?25h[?25l[76;243H~@k[32;52H[76;243H   [32;53H[76;258H3[32;53H[?25h[?25l[76;243H~@k[32;53H[76;243H   [32;54H[76;258H4[32;54H[?25h[?25l[76;243H~@k[32;54H[76;243H   [32;55H[76;258H5[32;55H[?25h[?25l[76;243H~@k[32;55H[76;243H   [32;56H[76;258H6[32;56H[?25h[?25l[76;243H~@k[32;56H[76;243H   [32;57H[76;258H7[32;57H[?25h[?25l[76;243H~@k[32;57H[76;243H   [32;58H[76;258H8[32;58H[?25h[?25l[76;243Hi[32;58H[76;243H [32;58H[76;1H[1m-- INSERT --[m[76;253H[K[76;253H135,58[8C71%[32;58H[?25h[?25l[76;258H9[32;59H[?25h[?25l[76;257H60[32;60H[?25h[?25l[76;258H1[32;61H[?25h[?25l[76;258H2[32;62H[?25h[?25l[76;258H3[32;63H[?25h[?25l[76;258H4[32;64H[?25h[?25l[76;258H5[32;65H[?25h[?25l[76;258H6[32;66H[?25h[?25l[76;258H7[32;67H[?25h[?25l[76;258H8[32;68H[?25h[?25l[76;258H9[32;69H[?25h[?25l[76;257H70[32;70H[?25h[?25l[76;258H1[32;71H[?25h[?25l[76;258H2[32;72H[?25h[?25l[76;258H3[32;73H[?25h[?25l[76;258H4[32;74H[?25h[?25l[76;258H5[32;75H[?25h[?25l[76;258H6[32;76H[?25h[?25l[76;258H7[32;77H[?25h[?25l[76;258H8[32;78H[?25h[?25l[76;258H9[32;79H[?25h[?25l[76;257H80[32;80H[?25h[?25l[76;258H1[32;81H[?25h[?25l[76;258H2[32;82H[?25h[?25l[76;258H3[32;83H[?25h[?25l[76;258H4[32;84H[?25h[?25l[76;258H5[32;85H[?25h[?25l[76;258H6[32;86H[?25h[?25l[76;258H7[32;87H[?25h[?25l[76;258H8[32;88H[?25h[?25l[76;258H9[32;89H[?25h[?25l[76;257H90[32;90H[?25h[?25l[76;258H1[32;91H[?25h[?25l[76;258H2[32;92H[?25h[?25l[76;258H3[32;93H[?25h[?25l[76;258H4[32;94H[?25h[?25l[76;258H5[32;95H[?25h[?25l[76;258H6[32;96H[?25h[?25l[76;258H7[32;97H[?25h[?25l[76;258H8[32;98H[?25h[?25l[76;258H9[32;99H[?25h[?25l[76;257H100[32;100H[?25h[?25l[76;259H1[32;101H[?25h[?25l[76;259H2[32;102H[?25h[?25l[76;259H3[32;103H[?25h[?25l[76;259H4[32;104H[?25h[?25l[76;259H5[32;105H[?25h[?25l[76;259H6[32;106H[?25h[?25l[76;259H7[32;107H[?25h[?25l[76;259H8[32;108H[?25h[?25l[76;259H9[32;109H[?25h[?25l[76;258H10[32;110H[?25h[?25l[76;259H1[32;111H[?25h[?25l[76;259H2[32;112H[?25h[?25l[76;259H3[32;113H[?25h[?25l[76;259H4[32;114H[?25h[?25l[76;259H5[32;115H[?25h[?25l[76;259H6[32;116H[?25h[?25l[76;259H7[32;117H[?25h[?25l[76;259H8[32;118H[?25h[?25l[76;259H9[32;119H[?25h[?25l[76;258H20[32;120H[?25h[?25l[76;259H1[32;121H[?25h[?25l[76;259H2[32;122H[?25h[?25l[1C[38;5;224m[46m()[m[76;259H3[32;123H[?25h[?25l[76;259H4[32;124H[?25h[?25l[46mN[m[1C[38;5;224m)[mN[38;5;224m[46m)[m[76;259H5[32;125H[?25h[?25l[46mC[m[1C[38;5;224m)[mC[38;5;224m[46m)[m[76;259H6[32;126H[?25h[?25l[46mY[m[1C[38;5;224m)[mY[38;5;224m[46m)[m[76;259H7[32;127H[?25h[?25l[46mC[m[1C[38;5;224m)[mC[38;5;224m[46m)[m[76;259H8[32;128H[?25h[?25l[46mL[m[1C[38;5;224m)[mL[38;5;224m[46m)[m[76;259H9[32;129H[?25h[?25l[46mE[m[1C[38;5;224m)[mE[38;5;224m[46m)[m[76;258H30[32;130H[?25h[?25l[46mS[m[1C[38;5;224m)[mS[38;5;224m[46m)[m[76;259H1[32;131H[?25h[?25l[46m [m[1C[38;5;224m)[m [38;5;224m[46m)[m[76;259H2[32;132H[?25h[?25l[38;5;224m)[m[32;133H[K[32;131H[38;5;224m[46m)[m[38;5;224m)[m[76;259H1[32;131H[?25h[?25l[93m[46m=[m[1C[38;5;224m)[m[93m=[m[38;5;224m[46m)[m[76;259H2[32;132H[?25h[?25l[95m[46m1[m[1C[38;5;224m)[m[95m1[m[38;5;224m[46m)[m[76;259H3[32;133H[?25h[?25l[95m[46m0[m[1C[38;5;224m)[m[95m0[m[38;5;224m[46m)[m[76;259H4[32;134H[?25h[?25l[46m [m[1C[38;5;224m)[m [38;5;224m[46m)[m[76;259H5[32;135H[?25h[?25l[38;5;224m)[m[32;136H[K[32;134H[38;5;224m[46m)[m[38;5;224m)[m[76;259H4[32;134H[?25h[76;1H[K[32;133H[?25l[76;243H^[[32;133H[76;243H  [32;134H[32;123H[38;5;224m([10C)[m[76;253H135,133[7C71%[32;133H[?25h[?25l[76;243H:[32;133H[76;243H[K[76;1H:[?2004h[?25hw[?25l[?25h[?25l [?25h[?25l[?25h[?25l"fitscript.R" 220L, 8056C written[32;133H[76;253H135,133[7C71%[76;253H[K[76;253H135,133[7C71%[32;133H[?25h[?25l[76;243H:[32;133H[76;1H[K[76;1H:[?2004h[?25hq[?25l[?25h[?25l [?25h[?25l[?25h[?25l[?2004l[76;1H[K[76;1H[?2004l[?1l>[?25h[?1049l[23;0;0t]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ module load 2021 [K
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ module spider R [K

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  R:
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    Description:
      R is a free software environment for statistical computing and graphics.

     Versions:
        R/4.1.0-foss-2021a
        R/4.2.1-foss-2022a
     Other possible modules matches:
        AMD-uProf  ANTLR  Advisor  BioRunner  Blender  Brotli  CUDAcore  Cartopy  CoordgenLibs  Crystal17  CubeWriter  DIRAC  Darshan-runtime  Darshan-util  Extrae  FreeSurfer  FriBidi  GCCcore  GDRCopy  GObject-Introspection  GROMACS  GStreamer  Ghostscript  ...

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  To find other possible module matches execute:

      $ module -r spider '.*R.*'

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  For detailed information about a specific "R" package (including how to load the modules) use the module's full name.
  Note that names that have a trailing (E) are extensions provided by other modules.
  For example:

     $ module spider R/4.2.1-foss-2022a
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ module load R/4.1.0-foss-2021a
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ export R_LIBS=$HOME/rpackages:$R_LIBS
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ module [K[K[K[K[K[K[Kcd
]0;kveldkamp49@int5:~[kveldkamp49@int5 ~]$ cd [K[K[Ks[Kls [K
[0m[38;5;33mrgmirt[0m  [38;5;33mrpackages[0m  [38;5;33mvae[0m
]0;kveldkamp49@int5:~[kveldkamp49@int5 ~]$ cd vae/
]0;kveldkamp49@int5:~/vae[kveldkamp49@int5 vae]$ ls [K
[0m[38;5;33mlogs[0m  [38;5;9mmirt_1.37.1.tar.gz[0m  mirtjob  mirtpars.txt  [38;5;33mMIRT-VAE-Qmatrix[0m  nl-agent-tcn448.log  qcgjobmirt.py  qcgjob.py  [38;5;33mresults[0m  Rplots.pdf  simpars.txt  slurm-2917599.out  stoposjob  vaejob  vaepars.txt
]0;kveldkamp49@int5:~/vae[kveldkamp49@int5 vae]$ cp [K[K[Kmv mirt_1.37.1.tar.gz ../
]0;kveldkamp49@int5:~/vae[kveldkamp49@int5 vae]$ ls [K
[0m[38;5;33mlogs[0m  mirtjob  mirtpars.txt  [38;5;33mMIRT-VAE-Qmatrix[0m  nl-agent-tcn448.log  qcgjobmirt.py  qcgjob.py  [38;5;33mresults[0m  Rplots.pdf  simpars.txt  slurm-2917599.out  stoposjob  vaejob  vaepars.txt
]0;kveldkamp49@int5:~/vae[kveldkamp49@int5 vae]$ cd ..
]0;kveldkamp49@int5:~[kveldkamp49@int5 ~]$ ls [K
[0m[38;5;9mmirt_1.37.1.tar.gz[0m  [38;5;33mrgmirt[0m  [38;5;33mrpackages[0m  [38;5;33mvae[0m
]0;kveldkamp49@int5:~[kveldkamp49@int5 ~]$ R CMD INSTALL mirt_1.37.1.tar.gz 
* installing to library â€˜/gpfs/home6/kveldkamp49/rpackagesâ€™
* installing *source* package â€˜mirtâ€™ ...
** package â€˜mirtâ€™ successfully unpacked and MD5 sums checked
** using staged installation
** libs
g++ -std=gnu++14 -I"/sw/arch/Centos8/EB_production/2021/software/R/4.1.0-foss-2021a/lib64/R/include" -DNDEBUG  -I'/gpfs/admin/_hpc/sw/arch/AMD-ZEN2/Centos8/EB_production/2021/software/R/4.1.0-foss-2021a/lib64/R/library/Rcpp/include' -I'/gpfs/admin/_hpc/sw/arch/AMD-ZEN2/Centos8/EB_production/2021/software/R/4.1.0-foss-2021a/lib64/R/library/RcppArmadillo/include' -I/sw/arch/Centos8/EB_production/2021/software/OpenSSL/1.1/include -I/sw/arch/Centos8/EB_production/2021/software/libgit2/1.1.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/GDAL/3.3.0-foss-2021a/include -I/sw/arch/Centos8/EB_production/2021/software/nodejs/14.17.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/GLPK/5.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/ImageMagick/7.0.11-14-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/GSL/2.7-GCC-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/UDUNITS/2.2.28-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/HDF5/1.10.7-gompi-2021a/include -I/sw/arch/Centos8/EB_production/2021/software/ICU/69.1-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libsndfile/1.0.31-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/FFTW/3.3.9-gompi-2021a/include -I/sw/arch/Centos8/EB_production/2021/software/NLopt/2.7.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/GMP/6.2.1-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libxml2/2.9.10-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/cURL/7.76.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/Tk/8.6.11-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/Java/11.0.2/include -I/sw/arch/Centos8/EB_production/2021/software/LibTIFF/4.2.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libjpeg-turbo/2.0.6-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libpng/1.6.37-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/PCRE2/10.36-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/SQLite/3.35.4-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/zlib/1.2.11-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/XZ/5.2.5-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/bzip2/1.0.8-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/ncurses/6.2-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libreadline/8.1-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/cairo/1.16.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libGLU/9.0.1-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/Mesa/21.1.1-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/X11/20210518-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/FlexiBLAS/3.0.4-GCC-10.3.0/include  -fopenmp -fpic  -O2 -ftree-vectorize -O2 -march=znver2 -funroll-all-loops -fno-math-errno  -c Estep.cpp -o Estep.o
g++ -std=gnu++14 -I"/sw/arch/Centos8/EB_production/2021/software/R/4.1.0-foss-2021a/lib64/R/include" -DNDEBUG  -I'/gpfs/admin/_hpc/sw/arch/AMD-ZEN2/Centos8/EB_production/2021/software/R/4.1.0-foss-2021a/lib64/R/library/Rcpp/include' -I'/gpfs/admin/_hpc/sw/arch/AMD-ZEN2/Centos8/EB_production/2021/software/R/4.1.0-foss-2021a/lib64/R/library/RcppArmadillo/include' -I/sw/arch/Centos8/EB_production/2021/software/OpenSSL/1.1/include -I/sw/arch/Centos8/EB_production/2021/software/libgit2/1.1.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/GDAL/3.3.0-foss-2021a/include -I/sw/arch/Centos8/EB_production/2021/software/nodejs/14.17.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/GLPK/5.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/ImageMagick/7.0.11-14-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/GSL/2.7-GCC-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/UDUNITS/2.2.28-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/HDF5/1.10.7-gompi-2021a/include -I/sw/arch/Centos8/EB_production/2021/software/ICU/69.1-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libsndfile/1.0.31-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/FFTW/3.3.9-gompi-2021a/include -I/sw/arch/Centos8/EB_production/2021/software/NLopt/2.7.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/GMP/6.2.1-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libxml2/2.9.10-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/cURL/7.76.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/Tk/8.6.11-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/Java/11.0.2/include -I/sw/arch/Centos8/EB_production/2021/software/LibTIFF/4.2.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libjpeg-turbo/2.0.6-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libpng/1.6.37-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/PCRE2/10.36-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/SQLite/3.35.4-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/zlib/1.2.11-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/XZ/5.2.5-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/bzip2/1.0.8-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/ncurses/6.2-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libreadline/8.1-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/cairo/1.16.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libGLU/9.0.1-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/Mesa/21.1.1-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/X11/20210518-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/FlexiBLAS/3.0.4-GCC-10.3.0/include  -fopenmp -fpic  -O2 -ftree-vectorize -O2 -march=znver2 -funroll-all-loops -fno-math-errno  -c Misc.cpp -o Misc.o
g++ -std=gnu++14 -I"/sw/arch/Centos8/EB_production/2021/software/R/4.1.0-foss-2021a/lib64/R/include" -DNDEBUG  -I'/gpfs/admin/_hpc/sw/arch/AMD-ZEN2/Centos8/EB_production/2021/software/R/4.1.0-foss-2021a/lib64/R/library/Rcpp/include' -I'/gpfs/admin/_hpc/sw/arch/AMD-ZEN2/Centos8/EB_production/2021/software/R/4.1.0-foss-2021a/lib64/R/library/RcppArmadillo/include' -I/sw/arch/Centos8/EB_production/2021/software/OpenSSL/1.1/include -I/sw/arch/Centos8/EB_production/2021/software/libgit2/1.1.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/GDAL/3.3.0-foss-2021a/include -I/sw/arch/Centos8/EB_production/2021/software/nodejs/14.17.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/GLPK/5.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/ImageMagick/7.0.11-14-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/GSL/2.7-GCC-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/UDUNITS/2.2.28-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/HDF5/1.10.7-gompi-2021a/include -I/sw/arch/Centos8/EB_production/2021/software/ICU/69.1-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libsndfile/1.0.31-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/FFTW/3.3.9-gompi-2021a/include -I/sw/arch/Centos8/EB_production/2021/software/NLopt/2.7.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/GMP/6.2.1-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libxml2/2.9.10-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/cURL/7.76.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/Tk/8.6.11-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/Java/11.0.2/include -I/sw/arch/Centos8/EB_production/2021/software/LibTIFF/4.2.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libjpeg-turbo/2.0.6-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libpng/1.6.37-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/PCRE2/10.36-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/SQLite/3.35.4-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/zlib/1.2.11-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/XZ/5.2.5-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/bzip2/1.0.8-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/ncurses/6.2-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libreadline/8.1-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/cairo/1.16.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libGLU/9.0.1-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/Mesa/21.1.1-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/X11/20210518-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/FlexiBLAS/3.0.4-GCC-10.3.0/include  -fopenmp -fpic  -O2 -ftree-vectorize -O2 -march=znver2 -funroll-all-loops -fno-math-errno  -c dpars.cpp -o dpars.o
g++ -std=gnu++14 -I"/sw/arch/Centos8/EB_production/2021/software/R/4.1.0-foss-2021a/lib64/R/include" -DNDEBUG  -I'/gpfs/admin/_hpc/sw/arch/AMD-ZEN2/Centos8/EB_production/2021/software/R/4.1.0-foss-2021a/lib64/R/library/Rcpp/include' -I'/gpfs/admin/_hpc/sw/arch/AMD-ZEN2/Centos8/EB_production/2021/software/R/4.1.0-foss-2021a/lib64/R/library/RcppArmadillo/include' -I/sw/arch/Centos8/EB_production/2021/software/OpenSSL/1.1/include -I/sw/arch/Centos8/EB_production/2021/software/libgit2/1.1.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/GDAL/3.3.0-foss-2021a/include -I/sw/arch/Centos8/EB_production/2021/software/nodejs/14.17.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/GLPK/5.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/ImageMagick/7.0.11-14-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/GSL/2.7-GCC-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/UDUNITS/2.2.28-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/HDF5/1.10.7-gompi-2021a/include -I/sw/arch/Centos8/EB_production/2021/software/ICU/69.1-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libsndfile/1.0.31-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/FFTW/3.3.9-gompi-2021a/include -I/sw/arch/Centos8/EB_production/2021/software/NLopt/2.7.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/GMP/6.2.1-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libxml2/2.9.10-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/cURL/7.76.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/Tk/8.6.11-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/Java/11.0.2/include -I/sw/arch/Centos8/EB_production/2021/software/LibTIFF/4.2.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libjpeg-turbo/2.0.6-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libpng/1.6.37-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/PCRE2/10.36-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/SQLite/3.35.4-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/zlib/1.2.11-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/XZ/5.2.5-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/bzip2/1.0.8-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/ncurses/6.2-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libreadline/8.1-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/cairo/1.16.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libGLU/9.0.1-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/Mesa/21.1.1-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/X11/20210518-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/FlexiBLAS/3.0.4-GCC-10.3.0/include  -fopenmp -fpic  -O2 -ftree-vectorize -O2 -march=znver2 -funroll-all-loops -fno-math-errno  -c ggum_derivs.cpp -o ggum_derivs.o
g++ -std=gnu++14 -I"/sw/arch/Centos8/EB_production/2021/software/R/4.1.0-foss-2021a/lib64/R/include" -DNDEBUG  -I'/gpfs/admin/_hpc/sw/arch/AMD-ZEN2/Centos8/EB_production/2021/software/R/4.1.0-foss-2021a/lib64/R/library/Rcpp/include' -I'/gpfs/admin/_hpc/sw/arch/AMD-ZEN2/Centos8/EB_production/2021/software/R/4.1.0-foss-2021a/lib64/R/library/RcppArmadillo/include' -I/sw/arch/Centos8/EB_production/2021/software/OpenSSL/1.1/include -I/sw/arch/Centos8/EB_production/2021/software/libgit2/1.1.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/GDAL/3.3.0-foss-2021a/include -I/sw/arch/Centos8/EB_production/2021/software/nodejs/14.17.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/GLPK/5.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/ImageMagick/7.0.11-14-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/GSL/2.7-GCC-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/UDUNITS/2.2.28-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/HDF5/1.10.7-gompi-2021a/include -I/sw/arch/Centos8/EB_production/2021/software/ICU/69.1-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libsndfile/1.0.31-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/FFTW/3.3.9-gompi-2021a/include -I/sw/arch/Centos8/EB_production/2021/software/NLopt/2.7.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/GMP/6.2.1-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libxml2/2.9.10-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/cURL/7.76.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/Tk/8.6.11-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/Java/11.0.2/include -I/sw/arch/Centos8/EB_production/2021/software/LibTIFF/4.2.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libjpeg-turbo/2.0.6-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libpng/1.6.37-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/PCRE2/10.36-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/SQLite/3.35.4-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/zlib/1.2.11-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/XZ/5.2.5-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/bzip2/1.0.8-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/ncurses/6.2-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libreadline/8.1-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/cairo/1.16.0-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/libGLU/9.0.1-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/Mesa/21.1.1-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/X11/20210518-GCCcore-10.3.0/include -I/sw/arch/Centos8/EB_production/2021/software/FlexiBLAS/3.0.4-GCC-10.3.0/include  -fopenmp -fpic  -O2 -ftree-vectorize -O2 -march=znver2 -funroll-all-loops -fno-math-errno  -c traceLinePts.cpp -o traceLinePts.o
g++ -std=gnu++14 -shared -L/sw/arch/Centos8/EB_production/2021/software/R/4.1.0-foss-2021a/lib64/R/lib -L/sw/arch/Centos8/EB_production/2021/software/OpenSSL/1.1/lib64 -L/sw/arch/Centos8/EB_production/2021/software/OpenSSL/1.1/lib -L/sw/arch/Centos8/EB_production/2021/software/libgit2/1.1.0-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/libgit2/1.1.0-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/GDAL/3.3.0-foss-2021a/lib64 -L/sw/arch/Centos8/EB_production/2021/software/GDAL/3.3.0-foss-2021a/lib -L/sw/arch/Centos8/EB_production/2021/software/nodejs/14.17.0-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/nodejs/14.17.0-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/GLPK/5.0-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/GLPK/5.0-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/ImageMagick/7.0.11-14-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/ImageMagick/7.0.11-14-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/GSL/2.7-GCC-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/GSL/2.7-GCC-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/UDUNITS/2.2.28-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/UDUNITS/2.2.28-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/HDF5/1.10.7-gompi-2021a/lib64 -L/sw/arch/Centos8/EB_production/2021/software/HDF5/1.10.7-gompi-2021a/lib -L/sw/arch/Centos8/EB_production/2021/software/ICU/69.1-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/ICU/69.1-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/libsndfile/1.0.31-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/libsndfile/1.0.31-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/FFTW/3.3.9-gompi-2021a/lib64 -L/sw/arch/Centos8/EB_production/2021/software/FFTW/3.3.9-gompi-2021a/lib -L/sw/arch/Centos8/EB_production/2021/software/NLopt/2.7.0-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/NLopt/2.7.0-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/GMP/6.2.1-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/GMP/6.2.1-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/libxml2/2.9.10-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/libxml2/2.9.10-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/cURL/7.76.0-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/cURL/7.76.0-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/Tk/8.6.11-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/Tk/8.6.11-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/Java/11.0.2/lib64 -L/sw/arch/Centos8/EB_production/2021/software/Java/11.0.2/lib -L/sw/arch/Centos8/EB_production/2021/software/LibTIFF/4.2.0-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/LibTIFF/4.2.0-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/libjpeg-turbo/2.0.6-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/libjpeg-turbo/2.0.6-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/libpng/1.6.37-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/libpng/1.6.37-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/PCRE2/10.36-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/PCRE2/10.36-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/SQLite/3.35.4-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/SQLite/3.35.4-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/zlib/1.2.11-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/zlib/1.2.11-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/XZ/5.2.5-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/XZ/5.2.5-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/bzip2/1.0.8-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/bzip2/1.0.8-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/ncurses/6.2-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/ncurses/6.2-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/libreadline/8.1-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/libreadline/8.1-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/cairo/1.16.0-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/cairo/1.16.0-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/libGLU/9.0.1-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/libGLU/9.0.1-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/Mesa/21.1.1-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/Mesa/21.1.1-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/X11/20210518-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/X11/20210518-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/Xvfb/1.20.11-GCCcore-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/Xvfb/1.20.11-GCCcore-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib64 -L/sw/arch/Centos8/EB_production/2021/software/ScaLAPACK/2.1.0-gompi-2021a-fb/lib -L/sw/arch/Centos8/EB_production/2021/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/FlexiBLAS/3.0.4-GCC-10.3.0/lib -L/sw/arch/Centos8/EB_production/2021/software/GCCcore/10.3.0/lib64 -L/sw/arch/Centos8/EB_production/2021/software/GCCcore/10.3.0/lib -o mirt.so Estep.o Misc.o dpars.o ggum_derivs.o traceLinePts.o -lflexiblas -lgfortran -lgfortran -lm -fopenmp -L/sw/arch/Centos8/EB_production/2021/software/R/4.1.0-foss-2021a/lib64/R/lib -lR
installing to /gpfs/home6/kveldkamp49/rpackages/00LOCK-mirt/00new/mirt/libs
** R
** data
*** moving datasets to lazyload DB
** inst
** byte-compile and prepare package for lazy loading
Creating a new generic function for â€˜Derivâ€™ in package â€˜mirtâ€™
** help
*** installing help indices
** building package indices
** installing vignettes
** testing if installed package can be loaded from temporary location
** checking absolute paths in shared objects and dynamic libraries
** testing if installed package can be loaded from final location
** testing if installed package keeps a record of temporary installation path
* DONE (mirt)
]0;kveldkamp49@int5:~[kveldkamp49@int5 ~]$ c[Kls [K
[0m[38;5;9mmirt_1.37.1.tar.gz[0m  [38;5;33mrgmirt[0m  [38;5;33mrpackages[0m  [38;5;33mvae[0m
]0;kveldkamp49@int5:~[kveldkamp49@int5 ~]$ cd rgmirt/EN-MIRT/scripts/
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ Rscript fitscript.R 0 0 3 1 [K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[Kvim fitscript.R 
[?2004h[?1049h[22;0;0t[?1h=[?2004h[1;76r[?12h[?12l[27m[23m[29m[m[H[2J[?25l[76;1H"fitscript.R" 220L, 8056C[2;1Hâ–½[6n[2;1H  [1;1H[>c]10;?]11;?[1;3H[34m# calculate to which fold each person and item belongs[m
  folds.persons [38;5;130m<-[m  [36mcut[m[35m([m[36mseq[m[35m([m[31m1[m[35m,[m[36mnrow[m[35m([mdata[35m)),[mbreaks[38;5;130m=[mk[35m[[m[31m1[m[35m],[mlabels[38;5;130m=[m[31mFALSE[m[35m)[m
  folds.items [38;5;130m<-[m [36mcut[m[35m([m[36mseq[m[35m([m[31m1[m[35m,[m[36mncol[m[35m([mdata[35m)),[mbreaks[38;5;130m=[mk[35m[[m[31m2[m[35m],[mlabels[38;5;130m=[m[31mFALSE[m[35m)[m

  rmses [38;5;130m=[m [36mc[m[35m()[m
  biases [38;5;130m=[m [36mc[m[35m()[m
  accuracies [38;5;130m=[m [36mc[m[35m()[m
  f1s [38;5;130m=[m [36mc[m[35m()[m

  [34m# loop though cross validation folds[m
  [38;5;130mfor[m [35m([mi [38;5;130min[m [31m1[m[35m:[mk[35m[[m[31m1[m[35m])
[m  [35m{[m
    [38;5;130mfor[m [35m([mj [38;5;130min[m [31m1[m[35m:[mk[35m[[m[31m2[m[35m])
[m    [35m{[m[15;7H[34m# save the persons and items that belong to the hold out test set[m[16;7Hper.ind [38;5;130m<-[m [36mwhich[m[35m([mfolds.persons[38;5;130m==[mi[35m)[m[17;7Hitem.ind [38;5;130m<-[m [36mwhich[m[35m([mfolds.items[38;5;130m==[mj[35m)[m[19;7H[34m# create train and test folds[m[20;7Htest [38;5;130m<-[m data[35m[[mper.ind[35m,[m item.ind[35m][m[21;7Htrain [38;5;130m<-[m data[22;7Htrain[35m[[mper.ind[35m,[mitem.ind[35m][m [38;5;130m<-[m [31mNA[m[24;7H[34m# [m[34m[103mif[m[34m some rows contain no responses after the leave out set, remove them from the training set, and adjust person indices accordingly[m[25;7Hemptyrows [38;5;130m=[m [36mrowSums[m[35m([m[36mis.na[m[35m([mtrain[35m))[m [38;5;130m==[m [36mncol[m[35m([mtrain[35m)[m[26;7Hemptycols [38;5;130m=[m [36mcolSums[m[35m([m[36mis.na[m[35m([mtrain[35m))[m [38;5;130m==[m [36mnrow[m[35m([mtrain[35m)[m[27;7H[38;5;130m[103mif[m[35m([m[36msum[m[35m([memptyrows[35m)[m[38;5;130m>[m[31m0[m[35m){[m[28;9Htrain [38;5;130m=[m train[35m[[m[38;5;130m![memptyrows[35m,[m [35m][m[29;9Hper.ind [38;5;130m=[m per.ind[35m[[m[38;5;130m![mper.ind [38;5;130m%in%[m [36mwhich[m[35m([memptyrows[35m)][30;7H}[m[31;7H[34m# do the same for columns[m[32;7H[38;5;130m[103mif[m[35m([m[36msum[m[35m([memptycols[35m)[m[38;5;130m>[m[31m0[m[35m){[m[33;9Htrain [38;5;130m=[m train[35m[,[m[38;5;130m![memptycols[35m][m[34;9Hitem.ind [38;5;130m=[m item.ind[35m[[m[38;5;130m![mitem.ind [38;5;130m%in%[m [36mwhich[m[35m([memptycols[35m)][35;7H}[m[37;7H[34m# fit model[m[38;7Hfit [38;5;130m<-[m [36mmirt[m[35m([mtrain[35m,[m model[35m,[m [31m'2PL'[m[35m,[m method[38;5;130m=[mmethod[35m,[m GenRandomPars[38;5;130m=[mrandompars[35m,[m lambda[38;5;130m=[mlambda[35m,[m pars[38;5;130m=[mpars[35m,[m technical [38;5;130m=[m [32mlist[m[35m([mNCYCLES[38;5;130m=[m[31m10[m[35m))[m[39;7H[34m# save parameters[m[40;7Hitempars [38;5;130m<-[m [36mcoef[m[35m([mfit[35m,[m simplify [38;5;130m=[m [31mTRUE[m[35m)$[mitems[41;7Ha [38;5;130m<-[m itempars[35m[,[m[31m1[m[35m:([m[36mncol[m[35m([mitempars[35m)[m[38;5;130m-[m[31m3[m[35m)][m[42;7Hd [38;5;130m<-[m itempars[35m[,[m [36mncol[m[35m([mitempars[35m)[m[38;5;130m-[m[31m2[m[35m][m[43;7Htheta [38;5;130m<-[m [36mfscores[m[35m([mfit[35m)[m[45;7H[34m# calculate true and predicted probablities[m[46;7Hp.pred [38;5;130m<-[m [36mpredict.mirt[m[35m([ma[35m,[m d[35m,[m theta[35m)[m[47;7Hp.true [38;5;130m<-[m [36mpredict.mirt[m[35m([ma_true[35m,[m [36mas.vector[m[35m([md_true[35m),[m theta_true[35m)[m[49;7H[34m# [m[34m[103mif[m[34m there are rows without responses, they have no theta estimates, so we have to fill in some empty rows to make the dimensions correct[m[50;7H[38;5;130m[103mif[m[35m([m[36msum[m[35m([memptyrows[35m)[m[38;5;130m>[m[31m0[m[35m){[m[51;9Hp.pred [38;5;130m=[m [36minsertEmptyRows[m[35m([mp.pred[35m,[m [36mwhich[m[35m([memptyrows[35m))[52;7H}[m[53;7H[38;5;130m[103mif[m[35m([m[36msum[m[35m([memptycols[35m)[m[38;5;130m>[m[31m0[m[35m){[m[54;9Hp.pred [38;5;130m=[m [36minsertEmptyCols[m[35m([mp.pred[35m,[m [36mwhich[m[35m([memptycols[35m))[55;7H}[m[56;7H[34m# calculate true and predicted responses[m[57;7Hresp.pred [38;5;130m=[m [36mround[m[35m([mp.pred[35m,[m [31m0[m[35m)[m[58;7Hresp.true [38;5;130m=[m [36mround[m[35m([mp.true[35m,[m [31m0[m[35m)[m[60;7H[34m# calculate metrics and save them[m[61;7Hrmses [38;5;130m<-[m [36mc[m[35m([mrmses[35m,[m [36mRMSE[m[35m([mest[38;5;130m=[mp.pred[35m[[mper.ind[35m,[m item.ind[35m],[m par[38;5;130m=[mp.true[35m[[mper.ind[35m,[m item.ind[35m]))[m[62;7Hbiases [38;5;130m<-[m [36mc[m[35m([mbiases[35m,[m [36mbias[m[35m([mest[38;5;130m=[mp.pred[35m[[mper.ind[35m,[m item.ind[35m],[m par[38;5;130m=[mp.true[35m[[mper.ind[35m,[m item.ind[35m]))[m[63;7Htop10 [38;5;130m<-[m [36macc_f1_at_n[m[35m([mtrue[38;5;130m=[mresp.true[35m,[m pred[38;5;130m=[mresp.predm[35m,[m n[38;5;130m=[m[31m10[m[35m)[m[64;7Htop20 [38;5;130m<-[m [36macc_f1_at_n[m[35m([mtrue[38;5;130m=[mresp.true[35m,[m pred[38;5;130m=[mresp.predm[35m,[m n[38;5;130m=[m[31m20[m[35m)[m[65;7Hacc10 [38;5;130m<-[m [36mc[m[35m([macc10[35m,[m top10[35m[[m[31m1[m[35m])[m[66;7Hf110 [38;5;130m<-[m [36mc[m[35m([mf110[35m,[m top10[35m[[m[31m2[m[35m])[m[67;7Hacc20 [38;5;130m<-[m [36mc[m[35m([macc20[35m,[m top20[35m[[m[31m1[m[35m])[m[68;7Hf120 [38;5;130m<-[m [36mc[m[35m([mf120[35m,[m top20[35m[[m[31m2[m[35m])[70;5H}
[m  [35m}[m
  [38;5;130mreturn[m[35m([m[36mc[m[35m([m[36mmean[m[35m([mrmses[35m),[m [36mmean[m[35m([mbiases[35m),[m [36mmean[m[35m([macc10[35m),[m [36mmean[m[35m([macc20[35m),[m [36mmean[m[35m([mf110[35m),[m [36mmean[m[35m([mf120[35m)))
}[m

[34m# read appropriate data file[m[76;253H135,133[7C66%[38;133H[?25h[27m[23m[29m[m[H[2J[?25l[1;3H[96m# calculate to which fold each person and item belongs[m
  folds.persons [93m<-[m  [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mnrow[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m1[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m
  folds.items [93m<-[m [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mncol[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m2[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m

  rmses [93m=[m [1m[96mc[m[38;5;224m()[m
  biases [93m=[m [1m[96mc[m[38;5;224m()[m
  accuracies [93m=[m [1m[96mc[m[38;5;224m()[m
  f1s [93m=[m [1m[96mc[m[38;5;224m()[m

  [96m# loop though cross validation folds[m
  [93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m1[m[38;5;224m])
[m  [38;5;224m{[m
    [93mfor[m [38;5;224m([mj [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m2[m[38;5;224m])
[m    [38;5;224m{[m[15;7H[96m# save the persons and items that belong to the hold out test set[m[16;7Hper.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.persons[93m==[mi[38;5;224m)[m[17;7Hitem.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.items[93m==[mj[38;5;224m)[m[19;7H[96m# create train and test folds[m[20;7Htest [93m<-[m data[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m][m[21;7Htrain [93m<-[m data[22;7Htrain[38;5;224m[[mper.ind[38;5;224m,[mitem.ind[38;5;224m][m [93m<-[m [95mNA[m[24;7H[96m# [m[30m[103mif[m[96m some rows contain no responses after the leave out set, remove them from the training set, and adjust person indices accordingly[m[25;7Hemptyrows [93m=[m [1m[96mrowSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mncol[m[38;5;224m([mtrain[38;5;224m)[m[26;7Hemptycols [93m=[m [1m[96mcolSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mnrow[m[38;5;224m([mtrain[38;5;224m)[m[27;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[28;9Htrain [93m=[m train[38;5;224m[[m[93m![memptyrows[38;5;224m,[m [38;5;224m][m[29;9Hper.ind [93m=[m per.ind[38;5;224m[[m[93m![mper.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m)][30;7H}[m[31;7H[96m# do the same for columns[m[32;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[33;9Htrain [93m=[m train[38;5;224m[,[m[93m![memptycols[38;5;224m][m[34;9Hitem.ind [93m=[m item.ind[38;5;224m[[m[93m![mitem.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m)][35;7H}[m[37;7H[96m# fit model[m[38;7Hfit [93m<-[m [1m[96mmirt[m[38;5;224m([mtrain[38;5;224m,[m model[38;5;224m,[m [95m'2PL'[m[38;5;224m,[m method[93m=[mmethod[38;5;224m,[m GenRandomPars[93m=[mrandompars[38;5;224m,[m lambda[93m=[mlambda[38;5;224m,[m pars[93m=[mpars[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m([mNCYCLES[93m=[m[95m10[m[38;5;224m))[m[39;7H[96m# save parameters[m[40;7Hitempars [93m<-[m [1m[96mcoef[m[38;5;224m([mfit[38;5;224m,[m simplify [93m=[m [95mTRUE[m[38;5;224m)$[mitems[41;7Ha [93m<-[m itempars[38;5;224m[,[m[95m1[m[38;5;224m:([m[1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m3[m[38;5;224m)][m[42;7Hd [93m<-[m itempars[38;5;224m[,[m [1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m2[m[38;5;224m][m[43;7Htheta [93m<-[m [1m[96mfscores[m[38;5;224m([mfit[38;5;224m)[m[45;7H[96m# calculate true and predicted probablities[m[46;7Hp.pred [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)[m[47;7Hp.true [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma_true[38;5;224m,[m [1m[96mas.vector[m[38;5;224m([md_true[38;5;224m),[m theta_true[38;5;224m)[m[49;7H[96m# [m[30m[103mif[m[96m there are rows without responses, they have no theta estimates, so we have to fill in some empty rows to make the dimensions correct[m[50;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[51;9Hp.pred [93m=[m [1m[96minsertEmptyRows[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m))[52;7H}[m[53;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[54;9Hp.pred [93m=[m [1m[96minsertEmptyCols[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m))[55;7H}[m[56;7H[96m# calculate true and predicted responses[m[57;7Hresp.pred [93m=[m [1m[96mround[m[38;5;224m([mp.pred[38;5;224m,[m [95m0[m[38;5;224m)[m[58;7Hresp.true [93m=[m [1m[96mround[m[38;5;224m([mp.true[38;5;224m,[m [95m0[m[38;5;224m)[m[60;7H[96m# calculate metrics and save them[m[61;7Hrmses [93m<-[m [1m[96mc[m[38;5;224m([mrmses[38;5;224m,[m [1m[96mRMSE[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[62;7Hbiases [93m<-[m [1m[96mc[m[38;5;224m([mbiases[38;5;224m,[m [1m[96mbias[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[63;7Htop10 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mtrue[93m=[mresp.true[38;5;224m,[m pred[93m=[mresp.predm[38;5;224m,[m n[93m=[m[95m10[m[38;5;224m)[m[64;7Htop20 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mtrue[93m=[mresp.true[38;5;224m,[m pred[93m=[mresp.predm[38;5;224m,[m n[93m=[m[95m20[m[38;5;224m)[m[65;7Hacc10 [93m<-[m [1m[96mc[m[38;5;224m([macc10[38;5;224m,[m top10[38;5;224m[[m[95m1[m[38;5;224m])[m[66;7Hf110 [93m<-[m [1m[96mc[m[38;5;224m([mf110[38;5;224m,[m top10[38;5;224m[[m[95m2[m[38;5;224m])[m[67;7Hacc20 [93m<-[m [1m[96mc[m[38;5;224m([macc20[38;5;224m,[m top20[38;5;224m[[m[95m1[m[38;5;224m])[m[68;7Hf120 [93m<-[m [1m[96mc[m[38;5;224m([mf120[38;5;224m,[m top20[38;5;224m[[m[95m2[m[38;5;224m])[70;5H}
[m  [38;5;224m}[m
  [93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([m[1m[96mmean[m[38;5;224m([mrmses[38;5;224m),[m [1m[96mmean[m[38;5;224m([mbiases[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc10[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc20[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf110[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf120[38;5;224m)))
}[m

[96m# read appropriate data file[m[76;253H135,133[7C66%"fitscript.R" 220L, 8056C[38;133H[?25h[?25l[76;243H~@k[38;133H[76;243H   [37;17H[76;255H4,17 [37;17H[?25h[?25l[76;243H~@k[37;17H[76;243H   [36;6H[76;255H3,6 [36;6H[?25h[?25l[32;27H[38;5;224m[46m{[35;7H}[m[76;255H2,7[35;7H[?25h[?25l[32;27H[38;5;224m{[35;7H}[m[76;255H1,17[34;17H[?25h[?25l[76;243H~@k[34;17H[76;243H   [33;17H[76;255H0[33;17H[?25h[?25l[76;254H29[32;17H[?25h[?25l[76;255H8[31;17H[?25h[?25l[27;27H[38;5;224m[46m{[30;7H}[m[76;255H7,7 [30;7H[?25h[?25l[27;27H[38;5;224m{[30;7H}[m[76;255H6,17[29;17H[?25h[?25l[76;243H~@k[29;17H[76;243H   [28;17H[76;255H5[28;17H[?25h[?25l[76;243H~@k[28;17H[76;243H   [27;17H[76;255H4[27;17H[?25h[?25l[76;255H3[26;17H[?25h[?25l[76;255H2[25;17H[?25h[?25l[76;255H1[24;17H[?25h[?25l[76;255H0,6 [23;6H[?25h[?25l[76;243H~@k[23;6H[76;243H   [22;17H[76;254H19,17[22;17H[?25h[?25l[76;255H8[21;17H[?25h[?25l[76;255H7[20;17H[?25h[?25l[76;255H6[19;17H[?25h[?25l[76;255H5,6 [18;6H[?25h[?25l[76;243H~@k[18;6H[76;243H   [17;17H[76;255H4,17[17;17H[?25h[?25l[76;255H3[16;17H[?25h[?25l[76;243H~@k[16;17H[76;243H   [15;17H[76;255H2[15;17H[?25h[?25l[14;5H[38;5;224m[46m{[70;5H}[m[76;255H1,5 [14;5H[?25h[?25l[38;5;224m{[70;5H}[m[76;255H0,17[13;17H[?25h[?25l[12;3H[38;5;224m[46m{[71;3H}[m[76;254H09,3 [12;3H[?25h[?25l[38;5;224m{[71;3H}[m[76;255H8,17[11;17H[?25h[?25l[76;255H7[10;17H[?25h[?25l[76;255H6,2 [9;2H[?25h[?25l[8;10H[38;5;224m[46m()[m[76;255H5,11[8;11H[?25h[?25l[7;17H[38;5;224m[46m()[m[8;10H[38;5;224m()[m[76;255H4,17[7;17H[?25h[?25l[6;13H[38;5;224m[46m()[m[7;17H[38;5;224m()[m[76;255H3,14[6;14H[?25h[?25l[1;75r[1;1H[L[1;76r[6;12H[38;5;224m[46m()[m[7;13H[38;5;224m()[m[76;1H[K[76;253H102,13[8C66%[6;13H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m{[7;12H()[m[76;253H[K[76;253H101,0-1[7C65%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hpars[38;5;224m)[m[10C[96m# parameters object from mirt[m[76;253H[K[76;253H100,17[8C64%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Htheta_true[38;5;224m,[m    [96m# true parameter values[m[76;253H[K[76;253H99,17[9C64%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hd_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H98,17[9C63%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;2H[1;75r[1;1H[L[1;76r[1;21Ha_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H97,2[10C62%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hlambda[38;5;224m,[m[8C[96m# l1 and l2 penalty[m[76;253H[K[76;253H96,1[10C62%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hk [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m    [96m# number of folds for 2d cross validation[m[76;253H[K[76;253H95,17[9C61%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hrandompars[38;5;224m,[m    [96m# mirt argument for whether to use random paramters values[m[76;253H[K[76;253H94,17[9C60%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hmethod[38;5;224m,[m[8C[96m# method of esitmation, e.g. EM[m[76;253H[K[76;253H93,17[9C60%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hmodel[38;5;224m,[m[9C[96m# model to be passed to mirt, can be number of dimensions[m[76;253H[K[76;253H92,17[9C59%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hcv.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([mdata[38;5;224m,[m[10C[96m# matrix of responses[m[76;253H[K[76;253H91,17[9C58%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# Function that fits rgmirt model using cross validation and returns the average RMSE and average bias[m[76;253H[K[76;253H90,17[9C57%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H89,17[9C57%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H88,17[9C56%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[m[76;253H[K[76;253H87,17[9C55%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([mavg_topn_accuracy[38;5;224m,[m avg_topn_f1_score[38;5;224m))[m[76;253H[K[76;253H86,17[9C55%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H85,17[9C54%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Havg_topn_f1_score [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_f1_scores[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H84,0-1[8C53%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Havg_topn_accuracy [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_accuracies[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H83,0-1[8C53%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[96m# Calculate the average top-n accuracy and top-n F1 score across all users[m[76;253H[K[76;253H82,1[10C52%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H81,17[9C51%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[38;5;224m}[m[76;253H[K[76;253H80,2[10C51%[6;2H[?25h[?25l[76;243H~@k[6;2H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[1;5Htopn_f1_scores[38;5;224m[[mi[38;5;224m][m [93m<-[m f1_score[76;253H[K[76;253H79,17[9C50%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[1;5Htopn_accuracies[38;5;224m[[mi[38;5;224m][m [93m<-[m topn_accuracy[76;253H[K[76;253H78,17[9C49%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H77,17[9C48%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hf1_score [93m<-[m [95m2[m [93m*[m precision [93m*[m recall [93m/[m [38;5;224m([mprecision [93m+[m recall[38;5;224m)[m[76;253H[K[76;253H76,2[10C48%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H75,3[10C47%[6;3H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hrecall [93m<-[m true_positives [93m/[m actual_positives[76;253H[K[76;253H74,17[9C46%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[1;5Hprecision [93m<-[m true_positives [93m/[m predicted_positives[76;253H[K[76;253H73,17[9C46%[6;17H[?25h[?25l[76;254H4[7;17H[?25h[?25l[76;254H5,3 [8;3H[?25h[?25l[76;254H6,2[9;2H[?25h[?25l[76;254H7,17[10;17H[?25h[?25l[76;243H~@k[10;17H[76;243H   [11;17H[76;254H8[11;17H[?25h[?25l[76;254H7[10;17H[?25h[?25l[76;254H6,2 [9;2H[?25h[?25l[76;254H5,3[8;3H[?25h[?25l[76;243H~@k[8;3H[76;243H   [7;17H[76;254H4,17[7;17H[?25h[?25l[76;243H~@k[7;17H[76;243H   [6;17H[76;254H3[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H72,4[10C45%[6;4H[?25h[?25l[76;243H~@k[6;4H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[1;5Hactual_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m[76;253H[K[76;253H71,17[9C44%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hpredicted_positives [93m<-[m [1m[96msum[m[38;5;224m([mpred_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m[76;253H[K[76;253H70,4[10C44%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htrue_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m[76;253H[K[76;253H69,17[9C43%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[96m# Calculate the top-n F1 score for the current user[m[76;253H[K[76;253H68,17[9C42%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H67,4[10C42%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htopn_accuracy [93m<-[m [1m[96msum[m[38;5;224m([mtrue_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m [93m/[m n[76;253H[K[76;253H66,17[9C41%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[96m# Calculate the top-n accuracy for the current user[m[76;253H[K[76;253H65,17[9C40%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H64,17[9C40%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htopn_indices [93m<-[m [1m[96morder[m[38;5;224m([m[93m-[mpred_relevance[38;5;224m)[[m[95m1[m[38;5;224m:[mn[38;5;224m][m[76;253H[K[76;253H63,17[9C39%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[96m# Get the indices of the top-n predicted relevance[m[76;253H[K[76;253H62,4[10C38%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H61,17[9C37%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hpred_relevance [93m<-[m pred[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H60,17[9C37%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htrue_relevance [93m<-[m true[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H59,4[10C36%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mnum_users[38;5;224m)[m [38;5;224m{[m[76;253H[K[76;253H58,17[9C35%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H57,17[9C35%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;4H[1;75r[1;1H[L[1;76r[1;3Htopn_f1_scores [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m[76;253H[K[76;253H56,4[10C34%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Htopn_accuracies [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m[76;253H[K[76;253H55,17[9C33%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H54,17[9C33%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hnum_movies [93m<-[m [1m[96mdim[m[38;5;224m([mtrue[38;5;224m)[[m[95m2[m[38;5;224m][m[76;253H[K[76;253H53,17[9C32%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;2H[1;75r[1;1H[L[1;76r[1;3Hnum_users [93m<-[m [1m[96mdim[m[38;5;224m([mtrue[38;5;224m)[[m[95m1[m[38;5;224m][m[76;253H[K[76;253H52,2[10C31%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H51,17[9C31%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hacc_f1_at_n [93m<-[m [38;5;121mfunction[m[38;5;224m([mtrue[38;5;224m,[m pred[38;5;224m,[m n[38;5;224m)[m [38;5;224m{[m[76;253H[K[76;253H50,17[9C30%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;2H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H49,2[10C29%[6;2H[?25h[?25l[76;243H~@k[6;2H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[m[76;253H[K[76;253H48,17[9C28%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[1;3H[1m[96mmean[m[38;5;224m([mest[93m-[mpar[38;5;224m)[m[76;253H[K[76;253H47,17[9C28%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m{[m[76;253H[K[76;253H46,0-1[8C27%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hbias [93m<-[m [38;5;121mfunction[m[38;5;224m([mpar[38;5;224m,[m est[38;5;224m)[m[76;253H[K[76;253H45,17[9C26%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# bias [m[76;253H[K[76;253H44,0-1[8C26%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[4;1H[38;5;224m[46m{

}[m[76;253H[K[76;253H43,1[10C25%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[5;1H{[m[6;7H[38;5;224m[46m([7C)[m
[38;5;224m}[m[76;253H[K[76;253H42,15[9C24%[6;15H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[1m[96msqrt[m[38;5;224m([m[1m[96msum[m[38;5;224m(([mest[93m-[mpar[38;5;224m)[m[93m^[m[95m2[m[38;5;224m)[m [93m/[m [1m[96mlength[m[38;5;224m([mpar[38;5;224m))[m[6;1H[38;5;224m[46m{[m[7;7H[38;5;224m([7C)[m
[38;5;224m[46m}[m[76;253H[K[76;253H41,1[10C24%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m{[m[6;17H[38;5;224m[46m([8C)[m
[38;5;224m{

}[m[76;253H[K[76;253H40,17[9C23%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1HRMSE [93m<-[m [38;5;121mfunction[m[38;5;224m([mpar[38;5;224m,[m est[38;5;224m)[7;17H([8C)[m[76;253H[K[76;253H39,7[10C22%[6;7H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# Root mean square error[m[76;253H[K[76;253H38,0-1[8C22%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[4;1H[38;5;224m[46m{

}[m[76;253H[K[76;253H37,1[10C21%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[5;1H{

}[m[76;253H[K[76;253H36,17[9C20%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mreturn[m[38;5;224m([mnew[38;5;224m)[m[6;1H[38;5;224m[46m{

}[m[76;253H[K[76;253H35,1[10C20%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hnew[38;5;224m[[m[93m-[mcs[38;5;224m,][m [93m<-[m m[6;17H[38;5;224m[46m([8C)[m
[38;5;224m{

}[m[76;253H[K[76;253H34,17[9C19%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hnew [93m=[m [38;5;121mmatrix[m[38;5;224m([m[95mNA[m[38;5;224m,[m nrow[93m=[m[1m[96mnrow[m[38;5;224m([mm[38;5;224m),[m ncol[93m=[m[1m[96mncol[m[38;5;224m([mm[38;5;224m)[m[93m+[m[1m[96mlength[m[38;5;224m([mcs[38;5;224m))[7;17H([8C)[m[76;253H[K[76;253H33,17[9C18%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1HinsertEmptyCols [93m<-[m [38;5;121mfunction[m[38;5;224m([mm[38;5;224m,[m cs[38;5;224m){[m[76;253H[K[76;253H32,0-1[8C17%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# function that inserts NA rows at each index specified in m[m[2;35H[38;5;224m[46m{[6;1H}[m[76;253H[K[76;253H31,1[10C17%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[3;35H{[m[6;9H[38;5;224m[46m([mnew[38;5;224m[46m)[m
[38;5;224m}[m[76;253H[K[76;253H30,13[9C16%[6;13H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mreturn[m[38;5;224m([mnew[38;5;224m)[7;9H([mnew[38;5;224m)[m[76;253H[K[76;253H29,16[9C15%[6;16H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hnew[38;5;224m[[m[93m-[mrs[38;5;224m,][m [93m<-[m m[76;253H[K[76;253H28,17[9C15%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hnew [93m=[m [38;5;121mmatrix[m[38;5;224m([m[95mNA[m[38;5;224m,[m nrow[93m=[m[1m[96mnrow[m[38;5;224m([mm[38;5;224m)[m[93m+[m[1m[96mlength[m[38;5;224m([mrs[38;5;224m),[m ncol[93m=[m[1m[96mncol[m[38;5;224m([mm[38;5;224m))[m[76;253H[K[76;253H27,17[9C14%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1HinsertEmptyRows [93m<-[m [38;5;121mfunction[m[38;5;224m([mm[38;5;224m,[m rs[38;5;224m){[m[76;253H[K[76;253H26,17[9C13%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# function that inserts NA rows at each index specified in m[m[2;35H[38;5;224m[46m{[6;1H}[m[76;253H[K[76;253H25,1[10C13%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[3;35H[38;5;224m{[m[6;9H[38;5;224m[46m([mnew[38;5;224m[46m)[m
[38;5;224m}[m[76;253H[K[76;253H24,13[9C12%[6;13H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[7;9H([mnew[38;5;224m)[m[76;253H[K[76;253H23,16[9C11%[6;16H[?25h[?25l[76;243H~@k[6;16H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[1;3H[93mreturn[m[38;5;224m([mprob[38;5;224m)[m[76;253H[K[76;253H22,17[9C11%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H21,17[9C10%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hprob [93m<-[m [1m[96mt[m[38;5;224m([m[1m[96mexp[m[38;5;224m([ma [93m%*%[m [1m[96mt[m[38;5;224m([mtheta[38;5;224m)[m [93m+[md[38;5;224m)[m [93m/[m [38;5;224m([m[95m1[m [93m+[m [1m[96mexp[m[38;5;224m([ma [93m%*%[m [1m[96mt[m[38;5;224m([mtheta[38;5;224m)[m[93m+[md[38;5;224m)))[m[76;253H[K[76;253H20,17[10C9%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m{[m[76;253H[K[76;253H19,0-1[9C8%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hpredict.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)[m
[38;5;224m[46m{[6;1H}[m[76;253H[K[76;253H18,1[11C8%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# predict probabilities based on mirt parameters[m

[38;5;224m{[m[6;9H[38;5;224m[46m([mprob[38;5;224m[46m)[m
[38;5;224m}[m[76;253H[K[76;253H17,14[10C7%[6;14H[?25h[?25l[1;75r[1;1H[L[1;76r[7;9H[38;5;224m([mprob[38;5;224m)[m[76;253H[K[76;253H16,2[11C6%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;81mlibrary[m[38;5;224m([mmirt[38;5;224m)[m[76;253H[K[76;253H15,17[10C6%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;1H[96m# load adapted version of mirt library (rgmirt)[m[6;1H[38;5;224m[46m{[10;1H}[m[76;253H[K[76;253H14,1[11C5%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[7;1H[38;5;224m{[11;1H}[m[76;253H[K[76;253H13,17[10C4%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hsparsity [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m5[m[38;5;224m])[m  [96m# sparsity of the dataset [m[76;253H[K[76;253H12,17[10C4%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hiteration [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m4[m[38;5;224m])[m [96m# number of the current iteration[m[76;253H[K[76;253H11,0-1[9C3%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hndim [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m3[m[38;5;224m])[m      [96m# number of latent dimensions[m[6;8H[38;5;224m[46m([mmirt[38;5;224m[46m)[m[76;253H[K[76;253H10,13[10C2%[6;13H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hlambda2 [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m2[m[38;5;224m])[m   [96m# l2 penalty[m[7;8H[38;5;224m([mmirt[38;5;224m)[m[76;253H[K[76;253H9,17[11C2%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hlambda1 [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m1[m[38;5;224m])[m   [96m# l1 penalty [m[76;253H[K[76;253H8,0-1[10C1%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hargs [93m=[m [1m[96mcommandArgs[m[38;5;224m([mtrailingOnly[93m=[m[95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H7,17[11C0%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[1;1H[96m# read command line arguments[m[76;253H[K[76;253H6,17[10CTop[6;17H[?25h[?25l[76;253H5[5;17H[?25h[?25l[76;253H4[4;17H[?25h[?25l[76;243H~@k[4;17H[76;243H   [3;17H[76;253H3[3;17H[?25h[?25l[76;253H2[2;17H[?25h[?25l[76;253H1[1;17H[?25h[?25l[76;243H~@k[1;17H[76;243H   [1;17H[?25h[?25l[76;243H~@k[1;17H[76;243H   [1;17H[?25h[?25l[76;243H~@k[1;17H[76;243H   [1;17H[?25h[?25l[76;243H~@k[1;17H[76;243H   [1;17H[?25h[?25l[76;243H~@k[1;17H[76;243H   [1;17H[?25h[?25l[76;243H~@k[1;17H[76;243H   [1;17H[?25h[?25l[76;243H:[1;17H[76;243H[K[76;1H:[?2004h[?25hq[?25l[?25h[?25l [?25h[?25l[?25h[?25l[?2004l[76;1H[K[76;1H[?2004l[?1l>[?25h[?1049l[23;0;0t]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ vim fitscript.R cd rgmirt/EN-MIRT/scripts/[10Pvim fitscript.R [KRscript vims[K[K[K[Kfitscript.R 0 0 3 1 0
Loading required package: stats4
Loading required package: lattice
Error in file(file, "rt") : cannot open the connection
Calls: read.csv -> read.table -> file
In addition: Warning message:
In file(file, "rt") :
  cannot open file '/home/kveldkamp49/data_parameters/data/_3_1_0_.csv': No such file or directory
Execution halted
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ vim mi[K[K[K fitscript.R 
[?2004h[?1049h[22;0;0t[?1h=[?2004h[1;76r[?12h[?12l[27m[23m[29m[m[H[2J[?25l[76;1H"fitscript.R" 220L, 8056C[2;1Hâ–½[6n[2;1H  [1;1H[>c]10;?]11;?[1;1H[34m# read command line arguments[m
args [38;5;130m=[m [36mcommandArgs[m[35m([mtrailingOnly[38;5;130m=[m[31mTRUE[m[35m)[m
lambda1 [38;5;130m=[m [36mas.numeric[m[35m([margs[35m[[m[31m1[m[35m])[m   [34m# l1 penalty [m
lambda2 [38;5;130m=[m [36mas.numeric[m[35m([margs[35m[[m[31m2[m[35m])[m   [34m# l2 penalty[m
ndim [38;5;130m=[m [36mas.numeric[m[35m([margs[35m[[m[31m3[m[35m])[m      [34m# number of latent dimensions[m
iteration [38;5;130m=[m [36mas.numeric[m[35m([margs[35m[[m[31m4[m[35m])[m [34m# number of the current iteration[m
sparsity [38;5;130m=[m [36mas.numeric[m[35m([margs[35m[[m[31m5[m[35m])[m  [34m# sparsity of the dataset 

# load adapted version of mirt library (rgmirt)[m
[35mlibrary[m[35m([mmirt[35m)[m

[34m# predict probabilities based on mirt parameters[m
predict.mirt [38;5;130m<-[m [32mfunction[m[35m([ma[35m,[m d[35m,[m theta[35m)
{[m
  prob [38;5;130m<-[m [36mt[m[35m([m[36mexp[m[35m([ma [38;5;130m%*%[m [36mt[m[35m([mtheta[35m)[m [38;5;130m+[md[35m)[m [38;5;130m/[m [35m([m[31m1[m [38;5;130m+[m [36mexp[m[35m([ma [38;5;130m%*%[m [36mt[m[35m([mtheta[35m)[m[38;5;130m+[md[35m)))[m

  [38;5;130mreturn[m[35m([mprob[35m)
}[m

[34m# function that inserts NA rows at each index specified in m[m
insertEmptyRows [38;5;130m<-[m [32mfunction[m[35m([mm[35m,[m rs[35m){[m
  new [38;5;130m=[m [32mmatrix[m[35m([m[31mNA[m[35m,[m nrow[38;5;130m=[m[36mnrow[m[35m([mm[35m)[m[38;5;130m+[m[36mlength[m[35m([mrs[35m),[m ncol[38;5;130m=[m[36mncol[m[35m([mm[35m))[m
  new[35m[[m[38;5;130m-[mrs[35m,][m [38;5;130m<-[m m
  [38;5;130mreturn[m[35m([mnew[35m)
}[m
[34m# function that inserts NA rows at each index specified in m[m
insertEmptyCols [38;5;130m<-[m [32mfunction[m[35m([mm[35m,[m cs[35m){[m
  new [38;5;130m=[m [32mmatrix[m[35m([m[31mNA[m[35m,[m nrow[38;5;130m=[m[36mnrow[m[35m([mm[35m),[m ncol[38;5;130m=[m[36mncol[m[35m([mm[35m)[m[38;5;130m+[m[36mlength[m[35m([mcs[35m))[m
  new[35m[[m[38;5;130m-[mcs[35m,][m [38;5;130m<-[m m
  [38;5;130mreturn[m[35m([mnew[35m)
}[m

[34m# Root mean square error[m
RMSE [38;5;130m<-[m [32mfunction[m[35m([mpar[35m,[m est[35m)
{[m
  [36msqrt[m[35m([m[36msum[m[35m(([mest[38;5;130m-[mpar[35m)[m[38;5;130m^[m[31m2[m[35m)[m [38;5;130m/[m [36mlength[m[35m([mpar[35m))
}[m

[34m# bias [m
bias [38;5;130m<-[m [32mfunction[m[35m([mpar[35m,[m est[35m)
{[m
  [36mmean[m[35m([mest[38;5;130m-[mpar[35m)
}[m

acc_f1_at_n [38;5;130m<-[m [32mfunction[m[35m([mtrue[35m,[m pred[35m,[m n[35m)[m [35m{[m

  num_users [38;5;130m<-[m [36mdim[m[35m([mtrue[35m)[[m[31m1[m[35m][m
  num_movies [38;5;130m<-[m [36mdim[m[35m([mtrue[35m)[[m[31m2[m[35m][m

  topn_accuracies [38;5;130m<-[m [32mvector[m[35m([m[31m"numeric"[m[35m,[m num_users[35m)[m
  topn_f1_scores [38;5;130m<-[m [32mvector[m[35m([m[31m"numeric"[m[35m,[m num_users[35m)[m

  [38;5;130mfor[m [35m([mi [38;5;130min[m [31m1[m[35m:[mnum_users[35m)[m [35m{[m
    true_relevance [38;5;130m<-[m true[35m[[mi[35m,[m [35m][m
    pred_relevance [38;5;130m<-[m pred[35m[[mi[35m,[m [35m][m[57;5H[34m# Get the indices of the top-n predicted relevance[m
    topn_indices [38;5;130m<-[m [36morder[m[35m([m[38;5;130m-[mpred_relevance[35m)[[m[31m1[m[35m:[mn[35m][m[60;5H[34m# Calculate the top-n accuracy for the current user[m
    topn_accuracy [38;5;130m<-[m [36msum[m[35m([mtrue_relevance[35m[[mtopn_indices[35m])[m [38;5;130m/[m n[63;5H[34m# Calculate the top-n F1 score for the current user[m
    true_positives [38;5;130m<-[m [36msum[m[35m([mtrue_relevance[35m[[mtopn_indices[35m])[m
    predicted_positives [38;5;130m<-[m [36msum[m[35m([mpred_relevance[35m[[mtopn_indices[35m])[m
    actual_positives [38;5;130m<-[m [36msum[m[35m([mtrue_relevance[35m[[mtopn_indices[35m])[m[68;5Hprecision [38;5;130m<-[m true_positives [38;5;130m/[m predicted_positives
    recall [38;5;130m<-[m true_positives [38;5;130m/[m actual_positives[71;5Hf1_score [38;5;130m<-[m [31m2[m [38;5;130m*[m precision [38;5;130m*[m recall [38;5;130m/[m [35m([mprecision [38;5;130m+[m recall[35m)[m[73;5Htopn_accuracies[35m[[mi[35m][m [38;5;130m<-[m topn_accuracy
    topn_f1_scores[35m[[mi[35m][m [38;5;130m<-[m f1_score
  [35m}[m[76;253H1,17[10CTop[1;17H[?25h[27m[23m[29m[m[H[2J[?25l[1;1H[96m# read command line arguments[m
args [93m=[m [1m[96mcommandArgs[m[38;5;224m([mtrailingOnly[93m=[m[95mTRUE[m[38;5;224m)[m
lambda1 [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m1[m[38;5;224m])[m   [96m# l1 penalty [m
lambda2 [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m2[m[38;5;224m])[m   [96m# l2 penalty[m
ndim [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m3[m[38;5;224m])[m      [96m# number of latent dimensions[m
iteration [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m4[m[38;5;224m])[m [96m# number of the current iteration[m
sparsity [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m5[m[38;5;224m])[m  [96m# sparsity of the dataset 

# load adapted version of mirt library (rgmirt)[m
[38;5;81mlibrary[m[38;5;224m([mmirt[38;5;224m)[m

[96m# predict probabilities based on mirt parameters[m
predict.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)
{[m
  prob [93m<-[m [1m[96mt[m[38;5;224m([m[1m[96mexp[m[38;5;224m([ma [93m%*%[m [1m[96mt[m[38;5;224m([mtheta[38;5;224m)[m [93m+[md[38;5;224m)[m [93m/[m [38;5;224m([m[95m1[m [93m+[m [1m[96mexp[m[38;5;224m([ma [93m%*%[m [1m[96mt[m[38;5;224m([mtheta[38;5;224m)[m[93m+[md[38;5;224m)))[m

  [93mreturn[m[38;5;224m([mprob[38;5;224m)
}[m

[96m# function that inserts NA rows at each index specified in m[m
insertEmptyRows [93m<-[m [38;5;121mfunction[m[38;5;224m([mm[38;5;224m,[m rs[38;5;224m){[m
  new [93m=[m [38;5;121mmatrix[m[38;5;224m([m[95mNA[m[38;5;224m,[m nrow[93m=[m[1m[96mnrow[m[38;5;224m([mm[38;5;224m)[m[93m+[m[1m[96mlength[m[38;5;224m([mrs[38;5;224m),[m ncol[93m=[m[1m[96mncol[m[38;5;224m([mm[38;5;224m))[m
  new[38;5;224m[[m[93m-[mrs[38;5;224m,][m [93m<-[m m
  [93mreturn[m[38;5;224m([mnew[38;5;224m)
}[m
[96m# function that inserts NA rows at each index specified in m[m
insertEmptyCols [93m<-[m [38;5;121mfunction[m[38;5;224m([mm[38;5;224m,[m cs[38;5;224m){[m
  new [93m=[m [38;5;121mmatrix[m[38;5;224m([m[95mNA[m[38;5;224m,[m nrow[93m=[m[1m[96mnrow[m[38;5;224m([mm[38;5;224m),[m ncol[93m=[m[1m[96mncol[m[38;5;224m([mm[38;5;224m)[m[93m+[m[1m[96mlength[m[38;5;224m([mcs[38;5;224m))[m
  new[38;5;224m[[m[93m-[mcs[38;5;224m,][m [93m<-[m m
  [93mreturn[m[38;5;224m([mnew[38;5;224m)
}[m

[96m# Root mean square error[m
RMSE [93m<-[m [38;5;121mfunction[m[38;5;224m([mpar[38;5;224m,[m est[38;5;224m)
{[m
  [1m[96msqrt[m[38;5;224m([m[1m[96msum[m[38;5;224m(([mest[93m-[mpar[38;5;224m)[m[93m^[m[95m2[m[38;5;224m)[m [93m/[m [1m[96mlength[m[38;5;224m([mpar[38;5;224m))
}[m

[96m# bias [m
bias [93m<-[m [38;5;121mfunction[m[38;5;224m([mpar[38;5;224m,[m est[38;5;224m)
{[m
  [1m[96mmean[m[38;5;224m([mest[93m-[mpar[38;5;224m)
}[m

acc_f1_at_n [93m<-[m [38;5;121mfunction[m[38;5;224m([mtrue[38;5;224m,[m pred[38;5;224m,[m n[38;5;224m)[m [38;5;224m{[m

  num_users [93m<-[m [1m[96mdim[m[38;5;224m([mtrue[38;5;224m)[[m[95m1[m[38;5;224m][m
  num_movies [93m<-[m [1m[96mdim[m[38;5;224m([mtrue[38;5;224m)[[m[95m2[m[38;5;224m][m

  topn_accuracies [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m
  topn_f1_scores [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m

  [93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mnum_users[38;5;224m)[m [38;5;224m{[m
    true_relevance [93m<-[m true[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m
    pred_relevance [93m<-[m pred[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m[57;5H[96m# Get the indices of the top-n predicted relevance[m
    topn_indices [93m<-[m [1m[96morder[m[38;5;224m([m[93m-[mpred_relevance[38;5;224m)[[m[95m1[m[38;5;224m:[mn[38;5;224m][m[60;5H[96m# Calculate the top-n accuracy for the current user[m
    topn_accuracy [93m<-[m [1m[96msum[m[38;5;224m([mtrue_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m [93m/[m n[63;5H[96m# Calculate the top-n F1 score for the current user[m
    true_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m
    predicted_positives [93m<-[m [1m[96msum[m[38;5;224m([mpred_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m
    actual_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m[68;5Hprecision [93m<-[m true_positives [93m/[m predicted_positives
    recall [93m<-[m true_positives [93m/[m actual_positives[71;5Hf1_score [93m<-[m [95m2[m [93m*[m precision [93m*[m recall [93m/[m [38;5;224m([mprecision [93m+[m recall[38;5;224m)[m[73;5Htopn_accuracies[38;5;224m[[mi[38;5;224m][m [93m<-[m topn_accuracy
    topn_f1_scores[38;5;224m[[mi[38;5;224m][m [93m<-[m f1_score
  [38;5;224m}[m[76;253H1,17[10CTop"fitscript.R" 220L, 8056C[1;17H[?25h[?25l[76;243H~@k[1;17H[76;243H   [2;17H[76;253H2[2;17H[?25h[?25l[76;243H~@k[2;17H[76;243H   [3;17H[76;253H3[3;17H[?25h[?25l[76;243H~@k[3;17H[76;243H   [4;17H[76;253H4[4;17H[?25h[?25l[76;253H5[5;17H[?25h[?25l[76;243H~@k[5;17H[76;243H   [6;17H[76;253H6[6;17H[?25h[?25l[76;253H7[7;17H[?25h[?25l[76;243H~@k[7;17H[76;243H   [8;1H[76;253H8,0-1[8;1H[?25h[?25l[76;253H9,17 [9;17H[?25h[?25l[10;8H[38;5;224m[46m([mmirt[38;5;224m[46m)[m[76;253H10,13[10;13H[?25h[?25l[76;243H~@k[10;13H[76;243H   [11;1H[10;8H[38;5;224m([mmirt[38;5;224m)[m[76;254H1,0-1[11;1H[?25h[?25l[76;254H2,17 [12;17H[?25h[?25l[76;254H3[13;17H[?25h[?25l
[38;5;224m[46m{[18;1H}[m[76;254H4,1 [14;1H[?25h[?25l[76;243H~@k[14;1H[76;243H   [15;17H[14;1H[38;5;224m{[18;1H}[m[76;254H5,17[15;17H[?25h[?25l[76;254H6,2 [16;2H[?25h[?25l[17;9H[38;5;224m[46m([mprob[38;5;224m[46m)[m[76;254H7,14[17;14H[?25h[?25l[14;1H[38;5;224m[46m{[m[17;9H[38;5;224m([mprob[38;5;224m)[m
[38;5;224m[46m}[m[76;254H8,1 [18;1H[?25h[?25l[14;1H[38;5;224m{[18;1H}[m[76;254H9,0-1[19;1H[?25h[?25l[76;243H~@k[19;1H[76;243H   [20;17H[76;253H20,17 [20;17H[?25h[?25l[76;243H~@k[20;17H[76;243H   [19;1H[76;253H19,0-1[19;1H[?25h[?25l[76;253H20,17 [20;17H[?25h[?25l[76;254H1[21;17H[?25h[?25l[76;243H~@k[21;17H[76;243H   [22;17H[76;254H2[22;17H[?25h[?25l[76;243H~@k[22;17H[76;243H   [23;16H[76;254H3,16[23;16H[?25h[?25l[76;243H~@k[23;16H[76;243H   [24;13H[38;5;224m[46m([mnew[38;5;224m[46m)[m[76;254H4,13[24;13H[?25h[?25l[21;35H[38;5;224m[46m{[m[24;9H[38;5;224m([mnew[38;5;224m)[m
[38;5;224m[46m}[m[76;254H5,1 [25;1H[?25h[?25l[21;35H[38;5;224m{[25;1H}[m[76;254H6,17[26;17H[?25h[?25l[76;254H7[27;17H[?25h[?25l[76;243H~@k[27;17H[76;243H   [28;17H[76;254H8[28;17H[?25h[?25l[76;254H9,16[29;16H[?25h[?25l[30;9H[38;5;224m[46m([mnew[38;5;224m[46m)[m[76;253H30,13[30;13H[?25h[?25l[27;35H[38;5;224m[46m{[m[30;9H[38;5;224m([mnew[38;5;224m)[m
[38;5;224m[46m}[m[76;254H1,1 [31;1H[?25h[?25l[27;35H[38;5;224m{[31;1H}[m[76;254H2,0-1[32;1H[?25h[?25l[76;254H3,17 [33;17H[?25h[?25l[34;17H[38;5;224m[46m([8C)[m[76;254H4[34;17H[?25h[?25l[76;243H~@k[34;17H[76;243H   [35;1H[34;17H[38;5;224m([8C)[m
[38;5;224m[46m{

}[m[76;254H5,1 [35;1H[?25h[?25l[38;5;224m{

}[m[76;254H6,17[36;17H[?25h[?25l[35;1H[38;5;224m[46m{

}[m[76;254H7,1 [37;1H[?25h[?25l[35;1H[38;5;224m{

}[m[76;254H8,0-1[38;1H[?25h[?25l[76;254H9,7  [39;7H[?25h[?25l[40;17H[38;5;224m[46m([8C)[m[76;253H40,17[40;17H[?25h[?25l[38;5;224m([8C)[m
[38;5;224m[46m{

}[m[76;254H1,1 [41;1H[?25h[?25l[76;243H~@k[41;1H[76;243H   [42;15H[41;1H[38;5;224m{[m[42;7H[38;5;224m[46m([7C)[m
[38;5;224m}[m[76;254H2,15[42;15H[?25h[?25l[41;1H[38;5;224m[46m{[m[42;7H[38;5;224m([7C)[m
[38;5;224m[46m}[m[76;254H3,1 [43;1H[?25h[?25l[41;1H[38;5;224m{

}[m[76;254H4,0-1[44;1H[?25h[?25l[76;243H~@k[44;1H[76;243H   [45;17H[76;254H5,17 [45;17H[?25h[?25l[76;254H6,0-1[46;1H[?25h[?25l[76;254H7,17 [47;17H[?25h[?25l[76;254H8[48;17H[?25h[?25l[76;243H~@k[48;17H[76;243H   [49;2H[76;254H9,2 [49;2H[?25h[?25l[76;253H50,17[50;17H[?25h[?25l[76;254H1[51;17H[?25h[?25l[76;254H2,2 [52;2H[?25h[?25l[76;243H~@k[52;2H[76;243H   [53;17H[76;254H3,17[53;17H[?25h[?25l[76;254H4[54;17H[?25h[?25l[76;254H5[55;17H[?25h[?25l[76;254H6,4 [56;4H[?25h[?25l[76;243H~@k[56;4H[76;243H   [57;17H[76;254H7,17[57;17H[?25h[?25l[76;243H~@k[57;17H[76;243H   [58;17H[76;254H8[58;17H[?25h[?25l[76;254H9,4 [59;4H[?25h[?25l[76;253H60,17[60;17H[?25h[?25l[76;254H1[61;17H[?25h[?25l[76;254H2,4 [62;4H[?25h[?25l[76;254H3,17[63;17H[?25h[?25l[76;254H4[64;17H[?25h[?25l[76;243H~@k[64;17H[76;243H   [65;17H[76;254H5[65;17H[?25h[?25l[76;254H6[66;17H[?25h[?25l[76;243H~@k[66;17H[76;243H   [67;4H[76;254H7,4 [67;4H[?25h[?25l[76;254H8,17[68;17H[?25h[?25l[76;254H9[69;17H[?25h[?25l[76;253H70,4 [70;4H[?25h[?25l[1;75r[75;1H
[1;76r[76;1H[K[76;253H71,17[10C0%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;3H[96m# Calculate the average top-n accuracy and top-n F1 score across all users[m[76;253H[K[76;253H72,4[11C1%[70;4H[?25h[?25l[76;243H~@k[70;4H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;3Havg_topn_accuracy [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_accuracies[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H73,17[10C2%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;3Havg_topn_f1_score [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_f1_scores[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H74,17[10C2%[70;17H[?25h[?25l[76;254H3[69;17H[?25h[?25l[76;254H2,4 [68;4H[?25h[?25l[76;254H1,17[67;17H[?25h[?25l[76;243H~@k[67;17H[76;243H   [66;4H[76;254H0,4 [66;4H[?25h[?25l[76;254H1,17[67;17H[?25h[?25l[76;254H2,4 [68;4H[?25h[?25l[76;254H3,17[69;17H[?25h[?25l[76;243H~@k[69;17H[76;243H   [70;17H[76;254H4[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[48;26H[38;5;224m[46m{[70;3H}[m[76;253H[K[76;253H75,3[11C3%[70;3H[?25h[?25l[1;75r[75;1H
[1;76r[47;26H[38;5;224m{[69;3H}[m[75;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([mavg_topn_accuracy[38;5;224m,[m avg_topn_f1_score[38;5;224m))[m[76;253H[K[76;253H76,2[11C4%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m[76;253H[K[76;253H77,17[10C4%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[76;253H[K[76;253H78,17[10C5%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H79,17[10C6%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# Function that fits rgmirt model using cross validation and returns the average RMSE and average bias[m[76;253H[K[76;253H80,2[11C6%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;1Hcv.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([mdata[38;5;224m,[m[10C[96m# matrix of responses[m[76;253H[K[76;253H81,17[10C7%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[33;40H[38;5;224m[46m{[70;1H}[m[75;21Hmodel[38;5;224m,[m[9C[96m# model to be passed to mirt, can be number of dimensions[m[76;253H[K[76;253H82,1[11C8%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[32;40H[38;5;224m{[69;1H}[m[75;21Hmethod[38;5;224m,[m[8C[96m# method of esitmation, e.g. EM[m[76;253H[K[76;253H83,0-1[9C8%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;21Hrandompars[38;5;224m,[m    [96m# mirt argument for whether to use random paramters values[m[76;253H[K[76;253H84,0-1[9C9%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;21Hk [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m    [96m# number of folds for 2d cross validation[m[76;253H[K[76;253H85,17[9C10%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;21Hlambda[38;5;224m,[m[8C[96m# l1 and l2 penalty[m[76;253H[K[76;253H86,17[9C11%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;21Ha_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H87,17[9C11%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;21Hd_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H88,17[9C12%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;21Htheta_true[38;5;224m,[m    [96m# true parameter values[m[76;253H[K[76;253H89,17[9C13%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;21Hpars[38;5;224m)[m[10C[96m# parameters object from mirt[m[76;253H[K[76;253H90,17[9C13%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[38;5;224m{[m[76;253H[K[76;253H91,17[9C14%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H92,17[9C15%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;3H[96m# calculate to which fold each person and item belongs[m[76;253H[K[76;253H93,17[9C15%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hfolds.persons [93m<-[m  [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mnrow[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m1[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[76;253H[K[76;253H94,17[9C16%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;3Hfolds.items [93m<-[m [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mncol[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m2[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[76;253H[K[76;253H95,17[9C17%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;1H[1;75r[75;1H
[1;76r[76;253H[K[76;253H96,1[10C17%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;3Hrmses [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H97,2[10C18%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hbiases [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H98,17[9C19%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Haccuracies [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H99,17[9C20%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hf1s [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H100,17[8C20%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;1H[1;75r[75;1H
[1;76r[76;253H[K[76;253H101,0-1[7C21%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[70;12H[38;5;224m[46m()[m[75;3H[96m# loop though cross validation folds[m[76;253H[K[76;253H102,13[8C22%[70;13H[?25h[?25l[1;75r[75;1H
[1;76r[69;12H[38;5;224m()[m[70;13H[38;5;224m[46m()[m[75;3H[93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H103,14[8C22%[70;14H[?25h[?25l[1;75r[75;1H
[1;76r[69;13H[38;5;224m()[m[70;17H[38;5;224m[46m()[m[75;3H[38;5;224m{[m[76;253H[K[76;253H104,17[8C23%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[69;17H[38;5;224m()[m[70;10H[38;5;224m[46m()[m[75;5H[93mfor[m [38;5;224m([mj [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H105,11[8C24%[70;11H[?25h[?25l[76;243H~@k[70;11H[76;243H   [70;2H[1;75r[75;1H
[1;76r[69;10H[38;5;224m()[75;5H{[m[76;253H[K[76;253H106,2[9C24%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# save the persons and items that belong to the hold out test set[m[76;253H[K[76;253H107,17[8C25%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hper.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.persons[93m==[mi[38;5;224m)[m[76;253H[K[76;253H108,17[8C26%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hitem.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.items[93m==[mj[38;5;224m)[m[76;253H[K[76;253H109,3[9C26%[70;3H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H110,17[8C27%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;5H[1;75r[75;1H
[1;76r[75;7H[96m# create train and test folds[m[76;253H[K[76;253H111,5[9C28%[70;5H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htest [93m<-[m data[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m][m[76;253H[K[76;253H112,17[8C28%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htrain [93m<-[m data[76;253H[K[76;253H113,17[8C29%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htrain[38;5;224m[[mper.ind[38;5;224m,[mitem.ind[38;5;224m][m [93m<-[m [95mNA[m[76;253H[K[76;253H114,17[8C30%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H115,6[9C31%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# [m[30m[103mif[m[96m some rows contain no responses after the leave out set, remove them from the training set, and adjust person indices accordingly[m[76;253H[K[76;253H116,17[8C31%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;7Hemptyrows [93m=[m [1m[96mrowSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mncol[m[38;5;224m([mtrain[38;5;224m)[m[76;253H[K[76;253H117,17[8C32%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hemptycols [93m=[m [1m[96mcolSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mnrow[m[38;5;224m([mtrain[38;5;224m)[m[76;253H[K[76;253H118,17[8C33%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H119,17[8C33%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Htrain [93m=[m train[38;5;224m[[m[93m![memptyrows[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H120,6[9C34%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Hper.ind [93m=[m per.ind[38;5;224m[[m[93m![mper.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m)][m[76;253H[K[76;253H121,17[8C35%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H122,17[8C35%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# do the same for columns[m[76;253H[K[76;253H123,17[8C36%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H124,17[8C37%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;9Htrain [93m=[m train[38;5;224m[,[m[93m![memptycols[38;5;224m][m[76;253H[K[76;253H125,17[8C37%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;9Hitem.ind [93m=[m item.ind[38;5;224m[[m[93m![mitem.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m)][m[76;253H[K[76;253H126,17[8C38%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[67;27H[38;5;224m[46m{[70;7H}[m[75;7H[38;5;224m}[m[76;253H[K[76;253H127,7[9C39%[70;7H[?25h[?25l[1;75r[75;1H
[1;76r[66;27H[38;5;224m{[69;7H}[m[76;253H[K[76;253H128,17[8C40%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;7H[96m# fit model[m[76;253H[K[76;253H129,17[8C40%[70;17H[?25h[?25l[76;255H8[69;17H[?25h[?25l[65;27H[38;5;224m[46m{[68;7H}[m[76;255H7,7 [68;7H[?25h[?25l[76;243H~@k[68;7H[76;243H   [67;17H[65;27H[38;5;224m{[68;7H}[m[76;255H6,17[67;17H[?25h[?25l[65;27H[38;5;224m[46m{[68;7H}[m[76;255H7,7 [68;7H[?25h[?25l[65;27H[38;5;224m{[68;7H}[m[76;255H8,17[69;17H[?25h[?25l[76;255H9[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;7Hfit [93m<-[m [1m[96mmirt[m[38;5;224m([mtrain[38;5;224m,[m model[38;5;224m,[m [95m'2PL'[m[38;5;224m,[m method[93m=[mmethod[38;5;224m,[m GenRandomPars[93m=[mrandompars[38;5;224m,[m lambda[93m=[mlambda[38;5;224m,[m pars[93m=[mpars[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m([mNCYCLES[93m=[m[95m10[m[38;5;224m))[m[76;253H[K[76;253H130,17[8C41%[70;17H[?25h[?25l[76;254H29[69;17H[?25h[?25l[76;255H8[68;17H[?25h[?25l[64;27H[38;5;224m[46m{[67;7H}[m[76;255H7,7 [67;7H[?25h[?25l[76;243H~@k[67;7H[76;243H   [66;17H[64;27H[38;5;224m{[67;7H}[m[76;255H6,17[66;17H[?25h[?25l[64;27H[38;5;224m[46m{[67;7H}[m[76;255H7,7 [67;7H[?25h[?25l[64;27H[38;5;224m{[67;7H}[m[76;255H8,17[68;17H[?25h[?25l[76;255H9[69;17H[?25h[?25l[76;243H~@k[69;17H[76;243H   [70;17H[76;254H30[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# save parameters[m[76;253H[K[76;253H131,17[8C42%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[67;27H[38;5;224m[46m{[70;7H}[m[75;7Hitempars [93m<-[m [1m[96mcoef[m[38;5;224m([mfit[38;5;224m,[m simplify [93m=[m [95mTRUE[m[38;5;224m)$[mitems[76;253H[K[76;253H132,7[9C42%[70;7H[?25h[?25l[1;75r[75;1H
[1;76r[66;27H[38;5;224m{[69;7H}[m[75;7Ha [93m<-[m itempars[38;5;224m[,[m[95m1[m[38;5;224m:([m[1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m3[m[38;5;224m)][m[76;253H[K[76;253H133,6[9C43%[70;6H[?25h[?25l[76;243H~@k[70;6H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;7Hd [93m<-[m itempars[38;5;224m[,[m [1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m2[m[38;5;224m][m[76;253H[K[76;253H134,17[8C44%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htheta [93m<-[m [1m[96mfscores[m[38;5;224m([mfit[38;5;224m)[m[76;253H[K[76;253H135,17[8C44%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H136,17[8C45%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# calculate true and predicted probablities[m[76;253H[K[76;253H137,17[8C46%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hp.pred [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)[m[76;253H[K[76;253H138,17[8C46%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hp.true [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma_true[38;5;224m,[m [1m[96mas.vector[m[38;5;224m([md_true[38;5;224m),[m theta_true[38;5;224m)[m[76;253H[K[76;253H139,17[8C47%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[76;253H[K[76;253H140,17[8C48%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# [m[30m[103mif[m[96m there are rows without responses, they have no theta estimates, so we have to fill in some empty rows to make the dimensions correct[m[76;253H[K[76;253H141,6[9C48%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H142,17[8C49%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Hp.pred [93m=[m [1m[96minsertEmptyRows[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m))[m[76;253H[K[76;253H143,17[8C50%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H144,17[8C51%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H145,6[9C51%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Hp.pred [93m=[m [1m[96minsertEmptyCols[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m))[m[76;253H[K[76;253H146,17[8C52%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H147,17[8C53%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# calculate true and predicted responses[m[76;253H[K[76;253H148,17[8C53%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[68;27H[38;5;224m[46m{[70;7H}[m[75;7Hresp.pred [93m=[m [1m[96mround[m[38;5;224m([mp.pred[38;5;224m,[m [95m0[m[38;5;224m)[m[76;253H[K[76;253H149,7[9C54%[70;7H[?25h[?25l[1;75r[75;1H
[1;76r[67;27H[38;5;224m{[69;7H}[m[75;7Hresp.true [93m=[m [1m[96mround[m[38;5;224m([mp.true[38;5;224m,[m [95m0[m[38;5;224m)[m[76;253H[K[76;253H150,17[8C55%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H151,17[8C55%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[68;27H[38;5;224m[46m{[70;7H}[m[75;7H[96m# calculate metrics and save them[m[76;253H[K[76;253H152,7[9C56%[70;7H[?25h[?25l[1;75r[75;1H
[1;76r[67;27H[38;5;224m{[69;7H}[m[75;7Hrmses [93m<-[m [1m[96mc[m[38;5;224m([mrmses[38;5;224m,[m [1m[96mRMSE[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[76;253H[K[76;253H153,17[8C57%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;7Hbiases [93m<-[m [1m[96mc[m[38;5;224m([mbiases[38;5;224m,[m [1m[96mbias[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[76;253H[K[76;253H154,17[8C57%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htop10 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mtrue[93m=[mresp.true[38;5;224m,[m pred[93m=[mresp.predm[38;5;224m,[m n[93m=[m[95m10[m[38;5;224m)[m[76;253H[K[76;253H155,17[8C58%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htop20 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mtrue[93m=[mresp.true[38;5;224m,[m pred[93m=[mresp.predm[38;5;224m,[m n[93m=[m[95m20[m[38;5;224m)[m[76;253H[K[76;253H156,6[9C59%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hacc10 [93m<-[m [1m[96mc[m[38;5;224m([macc10[38;5;224m,[m top10[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H157,17[8C60%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[70;17H[38;5;224m[46m([73C)[m[75;7Hf110 [93m<-[m [1m[96mc[m[38;5;224m([mf110[38;5;224m,[m top10[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H158,17[8C60%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[69;17H[38;5;224m([73C)[m[75;7Hacc20 [93m<-[m [1m[96mc[m[38;5;224m([macc20[38;5;224m,[m top20[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H159,17[8C61%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hf120 [93m<-[m [1m[96mc[m[38;5;224m([mf120[38;5;224m,[m top20[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H160,17[8C62%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[76;253H[K[76;253H161,17[8C62%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[70;17H[38;5;224m[46m([15C)[m[75;5H[38;5;224m}[m[76;253H[K[76;253H162,17[8C63%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[69;17H[38;5;224m([15C)[75;3H}[m[76;253H[K[76;253H163,17[8C64%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[70;17H[38;5;224m[46m([15C)[m[75;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([m[1m[96mmean[m[38;5;224m([mrmses[38;5;224m),[m [1m[96mmean[m[38;5;224m([mbiases[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc10[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc20[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf110[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf120[38;5;224m)))[m[76;253H[K[76;253H164,17[8C64%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[69;17H[38;5;224m([15C)[75;1H}[m[76;253H[K[76;253H165,17[8C65%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H166,6[9C66%[70;6H[?25h[?25l[76;243H~@k[70;6H[76;243H   [70;5H[1;75r[75;1H
[1;76r[14;5H[38;5;224m[46m{[70;5H}[m[75;1H[96m# read appropriate data file[m[76;253H[K[76;253H167,5[9C66%[70;5H[?25h[?25l[1;75r[75;1H
[1;76r[11;3H[38;5;224m[46m{[m[13;5H[38;5;224m{[69;5H}[m
  [38;5;224m[46m}[m[75;1Hdata1 [93m=[m [1m[96mread.csv[m[38;5;224m([m[1m[96mpaste[m[38;5;224m([m[95m'~/data_parameters/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[76;253H[K[76;253H168,3[9C67%[70;3H[?25h[?25l[1;75r[75;1H
[1;76r[10;3H[38;5;224m{[69;3H}[m[76;253H[K[76;253H169,17[8C68%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# load true parameter values[m[76;253H[K[76;253H170,1[9C68%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[1m[96mload[m[38;5;224m([mfile[93m=[m[1m[96mpaste[m[38;5;224m([m[95m'~/data_parameters/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m))[m[76;253H[K[76;253H171,0-1[7C69%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H172,17[8C70%[70;17H[?25h[?25l[76;255H1,0-1[69;1H[?25h[?25l[76;255H0,1  [68;1H[?25h[?25l[76;254H69,17[67;17H[?25h[?25l[76;243H~@k[67;17H[76;243H   [66;3H[7;3H[38;5;224m[46m{[66;3H}[m[76;255H8,3 [66;3H[?25h[?25l[7;3H[38;5;224m{[66;3H}[m[76;255H9,17[67;17H[?25h[?25l[76;254H70,1 [68;1H[?25h[?25l[76;255H1,0-1[69;1H[?25h[?25l[76;243H~@k[69;1H[76;243H   [70;17H[76;255H2,17 [70;17H[?25h[?25l[1;75r[75;1H
[1;76r[70;17H[38;5;224m[46m([89C)[m[75;1H[96m# initialize paramters[m[76;253H[K[76;253H173,17[8C71%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;1H[1;75r[75;1H
[1;76r[69;17H[38;5;224m([89C)[m[75;1H[1m[96mprint[m[38;5;224m([m[95m'initializing pars...'[m[38;5;224m)[m[76;253H[K[76;253H174,0-1[7C71%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1Hpars [93m<-[m [1m[96mmirt[m[38;5;224m([mdata1[38;5;224m,[mndim[38;5;224m,[m pars [93m=[m [95m'values'[m[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m())[m[76;253H[K[76;253H175,17[8C72%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H176,17[8C73%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# set some loadings to zero[m[76;253H[K[76;253H177,6[9C73%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[30m[103mif[m[38;5;224m([mndim[93m==[m[95m1[m[38;5;224m){[m[76;253H[K[76;253H178,17[8C74%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H179,17[8C75%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H180,17[8C75%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m [93melse[m [30m[103mif[m [38;5;224m([mndim[93m==[m[95m2[m[38;5;224m){[m[76;253H[K[76;253H181,0-1[7C76%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m5[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H182,17[8C77%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[70;12H[38;5;224m[46m{


}[m

  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m5[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H183,12[8C77%[70;12H[?25h[?25l[1;75r[75;1H
[1;76r[69;12H[38;5;224m{


}[m[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m6[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H184,17[8C78%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m6[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H185,17[8C79%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m[93melse[m [30m[103mif[m [38;5;224m([mndim[93m==[m[95m3[m[38;5;224m){[m[76;253H[K[76;253H186,17[8C80%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H187,17[8C80%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H188,17[8C81%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m11[m[38;5;224m:[m[95m20[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H189,17[8C82%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m11[m[38;5;224m:[m[95m20[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H190,17[8C82%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a3'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m21[m[38;5;224m:[m[95m30[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H191,17[8C83%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a3'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m21[m[38;5;224m:[m[95m30[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H192,17[8C84%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m[76;253H[K[76;253H193,17[8C84%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[76;253H[K[76;253H194,17[8C85%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [69;17H[76;255H3[69;17H[?25h[?25l[76;243H~@k[69;17H[76;243H   [68;17H[76;255H2[68;17H[?25h[?25l[76;243H~@k[68;17H[76;243H   [67;17H[76;255H1[67;17H[?25h[?25l[76;243H~@k[67;17H[76;243H   [66;17H[76;255H0[66;17H[?25h[?25l[76;243H~@k[66;17H[76;243H   [65;17H[76;254H89[65;17H[?25h[?25l[76;243H~@k[65;17H[76;243H   [64;17H[76;255H8[64;17H[?25h[?25l[76;243H~@k[64;17H[76;243H   [63;17H[76;255H7[63;17H[?25h[?25l[76;243H~@k[63;17H[76;243H   [62;17H[76;255H6[62;17H[?25h[?25l[76;243H~@k[62;17H[76;243H   [61;17H[76;255H5[61;17H[?25h[?25l[76;243H~@k[61;17H[76;243H   [60;17H[76;255H4[60;17H[?25h[?25l[76;243H~@k[60;17H[76;243H   [59;12H[38;5;224m[46m{


}[m[76;255H3,12[59;12H[?25h[?25l[76;243H~@k[59;12H[76;243H   [58;17H[59;12H[38;5;224m{


}[m[76;255H2,17[58;17H[?25h[?25l[76;243H~@k[58;17H[76;243H   [57;1H[76;255H1,0-1[57;1H[?25h[?25l[76;243H~@k[57;1H[76;243H   [56;17H[76;255H0,17 [56;17H[?25h[?25l[76;243H~@k[56;17H[76;243H   [55;17H[76;254H79[55;17H[?25h[?25l[76;243H~@k[55;17H[76;243H   [54;17H[76;255H8[54;17H[?25h[?25l[76;243H~@k[54;17H[76;243H   [53;6H[76;255H7,6 [53;6H[?25h[?25l[76;243H~@k[53;6H[76;243H   [52;17H[76;255H6,17[52;17H[?25h[?25l[76;243H~@k[52;17H[76;243H   [51;17H[76;255H5[51;17H[?25h[?25l[76;243H~@k[51;17H[76;243H   [50;1H[76;255H4,0-1[50;1H[?25h[?25l[76;243H~@k[50;1H[76;243H   [49;17H[38;5;224m[46m([89C)[m[76;255H3,17 [49;17H[?25h[?25l[76;243H~@k[49;17H[76;243H   [49;18H[38;5;224m([89C)[m[76;258H8[49;18H[?25h[?25l[76;243H~@k[49;18H[76;243H   [49;19H[76;258H9[49;19H[?25h[?25l[76;243H~@k[49;19H[76;243H   [49;20H[76;257H20[49;20H[?25h[?25l[76;243H~@k[49;20H[76;243H   [49;21H[76;258H1[49;21H[?25h[?25l[76;243H~@k[49;21H[76;243H   [49;22H[76;258H2[49;22H[?25h[?25l[76;243H~@k[49;22H[76;243H   [49;23H[38;5;224m[46m([69C)[m[76;258H3[49;23H[?25h[?25l[76;243H~@k[49;23H[76;243H   [49;24H[38;5;224m([69C)[m[76;258H4[49;24H[?25h[?25l[76;243H~@k[49;24H[76;243H   [49;25H[76;258H5[49;25H[?25h[?25l[76;243H~@k[49;25H[76;243H   [49;26H[76;258H6[49;26H[?25h[?25l[76;243H~@k[49;26H[76;243H   [49;27H[76;258H7[49;27H[?25h[?25l[76;243H~@k[49;27H[76;243H   [49;28H[76;258H8[49;28H[?25h[?25l[76;243H~@k[49;28H[76;243H   [49;29H[76;258H9[49;29H[?25h[?25l[76;243H~@k[49;29H[76;243H   [49;30H[76;257H30[49;30H[?25h[?25l[76;243H~@k[49;30H[76;243H   [49;31H[76;258H1[49;31H[?25h[?25l[76;243H~@k[49;31H[76;243H   [49;32H[76;258H2[49;32H[?25h[?25l[76;243H~@k[49;32H[76;243H   [49;33H[76;258H3[49;33H[?25h[?25l[76;243H~@k[49;33H[76;243H   [49;34H[76;258H4[49;34H[?25h[?25l[76;243H~@k[49;34H[76;243H   [49;35H[76;258H5[49;35H[?25h[?25l[76;243H~@k[49;35H[76;243H   [49;36H[76;258H6[49;36H[?25h[?25l[76;243H~@k[49;36H[76;243H   [49;37H[76;258H7[49;37H[?25h[?25l[76;243H~@k[49;37H[76;243H   [49;38H[76;258H8[49;38H[?25h[?25l[76;243H~@k[49;38H[76;243H   [49;39H[76;258H9[49;39H[?25h[?25l[76;243H~@k[49;39H[76;243H   [49;40H[76;257H40[49;40H[?25h[?25l[76;243H~@k[49;40H[76;243H   [49;41H[76;258H1[49;41H[?25h[?25l[76;243H~@k[49;41H[76;243H   [49;42H[76;258H2[49;42H[?25h[?25l[76;243H~@k[49;42H[76;243H   [49;41H[76;258H1[49;41H[?25h[?25l[76;243H~@k[49;41H[76;243H   [49;40H[76;258H0[49;40H[?25h[?25l[76;243Hi[49;40H[76;243H [49;40H[76;1H[1m-- INSERT --[m[76;253H[K[76;253H173,40[8C85%[49;40H[?25h[?25l[76;258H1[49;41H[?25h[?25l[76;258H2[49;42H[?25h[?25l[95m/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[49;107H[K[76;258H1[49;41H[?25h[?25l[95m/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[49;106H[K[76;258H0[49;40H[?25h[?25l[95m/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[49;105H[K[76;257H39[49;39H[?25h[?25l[95m/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[49;104H[K[76;258H8[49;38H[?25h[?25l[95m/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[49;103H[K[76;258H7[49;37H[?25h[?25l[95m/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[49;102H[K[76;258H6[49;36H[?25h[?25l[95m/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[49;101H[K[76;258H5[49;35H[?25h[?25l[95m/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[49;100H[K[76;258H4[49;34H[?25h[?25l[95m/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[49;99H[K[76;258H3[49;33H[?25h[?25l[95m/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[49;98H[K[76;258H2[49;32H[?25h[?25l[95m/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[49;97H[K[76;258H1[49;31H[?25h[?25l[95m/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[49;96H[K[76;258H0[49;30H[?25h[?25l[95m/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[49;95H[K[76;257H29[49;29H[?25h[?25l[95m/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[49;94H[K[76;258H8[49;28H[?25h[?25l[95m/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[49;93H[K[76;258H7[49;27H[?25h[?25l[95mr/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[76;258H8[49;28H[?25h[?25l[95mg/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[76;258H9[49;29H[?25h[?25l[95mm/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[76;257H30[49;30H[?25h[?25l[95mi/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[76;258H1[49;31H[?25h[?25l[95mr/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[76;258H2[49;32H[?25h[?25l[95mt/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[76;258H3[49;33H[?25h[?25l[95m /data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[76;258H4[49;34H[?25h[?25l[95m/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[49;99H[K[76;258H3[49;33H[?25h[?25l[76;255H4,1 [50;1H[?25h[?25l[76;255H5,29[51;29H[?25h[?25l[76;255H6,33[52;33H[?25h[?25l[76;258H4[52;34H[?25h[?25l[76;258H5[52;35H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[52;104H[K[76;258H4[52;34H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[52;103H[K[76;258H3[52;33H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[52;102H[K[76;258H2[52;32H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[52;101H[K[76;258H1[52;31H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[52;100H[K[76;258H0[52;30H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[52;99H[K[76;257H29[52;29H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[52;98H[K[76;258H8[52;28H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[52;97H[K[76;258H7[52;27H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[52;96H[K[76;258H6[52;26H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[52;95H[K[76;258H5[52;25H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[52;94H[K[76;258H4[52;24H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[52;93H[K[76;258H3[52;23H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[52;92H[K[76;258H2[52;22H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[52;91H[K[76;258H1[52;21H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[52;90H[K[76;258H0[52;20H[?25h[?25l[95mr/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[1C[38;5;224m)[m[76;258H1[52;21H[?25h[?25l[95mg/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[1C[38;5;224m)[m[76;258H2[52;22H[?25h[?25l[95mm/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[1C[38;5;224m)[m[76;258H3[52;23H[?25h[?25l[95mi/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[1C[38;5;224m)[m[76;258H4[52;24H[?25h[?25l[95mr/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[1C[38;5;224m)[m[76;258H5[52;25H[?25h[?25l[95mt/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[1C[38;5;224m)[m[76;258H6[52;26H[?25h[?25l[95m /parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[1C[38;5;224m)[m[76;258H7[52;27H[?25h[?25l[95m/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m)[m[52;96H[K[76;258H6[52;26H[?25h[?25l[76;255H7,7 [53;7H[?25h[?25l[76;255H8,23[54;23H[?25h[?25l[76;255H9,26[55;26H[?25h[?25l[76;254H80[56;26H[?25h[?25l[76;255H1,1 [57;1H[?25h[?25l[76;255H2,26[58;26H[?25h[?25l[59;12H[38;5;224m[46m{


}[m[76;255H3,13[59;13H[?25h[?25l[38;5;224m{


}[m[76;255H4,26[60;26H[?25h[?25l[62;20H[38;5;224m[46m{[67;1H}[m[76;255H6,21[62;21H[?25h[?25l[38;5;224m{[67;1H}[m[76;255H9,26[65;26H[?25h[?25l[67;19H[38;5;224m[46m{[74;1H}[m[76;254H91,20[67;20H[?25h[?25l[38;5;224m{[74;1H}[m[76;255H3,26[69;26H[?25h[?25l[76;255H4[70;26H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# fit model[m[76;253H[K[76;253H195,26[8C86%[70;26H[?25h[?25l[1;75r[1;1H[3M[1;76r[73;1H[1m[96mprint[m[38;5;224m([m[95m'fitting model...'[m[38;5;224m)[m
start [93m=[m [1m[96mSys.time[m[38;5;224m()[m
metrics [93m<-[m [1m[96mcv.mirt[m[38;5;224m([mdata1[38;5;224m,[m ndim[38;5;224m,[m[76;253H[K[76;253H198,2[9C88%[63;19H[38;5;224m[46m{[70;1H}[?25h[?25l[1;75r[m[1;1H[2M[1;76r[74;17Hmethod [93m=[m [95m'EM'[m[38;5;224m,[m[75;17Hrandompars [93m=[m [95mF[m[38;5;224m,[m k [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m[76;253H[K[76;253H200,12[8C89%[61;19H[38;5;224m{[68;1H}[70;12H[?25h[?25l[1;75r[m[1;1H[4M[1;76r[72;17Hlambda [93m=[m [1m[96mc[m[38;5;224m([mlambda1[38;5;224m,[mlambda2[38;5;224m),[m[73;17Ha_true [93m=[m a1[38;5;224m,[m[74;17Hd_true [93m=[m d1[38;5;224m,[m[75;17Htheta_true [93m=[m theta1[38;5;224m,[m[76;253H[K[76;253H204,26[8C92%[70;26H[1;75r[1;1H[2M[1;76r[74;17Hpars [93m=[m pars[38;5;224m)[m
end [93m=[m [1m[96mSys.time[m[38;5;224m()[m[76;253H[K[76;253H206,26[8C93%[70;26H[?25h[?25l[1;75r[1;1H[5M[1;76r[71;1Htime [93m=[m end[93m-[mstart
[1m[96mprint[m[38;5;224m([mtime[38;5;224m)[m

[96m# save results[m
fileConn[93m<-[m[1m[96mfile[m[38;5;224m([m[1m[96mpaste0[m[38;5;224m([m[95m'~/results/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[38;5;224m))[m[76;253H[K[76;253H211,17[8C97%[70;15H[38;5;224m[46m()[1;75r[m[1;1H[2M[1;76r[74;1H[1m[96mwriteLines[m[38;5;224m([m[1m[96mc[m[38;5;224m([m[1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m1[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m2[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m3[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m4[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m5[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m6[m[38;5;224m])),[m fileConn[38;5;224m)[m
[1m[96mclose[m[38;5;224m([mfileConn[38;5;224m)[m[76;253H[K[76;253H213,12[8C98%[68;15H[38;5;224m()[m[70;6H[38;5;224m[46m([mtime[38;5;224m[46m)[?25h[?25l[1;75r[m[1;1H[2M[1;76r[76;253H[K[76;253H218,16[8CBot[68;6H[38;5;224m([mtime[38;5;224m)[m[73;6H[38;5;224m[46m([8C)[?25h[?25l[m[73;6H[38;5;224m([8C)[m[76;254H20,1 [75;1H[?25h[?25l[76;254H19[74;1H[?25h[?25l[73;6H[38;5;224m[46m([8C)[m[76;255H8,16[73;16H[?25h[?25l[72;26H[38;5;224m[46m([10C)[m[73;6H[38;5;224m([8C)[m[76;255H7,2[72;26H[?25h[?25l[76;258H7[72;27H[?25h[?25l[38;5;224m([10C)[m[76;255H6[71;27H[?25h[?25l[76;258H6[71;26H[?25h[?25l[1C[95mresults/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[1C[38;5;224m)[m[76;258H7[71;27H[?25h[?25l[95mgresults/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[1C[38;5;224m)[m[76;258H8[71;28H[?25h[?25l[95mmresults/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[1C[38;5;224m)[m[76;258H9[71;29H[?25h[?25l[95miresults/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[1C[38;5;224m)[m[76;257H30[71;30H[?25h[?25l[1C[95mresults/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[1C[38;5;224m)[m[76;258H1[71;31H[?25h[?25l[95mtresults/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[1C[38;5;224m)[m[76;258H2[71;32H[?25h[?25l[95m results/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[1C[38;5;224m)[m[76;258H3[71;33H[?25h[?25l[95mresults/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[38;5;224m)[m[71;110H[K[76;258H2[71;32H[?25h[?25l[95m/results/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[1C[38;5;224m)[m[76;258H3[71;33H[?25h[76;1H[K[71;32H[?25l[76;243H^[[71;32H[76;243H  [71;33H[76;253H216,32[8CBot[71;32H[?25h[?25l[76;243H:[71;32H[76;243H[K[76;1H:[?2004h[?25hw[?25l[?25h[?25l [?25h[?25l[?25h[?25l"fitscript.R" 220L, 8045C written[71;32H[76;253H216,32[8CBot[76;253H[K[76;253H216,32[8CBot[71;32H[?25h[?25l[76;243H:[71;32H[76;1H[K[76;1H:[?2004h[?25hq[?25l[?25h[?25l [?25h[?25l[?25h[?25l[?2004l[76;1H[K[76;1H[?2004l[?1l>[?25h[?1049l[23;0;0t]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ vim fitscript.R Rscript fitscript.R 0 0 3 1 0
Loading required package: stats4
Loading required package: lattice
Error in file(file, "rt") : cannot open the connection
Calls: read.csv -> read.table -> file
In addition: Warning message:
In file(file, "rt") :
  cannot open file '/home/kveldkamp49/rgmirt/data/_3_1_0_.csv': No such file or directory
Execution halted
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ cd ../..[K[Kdata/
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/data[kveldkamp49@int5 data]$ ;s [K
bash: syntax error near unexpected token `;'
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/data[kveldkamp49@int5 data]$ cd ..
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT[kveldkamp49@int5 EN-MIRT]$ ls [K
[0m[38;5;33mdata[0m  [38;5;33mmirt[0m  Movielens_results.csv  README.md  [38;5;33mscripts[0m  typescript
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT[kveldkamp49@int5 EN-MIRT]$ cd ..
]0;kveldkamp49@int5:~/rgmirt[kveldkamp49@int5 rgmirt]$ cd data/
]0;kveldkamp49@int5:~/rgmirt/data[kveldkamp49@int5 data]$ ls [K
_1_12_0.95_.csv  _1_16_0.85_.csv  _1_19_0.95_.csv  _2_1_0.9_.csv    _2_14_0.85_.csv  _2_17_0.95_.csv  _2_20_0.9_.csv  _2_5_0.85_.csv  _2_8_0.95_.csv   _3_1_0.9_.csv    _3_14_0.85_.csv  _3_17_0.95_.csv  _3_20_0.9_.csv  _3_5_0.85_.csv  _3_8_0.95_.csv
_1_13_0.85_.csv  _1_16_0.95_.csv  _1_19_0.9_.csv   _2_11_0.85_.csv  _2_14_0.95_.csv  _2_17_0.9_.csv   _2_2_0.85_.csv  _2_5_0.95_.csv  _2_8_0.9_.csv    _3_11_0.85_.csv  _3_14_0.95_.csv  _3_17_0.9_.csv   _3_2_0.85_.csv  _3_5_0.95_.csv  _3_8_0.9_.csv
_1_13_0.95_.csv  _1_16_0.9_.csv   _1_20_0.85_.csv  _2_11_0.95_.csv  _2_14_0.9_.csv   _2_18_0.85_.csv  _2_2_0.95_.csv  _2_5_0.9_.csv   _2_9_0.85_.csv   _3_11_0.95_.csv  _3_14_0.9_.csv   _3_18_0.85_.csv  _3_2_0.95_.csv  _3_5_0.9_.csv   _3_9_0.85_.csv
_1_13_0.9_.csv   _1_17_0.85_.csv  _1_20_0.95_.csv  _2_11_0.9_.csv   _2_15_0.85_.csv  _2_18_0.95_.csv  _2_2_0.9_.csv   _2_6_0.85_.csv  _2_9_0.95_.csv   _3_11_0.9_.csv   _3_15_0.85_.csv  _3_18_0.95_.csv  _3_2_0.9_.csv   _3_6_0.85_.csv  _3_9_0.95_.csv
_1_14_0.85_.csv  _1_17_0.95_.csv  _1_20_0.9_.csv   _2_12_0.85_.csv  _2_15_0.95_.csv  _2_18_0.9_.csv   _2_3_0.85_.csv  _2_6_0.95_.csv  _2_9_0.9_.csv    _3_12_0.85_.csv  _3_15_0.95_.csv  _3_18_0.9_.csv   _3_3_0.85_.csv  _3_6_0.95_.csv  _3_9_0.9_.csv
_1_14_0.95_.csv  _1_17_0.9_.csv   _2_10_0.85_.csv  _2_12_0.95_.csv  _2_15_0.9_.csv   _2_19_0.85_.csv  _2_3_0.95_.csv  _2_6_0.9_.csv   _3_10_0.85_.csv  _3_12_0.95_.csv  _3_15_0.9_.csv   _3_19_0.85_.csv  _3_3_0.95_.csv  _3_6_0.9_.csv
_1_14_0.9_.csv   _1_18_0.85_.csv  _2_10_0.95_.csv  _2_12_0.9_.csv   _2_16_0.85_.csv  _2_19_0.95_.csv  _2_3_0.9_.csv   _2_7_0.85_.csv  _3_10_0.95_.csv  _3_12_0.9_.csv   _3_16_0.85_.csv  _3_19_0.95_.csv  _3_3_0.9_.csv   _3_7_0.85_.csv
_1_15_0.85_.csv  _1_18_0.95_.csv  _2_10_0.9_.csv   _2_13_0.85_.csv  _2_16_0.95_.csv  _2_19_0.9_.csv   _2_4_0.85_.csv  _2_7_0.95_.csv  _3_10_0.9_.csv   _3_13_0.85_.csv  _3_16_0.95_.csv  _3_19_0.9_.csv   _3_4_0.85_.csv  _3_7_0.95_.csv
_1_15_0.95_.csv  _1_18_0.9_.csv   _2_1_0.85_.csv   _2_13_0.95_.csv  _2_16_0.9_.csv   _2_20_0.85_.csv  _2_4_0.95_.csv  _2_7_0.9_.csv   _3_1_0.85_.csv   _3_13_0.95_.csv  _3_16_0.9_.csv   _3_20_0.85_.csv  _3_4_0.95_.csv  _3_7_0.9_.csv
_1_15_0.9_.csv   _1_19_0.85_.csv  _2_1_0.95_.csv   _2_13_0.9_.csv   _2_17_0.85_.csv  _2_20_0.95_.csv  _2_4_0.9_.csv   _2_8_0.85_.csv  _3_1_0.95_.csv   _3_13_0.9_.csv   _3_17_0.85_.csv  _3_20_0.95_.csv  _3_4_0.9_.csv   _3_8_0.85_.csv
]0;kveldkamp49@int5:~/rgmirt/data[kveldkamp49@int5 data]$ lscd data/[3P..[3Plscd ..[3P;scd ../data/[K[K[K[K[K[K[K[K[K[K[Kcd ..
]0;kveldkamp49@int5:~/rgmirt[kveldkamp49@int5 rgmirt]$ ls [K
[0m[38;5;33mdata[0m  [38;5;33mEN-MIRT[0m  [38;5;33mparameters[0m  [38;5;33mresults[0m
]0;kveldkamp49@int5:~/rgmirt[kveldkamp49@int5 rgmirt]$ cd EN-MIRT/scripts/
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ Rscript fitscript.R 0 0 3 1 .85
Loading required package: stats4
Loading required package: lattice
Error in readChar(con, 5L, useBytes = TRUE) : cannot open the connection
Calls: load -> readChar
In addition: Warning message:
In readChar(con, 5L, useBytes = TRUE) :
  cannot open compressed file '/home/kveldkamp49/rgmirt/parameters/true/true_3_1_0.85_.RData', probable reason 'No such file or directory'
Execution halted
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ cd ../..
]0;kveldkamp49@int5:~/rgmirt[kveldkamp49@int5 rgmirt]$ ;l[K[Kls [K
[0m[38;5;33mdata[0m  [38;5;33mEN-MIRT[0m  [38;5;33mparameters[0m  [38;5;33mresults[0m
]0;kveldkamp49@int5:~/rgmirt[kveldkamp49@int5 rgmirt]$ cd parameters/
]0;kveldkamp49@int5:~/rgmirt/parameters[kveldkamp49@int5 parameters]$ ls [K
true_1_10_0.85_.RData  true_1_11_0.85_.RData  true_1_13_0.85_.RData  true_1_15_0.85_.RData  true_1_17_0.85_.RData  true_1_19_0.85_.RData  true_1_2_0.85_.RData  true_1_4_0.85_.RData  true_1_6_0.85_.RData  true_1_8_0.85_.RData  true_2_1_0.85_.RData  true_2_3_0.85_.RData
true_1_10_0.95_.RData  true_1_11_0.95_.RData  true_1_13_0.95_.RData  true_1_15_0.95_.RData  true_1_17_0.95_.RData  true_1_19_0.95_.RData  true_1_2_0.95_.RData  true_1_4_0.95_.RData  true_1_6_0.95_.RData  true_1_8_0.95_.RData  true_2_1_0.95_.RData  true_2_3_0.95_.RData
true_1_10_0.9_.RData   true_1_11_0.9_.RData   true_1_13_0.9_.RData   true_1_15_0.9_.RData   true_1_17_0.9_.RData   true_1_19_0.9_.RData   true_1_2_0.9_.RData   true_1_4_0.9_.RData   true_1_6_0.9_.RData   true_1_8_0.9_.RData   true_2_1_0.9_.RData   true_2_3_0.9_.RData
true_1_1_0.85_.RData   true_1_12_0.85_.RData  true_1_14_0.85_.RData  true_1_16_0.85_.RData  true_1_18_0.85_.RData  true_1_20_0.85_.RData  true_1_3_0.85_.RData  true_1_5_0.85_.RData  true_1_7_0.85_.RData  true_1_9_0.85_.RData  true_2_2_0.85_.RData  true_2_4_0.9_.RData
true_1_1_0.95_.RData   true_1_12_0.95_.RData  true_1_14_0.95_.RData  true_1_16_0.95_.RData  true_1_18_0.95_.RData  true_1_20_0.95_.RData  true_1_3_0.95_.RData  true_1_5_0.95_.RData  true_1_7_0.95_.RData  true_1_9_0.95_.RData  true_2_2_0.95_.RData
true_1_1_0.9_.RData    true_1_12_0.9_.RData   true_1_14_0.9_.RData   true_1_16_0.9_.RData   true_1_18_0.9_.RData   true_1_20_0.9_.RData   true_1_3_0.9_.RData   true_1_5_0.9_.RData   true_1_7_0.9_.RData   true_1_9_0.9_.RData   true_2_2_0.9_.RData
]0;kveldkamp49@int5:~/rgmirt/parameters[kveldkamp49@int5 parameters]$ cat true [K_1_1_0.9_.RData 
‹      y4ÔïÇm!-H«’(K’"äBÊ‘HI’|IÉšJ$Ze'kdÉîÚ÷}ß}gÆØ×Ÿß?ó™ó9sÎ<ó<÷¾ïëuÎœõ+wD˜î0QQQÑRÑQo?îØ~JÅtMãæY		±Kg…©¨èh¶ïPSÑQíÜ¾Ò[›[nß¥ÙKEÅÇo†Iég`ZKëP«Ól:èÏj¾/§•®¼ž»šOosôJ‡óiœè/oÏ€BiÞ×J))*³zÆèéïC×W±žƒën–ÃÅ!dðåŒ°öÐŸw`ì¹#2û§ß¼Ã"¢Î×¨ø\I¢?{ ç}ŸŽÜKÄ¹Ý1%¡§` Qú±ÈL9Î·ÌÑtñâ„ø×]ì_ãŸ	¾ÙÙƒÜH9ºûESÔ]ËÓ)‹?…C"m&2ÃëP°õAöÄÞ#ð‡ã@—Ò‡+PP²Äù”Ë&âß–tù}¢àè‹¤ÕÜq¦ºØ’¢ÏìJzƒæDX>®´ï5àî>*³WÜeªZ*ò©¯Gœfº®-‘üš/åpTõ¤¾ÿã,Ì˜èˆj¯Ã…÷«CŠ°A®dzºB¬xkÇ>ààå›	ë‹X“L“ª~Ó¹L%ü×÷â|~¾ü	miÜì½8§IJg”PjÓpEºÌ²ö.ñ¦ëHñáFìõ¤§¿ÎA^±Ul¤á¤ôã‡T	8Iq¨ŠÚMR;Æªk ÑÙù„5õ2ôxê½ágL„ŸwŽcpu§œU¢Ê1¤Œ,õEˆý‚¡ÛÖRF/òð«´ÒÝ®é8xôO©¹!Žî\T¿vÃò-_¹xjX…V‰à˜¼gFBbjM2ˆy4´‚?ðX9a›ÃSÊÖ·(èÞ“ê·S&	WÌ´¸BåË,÷3‹Aýôûyþî¸½VËãCoôç‚Ö¿ßHÄâókÿÝÉÀôÃlLŽ0yeõÑsuXð4*|~Æ"™™^ÄbuÒazyNè°)cT½-‹›³GFYJ!åÕÑ”@A Ç4ÍèìÆº6ÕÎ¹+¦ŠAoü)9Jn=³Ë¯ÎxV #¿HÝÅeZ…bóKiS¤"g½‡Ûû»–¥·ã|®L¾]ÐóôÁAÃ=›žŸc ™¢|¡+ûÚòòJ¦±ïW©é)Í3PdqNe§n<¢h8Z„}…þÁ7ÅÏÀPâàÞ_‡&±P ¤g–»fÍX±Gcí±îA_øýÄ^\JEz8®Wí9ð _›¼q›ÉÇy/êÐC¹±ã7"òn@?Çƒ½ïX`¸—W@ãP]]ánÇ’ÿú2?Íra‹H‹Ò~i! t•2Ëòeõ¸æçÐ¾4zE†gNþ±…-óo™Ïô±îëgË÷ä}Ðç£·»¦îP2–¢ø¶0ÁÖq×?5Hð‹óÌ\ÅžLT/<°9!7~É¹›ž¿)gƒ%†ðäÉ‰?@¼€¿Fa»Ú2•ŽÁèÊs=¹¡ê¼ÕÁNÂ€Æ=Ãbv8Gæ 3x‹÷ÓÄF|JÂqójÝžÁ¤æá7‰I	0‘U¬í(öG8xÑÉøÃÞ¾‡Ü3‘Ü;äÀoÉíÉÉ•œKÞùLvyß¯VWa÷;âýé‰uì½¦[6Å‚”‡¿–Ô©Ã@:6žúê–GRgaò"éî_‘ó8Æ#ÂIeyf®ø^¸K¶%£Þ/ãu´†áëVÜ¸3A!E•áàNºÞÜÉ
$žÑjþòæ/¶\õ|úð´efL=9	Iw³¿=îÀú”™¨|>\st¼½[ô	6×ß³µaÀõqK]y·F+‡%mjÞÒ—î0ò†ƒFû¶×x~è¤<VÞÒcpzÆ;ûwt&öàËYÚ×9<X{÷YÆâ}U}U}F†eÎ®š8ÊRDùº³_®s]y÷šMÉçywsÂ
—§«ŒQ*´)·Ÿò†Žo=äŠ?"9úpÏ.ÿ˜a’ÈðLX7»ÔG^zCr÷æAß»Ç„±ØQ:e½*‹S¡bé7aD«här‡R‚û~s“Æ±€õQÅ»0¢÷6}Åÿ",|Šõzl4Ÿž÷>üYBÏú…nÐcÙÙŠõ‘%œŠø}+4(û¥tä;[ïÀòŽ¢“)ØÇRXÍtl'´7ÑmÕxñcWÞžÑ'ÚP-E–¨iÈ§›%Ôþ×€Ce†Œnç4 ÌôÝÂë¸0-lŸ¼›G.vš·Ô`8ñçê”ŒÇe]ÍJSÇ¹¶J›A¬nirN¶ƒÍ/‡›ö¦à¸Õy‘…·ØùàKÀ\AXç·:ùÌ"ö‹æ¥2AÛñÝëÅä„|*nî»wrya €µ>¼K§øž¤èþñÄžÏoç˜¦oÁÜãæ,öº£0¢9Ñ±‡	6ºëïž@3GjÌ#Úl¢a	=ð‘«[˜ï{ÇµLåÝü==8_)ëc%#	©‚|$ K|Ò¿aƒ¾?^ÚàX~ýØ¬þ"XÿÖ»Eµ&˜Í°ÂÖ²D–~
Ãˆýç»õnÀ·z¥™4ïí}Ø7É å±ê=KTƒFH8Ç³öX¶dç¢B,i¬±þ„Gàá¶Øýþè”“	3Öm†=~½gFÙç/^9ÿjc:¥íxºÂÑçªqf<]<
~ÿÎUµÃò¸¸}Ë¯û {@ËLG8þ¦iý5¦yŽ]áåÿ.HÃêóØ¦–y˜¹åU‚…[£–ê%éqÐš&–ñ{,–	ÅÞè÷¸ŠeõŸ£ßB’v¸rkÙ ’“V6=Ÿa¤ÿA™kö‚Hî4Ð‰“=ƒ)7¾Îï/È€nçºHû8Ø(™`ÿYb÷ÿY8¸{õ“"Ùê`§…Yg /öW¼é„ŠODM¡@q˜-\—Œ®Ç>“5[ªÙ|¿¯ @¨ÁFž¤\.?X½úò§¶ð$ŒØ9Žêñh^ê4ŒImA…›eÐ×ÖÏ8¥r$|Ò?®±W%Á\…pŒtBög7fsçc'Ÿ\ø%¿8è¿cKxþq-šH®Éá<493ý7†M)lïR¯›â|ÈÃ¥¹s‚ÿ¢ãB4‰ªjFJ>Ny¡jŽå0ú{þ»b®ÄÓ=‹b‚åKº²²	@¼•hÀê ˜ý½e«åþg9í¶hé¨q€R¨Mn_ç…qzåÒûïçÛÙm“Xž×bÿ½Ùÿ$¯ˆBgÆ¯øÅL9a?ºÂq)Û¹¯Ÿ]ÅÎÔkgÃ>cÔý3š_<_C¯Éfés÷˜jiË] ‚¿£Ž™©Åyõ»~µ6)]¼E:mì¼EG5¡7?T©8F	çZ7,+Ù°Ëp#õÅé÷¸XÅü0Ê†+zÆØÌ$±V½õ‚¦•¦/;Ìþ#æS‘\ùÐNÉÙ.“¶¨aVìÚþóÇ¡¿·x°§,g]§8Kžûc›¯—ËïÞ'°2öýßÇ¥sX¯ùæÇ?Æ©c1Æålšïe›°òNµud5¦óÍûFäSï¥1:}ü/¶ÿcï{}Ç<ž=1	ßDrÂç’É‘XXqÏîr÷†åÏ…~!ô‰8°ÓÕs_ë;è"•¦¾9èùìÏ«—!©Î¦á{ ßßùF‚±w„Ý"*pâ,Ãã÷$p¼,Å×,lÅªõÌ
‡@57ÇãM« X÷ï­¢þ9zLÏ]ø	äŒÖ0ÇþóØñŽJÖ|ÂIŠ†î1œ“¡á{Q°K†a%F‰oa¶Íb«é•1®öS’ÝÿÄŽ±°ÂÈ>|ç§M6ÒÄ˜7ÖÃ†XÇk·*u$Ÿø¬jc‹¯¯V3T¾âÆÃƒ²`ö?…SÝºw±qoÍ1…—ó¸Ô›¥]}*2]®Ó-x¥âX¼ë|I¦¬š[6ÞZK€ÕöÚwÃŽN8õ[ú¯_5zþu,)r\p`®(öÞxüè[)L<<¦aðH
ÞÔpªmÝh†°s•ÿ(åÌk¢cs+ì½€CÇ®\Vú„¤D¡VŸyuœ¸Öã±Á‰ëK{mªÒ`@xd—á#n$}¢¼ˆ²iÅ–‘Þß`”ªÇ´žƒ™áó>t`S1Â#yó4¼eœ~CnÇB]Æc{ÖŠ`AöÃÌ	n:¨¯û!uïA7ŒQg~ü'–D »øxÎ ù—9Cw{½'†ZMaZ¬É‡žz'êR(ám8ù.à§~ƒ6n#ú}zjh9ËúË0û1tÒñöÏs*âd£¥8ŸQ-ŒôŒÅ¸³ùïîdÃ³`BÈa¯½T1äU1û›0ŒåSDÜÅÜw|Ò<ø)˜5ßuËˆ&HçÂX×]€C£>ACÂîßn;´iR`ý·^j…‰ÚVqæ8&š=àžj ù7¼=8¼/âg—mLÜ6\V5=µ ÍMT4=›7¡åEKÒ|Ö¨¹Ÿ­a«†ÿßwq²Zõžôáè§ËñÂžÇ°ußaÆ—~Ívtñò£0"­ú²ýÐnþpÔ¶ˆ¸„¤(ç
÷›¼{Ùªc)¸NRüòy92u~üI†æ¢V±Š;§¡xO¯”ÛMGèTNÕµú˜ÕæLž¿žÚÂŒ£Ãºì7EXd.ŒÒ$BÃg.–¥ï0ý±¬(y7Ìÿ \Ug‡bc¬‹£:¤Ü‡¢zÿÃþ]ÓÁŸ*  ¹y—ù5.œ%¨ÅR £k‡„mÇ$4V;èÖsÚàâþ®Ý4ÅÅØçúîü„Êwñ¯ÆÏ·bgûžuÿW%°ºÃq—›h®	Î8ˆÿž=`»ëY‹¯éW²ç±òõÓUÕp4®E$Qæ4k´‹îÚï„ÍA	•-Š!G™=«¼‘|eõVÿê6÷$/x¦²Á8©ìgšö.56ËÌAþ6L5¹þÀ–‡Ïæ !Ñˆ•‹m)¢‰G#Êç”þóíü	£yúç÷6×sÝzœ³†6-ôHÌ¿ßJ
ÇÛkvœQL†ù‡‹d­ÍTj? ´$»YØš>oéàä³ŽÏœÅ³´Zß"åJ—Ì/Møþ¾•ñò±‡8ÇŸhfBÿ‹$|/ÅiÞJªðñ/…ç!spDÎ–§HÕ³°nóx‘ŸHºLfhT´ÙÁp ºæï›f8þî‹Ígj‘K×-ì‡ãƒxf­æ‹$wÔnó|T^§ŽŒ—Þ
×R‚ÔfF™”hl»ÒÏìÖuæ—Í©KZÆ0õ[¯âo9\T}ñ¶ë0ôý^[ý:¯B Ù=µð>0W’ÓCÏžË§ÚÑc/®ƒg”ùYÊ°ù¯0W[@,t¤Æp<Ó9
sÑ«_©§±ë†E]7~8vè}G´ÕôLÿI4Ã¥¹óŸï5J‚gw06‡µc+§ü€ŸØX”ëZôµÇÑÞEm.Aèÿ2ÙÎ5ñÖN>¿!íß‡MäMá~Éy˜8™0Ò:0Ñ{ñcêö.t8ÛfdáAj,‘8çòâ÷š›P1®œ¶¯T8o<.ùoÔFŒ·ÖEb¶nƒŽåzE¼#àÐzf÷å@Õ§ös;`ÒÑT¬öå(6êŸåÛŸ…0­×QýR¸«NÛüueÎRÃ¬½¨B4Æ;*Çg'à0¿ãÃ.Æô9Xí¥²¢sG/©Üµ…íºk‡JÈ°xÃP`Åñ?ì¶Ð[P³JÂU2)àxú~lÔÖ½½É‡Ëêí¬r²5P[Â¹›‡s”‹ûñ½:qRãÎ?%ÓýÄá°w7žU<{eF	{sÙ_š°÷éŽÌ{îØÉäôÔIRºo¦ø&šæ3´´¸š§ÁŒöÌuùï—päƒYÆLÑS ;~W›Åñ­›)ËŽyÐõk¾ŽH½†³|ÃqÛ¹×w„Gù¨ô(ÒÆy‰³â4ý‰pÊÈ$ý'wy£Ð£2¸NX^(ÇÍP›OaÝÛ9êÞ:ÏòY çy„ÂŒÝ|qú#ŸÛOì/N/¦ZsÏ§rò¹ÄóŸÎ5—ìÏjF²ÑÙóÙfæá¢á»ýº7‚Ø<Åaã÷T‹.°½:6ý»uWîìðŠ ¿Òž'`xæërï•ß@nÞ]Q)Oõœ’¿÷‡4h?ùŸÀŽ[ÖöyY0¡ ª˜wgf6[Ÿ~™…*ÿÄ]“[0ðËo7ïC{27b1Ûy‡¹§þ¦êÀ²ÓÖw·ÎµA[›eÄç³Ð¯v“ó¹É%h¸î@,~¨ƒCd®¸Ä`UëÄ€t©ŽŽÍa95Ýüû&pž¢ÜU}
úG4.(ÐCŸÃ'³¿{±áÈØ'»h6¬W Ðpï„Î9IYßEqÐ>Õ¨áœ&N^	TQKs¥"T™\W¡-:¯|Ð¦UÏÅë´!YŠ¥†»¬V¥>[’ƒ`6ég—È€#t»6Ä6œ/„–8izÑùmol´+wšd„ò=Ë¸›0Ÿ¶ßo¡AkÈÆ¯e¢ƒ`v/ñýÛ-SùüPÛïûÖYÉ2À@ÖVbG+$æ¬îLº‰“ùþ*íqV¸¢'G¤Ñ„²ƒ¿ŸR’qòß/Ks×³° ¡Tšÿô8èUsÝ>£Š›K~½nïîùY]@ö6O¯i†6P—ÀËÿV«”±„eÁgÈú	–­d¯(2Õa›·LÎ3e˜Û—ú™ Ähö½Á¯±Î wïÓ³yˆ*Òóôþƒ^¦W/…Ï§ 9†ï»ÝU¬ÔYŠ9d‡S¯_3‰ECUãá§q8Mk—hUò-wµ]/{ãŒÿ~_Ûõå
Ö|ÔzÑI=Ÿ^¤9¹á8§èÃ§¯~ÁŒÑ@ÊÍÎŸ@I©-ÞhpÉ§Í¾Ÿûnl›{øžÅ–U½ Ðˆ_¤}é¦·]oìõÃ”·@)¶f&@õ÷¦®8ñõ[ÄËÀÃ°R&rUç©'®q(¿î©VÝîsgß>h+l½!š]ˆÄ?/ŽšÞ=ƒƒ_Šl]ŒÍ°_—0$ØC‡#cË›ÃÔ0u,îrxè6¯©_¡
ò5Ã1ÁÀî×¦!ØÙƒò¹µ‰Øýn¿o\vÙÃKöÊkòËÿÁbÞ¡êÇõØ–Ãw/§Êþ	>VŠ+©:wÂ…¨ÔVZ„h\~ê_<®‚#­wuÏ™×@Ó¥%ÕÿibyÇcù')50Îxýè‡<ÕÃ‘óÕi°¸¬LC.0Ãi&~‘KoW`ëâ¼’lF;Ú\ÂÖ{+Ê²sXq©Íò»îQÜ
×*¸û>«2l¶¤%ƒp:·ÝKáîV'ÿ
ŠŒÁFÎÓ)¿$®AU	‘/¸y”þÎ¯m®±\’ëÂ²¾÷_qú¾žèÔ°6N;n”¹±C_ŠÐåë18ê1¾B
6 ÒÌëµTëPì¢WþQ?y+{Ö¶ùRe|g‰¯.tjU…³½gÇÌýëÏ„¤ÁTý÷G•Ø5ÒÜwÿ>ã³xÏû[¹uJOÀß³§•	ð@C€ñ)½Jœeˆø^¿›
‰ÝÍ¢¹+šQ6{ÑÝü$ü¤O&¤ÃPr…™½«3¬:Œë©…ëâ†ãôíFMG\ºýqåïø©Ç´J°ñÁh<?m ì-,.>¡8çªc>KŸ€áÇ.%ôWÒ`|WÊ“3½»¡—JÅ8<VH‡mËÔ7Ýq‘–Õ¶ÎNÄŒxoàè¾¡¨Ô„^ÓÜÚ{61s~ù1³-UVNÔk!’¬Ÿó¹*¨ÅD%ÉV8é’~»¢È÷¤?ÝQÐ„â½TKSpÛìõOÕc‘Êžº3KØš™­&²ÛIif¦®âãHŽöÖÚEó¤““d6aà„ªãJÚa$Ö[>sÏE\H’ü(~n#ŸîÍP„ÛÃx\âT.=’ØK¾:B£"Pá·ß ç=tš4(¸hs!ù§Ežq]üµS±$È·ÿB_€ÛÎNâ6Neä†]+Æ¹û.û2ùq®tD9µ”Gœ´SÕ?âäÕËhšl¥Ý·×C—`XìÆÃ`=ØüÏüÞø-ì,ÝÐ“ásÅRÁË‰z0Æz¡1GT›ú¤×a_©Žléœ.ÉÄDy1Ãà¹,Wê2Cœb)‘ç¯ò†6:Nµ»·I@*çyü+ïx>ìåØ;¤ñæi’
SqÒ*—«ñ£î6Ä¶œf«Séw&;€rPã›P²>¤öÐí”âŸDRâ¡´‡0âÏÚ°í¯7Í´»ôª`Ëkæ¦óSe\‘žjÉh„òðÀ?ßË _Q¨tTê„mØ{ô bbq)}ëœM´‡þƒO¨ŒæqFÕuîE3.úxºøÂ$EXínËÅ¿åCœºZŒ68zõÅŠ£ÿ]±=1xp76kÞi²©Ä!»€ÜNãPD³|!¶Çë¿Êýh½ŒKáâÌA™^Ø®Þ÷Å6ú7ûß/à¼”¬‡¿1V¯¨¾	`sF^ÝÎUX69,¡™ ¤øN£Ñ_Ðÿ,ù§4úeìç©Ÿà“s…[ñþ¶w1Ê<{‡!¶ZU‹Æ@^ÛÅhoJ Î:Ñò|‡¬äYnZIÆãä…uÇgÇ¡âÝ*zŒ&B¡s}Ï×ß“Ø¯£LÒ÷©…B‡Z™«là2¸¤n¨ŽßN^7·‚Á´JŽ¿?pQÆ§üÜ1LÛÉþ§dc?’­c×jZ³pêÉRVù{æ|št_^-ßÅRŸac9-ÏÙ2v…Ñæ²b++/è|•R0—ÓÿƒÑ F{«œùCq*ç=ƒ t<£Ÿ’‘_Â&Ùˆ"¾‹ç¢ðÖ6\C‡?F“®+ÀÈä‰Üú`Ì¬®°ët
ÆÂð3¯îrë¨t[.ŽVúÂRåM¿ôˆJ™~Õ0D"‡·ý4òòn¤g&Ãhëïj>‰I˜¿ë1“Í@Ø¡Êo; €ÄÆ«=fŸàœ^øÏ3ÅÒ8n™$·¤ÇïmÒÕ.âTö_}•6[ìJâàµï˜‚r¦ìÝ3ê÷7Õ×§£!­½ðY7­1¤™;@mã¶?UåÞJþ 8Aæ¹º55R¾èræGRèM¿<‡‡8åý6jIO7ŸÆHóˆ¢dÎ?¹`ç¬Ô
c‚%÷öõí~÷Õ2KçÅ®¹ˆÖkÌ/°ÑùÖXu`3Œ±¸.øÕ`Ÿi÷ÑµÁ9˜¿óýóÅ ]>0Qê“LÒ²Øã}YðÙ0vY,+<ª~¿à7*»^â_S?šø½rgÈn(ãH`ãSWÂÙhÏ–ŸãµJ}Î‡-ÌO¤¹s!]K*ŠÆGÀÐµ¢à€hŸ;üË
†>ü'£1¨K'þ±ê'ƒ^®h†WÂ´qùP¾Œ'Œ°¸™<ÞøGÎ+•þ9<ëŸ¶œZÙ°<Ô\®u°{ø]³ï?r‚ÉCÍ†f¹j°HèŠ>*§ í·6®1þvÂéô×®í	I˜zp&[¡à¶‡•í7í°Æ%ñsêäš"ùE(ôh¹Û¬—ènsŽnJüÁÞÝtL¸ðþéRÓ6ø5‘µ¼õpCšÂÒ}ý'ï‹÷@}¸û[¥ì3Õû\¿zæúš”ºÿma¯¡_läÍCØ×µw>Ç¤öûûÛü±ã;Ïà.N
Ôs¨†ÅW™cMùåë]².X9vŸÊ”}†ÎÉ'jíæÃú—ösÁLå-ÆkåÁ8=F~§g:Î\÷Ë<úéäöüjÈÐ>â†³ßíOœì)ÂñXÅ’#Ø°¨§è‘;‡Í©¯(ož(!™U˜inñÐ6‡*²uéoçä·6{^!ìo5Š»i0ÛÍùvX5V4ÍøüIv‚‰²‚=´G±Ìòñ…F¹#Ð¯|Vé/£7¶¿üO^ÆÀ|¤xêt{=Ì—´)?’¶ÃÕU>KËÇüH¦2ô½Ñ|ºO™ðD^ÏÂq¹¼rŽ!°ñîµ»ëçí9Ôn¶ºîQCÚArV•M°ž×*œ[n€+éÚ<ƒæÙ0÷û…ìX>0Ñõ8«b“çD¤Ók/Û»ø‹ñ)þEv¤{8è¢»Ê¼ßÖ¥4,î¸Aº€Àé'›4° ²Te+"+«OõL`eüäÉ3abHé‘yùJŠˆœüNg3a!ÚæÎ=Ìâý4¹öu{Þg´æu€6ó®;»ì`b¬œ^h—>ÎWk7ÿ>ÆqùŽÖ7ËP&áxì8&‘e>Å/Bïñ›¬nR0÷ëßó‡M·y•G–æZŒø†—Ý:ëÜ±t
¸pŠþS†Ëv×­…½0|Ÿ¦xç$Y™­ÒaêjZû¹uw(|q††ÄYCT?oÍ_y9w%N3lYÂ¸»Ûh.Ôu¿'µ\Þƒm4\•wU¡ˆ—¢~óÄ46î	^ûƒé‰ÎG<oaì¢VÝŠ·RbÂmt¿ Ñ‚‡†ŠWVßgø?÷”†>ÚòSmsÛs4cFbL[þž4Ð*ñ'P½çùU8wXûéYÑ>œð®]žÃ"Ñ||'©q2÷NKHs<ŒJ.n‘¨Åþƒ‚‰7ïæS÷”}yn©	´Š‰qÈ¶P?lT»ï5kÜ#Šà¨¬Ì‰ØwÛý|åÒ‡É¨ñ¥ðÅFb÷JM’Ëz4æ\ÌÐ)©_„ê7U’'y—±„êúHmj>Úèð——µ€Þ¯ÞôC‡¤H=”°KÊ~²…=ì¡)›=»p®SëæøÝ\š}}úš]é¯)l!qä÷ÎK?a¸–¨³óé®1ß(X5Çq}¶Zê>ö¯
r¼‹§#R8Ç6!dÌ‰¹^ã®òÐGnV\Äô)_;e¡'Pf5‡VÑtê¯+NŸH~À­·–‚ÞR2mô`Pî¢ÜœÆshº|ÇB-ã;_«-lROÊÎ]qaXÆë°äæ(’(/³½y ä¸=?£Üpp&¯÷å)L‘êxÿõ87fßõŸºO¿ˆ	‘ŽPÅÖló½fRÝzoºá`ÜÒYŠ­:¶¾wv¬4	“Õ2ëªq, Ôf®ˆµúÌ‘Wã—ôOöikÔ ,ž½®cÖÿÌ{³ìyo
õ¹ƒìîÀÅ#¯Ì@nXjŠSÕ*ÝöþývF|ª¶’ ½æ/¸T£+/!€ÍÌ×Œ6Mq°Õ=T)sH"¶Vù,V@æØh+“H†ú-;•`h•<É£|coõ%”k»˜f6×ß¨ãò‚/GzýÍ…}×â ¹’ô)ÿ­ÁgàìW ›QàýÃ#ŸÀ·°ó[±öX+êîý=æ( ­º)h‡¤+Õ}•__¨ž%Yñ©G"°féN Rvfyç
ù}³”‡aèš¹à¯5J9\º#™9QUb8qUZ*,5IŽï«Þ0C?Å÷™k-F8ˆ31]¿Ž—Ì`ôð ÔÐUÿÐò]K*÷±½9UIˆZ&ÏÒšûJGbcÌ«rV˜3ý^ùŒ-Ÿæ~î¾Ó0øð`FYúv5[îªnXÀAÝõôþ%l8ÿ.@åa
ŒoýÛsª	jI×$»vhoçw…ýáìn½ôAüÊHŠ¿,tãöO‹ý4¼›‚%ñá×§ú¡ëÖ7¦¶KÙ@¹ê•|»Èvû]¼˜¤}Þ¾¸r–-âû´ÿ\Í^Ý:“6ü|JÜÐFvg1^cÃ¡hÙWéqé˜K•Íˆ3ŒÊß*öÀŽDk·¯°±çíÞ¾”ÿÄÈ$ú"#öØ£eÖ³0ëôÜ¥0˜ºkõõÍÿÛ¤œG¸7s‘"Tø¥âVP~-%¹aCY	¤<õîÏÝžGq<§¤Š`ýØ©¿«PòefÝá3NH8ÂQM¨xáÎ½Þ°ôr„Ne©v›sÒ;ÐoKÓÃ#%÷A«ìÑþßnœ—ÃØÐ>Ì¯¹o¼a	dKyK—FL–‚çöb³HÑ©-™z¾€.-òÇ.5ã¨`Y¬2«–V•O½ìmJU ã¿²ƒ°ÑýîÝS9X-Žñ»åg}s'2¿Ô1@÷“Š“–M˜s(8¡ûcÿo6vØ’Ô<Ë¯sæTÑþã“Pê4¥ Öôçh¦°0Å‘¾cùyE3Å˜³£Ò ‡ngžèœÂå£ýÊþ0Ks\9ôž l¥Ë:oùçàPÌ•ç46`DÐY0Î~;ñœfÀêÆdìHÊÆÍãºúWÏoŸûõƒVŸ=°Ÿú—«F­LPO|ejÞ€ö®k¥×o¥cßš´ªhô+9_„;>•?ík„ú7–÷ª*–+v‹ôbotÂhu/4»÷ÄÞ)¦A
ùü®° \í‰(øD!PQ§¼§fsÂîÿý%r@ìÜ)Zó#R+>šÑF·vàé5&œÏ,¿×j‡C}	ªmÛþn*ç[…ÐVVþvHþ5XõQ4›Cƒ½Çµ„XÈË{[J­DÍë^&Ì:@z&ðãÃª&SþS¡>ôºC÷öÅ¥°æs@¸ï– ,À#öóû]‘4çœ§ Š‹F=ÿ>bg+Ght˜Ì,ö4<èkAJoÀ}¹8"’Âš×«`^‰ã  ÷ x|¹ìyzçm˜zËV3ZÓbw{Z¬àØnµœ{=›XúyE^ëË¶?©)Rvë°hÉœqt“/a®}GX©â$’­Œì˜ÅÔá´>}Ÿ)¯w9ÅcØ–ºå±ß"2ZëSô.üç*tä?œT{2ŸéŒã^©©6`Úè$ëEÀEáûM6¥®8r"ìt¯™(6tÙòŽÎAs_mž'O.]ð{¼æ8’Ouù‡˜tÅY\ØùÖÂ<
$÷dú=¤8¬;Z½ÏY‘ˆZÿªÎnüÅåŸ²´9u§`taéV˜6~R*³ÖB²%òšõC¥ï>Žý_{ppd(åõ—! ,ò‡x=þ…u²§BCŽcÓ]ãu‹¬?Ð/'tòFÝS˜&EVê{9QLGC;æ7šõ§c#Eu½ÍaK”ýç÷ïFØ$±dRFRÝ>·iÞZŸO¸)º™Ëªû?ŸÓK YE§ÏéN0vç¬ŽÇ÷@‹ÊÙðV‘q˜î±Pæ7æÇÞƒÖéçqÅöº„³¤ØÇn²u
C¶ð¡eÂÛ|êsßŠ5o@ÿÊËÈ.ªd ö‰?J!Ý„®ù˜T#ó8l¿~)^¹n›û”4`³f¤,ÊmL–6DpáÑÑwgr±žui÷Pd Ôžë0ÿa²‚­¢îÜG~—àò$­‰Ás"Ì^¾?îçó(wmÝ"äâÑ¶[å<SbƒÈ²ÛscÂj²aj†ØÄÇ^rÄÉ”-BŒ|Ìë¼öµ©Âú
®öö¤Ï˜¬íÄÔ =
‚§Û©wCÿKæ+êëÛ¾þòºÆ‰}Ðae—ùÛü ’Z/¹¼ÆÃ¸¬”sxå^ŽÒ ŸbQÁÉ÷·Rz„«áƒ4wð:G`½€À’
ÙO©Œ~ÇŠ/*Ì³ÁXÜmÎGÇÉ°ðŸdtˆ6Öåhdñâ¿bLÉN˜¾k¸c÷°5N]£6©HÀ.5¦såØºxÁ|,‡ÆDé–Ò)8´‡¡}]ê%®)ÓzýusÁ­ÏŒó™“­PŸZrðçÇB,ð¯~~–6gÃfNjPLp1ƒ:‹ké$^$x³K¶Âzg,uØÜ-ŒÚºE^dƒ¼M~ú®øW˜äN¤“…ö{Ä¾;8@ì,Pa‚Õ¶Þkª]¿`n2z¾êŽ’•h¶ÓAÙõƒIm;Øq#èb–Òp:Ï^—x«öÞŒ–šÍ÷±Ë².&¥µEœÉ0 }B|5è.ú*Å¨g÷ÂŠB•Âf¥tÜ¿úé^d'Ö)~XñÓª„Ei!­X’Ž6JÒEoAïb¸è?²ïçþ˜ñJ\tö­2±ÁÚÄm±¾Rì`<a6ÌTÃM.j—nOäSý!:8Ma¥ýúÇÄ4Ü¼EJv´‰„oÖñýv<¸®ùÉ{_ULìÿ÷õîr:NÉ]p7VEJhÉÅ$_^¬þñäÃõÞ(/Ú¿l'Þ‰Ñï\COù`ß½+²9gp¼O —&¥˜ðëØVAÉM&úÛO ç	ÿScÙ=Ð§–W“Ç²ù½vûƒpuÏ‰…	gX9YèS(X?Lþ‡ÅçºŒ‘jåU­:ƒ±Îç¹¹’¶&wÖ‡ÒŒ0GA1ï.û,Î±Ð&	í¢Çø3£tŽÿíÅ®‡ŸºÝÏà|Ñ‰>Ù÷o€¸ÓI!"‡€9§»¤â ê}…íªÉ/ÜÜù£$ãD+ù`þî+óNPúê¡ð‹K>8±L±—ZCJåÎo·ëÈæW2¿!Ì9H÷¦íaô?AÇÛ‘'¡joûHã?O,¡±U‰ÝAm¯8ŸÌßÅee¯ =÷ó„)ß†mÂœ#ÓÑ*á®»q01zm¯Ç\/€¥À‡%©L:H²k-ð®Ï‚µ˜+!õÓÍÛë¸E¸˜Â¶ÜÒ;ú ¯mçæž„í¼/ŸåT˜‡\öùJ",8˜4s’`ž~ðÜqFró¡¡—†Á9[ÞÕ•b ­¾+¬{Ä‰¯„“¿Ã¼OUÿÈBYåÛ/ùe7°¸Ã%åð¡;0:£+2ß‰3ž<^}i±ø–²ÕE…%è¹ò»Ú#ÿý—`Pæˆéªî5­— Y©ý‹ÒØYÈŽæãªœÎÉrë°±ì¹7³ïP6›£ÇÅ·ûÊ¼ë;éŒ<sz×Í¤›1ò×„d‹a%4–¾¢@æ·¢šò*Á†fïŠ¦áìø¸žîª	•–	†rHm¤[±›ÅBÉeíÏÐgüÕAQ8ˆÖÙoE‚¼±x-7ñ¼Q
4©yÎç±~ÃŠ§ê¯œ°ßö½Ù;'¤Ô¾*{»ÆCØ¡Ô¯Ð÷&›Å#UÚ†€ük­6æã½y&›0´s¯¬Í¹=ÐÍsKú¥z!6j7‘›ÏYÀ˜ù“{ÎÙqÚø¢_†ž1i÷«¦T–@{mÜñŒÞ/7¼›ƒê±v]î9Âªæ‰¿?ß¡<k…Iº’|ãêGÐÏëlû2šH.øHÎ³c¿Ž¸¦ñÕ°L•’à¡QˆSÇ=î¿r/ÁVI¿ï>Ì\8÷©PwÊ¤ZÒ¿hÿ¨6QÌ;$Öó×K+2S8þHãZB$¦º›5î(Ý‹ÚU¬ÿpÊ(<<„“j/w*¨Âû_³áIzWp<­=ë\®$6v6ùÐ=lƒü¦?£`ØðÚ§AI7,&¸”žÝ÷ºdÐI‡z†¥ßus0Æn
U_°Ïæâ`Ìâ®í×ó3Ä‘²ýÏ2žæ`‘{™ˆu Œäý~|†/ÊJóîyvI^¦¾Ã;uóiL"†òÎoïÇ®¤ƒ¬;oàwòã×jœî6:Î;®ƒ:bDí@\!Fä¦þ×ˆ–d÷8ÛíÁ~›žw–n¸Ú0X©	#ú-1ž@žn:mÇ¹;e¹||Êé£ÙLª°µy·ª";çšºR|Y„ÐÑPâñ†î;¨w¼q[`Z™ÆhÒ»AÉ°‡Ã-2¦ìùíyZÈJ!šZ¶; 4Ì—rþM/+|q¿ÃŠç&tžAe„²újñIœ5ýq9k×. «7Äñ´¨»N¹ûž„I%¥ã0·fë_hO‡Ã’¡o¤ž‡¦G~kË=ØòLÈiÿˆ;Lž©ú[K/MEâR×™CÊ­£ê/Ã¯éÕùN·Ïl8:ôeiì2¶¼ý{¹(ø´äs[Ì°˜Ž~Í(ƒâçùŠõqrväyÉ‹,}0E2œÇ¼B–ûMQÂ°ìÍöåL+Žhµ1þÝ)‹UåòÇ~Þï‚Lùµ7Æg²€d§pIpWÖÒ‘¯Ý®ÆêwÁ*‚0ìË'+°íµ
*eäëD\hÉx#>…¾Ÿ»¼÷¨CÅú•™P®!½Xï±0À¨úÑÜ"

ÛoÉ7Äêý+™Nf˜øô†ÃcÉ½¸æå¼’ÞŠ¤#B<ÜÂq0ß¿0#fäõjÂJ`q1õ›Ë£|XÞO¾tSëÚÞ½ëæc)ìÌRózÈ´ÝÏ^ÎëËþÛ¹Ëf{õKé'\Ð0¥i™Ç²’×Šp #jš…œ~Á¸õ-FU"SÝ«ù]Ÿ”—Ot…ƒ\pŠÎ1Â¹j)FóQ=ÆùT>ÒmŠ+$ýì>±º­g:ôç"q¼Ä3áŒ\ Lîë›r­Çi©qEš/ÏÐFüuicäO	Ì™œ‡+•àõÕFÌ¬`5¹Hû
znU%9ïUÇæ¾'ncÛóÔ{5ŽØ=Ól{Câ’z?Ü–â{ä¶XßÈêIìáµoctÃÆ·W‚‘Xàåã	Ã‹)4Al¡Rm0ç| .dåEçýè™Å–.jësûû`Ô»ý—å,~Ÿ%„³)rz?ÇXq2ñø«‚ŽÝ¸bc¸0/ûÖN;ìÍ¤ÁÙ»¶E{¬mŸ›Ö™Å¨4$ï°‹ FÊ4ÿžg‘pÂâ¼®Ö†è<;˜
žëßO³Ÿ^$0&ŸüWH
ÁœÃÉãk/bÓµíWoI8t`æ£Ür
L[~>×:á€UÚÙ_Žø åŠr˜ð|Ã–]¢›£'HŠ0éz|ùþýwØË-«ß”C&#+šZ£Xn¶æ«NNÁ¡ðß…™›1´,ŒP8YÜ+5gŒ‘%Ó+' â–ƒ¹Üeø¬FmqWˆ–rÏh?â°Â¹<ÚÏÉ¢‘°|£5¨yÔ‹Úzt¨6¤qÂ™~@?‹{›ÃïÅÇì åT°È×ØÔ±ßËõÒ:yámÇUœy¯¨Ä¬±=_jçÇë¿Ãæ^-§•¼0‘4!SI=qßš\;†”®&ÝÍÖÌz lzR=(Ÿ*~Åº}àLìYï é×!iHÌ7±AÚòjšÁ âZ+Ï­AW`¥~’ëg0^;¨im£€ý‚Äoàt#SVÉõOV;z¬¢â"
¾–Ád«ƒRL ?ôŽþ@ ËŠPëñ†‘»w	‘ŸÑçrÕbx”šÑ6ô‹Æ ‘N«eTØ‹1­d?†ñS'sds;pì}Tý1ji,zHÝäåò†©O}j~»3+|Óí·
·½<hÒt<Ó+óL±`ãÍÍ¢ bÉö9S‰ÀØ¥r9E-ÐL§.ssÂ\t‹ã|,µ¸=2{—“užJÅ¿Wp®u¼ƒÃ’z‰ëº31.íppË#ñL¼½fwÐm·:k»Í¡GíóñÈÔë0Cës>9Õj”S´`Dˆÿ„Œì86Š¬„ò,Åj)®ÌSñ¸®Pç±ëŠ²7^è-ÂpÚ{®ò‚	HÈ˜T4§Ó‚Þ¿„(RL)tïŒ
S}®C ~ØCýŒtIf:Ò
SÕ0Í ™ïþ¯Êçoê»àJ¨m}çá¸I9u!×GZêå“”ÜNàTóHÖz¹4,Þ¾ùC°Q927{ð4´^§müu'ïÈ_·r¼ŠãKT*;{@OÒÃG-ùoaP-ãd_Ô¤¼öÖþÏRZn¸oiÀÀÕ†ÓÉRM¸$©#ø|ÛüÖ¦ 15ÕkxŽR{Åo&^Pƒ˜ƒ¦ž^W"ôCvãÈÖ;ì‰?“7:ß€™³sË/²	ÔyáÊb±rãÏõÅ`)HÛ{â{‚)ˆ—ú÷ñRCã‘»%\‘;€2XÂd¬†ó–ó>ykþùÔYå)lŒ@l?7•` Ýovüœxä6Ó%uHÝ"²®,vaC°Í!É`ÍkµKã·r°C¦ÃAœë$¬‰~Áš-µ²ëú°i!¾dÕ‹›çvVõü £íï¯ºõÊg–8ƒsoåh?ªmç×ÌPÑqN¬ê‹“ùÂý+VG×$°Ò#öeG´¾mNV·2ÅUéOÁ»ªÔpúÎ[ãhm°º*u…€ñmØ&ºqrÓTfà˜/®œÙ§,í#/OZLàÔÎ™:¥;qŒ×\fOP½¥õ¬Y*‚¡gÏÍ7ãè×Ëåúc0 ì¥@Õ“UeC„]@Twøs-à	®©it7ïsË§ºv,ó¦•&äŸ	nôÌA3Ü]âVÇø
îHƒå….?‰ÃH–\ó¼+IÓ\×Û1MîöÙ¿÷ipaÿÍàùŸ0íËU:x£m»>›9ôBØ)|ªî'õQ\8}O`Ã:e±~ÝatËOÿ¡·‹ÇqƒÁK‰rÐÿ°tWwnNð³¾HX‚Î˜?ŠrƒE°6X¹ßãæŽT[¹çßW)ïåýåÐæ°{üšP(NóX6jõ¨Iý—*ÏFbIÃí!v¯¡§Úþ>§mRÞŸþùèÔnˆÝ=}t;o^F#áøS‡ü\gSìÿË³µ±¥…±Â‹ß^tþ†%¥C|§„ ~ÚÀõ^× VWŸ?ÄùÉ‡½6eÙË`I•‡ž…¼ãå3ÎjIÂ„ûD|¤ÖEµY‰áÅ0=¤°V7¼«"mïSèÇ3=ì(d
©¢É§ùo¸âò*'Î\´ÔŽ6Âù¬i‘0iè¬`›ý—³W`¡ðû¤ûÉ\¸¼Åìgu	ë8Ê®Ž²òa£‹(Ô.u7ÁÎ»OË7°MÅðõž]8(‡—
³péŒqŽ¤âÛ´9 Ù·*_|•Ö†Æuòõ[4/`Êä¼ÿŸ>dF¤øM>c»í=ya{lY¼SÒ=eºÏæ\Ä©yý÷KaòCáú“\™ ¿@íEý†ö|=½lûÊÉQÜ8íj{þmöñï<¹áBÀéçž•ÔMÃR’¤#u¬"tŠyáeÑº£	K’áäIZÚ°ÜØH/'D·©„Ó4ñojÍå æ;£ÿ>N×ÉŠ>ZƒsrÏnôbÇœ”¿ñ(¤çì¾ác"Š[Æä€¶kHÊ2ÉW/ó†òÕìÃxé 9–d¾çÂ¬ÿlƒ©ŸÃ2O¿”ªº3¶‡Kn\˜NÇ«¼gK`H7\_~‚¹^Ýcu€ù³+âoú*±ÛÌŒÃ¬¬‚oP:Ë­ð_óñSšSj8'rwp¢½²¢müõ¬)Ûþz?ÿÅ]
lÝ%iíá‡æ»›žƒùT‡Ÿ6œQ»¤œDºÛ þÅÓ¥¶÷jCC¦Açû§ÏôZ[|ÓO‰VÜÆÁ}ÒâÕØ¿›¿BtÞ§o™½¬ÚÀúa†¿`K>ßÐ²<*ßZ—óÆœëz–[K<0m_£|Ý/ÇöŸcTÚƒÃÙ¶2'ežÀl¥®fÂÄL<ò¸QÓÍ·(ÂŽW)D,i•%ž­…•“-ü’`ÁõØ¡avYÈ5ÉM¿!¨ƒž¬¡{‡ û/!¶­Ï3½¸KïÂµô±ŸÎWØ8U­»Có©Søo{$Bá¹i»˜«³.U+\d¨ˆ}ˆä·cõÒ‘u0wfßLy£6ÎõÓ'M"% >ÏÙj.ÜÑ<IIàGâ…[
Š¶qHr8gÉÓëŠ†.f;xòéÏ=­ÒŒË€IØÈÒ»¦0¾r§QaNz²OÆ×?Âyj	¥×eP 8}«’sLVÜ“¨£ƒáWöäÑWØEºYì9Bä„¹q¹–Ò¢•¤»ˆ³/¹–`ôË…²¥è ZÜwx¹º+©²kÂÉ1óGŸR?#ñ¹Ë7ù~\xmí® jÄa/Å	ÆoØDø+ÇÒ¿2.YÆÞ/ØëÂM;eÿDÁDÚÓ";~b’ZwÑÍÇË8÷ÊEŒf»	Jêí˜ëÐþ é–OÓÓquø6ÝŒ•nO…’£nï¸bÇ‘<3wøq–D>Ó¤âhûÉîá‰¤b¦Tp=£Õ{Ž&‡ ”Ôb`¯ß¶wé)Ü0¬Ã™Unÿ°2+|÷¤ ^ù.LÅ°Ë¼?L†Iši^åƒv0’(bwX‚<]âÌó×a¦Ù^ü[Þy,º·qù1/Ô$™_nÞˆÆçËå4Û°ugˆÔ—K0«ZYb«ð“@#7§!nÑÄâ?B{51{nÜJø~®jô—leÛ`±ÆÓïœ!mŸÉÝ‚´]p[æTô¬û³8hæ1BMÀ•¸ç¼°Iëüß3+NXÌ>¢t˜õVò›þ+æ¾¼š¸]°Õ:šF)yTYóÙ}­Ä)—Sc¶»îÃuztò}V¶xêK¯#W½\NÃÉó¶ØæË8lzÀU!*í2„Ûµ<atÖTÉøû)œÝ´®6LV2[o†`~R"/2¾ùjcê5·,/Ié?%fNb94‡‘ÿëvÅÒ@ßóüPÌ1?Ñ*Í—…#w
ùŽ¨âÈù¹Þ{Ç±½7ãðÙ[½ÐfÛpƒ÷c.f^ÈæqÂ•r[%æpql;÷;“ë:d¿Š’ðeöBæF®	o´D?ÔÃ‰S3\ø—a>Jå@áS³m~íïÒa¼„¡)ÕŠÙ@Ê·gÐùƒ‰á]×b¯‹åïØÅÐÚuN\Ié>‚áœ;Øzà4ŽÚŽG´qÁ,-oøî3G°Ñ¡P…tå#Ì“|;ÞMžNÓ—vÄÙÛÿªëNOAp«¯ ’<ï™4V×`§²sj­Û$ªÈ¼24×‚ùš½!ÁtJ0fõ…!ýØAìöÕ¼; v_‚œå^(½ù:©Ù)gòe"ºCOp<³ù’X¨tŸA•ûMÛkÕÉ¦8øðúXÞì Ž_.– ò™á[{·9òÇmò‚ávz§ÝQz†Cîêv‡(`QÎ‚{Ùž!ÙUkÝß…æÏÜúy³@§8­9õñ!vðã>®ÿr^²7GŸÊ„ù²w?JÞ¶aSõbÐE«¸0?ÁeúÉ÷Y‘‹9W(œiqyQ?:AÔÏµ¾rb`ÃqÞv²Óä_õÏ/s(ï21%¤.ââØmãWÐ¤+úNÆr›côz´¾ÂbõwÁð8œ=¨vHîÔoLÝ½óyËIðŽ½QY†CbÿQ–Ìßc¹Áó6çG¶0p¶›ôÚ,æì«n§iÂªä³óÛçØÖÞuÄÃšx;û§-1$¿²‹óÇîÍ±<ê“0µú|M‚;'~ÌúÒf†Œ}Tù¨Ù~ÈÒºûBŠy©^¨^Äê_f3ÇåÅ„Š¨=H6¦ô¤Z>ÀAËª`zËß˜«§'¸Äc@ å´`–¹0ƒ¬‘´Lš/qT'SKÂ9gÅúCy/´öìtða¹ã;R^_Òt…ùÂKL°`éê¡Á÷ßÔlÊµ/½¶ ÁnÑ?^»KæÔÛ/–wcwˆìÂ¹ÏŸ`8ü³+ñŒ)ö|<ÿb9æéŒü•Õ»qÄZãã…œ1ì‹Ýa.è©Œ}á¹O~êÆO—¦kë‘ÈÎ|~2ù43|£^JØæ+»?Ñ
&˜TÑìsO#›D¶Ü=®@ 6[RxA%mþ6Xä‹64¬ÿj9“„³ÞÖ)ö$2½Ð’:íŽóÂbÒ“Xaš<T%ç?Ó¬i}RñÑ`½ƒìˆ.l¾'­ïàÈ»ÁF8,ü§j¯3n‚ä+ó"’íMísùô'½6j€µÓP—}ïÝËcÜ<.>»élJôYæEçã”àDä)“7Ðwîü'Ëº!ìº%ü”8S_ýú¼§³°E'åïa‡"uäòrL•J_Ì
k†•œK»x±:‰¨üÍû¹/i_IšÂÑ)ëNXì‘æ¥¡m•xTâý{8fx€ÛñH&Î¾Í{H…
+é4ÆnÜ€–°û©°#yqæqþ÷78XöM82ä:Î*5kF÷@gÒ.n)¿x ]Wð+ú&³ŽIþÚÎõ•j…$˜,z^%~Éûg¥¿ð`íS›¨ƒø|ÚB†g^Ø-ãÈ&ÍÜˆ+U¥Ññt­0JÙklrA¿Ö¯›Î/ãÊŠ÷#“·`IkôJÄrŒ9ÈmeäN#‰?Ë@-*µßLÝ¨ÿ‹ß¾þÛ5#QdþÝwÐ§ïV¬èÚÕE¤ÍŸ[ÖHâè|'n¶_äm¾ýÏÐ”©¾¦qœZdgßËÀ8Öœ~#ƒ	>=J0I÷1å¨”Îk÷&ßq\‡¿4aîÊWg°9èc§
ñ%ô—r =¬KzI—ÀìNÓT/œä6ã&¦œŠóMæ;bPg.SòŸ-Ž\pýfÍ÷Œ~§›¶}åyÂö\ú÷øhEƒ5ÌÚ^¨zô_Æïè¨Ïéáðñò_äá«8F¾q‡NOIí¼v,â4½Ge›1FœüÞîñÜHÒ·Nõ$@ï#þuúM$-l´¸‰A— áuG²Lœ¸©M=|êyŸúGÀ¤“ýÌýW`æ„D‹jü‹Y)<ÍÎ¶Ÿ#çµÀbL³Z½´0t©ód¾ß|Ži—†óÂ’•a¢ôÖ0­˜
LŒïm»©à›OÃž|ðá‰& ¥«ì1Ýæ`–r)9†ìI<Ù¼1Þ…½RÔöíÂ¸áÓr0ÜÇýJ¾¶’w­ä\‹\Äâ¬‹®Ú4tWß´ó®+D‡Ï2ëÂÞ~é¤ c7hžóÉ×úÒ
k™¿Â-¦¡Æ’)W¶}T«±°÷bI¶´øž˜ôA5þ¯à’‡¿S¸µ ¥é!ïÔy±#}ÌŸìŽËMûÄÃv 6ücŸW}ñ²ß³°ÿ{ÇoÔKhžYÄÞñ5cqË3¸¶¿;Üm×HÕ³ÝÁ±ð'>v¾Æ€éÁ/–¹/ÝÁqW?>ÜÄ¦3ÓCR’'`ÎÚåÊÔ¤&’Sí«çÕ`*'Z÷»à0¶ÊîÑ>šá)_¸ØÆ@ÿzÔþ›Ÿ·paº9(æ~.ôKdˆùû®ã4G”øÑKdlŠ:b^/6	ä˜û½ß¶ä0®iWœŽC}Î•Æ:`»í»ºDEšÔ9n]ñ¶Zì'sÆ±ûÍ½OáÉÖ0³/„N!Akþ¾¸~!ó&>S÷Úæò{m*z"êr“£ïÙc7wóôZ	ö·\ð’‚%r2)9¾zdýrSží†Cº½}Ý0dU®ßµé‰äF·nV5¨Öß¸èþá6‡Û­œ„âº);õøýØy-ènX¿­ßj\ÞQˆ£O]™y™Œ=2dRˆn;Pô<çÍÝ91ýF°’b…L;¹ä
n@eõÇ+=%P·e_k£„£|>OÎ’c}VŸ³fè %ì®KŠÄb<‹´“48¡{ßó[õI(RPÍKáÑƒÉï-R¼ŠÓõùÖûªaºìëÇÎO1·½ü5qBI£×°äE~ú¦ýEœ5õ¥<áE3¢šã®qÊÚ,¬ð!u>ÕT3ïéi\Þü2R¶ˆÄk	þ¥·!¬ß¥Åêk²ž¥Ã‘¤’Ï¾r×Çß'§OQA~F'ñåö¤òê±?eÅ~»™²÷±8
Õ{Jhqæ†ÐîÌ‘b"·!Y…Íq—õ‘< îÙ÷eËïv[ã
»2qþ#ïâ‚1®­/†Gí—†ÊóÒ=¬:	0äÝm×ÅÅŒ?T[u öy?#ÉÂ •ýtÜìŽùÈ‘].…ï…i´Iù°¸Ìÿòþn Ùüþ¾\CŸŸïžˆ‡V`Ö:ôýj>5¿_Í<,ôÓ®¯Xb½îfYÂQìÜ?Ù `}Ä<„ßÃ·1§‡±öù8à™üÌ´(’.û­xåBÃ½½÷œwÉ"z¯â/v©ÇÇyÜJÊXð×ëö8!ä'”pò6u\¿x¬TN_²Sm	ÄîÖÝ¥}.ŸjÏÃ«ïÂ+`Åú~FbN>þã5àacÆEÞ©½áÅß±›#{—’Ù–lÀ9‡O»©R$`úg|ž@Éõ|ã<«Ô|°²TüNd?LÞ³Š»; çNô¼×´+~¢Ï•™ÛþÕkV’
c<6Ñ¦‰0ÜwE‚m.[Õ2î·ªã¢pJo`×vs_7?akšBŽßÅúVÏ2²9vKF02›'Ã«äaEcÿ™Õƒo!†ú£1›[6Uz±mñÂàrÿ}W€N¥“VŸÔ ‡¼y\ŒÚZ–†f™g/ÂÔ¨(S¼ÌÇ¤~·0òÁ¥¸û¦µsJÐÓ­Ës™®0Çåµ¨,vOèÔ2¼pUt›§cïQ=Ì§å84 MÃ>}­ÿ„ø û“…D¬9	6„vt)‚™3|‰A¥VÐšÄ©ZãÞüò7Ä ?å«‡ ë4ŒkGkHÆÂ¿6#¶¼ÍYœø[g˜FoKcâ–¿Î·"érqOÕÄ.¨?åb‘ ¾½ê=´?öA¬ºK^+Ï·¸gåëaqeÒ§BqR˜Ÿiç£0$Kj¸³Ò„“Ú;§Ì¢¿bý°ð]ÝÝ3d#þÅ–é—ÚDÌ&°ñÒ—¶cñ¡ÐúCª‡ú¢$ˆR…ø«aûÜñ‹×€˜ìë1çÇ /Å´Ñ åç•ýÞP±ÃAòÅ/"ôàï©>Ìï(§Ã;7äpnnæá™EnhÄN+ë¹lø¢<K`ÆZÙÍ8'3$üs?ò÷O‰–©ú÷&”nÝ¬£ZÇ‘__žQïS‚Ñh+Â¤9úöÉ·©óÛõ¯ðò€À®2\{®?ïâ…äËfu»í|üíòmy?Œœ¿ìLrâÇÞ²²Ü*¡±~Ž³Ócëî³}$W@Ž^AæÌ9,ÝÏ’ÄPýfY±¥í\û<zK“¸‹@õŒç¦ê¥0xƒõŠÀÃÎmþÝ¥âÈ®‰}nË…9‡CòØÖú¿¸Ùç×“©ù ˆ†Y_®0NâDb3ù‰çy\<ævÿ§•2PfSZFqèåƒüÅ0¿Â«÷ejÅº	×Ãì+žÝŽºÞØ¿X»OçŸ’%_ëHÄ\‘yµWë50|Ù…ÊaQ9ŸŠña@È© Ø2=¹;þNe>•Ç5'M91œ>0Ò§[±±‚ã«8yÁïÎpG’Em™Ëÿ²Áºâ¥€È^ x‰êÖÁpoE¾ö¤ÎrÊ>ÔÄ,êó¯|·aQäz±Šû?œø÷zïm·zøvë÷Kge ÷^ÿÄË$’«ns|;jŠi!'¤™Qó,îœ?Pjä¡%ÉÆ,œŠÕŽM«ø	¤UÕÿÿ„pKˆ¶dÆÜ½ûk¾…Ãj¢d_èÞØ©{h+GZãNêÌ`XªÊ %žŠÖ)+‡òr£'®×c•Áñò‰½ùT®¬µúC0®MQ-øw7Ÿš‘èv¦N)ÃÓ§ÞüúƒJÆ¿˜@ÿ½·qhüÆ:ü}æk¨Ù¥|gç2'Öo8$ð§7Áœß¥u[îtèÿ}:inïÜ{n>™ËÖ>Èµöãà‚oÏî~œ?©üêé®¿Ð‘cæíægc;µ<pAE‘+.À'#¾KNtÆyÝßÖ™~Ø,=6G—–#5[œm"°õ‘éoí¾í÷q)“=»¶ÓŠ?¨î>ÀÙX*¿C;&€l¶{Œ¦7w¤nü€£e«v¥î #wÅµ?€«2[qú_A˜Zy»¢l<£Ñ<ýßÿBáuõ±/B°Ø^­Õ8¡…ÓTwy8ê<¡"4žÙûÂ",$Æ
½¤Ãé‡$Æ+†ø/Ü–,ÿá1”n–ÈXßÁq×owýN;æïx!¦!–zjY'žSöÝ‚É·R2ò©0)‹{øyp¾‘¶q!SŠZï,J=†¹¹\&>[[ìîÞÌ<ûX{Ž9P%a¯_ÉÇ—qé0ùÎý£€gPnÿ ^‹oRõ—+w'´ üóŸèù­KØ;pHÝøçd¼9d{¦aúGÄß½'A.Ó÷‚7Ô8e®j¦¶¯“Këñ‡­ã£­ŸÄ—a:ýÜà#3mì+|s—¶æ˜u¸îÏÂ@¨_¼Ê„<ô9ü‘È‡9™ä$—‘b¬âbÿ[ÜJj³7ê‘´#èf\;tŽš¬õsc*ºÿ•ÉÔÂúûöÂß®â¼ˆ˜Q²öY(Õ"ý®'C¿ýEc&¬º™%Myn‚5aû{{w²aý®¤sºÚ:£Ñ¯Ð4dØ²q˜ª/xˆ>ZÅ±r"Íë½ø³xì“0w$Î	•{3§Â¦¤Íîaì›Óù<x8ªlÆLÄÏ^ÁÙ)ßÚv©C0ÝÜ×~èbÖ2èý]§bÖý6¥J J½q©­>‹S·õÔ*B€Üüz_ø{èŠÌª¹|ÁÄ˜rºØ¿-‡¥•mÔ$ùÙ–
€Z†ë·nJÁZxz;Ouæ^m».òçˆB~a!KP§Uoð¼gˆ7=Aãj1¬TÄœ»ìÇ”Â“úâ
lØwÓ5 Ÿ:Âø/Ò’»fp×Áa½ðëaÉ¤%4òÓŽ¶‡#ùê‰ñáÓ2Ð5ÿ2°ÙggXK2aÞU{ñï»O8Ó Bý\*6OJ¯MÞ)bcñÙyá>è¯~Õ³ñj¢Lïðÿ„…·Ú]rbUs—Õp¼|`=&(×ïî~,´½¾2‚ô_£èõLšñ®È§ª½ñÅÒÅZÛ„…3½™‘¬ivž0m/\ñá`´+•~fnß‡[ªÁ]o¬a"…$IŒ­	ëÚÆ‹j6˜ÃÊÃJø‚åF«#‰ê°n¿#=©¿»Ú¥}’í‘¬R–¦l­õéábË¸L-fwžë8®‰Hõ0Í½_yëR5^æÝ¥~†þ^„¹$)Hxæ4dq9ÖÎßöŒ†‰´\áŸæ½ÐÛühß‰Û}Øc~o2yyf}9|·?ŠåQNk;K\prGsCå	˜ñäyU~ÎÛ*Ô¿—äÃ&G¯Úò‡0>à|J/kœY,þ¸³@ÇP ŠÏsO'µ×¨.E#e9ñåŸÔÊæŠTÿ×‹eQ­OÎA¿Þ=
õzv˜_1ž²ü€Ë‘GÄBß§a™aõº ÿ&ÌŠ<d³ÿ©À@kôZŸ÷¼Úsf;å
(‡Ý¡LŽ%DÛ›ˆMŽÓíëaú8÷üÃœÉC~$òØ˜ªÆy“]u¾û±­TÝ¯÷¶#äG/t³e(B±K­—Àê%hTü—ÕmM—©ý'šƒ³‹(áoƒÓÉ<½ñ<™FoFë±?÷øž¯Yõù¦c§kø•`Š­T¡?^ˆ¹—^ä&œÇÑYÝE…HVö#WßvÇ©2co‰/ÛÜGÊòÊ=¶ sÜ¿ÚºîßBRð»+N£¸0s$|§®’$b:M„B1Bh€Ny<fÚi?ó¥ÿ3Š%zþ¸Œ&yãh-4'hŠ­oEÊU‰rsÏ4Qê2Ú5oðÀbU•áö7ùtA5ß,]Ày%ß;o…^`é)·ÑàkTØ;•#ù(ò,fþv3LZŠ€eÛ9_ï-X ©Ïl²Üâöö÷¬p·óíÝÊ%hë)^^­ Ç‰#L„Ù\{ì¹±Ñ}ßº:ŸªåwcÞSSìêz¯ñ²…îïåP„A»&ç¢áQÌf0ñ4ÁqÊÒ5MÿŒå4›’lºX{âxòŽÀN¨ï|ºß÷$;Šyá‡‡$ž9¬²¡‡¤ÖÆ/QGâPò{ç—0Ïj×NqCÒÞÞ!.{X˜RûB©“AŠGÖMf—:©ˆKîÍ¯þâ$ÐŠó¦r‡‡j3ÊÖOo˜Ž;WßÝÌ„ó²´[Ùz8ÿB»¯Tt7,œ¦Ôë%Ð¼NðÓ{’KžŒ‰ËŠ¡ë„ÆKvh›ï2YædŠ
Ûß±f\~Ù¾5}÷?(¢¼šÑ	#ìîIö³-0˜úðÍŠ	tü
k<^ƒëò5qæ×—`@Dàeèp/æûñÇý{½ûK}ùÉÜ¯`äŠmû_sgXbHÙké”‚“lö¦ƒjÓ8˜¥Ñ»ÒâŠIR;k¨V`¢‹»Æú¡0{z&^ëëwþ«ÿÉ¹JjSôØV”{é¯Ÿ'îZ}Œ‰Þî¼0ù¼çºÐc¥“×î#Ø¿ÔÁrºs{Ÿ²¦ü¸Í y.‚‡ŸÄQvçŠo€‹5_LãŒlÐ‰ýŽÃP±a‡ÝŠq¥“§UCÁ2©½»iÙ’ ×6ÞèˆÍoèºz5äŸ1ÑþW-M4éR5ôß@sµ¸XÀMþmNôüõÇ]‡¨ÿžíV¡Ç|Å/o²³ g£w3¼²Ì·`‚.^líã-]Ì«V~Na³„žå7\L98µ³@ÛTj=Ï„éBšOíË7H¦Áœ×¦Ü•8hÚJü¤
ã|kB}ßÒaX¬ò-ëm\øU›(5’d¦ÏÑÿEÂ`ûôµ_%¸š|*á(’è6HÕÂNÛ¾?Äë™n˜O¿_ÔîO¨6?ùY¢ûKwæiØ·}€¥ö÷ü%œ+¯«¹ÄÆ%–é?Þ3¿ÅªvžÕ6*7·CúS8v¢³ÈþÐvÿ<¯{Cë.N†»_¼¨Ÿgx«þƒfÙa­ï:MØ¢^X/¦Qoíèêîþ‡}6|VFRA0o!;6{Kºž§|U¤õ‚¦ÎR–~çãHÞ'~ŠÖ†×Ò9÷®ˆæSÕµ±°‰Ÿ„‘µ¨‚EémŸð¥¡ÜÒº#?jŠ¥.ßÆrß
=C ŽwuøOÃa2ÿÑ@ƒaX4¸ÐCuÓº³?þ©Ð€‘ÑMÏH_m+T˜1±›„ªC±‡úbï×Wì—`NVDØ{ 6¸ò¥/_@4»|I¿ÉKÙŒO‚17Ç#‚64›Ý#_GÏ¢]ÅûìfŠ°,»éôPî.Eß}&NÈÂfþŸCâ@<³¯æÔ2ô—Ç-™k`áÕÅ…Eýð÷˜qç ´÷Þ{rìé4ŒiýnvPP‡YÓÙXŽo0Ä“[XÿÖ–g®ÈÆêcá3Ñ,õ›50j/V¸ßÍ+MoK¾Nh…™š§kÁ28{ïË•î$ÿ5oIûG³‹‹›=Gâ·ÞÃóg­¡agÎû³G¿ ù>£ãÒ[.èwŽÞÌ•±„ÉWw†ƒ•<pÍŠÃ`Œ@…jÑâ¼«Ã¦‰¼ãSô¸ðÅ0Ékä¬&´¾šVÔ‚*Ó?½ŽøÙ<¼|„Ù§}'ãÍp ^Ø—'Kšòfz(ó!±„éWô‰^U©ç0[otL^Lùpú;œRÕÒÇ!±äÇ_0«Hæ•ÊP$F§³ÚdÂ?¾}k¨«ˆ%LÎBbôÊ0Èø²:²¥V.¸óT×_Ãa’Ý›.lpåS(oÐÒß9ñÞ/0E«ÐÖÈE²×i^Õ‚h¶ô\VÛ=8x>Ô`Ÿ5P4ñç}ZÞÛ°Ôô
6Ò¢W›p¤ÈÆÅ‘‰Àx]']%#gHÂOÓÀâÏ^‹ÇÑ3új§ù‹s0Öµëa=I'ÿ›ÎxÀ‚ÆiõåôŸëOvŽÅ|C­7Ü +îÀÛ—æ²0•ýÇø'Õ¥íþÙažÌà3ÝbùOk`ïr„I6]ÔwKüzŽjóúÎêQÂ¾žÚËgqõˆœžkôÔµˆå\§FâÉÐÒö­XØÙRÔ×ÿ—SLÔ¿ËÔÃê™!Eâi$²ÖU=¸© Í##ÌÕ:S°€¬%§c%0?æò”ˆ5#–ËžÐ˜Øößè£ˆ5q®8àb…­4x'2q×x¸è|Drìð=Ö—"0@uò?T"c›8ªKf$PÅÕgÐ­â¸šy?Ã)æ¤,ã÷rHr,}Ía$ó¯DFUþ»ƒïÂÆÏ’€||3¶ò)ò\oN-äSiV[¶	v˜ØŸ¥
½IªYNÂ¶HžÕ¶•ø#7Û-+q•³À?¹Iºî«õ(SÎçS=íôæƒÖ¹€ü6¾P\`êá£3[„¦exnI
fs±³ŸSÇ–Â°BM%,eêhO.©KÊûwãs“Ž´cNF^KTyŒmŠÕÂâ¡LP?*}¤Á	†¾	³sÁ¥Cç_L‡ÊW¾ìŒ@Òí»¶†Ûþ³&šÀé;`ZB2þ×A„Ê„»Ó©mátBìµ×Ù©8ì¤%<ƒ“Â®ÞÂ~-êïçZ®bÍî¦`ÛI©à¸¼Öý/ÇÕ<CVï`îâÀ]Öh;é¥ûí£$f–*æ´Z‚Î=9Ÿ^U.a3ÉüØõÊ èvr9eZü
†KŒ4ïÔÐ#q!DOJ—?=U'ÌÉú"Arˆ5§kbwÛÿ€5-‡Î^µ|ÜbI­;MW×[ÎáLÕ/éeò˜¦{hÑScMÏru¿àpÀg©?3ÕWÉÛÜ¤‚SÍY¥Ü—aù°ÿ£/âË—êýç9§*L½`~2Ó»¹ÛÜ{#ÆwÂ˜ñ­ÑJ)ìŒÝø7iZ/Ýç‘Â¶ç?gå¥z`p½ó¸ùe3òäùþ}ÍÇ'&}­Ò6¡¸ÅBìÇA&¨¾$›Ñ»+5Ÿf1íÃœ±n¾ý¹NÜ¯Ò½	ò‘C2®ÕãœÊÀ´ÜE	œsÓŒŒ»ÍÿD_\NÂ… gµŸ`ÃûAn5PÌ:ß°I»ùªÄFk–#®ëå-‰ÎÀ¢þ^]«g@ºö¯Êù¶n
Æª3]ƒ&ç¾ÔÂnoXP!>{fc‚äÏ&‚oÜ±)Ú¼RÌÚcçyßòg#)cóŒ×©\˜ZÓØÑ|³KºäÙfí8°r¯CÛ»ï«Ã–ù½°'’°CŽþë¼É ,‰´ñÉSýË§ºè›Á™Õ«¹[2¶X±$0{Rª
ýÏhg?ÉÈg´k@?hL=dlŒs\FêÇž@Ób¬+qÈêûžÿ9L?‡£¬;cÇÿëÅiÕÀ€SM!ˆá’œW‹©piáòÉ%š)X™\­-8{²ò»;žŒmóéyysåEl{ât4pÆ&Z+¯ŽÜƒþˆ€þhò,ø˜{ê+$Yæ?ŸÅÕ£¬:§H8ÑhÑÅ·ù	»oëÈ˜{‡bÖ~¥±1;Ð‹ùW›
ôæ«úD€MÇÇòeX(÷ásö{€ŠÊuPÎ€Î[ß[F	VÐ¸q\uUM¦$¶§Ê+ìªÐ³f[€Ö«¬¿“ŽVboó†WŠéUØÐ*—ãjÁiAë°Ì÷›´'ÿ‡	/þxûkâ[?”\Ík¢u8Œ­b’Ì¬nœ€ÑtýÒØxëë»Ä]P]ÑÉ0Õ¯ÜÚS)àäå×Z!ôñ8ðý´IiÞO$¿øûì°,ÖÍ\’œy=vÝî-ê•0dÔ(çÍâ“9¿Ûy^@Ñ¥®²¸ïÙØüö~ë~Ýd˜¼.{œì†ÕÇØ­M¨—ói.©ºäüè…¦]'DÌú¿CßåÃçxsv`ŸÏÅw¯[¤FIá¸ˆ;¯Âo[²þAÓÞªhÏ¼?šùHIû©’tú<bu‡ƒ]¸ös­Üéü”{}*Ž±\jÃ­·âÄp\šÏhÚï‰#­ã×.ÚÂDeÊe×T6hÌvt›ƒï>¿Tac®©õO›5ôQ§ÿ=‡1ÐèÙIÃ“˜ƒ}Bã”|æªª!@‹¦xeàÖÉì2™‚qqŸÐ•h:{pó×uìÿ±¤.¥X†S§YÎ–ðäÓèß:¨
H·ÿ6ÓòjØžŽ	|Õ€ù—am“ÖHª”q¤0áàˆ8‡ï‚
½ûÞ «=IOL¨yqî]a})6“?>û’xÚÍº~äôèãÆÏ¦i¥åiøyÄ»&êØw¨±û<Þ"³«Ó[b[`Eð'±¾t‹®Kq'På¡I¬>‚Ï½ð•œ@¢Ö“MùMi˜çêÝ¯ð¾ICì¿¹b Çêñíù;ÁÐòÎaŸçƒa$ÕÖE¿Ù€!-v?¶ÇK8v¶ÖX~»¯vÓxßÀÍ>«lÎª„Ï?]§hÂB™åÏ-³_0’on–ž„Ó‰Ôå’ÑUPnÜ¾ðQn'ô=`»sÛŸŠÕÃ?îþ1‰5V•¥þN=HÉ¹¡MÖ †¼Ë.ÿvÁ¸)Ë3!Ññ3ÚQyºÕY¹ôâŽa/mí¥¸c#¸"'Ÿõåñ.X8{”QY‚F‚Ô˜–°Ñ{ùýžøIœ[ËòM†!5{ÙÕ$$%þ%Â¤ö¥H	ÙïØÐ3Áè6-ÙÉã„¨/Ì\¶QRL¿¥ßÙýéþƒ1ÓƒûÃîß…Åù‡öé^­Ø>k‘vïwh÷0t6<J úøû¬êm¨vŠüçûÕž3|U~Y›WáÞ>V ôs_}E]e¦	g±Æç^{Ê¾œ5?`ÎÖMÝ.ÃfkX¼Nmúð?\ Žy°"ƒŽÔ©“NÌ8ú@˜Å}åä´(ÜxÎQ ýíÃ—Õ&¡ù³q{…tìø4³[p‰N¼î`óëÑð•…0ÿ-‡Oj+Jnø™|ðürP÷4Ù¹‰øAz7Îù‰6½;÷È4y¶ëêø5C
KIú;ŒeOÒWßnjØ¢ù$Ú’|úOeŸ
8w†ÔÓ¬€ÉE¦µº—zØsË{Èêô*L¢|ð-?³Íåòja%VPgµÒö+ :*NÁœ–
<çþI°tPZ_è+·úÔh_È€e¶MÚ™u@äQ49R†éw"g¢žd`×Ö(õ‘ÖhˆdXñ!ŽÀæjcu´0Î=›õþ›’Om¯jÌX
”Ç?ìÅ/ÁŽáŽ	54ÜL;8:ŠÍ=\ýçW¾ÁÌéÙ
;œ¿o¶~š×>h½Ð¾†£"{5Ççáé[âF+,ýå'‹~î¹Â)'`]E•ƒý8Ô¬¶0D¸FÃ/rµ4béÅSæŸºäÉöH»Ç&2ŽÖÜpý 3IYa)ÃPÈöùŽb-vD/ðr7C;Ë3ÉÕ‰o*m¢AáÇt½²©y”ÛºZF6~¼Â…Lm…b1NÞV*_)Ä‘{~{Ïíç†æµ0ÇËHŽ¼æ¼ºS7/Üâf¥9ŒõNïçôMqJ&ÿ`à³íºßš.ê@bWÃ`oŽ8Ìp;×Ü„ÁÓÍÜ;’pE×˜ßpg#¤–|ì{5qH‡Ï±JKÕà(§M©u’‹q9Ý-%~¾7¡{°_@p@}ùÎmÒö‡sZÀl¡ì¯Lau˜\W[]*'Bß|ÐÇé¾‹ÐS¥sA‚Ù &8+_>¥àLLw%Ý~\¹æÎÍœŽ‹¾wê.žÁ~ã^Ê–^6¨èTžˆ…Å`´™:…d§«éeÆ³ØÁàÙÞNr‚7~ñÙþ8÷áØ=4»ƒ˜)ym«ûbmœ¶;n™Ô5¿­AŸ¶þ 3jêÚ(`ï*Ÿ1“G2ŒÌ–—ÍÌ.Àæ{6Ù",’9mizÏ
“£>½"o‡£¤ª-Ë¤³ØÂºÁ@³†kšoÝ'-ÀÀ‡	j±w¯0\;üµN&6R¡ÐX­¶^ÒVïô°æZt@×ëÉ|:6ASÚV’æ
±“!ê×‡§UÁõÂNúb¤oV]gþ[†]Cêê~kàjr§xo)?.ž!Ç³Cmkr°.Û?\œs~óH|'›*k]ïCº›ã’»:3”ˆç_ša}ªèu³\ì8±!’¯FƒƒÍÍÃi¦C8Æ*ì¸°È
sA"_`CÆg¹¾¶ÑP1ÐL&œ‘Û´,w¤|…"kÎ}pIäë}X|àE
&LâLªŸÓûsW‘XPÒ¼J]—hMÝ×Žârò2•wÿ3XwræŽ„áßR^ü­’‰¡³°fÅ¯lOsô?G$µa“‰JÐñÌDÏÅÜþÊýi}©ü[v¸þ6ö%½hVÏ™Y“dÏáê£â|'=6lV/úM•H†R–ƒÚwÐÃÀÅºõ:á/Ð}àOÇ“_Ð_ÇõÞ“~ìÜQ&Ô¡ý®O$ŽÀt<ÇýgÂcX›ÔÇ­ï‰gxB4ü½¡îÏ=âŽïÚ+À¶íAû½˜ÃÈ™0iUÑæZ™}Üvô”²ÁÖ¡åÍ‡qmm©ýûì˜¨>}ƒSú.Ì™â&ºåâdz+çÛØLüUæöM¸^Gh›óZ;Š`:6âXT ;NÎ©»gÄ²ôÅk—½aø¬(uÊ>^œ{8§[þ,”vx}ôäÅ¥”â*-èI3ÑxÙýÛt1ðŒzöz…ÂÌÕ½«lÊ»pÐïïª…Ž¬u~S|rk—+ø¼UqÎ`ã[Rƒ)ÌÎL‰ð	üÀnjqÖdv ÊÕ3¬uÖ`ßÃÆöI_]Ü¸!z ÈY¡O2§°Å‡æR´ÎW,Qy¿wê7Žvæ\Ä9’ƒúúcš†Ÿ_ˆ‘”ÏÒ9—ö:œ8
¨¾ï†Ç¯~¯ÖÁPµÑ|Î?nÜ<(Iù}F«ý%u½T'‡H3Œõßé"dèc½Z ™ž›–W—Vd;ÀðìyÂ¢“*PªBË¬X'0'œM…×q×^ÚÉŸÿG"Îp,©tÀ˜ÑŸk9×]±™û›×ày~l)¶`ýsò"4æ?a;8Ÿ.[™LS\„3G,‚a\Z]‡œæŠƒoÄƒÃ×WpžOÂOôv‹†Ycdœq.w—Ô¾_‘ôÒ.Œ½{_^ži~}4µg˜ÔÂÆ~bõÓH˜ðÿžîN®Z´NŸ†Q~:îÅ¯ÿáø§ûUeöù4Æ¯‡T‡Ã4ÏœÜÑ·žÐæù„!J¦¤­ÛÉÂÐÎ6Ç¯]W—O[ Bë°³Fëžl=f€Ã2ô†‡¨ó©Ú“Vñ×sLÓCä¹ƒƒæ¤¬Öß™°E÷b_Ûs7ÜXÝtº3ƒ«û÷.8À E‹ÍÄ·	IÜ5ÑíP>+¹;˜½µùgx`ÜÈ‹N)­ûmƒuƒ`©÷åÎg·ôÔLY€Ä*L‰=ñgB÷=¹Ry&¬;ÒùÞ!QüÅ×ùÔµ«[DŽ+X—K&Gh`;GÂË7¼?1×ô|Ë€=öû\µO‚™÷–>/~2ÓÆD›Ð¤9±8êÝ
QJGa:–Ú^JÕ÷cw·êUj‡g¸Êm¿y¯8IÑt:y• wìó¿‡Y$k`
^´†	Ê§¬Y$À2«9OÁžj}|‰þAzŽe¯ŸØ§þ[7þÅì¢úrN¼Í~ [‡¹•±ø‹¡Ùµ¶eÈ$†ì_B>+wËÉˆý #ö	*©áîÛŸ'ÉÓçJ´Œ“Ž­Ç&©éã O0ÀvKì°ú4ôÕ$lÆÈoáåuˆMk*,ô&M-Ù©Á@fcá§ù.œù9q?ð@ô:þDIåTsù{±¹`Ÿ‚køùÛ°~:Q;º›Œ±Þ¯uÈ8‘â_÷yw,ÎUöQ}–ƒD…DûŠV:o09MÂrG˜ä¨6Œ$ÕÊ'X÷BÁÓï¿ôÕ`ÁM&¤°j6êÙ“›°"zÁ÷ééHH‘›Ü¢aqÆ[žU³Š:Îm0¯þj„ó_de=€‘P>¥òû
ØHj
ZH¹=3¿}bJ±ãÖÒ[aS>Mø§ò†Ü|ZÎ†–÷QÐpˆ‹àÃl%æ=ÇŸØ±@}'•›|¿U¬)}Ì3Z‚nÞÛu_vIéßu+œ7Ž\¼Šã·©…U &"Ô•9G~ã¬»u`ï(ÝöyÐ*ŸœÃhÐÝ8Tu–2,«~šCçR³;Ol(¦4ßÎøÎÂ|fÖj³?T	¤5¸ôêŸ¨}y…«»9§+ÞAÓçç_2ñ#6Dù|w¬nÂåòr¾ñß‡!O:àûYÕã0õê„Ög6˜¼Çó–døª%p:­bïßsù6
Û9u²'ŒB‹kóÏETî¡}ê‡v4æ.E7"0v´•0Åñcù"ÁeÐRÚUS›ª¯9ô®¨æ„±Cf†RuøEWÖä.CçP¡ëíl—­P½q(ínùGpÀìs:¦
…y4xÉÎp!
›ýVÎµàv¾õæÄ_H##±=¢kÚ±@=P˜CÄ
ƒLg‡ä¿UÁR.·¤­j®íKuI‡»›þ2IÆPÙ%Xe_{Ûj®|bêv|AÏéƒ9ê°È¼aQ3gË#ÜÌÂ2A°°ã‘¡‡Å¹Þ’vA=ç•Ýõ§q´°ÓMZB ±”æsV6mx³Éo…‰lI†½7ö"é@ô®—F_qºñij´³”ñš'½…Qö¡½Y×‘H‰±ÝaKsƒª[ç6ÃJ„äÜðD4Dœ¶Ö2ô†¡F¾ËxnÛÊõºR„q*ïüNR–1ŒJÇ†äé$bõ¸¬5µfDÌehm&²áTMË´ÁMìŒ±-Ï²ˆÅY¿PuèÍýÔhó&÷ˆT[ž—F,>n·ïæüÁ%a­.Ôº=ßž}ùö ’™=ä–#Þé­Pùçsq Æ‚Ãþj'Lû\]‰§Â¹7Ï—’È‰Ð?¾îò0¾†½x¬èÊæ±(~°ãl\ÌÍý KhG’Ë’ñ0ti×‰”ªïDJÙáŸ™în8îÀ=´÷÷¬>ÖnÚ®-RŸê?Öî‡¦¦I?~«=8š9³ïÙ_yhÜŸ+Kr¾ŠÑb7è?ŠœÂ‰@?ïo'
¡¯zëê•[…Øü€³­Ö4+ŸV\ÆðÚÓP?eÄÀ¢`€”£t&vPu;±°Kæ i+®oäd@J1·ôã\ YGüî½ˆ­öƒŸ¸áÓ†ÿý®ƒA+­Î=ÜT0ð[#ý¦g>Õ÷?ï©m@_ÏPü“:sPw¤}Ä1÷G-Ü¶ùtQlÍ¯i¸ðHÖÛå8Îî®öjÝ…³G#×ã±N7èŠçÅÐck™Štªø¨©&Åuõóû!1I“ùFT¾¼™6·(	$¯=¹z³=°|ÓN²Áô¼¸]òò’ÅV›ç8äuàÔë®”"],ÚÇ9pwšg»¯”'£´MqKö²ù™s¢HŽ•°Ów¨ÆaÊ† Ï7XX7Ÿ±«DÊµQ¹Ã§puôËã´¾m_˜Šºvœ"éû“òÏ¼z” º@I‰6ÈocZßÜý
²Œñ
ÃÈí³Ç´{á Ø…ÒÊ¨¸¯`#üãI>ƒ\³“×5\£}V~Ú†,>¤v˜(c—®ó@;U’ý÷“åûÎCç£ðÆœîWØª{N`¹È§:9EOÿÂæpö'Q˜:#¤£Ó…£š,A\SÚ¸~j04QîNzÈö±v@g¼xÄ=ÓVhù.¨KLiÂ…KŸ”Í‘2ë²õEPhíšÞçÊà ·×'j}èTkˆ1ÇrXI~Äpô¡?ÌÓ_`Ým´½ž‰ÎKÞ"­0LöË=ªJõ¹n*b­ÄÁ•ËY?`||HfÒo{~ôYŸ³ ô[vu”†µëf÷BµX±qÒÒÇáî6wŠQgÍ…CÒ»ÜHŸâ¡vØª4–[¦Ux–>ãô#‘Ã’Û^+vgØ[ž€©o„wË7õÀÀÃì\Ök÷adÉŒVÇ(Ôîïˆ±žüsgÂ96qUæ¤ªG‹ÌÍêºîfVÃVÊÆÉÕÐC05Â#|ë&´±}2ÑI„‚¦Þ?åcMÐ÷¼–\JÄÈúU˜VŸxUqEÉ8Øé-ôg‡9/ÆâTôšçšíùÎ•gY
†ã:t÷)ß‡*_º‘:yqœ“|–¯}—xm]FN`uýÁkdø{ÿÊn+{¨þ( ð@WzKŒ,š F„žÎº…ñ^²âWà_·¸Rm®´½(W{Ã	“ü±lO½~b›‡óÁÎ0/§£&n¼…ËqnÞªñXœû0³æ¡Ž>Há{Ô ‚½É¥ùÄ‰Izõ…S{ªs]'ÏðEò®Ð•¶'N@<Î¾uþôöµ…èê¡uç™ër­Ð5Û21§Ð
s“Ž÷Âï4•+ç-ÞèbtãåR°äCe\Ã·£X§›¹h˜€‚ñ£ÿùmByÏõ‰OÓ0jgû–ïË9Øx7¿|:ê'PL®•I¯àÚaÆ2æÓÉ§½,Õn2O?õÀBÈÛ\tÉ°ésZÝï
,lhŠ\x³z’‹v»Á m…Seo¡Ë¼•«åí{ì5ÐÔ‰®¿
É¾#º¬˜àíooÛŠÕ’+úËxaX“8Ê@ÝŒm¿½}<>¢×íÒzRh..þJ£wgvÅåº´VšdèÓ'<>£a}s"y÷î‰Â–íª‰‚¶M¦þ]ÞûÚÅ5iwâ ¡Ÿ×;óS>5³H1•€Ÿ¹Ðñl´øû
†E¶s¿¯ê<½'}èg¡#Î¦!36’¿Gbß_È~*½ôVŒöyåYbÍ¯ò¡í)˜J83y2R’ÿF'ˆBí€KÁ»«+8K«UÆ{2u&ýÖ5°É¦·ŠS‹Zlä®+<;D÷Üùu¯8*büÆø& æ©^,ýŒåÁyÖÃzÉÓHZä°Ùi´ól®s¨ÂœKC¯Ì+œÓ÷ò—¿¸íÛïý`ÜõÊáZa$‡Öœw1Û€Õ_ò9Oë]aX!øtQO1¬²=Õ×ãÆ.¾ýã4éWqÍ>[“|Àð¦µî”È|’ÁÖ‰8Ÿöæ¿Sl=8p€?»d›ïr¦Fu~"…E¾èôÑ	XþØÈåò|	Ç"´_pVµÀxiÌø^/ ü ŸŒLÍl^lxê¶÷ä¼\ÿü	NtÎ‰÷¿Œ)]\ë“…»°a°eÏ9¾u¶è)ÎS¹Øê#Á¯‘DQ,ØïnÕ‘¹`ŒK7T~º3°CÁí}vžAN8`cB—vÇeê$C/îÇVKZ.w. 0;þføýçy[Ò£2ŸVŒ²ÿö““Æ¿?…>’ÏÑãb³œØ>s¦þhJ(´jDé\ùõâX¼½š\ÃA£Ù©‹{’°;<D³(çÎ¾yüYZ&Ü”Lï…‹ÉU%üRŸ ìÃ­_È÷ÇžÎvD"Áäaxv:öÿlþó™n›o´àõ±EshiVÝ)b‹Ó)xî¯2ÇØŽ]Ö ‡²]·£›@æ¹q‹àÿd¤Ó¯[ÜÈ§éóÑÉp2€²Ã†µéÓØ«Ã%áÛ…#ü÷ùÊ³b@¯7‘Ý±}„Ý»wëÃJ“$³Ò‰iæ²¦h
ýŽc·¯1ÀœÝGÞSéë0ÆA#õ˜–ÏýbÕðÍ†~m½êhy
’¤Eõ†0¨˜ßËt×3ì¼sFø1åÆ_àÿ|fDåóg²p&Ã=*å;¬3ÝÓÆ)™£ÌòÐj¯UÓ·•l<_`ÞŸ¬]þ®y8œ«a8ýXFseH,bÚ¨@@*“(æ%šLròA“¨Ôßû£RØ,ÑÑËºô‡ŒæoI¼óNÞÙß»ÔÉcµª–	Ô2ïØ<;`ƒ]ñz£¨Li/§7¿‡ùfQ‡úµ1¨Ò:rYý˜ASÙA$Ÿªê.Põ´Â$±BoË ÿ]îÂôbìPf¼.­2@Øñ{A×‰nËöÇnˆfxcfûKâ!áš|Z¦ê1uÿoØq$˜Ø™½@µ_T‹`&Œn‹þªøpýùËQ‡mŽåüðä¾°(ŽT¾Ò<¼c>g.Ô$^Æ5Fý¦Ã¢å8Æ¼o_h#.½bïlpG³ÿ¥fd†”–îÕ<§qPÄêãín0Us¦âì†Ôü%¹÷úŒéš/æßF")¼v´Ú[»ÈJÓÀP¨í^L^`='>¦‹±‡i,Ù}ÅAŠtõ…¼ÏÑéîaïi›±¦[C*¦öEæ]|¶WŒh•;»bUU?e —Ë‚ö0)¬J´zÿ#Xvï`ë„+Ósq§2—p„^*œ,,€ä£²TiYÕØçÿ‹žñ(køíó>~ÀÅ¿•J
¦½Øªæ¬4•X€Ã=!JbÔ0$Ä÷DkdøˆK÷°ýÀ8Ã‘çC¸uf(üü“Xýá!´»°K>-÷Y”½ü@÷ž;õU}}ìÂ`4ëþ¸m‚eÙnKGE`†±FáïŸcÛ>QPÿÍF:öË¿7}5‚ÝùyÄé¤w°r¿AÿORv¶ôí÷§ÆÅ¨o·ÝÞæ¿Ž¯â‰×F°ÅõA0ã9l’´{¢œ­¦ì_pÁHµÚì …
ëÑ—Ïâ!VÊ7‡º„V¶=µ20U{þ1|c.óý†Ãœ_™Ú[d(æž%£õÇy:®¶”@!Ý`¨+ò†¾·vçïÆ2þ¾JÝÉ4œ»wëí•šD˜ð¿˜­E;½Ájœ³útÐ›ÂcaÀZ‰¤¬L¾öÿÿOð‡d‰ãw ª"	­YpÁöÌÖÚc°sÐ!2Ï‘@õô¶RåŸ1oˆ7ÅÎ‘'‡ºvÐâØ‚â½á!ld.ö—PÏÅÎ
­˜‰Œ#Ð:ä qs›7ºÞ4èJIcWLû'î¾ lcû6+ý\VCüŸ]ÞÂº«§VpÐAˆf<ýW•=V#ÏíÎ0!¹—ÏYÇùÖ×îR?úâRvTpéL¹CQÇ»ÔÝA?!}25{âŽ:¶Ø.ä™itã¨Ô·f« õî~ö"|›—oZÌº”ŸÁ69F‡Nl…‚]a*s\$lýÅ3ï	šF²-ô¨4oJDÂ"uO·Ê1¡m/ºL¾³gŽì:®l[ëœz»11(Íñþã[¬²jIØåñP<Ÿ…‚/“—œ‹Í t §kÍw2çÄSj‚Ø*Ì›œ§1+ÀÒÿNO»¦E¾iG0¦y¹Î–Æá„ö/éÉ,a˜«êm”ÐâáŸq/¡Hþ‹ÎW/\`¢æ"&âP“I)Mû'˜l"X´·zâ”†ìÝv*U¬ýY$wÇñ46É»­&ë
àrA&í½ ~ G#Oå*~¢2ýí03ùzdM1Èœ>åöi\‹«f,	Â>Í}nbPŸgÔ¡vª f¯Šõw-Âªhàí}í€«5Ÿ³y£aÎµéCØá pýä÷åU)VÈë¦×4ãJHMR¶Ê)èŠz‘ÿ(î¿g˜£¢pú1!¾ËHvÝÒ.æKA¿¡ž¦o§mÇkìgwÙóö6TÏ8›ý×‰¤*8¬v| IÃú2æûÎâPÁ/ñØ÷2ª·»'XF<p«^üeA¾Vª¶;Æ«ÔàÔVßã¬S_!Í\¢$gTI‡(NíjçáWŸò¤3ÿº!vô÷)nfØÛ@]ÅÙ³"Q˜,ÓpfÄ–ÃËéï…qþ„¯çÄ®*­éT.àÜÇÓMÏ²[š¹ƒLÂ¹Êêä$ÞtO¹—÷Hõ:Îÿ^ÙUwÛOÛH3I]„Õ~¦»Ã4aJ.eÎ?‘¸Í¡§2îüÂˆx9@ÀM=…Š×5Ê0§íÉZqóÍ»S*=¡Õ÷çQ“÷•P"—ÆQ<%Kþ–¥Yë¡0z,êUn=µ^žœº¾$|^¦	Û.µ·ûúþÃ’ý/¹·÷»ö;\ÛÍ‚ªNTH<gf2‰ƒgïzO+`Bd¤è_K=–”|<=˜#¥ô2Ìm8$üÏ9BÚf&E7]ípø)áÈ½Šs8ø®õ†0KÖ®^^Žcÿ…CÀJ÷ØFØŽíH¹ýæÎÆmº1cîÖäç™ë°©.P}ëÁnÜü—!Ób‘ŒÄû–¹6,¸Iºp]&g×áåø÷×Ø}ñAÈ›£PÙzëoÝ±X|;UÜ¨Í²ƒ‹±æ˜Rå:â<òˆùƒ7êÜHØ"Þuíw8•ÿÇ¢RF”BYeT2niQBRIFIfQF(£T„oÊ*[’•ÈÞÜÇÞ{ï½×9ÇÞ?¿¿Ïs=×ù¬÷ûõºÎy®'òg?®<
“(§‚AÁ¯AôH>êî †=ÇlkÙ5px¹õQM„î©<QÂµ‹ÿäçØ`¡¨ÑïÚ½C8Ö.Tl÷¯·¶•£„Æå(åfÝ·Z²ÀµÿöÖ
	ûºé|•Â¡wo™&ü¡(±1ëß^h¾ôhwçŽ§n>Ë·¹ûý*Fëx\Ç¥G­·ó?;ÁÄŸwœ²‘ÆrTkL“N°©ÄmbR‡¤jâ5JœRL$sE¡í(Û‰¯oÀü×ñÛùªÊ8½åNWØ ÎË¤~z±¶seÂ¿L ‹¾ÝyØ¦†35œv<¯Çxá¹ø\Srr]$±ïÀŽ{Óâ8—6áã,rbÚ£_„yÀl“~²~'úK}>ºr'Ü{^Í8á¼(ûö£«8´<²gîL?Œòuz”]?$·K*6²¨öNç”)K7_€ÜðÀGÛŠPßj;œ¤íŒ‡„–N\ÅÑkï=·””7r|§Í–£Øõør¬ü~¼#œíòŠ7·=ÂÅ.¹þ_ÜÜ:¥ñ„ƒGüÕæ+°'ÛÀã‘ï}X8|¡n"b‡SU
¶\	{Ú«éO±¥¨rRS¾3éaÞÊ?©Æ‡SJÎG\ÀR:[êÓ´K8Qô]êšès å
tZRÊ¨öˆ4\”Ñ‚¶Êç
J˜©[ÜŽv	ý7Y„ÃlpðÍÑA1œ`W»(ÊõjcK|:âý¤y]Xì8=Ý=¹ÃÃ¾rÚn…a¦„8¸ùç!4o3yßY,€ŸÜÚÓCÏÀÕ"YC\: 0)ã¢éÑõ=:Ð­~Y[À\K6lµBa#)Â,¾¹»zlOé
âW’ç?¹gØ¸RÛÛBT„Á›…gnyB¿pÔ„°•l
+ªUžfƒ³³«aX¥31{(%ZŽ²Ù‹?ö	7´IWÐ½âÂ%õm±çø»g\ýk¿Lð½%jŒîäÓÖcÙ·á8z ìºÎ«X8÷jnTî,‹L{Ñ•>ÅéÄ‹O®3@òÚ4Ÿíä
2,V¾ëD1á[átû0çävéø1ÀüäßÃLÛa…({úMÏ#\¾à•ãlø	*]˜UÇÏbŸòÛçÝ»›pI{ñA8ïlŸ:à vÙ)‰SÐöËCƒwá/£tŠn¹ýùÙGN|†¾ç²k!gÿƒ‡YÆÌ›~Xÿû%cTNÒ¢}?‹»9JŒÿÃÙÍ@ãU3ìÈ3
m¡ÞéƒÆ§ö%'qhVç×’èèö6û{±z/(Ø^¾r–TÉŽRûh°¿ì¿c_eX¥wÙ§ÐÓŸ_¯ùmTK  ]úÅé±°³(ÍŠ¡?C1!—Ë’Û|]¸f®}ªƒƒ@½·²ð£ös¿³NZyƒ‹áZr¡}£pJãà{ eð<é·‚šÇÝ‡AËKõ£Ý-;uävUû™Oi„EcyCæui˜ÎíøQ¾úË„Þ~\ž¾‹…_%Ö.îÛáŸ÷ì>J \üÒÉ–^…ãO—¯±Àäû¹¯DðáBÝ½C§l¡ãK_‹ÇÎçÎBB×£úi‰\Ãìœ¹“y;9¶ØïÁá’w·_àÙÃŒ4ó*®Áðò›™_G³qª¦Zsbr¦§¢¿ˆ9‰‹Ùšæß)âdØíhñø|,§ëãa|í	=éN.×ŽÜ1¾™‘à:œÉ«þ˜¼¦¾n÷ÚOüÅ¶v>8âLµ%ùT’/q´fêÓÑ~è+^*Óø£%¥GÕ‡‚±>ézw¡“Ö“ÂgXbƒ°m}”~ì´.d¿tN>, „Ó7Ø>œøù1­³ŠÐx2á±ïñ–÷Häå·½XuŸ:O©f;ã+£ŸýÌ…¥deZ!iˆ¬:RÚñþäkÏ|Þ‘#U	/œ°ûk·¸ùÈ:Î_5XRÐ¬‚ð§ä±°”h0PbüRCkÌ‡]œHXO¾ÈÌÙÝƒäƒKÒ†õë°êß¾­©€½Ý9Þ²°(÷’ÁãLL	;*ì…‘¢‚ó©¼r.V	ø»½C¢®ÛâÂ÷}ís¯ÆpÅb°À£V
—³ËzŸ]ŸÀ¶2ŽP;>l¤òqy1…·?=‘X&ÐÜPü¹=‰Cªrß_úãôªzñÂ37hŠå8ÆŠÙw>mo1D²F™Š9å a÷8Û„qV¤%ùï<ìƒ–úENN8p.Gï
ôO²EøÀ¼ò‰ †6Sh7þøŠ÷áA$µ&Ë†âTçØŽ¦G¸¢êÁ6­K€¦ø­[‡ë?áüÃ{A-ÁôcÏ§Û‚µúƒËÃÊ€Ô¾ø@£é5Ÿ,Ûç5çÓ%~¡¿jÕ±áïÁ—7ùz€¸þ]pÏ‡x$ÝÖd%HµÁì£¢9î7¼Ø[e§=«ú‰/:Ë¾¼•äÿ„öZCá‹ƒºò_ƒ°Þë>If×$Ž>~pü´r—3˜ÚÐÃB¦µ<åˆ0¦O_Õ>·>	#Ï/¹òÔ²àÐ[Ù¯ÇvrQlYää?hS§¼qö‹å[ °J„ñ'™úAGÄ:é¡‘ŽS×i8¦þƒ£'}õ$aáujìžK<PpBÛ¾PØ–®–%„©‹à€ZiÐçâ9X>IñlZØ'›çk>tí†*õ>æu~øã–pqrb¿fJüçM„y¶…7-îÐ¦ìôy\d6É„HÝ‡õÍ´Ö6<°\FÒ.T<£â4Uz¾ëØç_cr –
Å=xûúqIhäúê\œ¤1*{²þçµ&(«­£±ÿ¥¼íñã8ý‰ðIåÝAœlÏ»q~÷q˜¸Jµ·G—¹5—¬ïÜgßÃŸÌó	ÏµÚ«%=þ2¼ÑÒ´Ø9¢½bt*íZxÁ’Ýf™ñ	–dÙðÖ¥Âî›ß‚w‡ÁšµƒNñR=¶ð~f‚„ðVÑ×Ré8<2~¶bÿK,lËò¤„:CâkpÀôÐö;j7t4hõ{.¿ãQ„qá$û‡'èŒ¥Ã@¸×ñY˜Ø÷òÜUúIl<™ðæè&¦Úôñ„'P6šÊ».e(ÙþÆKúm 1çGÈI‡è%o½¼~VçB3^SËÁTÀ6…×ÕKØó{FÜxöý·Q-è²ˆ‹q±Ä7¨—.¿r©H7ò—®óbxÊçnšÝ<rS¾béb3@zËwZMà5:]_|÷R ':nÆWßŽÆmXÅWF€#ÍÂŸ¶ç=!û˜œ}²5öÇ ¥JZ¬Þ¼³ö_æÚµ¶S^ÇaÞWyîÖ#P¡<–¥@»
L_Î²€)©gÒwÊÀ|ò)
u>ô>XöûCâìÍÑ£ãÞkb\7¡"±víÒã+0­è+ý±6gfã«Šœ[°RŸ+xÛà..xÂv®>¬\<¹Z÷‘o\k™*j†öÆù‘&·9þ úVšôF;£ˆÝÑ@‚¯iÌ´Ö8¯Á_U”€„‹"½W] ? |äSTÍú«·…hâ´Éqò¿`2¤_Wffiá†)‘‰lO.7q=®_ÂïÄÙî0Xù}áÑXp¾ÏØàZ|uc.ý¹mA …	êÕ®»ø£vpÐ¡Ó;Þß,üM0Æ!Îàm%˜^Hº;üÁ§þüé ‹³l¹Äã‹£gâh$ÓÔ·KWqrXÿ,ä`/Å¬7>"PÖžûäy¤&>4‘NøCw¥…†UŸ2ø4y<}úâöouŒ1}(#Pˆ½ü+Ûf‹yÏü,<»9üèMc­¦ŒJÝÒ}E+‚=obU>ÃÈ§Œ†•k°Á<ÜDcÃnÝ"Õë§qÎÉðE¨4Ž²”E-ƒ¡ìoôÏ­a£å*¯Ú¿J(÷<b²Ùƒƒ-ì?Âê˜`ûMrE\ÌcèSÈ	žy…G·ÈÉÍ¸`%ôžVÄÖf¥Sn•­Á”xê³obo ÏM$m´‰¦÷K—'ømà¬Êª<ôG¿ü\äóÃÉAï‹vÆy¨Úz‘@£>,¦.G[Øž§áû’ìäÿ@¹nñI“µ*›_ûsÄ­†l þ†ôŒ"ßÿß_?™Ôp†³Þ¿<Ú%<n"lÇ:`sõ¿0÷G‹ÐOë"´{‡Šs¾š}!ÐRýš¦Ì&AÓµ,®¿
moe85ÓpA‹t7zJ	—cT2­«`8¹µjÈööo
¯³œ!Bÿ“ÏéæªI0Ýt±vÚjó^ùË×q©2Ý»Žæ;jˆJ¬«ÏŸ»»{¿7„A¶Iuw,Û'P['·ûùáÓ†”ß±øSÐ!Ýš-lZé”uÛÚááÕ³Ì‡pQCG|œã8ŸìmÄ†^ioñ¿º8OÕi7S”uï‚Ü½Ûp4ß+ã]’”dÜQñ13nªƒuCK»µD˜Jº˜ž¼L?{úÃ­¡¥¸Á–s—du3WˆíxÛŠëá™7Põ6^4ìÁ6¯,6ùŸ¢ÇYM~¢ß:,KT>Øj“£.md‡¶nsÒÛî78d.Ã.7™
ëùn'dw€ÁºÓ&Oâ¼pôWÌd½ÏA¾)æù_…N4jÚwêMCõî'Û_0ü§„c‹ß>lô}ð™wë ¬Tê¥˜ ÝB;Zìô’÷eV–ŽOàBCoö¯Í¬Xp´JY‚aÝ¦õKn0IúÕ”øÛŒ7?5±=†®¡í.¯29šûym1Dœ¦*éäYK€!œ’;ŸÙõ‹ÍnÝ‡M:Þ³LÙ÷p9kßwAÜ Ñ»É:¶Ž­†ßåí¼`¶kô|À9+ì÷%WÜUÇÙü‡¥ì^ðowêdªˆ:ô§ÉŒè`×{­)] yí.¢?ó.÷
â„íË&›ÅPýïå¶žÖ7÷gØ¤¥æÁöÄE•îG:0ðN¯îìÞ˜8p@¢ôŒ/”?$Râæ
3ir1Ìª°ÕÑÅÓ[è3nÑ«ÉHÀ!‰Ta{–Xä³Ùýîö¿v‘ü6­…‡Wßêb³ð)=“6 eº2>â˜†í"ë»p9Øþíây¼ë $Ž}óÏþÒŒÿ$ßŸ×4zF r3ŽÞ`fÂÊÎ_ù)…6Pªþ`ú¢a	´çßºå²Â“[½óºŠÐŸ¢oG~àr¡²YÞ&g>02ïÒæ1åý" ×F#!Ús·Â
dr\v|‹ÙÉ<ó‰8¹l”;º1týë‰µ"ÐL§+vÎsbw‘ÒNÞ6Àv7ñÄ#ÿ©Á’Lá>SK#$Ö/Šölcß_MÛÇ§q3R,rüÊÎ8H66½ï…fÓ¨HJ+X¼¬zµON‡ì(v-«´B‹–P ‡D&Ž	¼Ü~Œ9ý3‘_®cÝ4ÿ²½êSÂî9ÏðÖƒ0Î—eÇÑå+GI6S§¬Æ)ÎMîº»ñËª›i	{ŒÛ/Â|Úæ²¹	®Oñ6¦ÀäþQöv¥»Ø :GŸ?–£~õüOÿ5Wèt=&™·ƒ+jvbå¨©´·^ç‡ñ½)ÌªéÎPìôøÜcWlÑ:þ"îÖXþôãôŸ¸@lã——¼UûÆ&½dÖAÒë™–›',pãXëÛ®½¿D\yTxíŒ2.ª~äO…Á7¤÷»„4qí’Üã‰­}@ú=¦t’È¥o£ýakªAã³¶—ÖØ°ÁéE*÷Vépz f•›s¶Ý	¹ù‰8ÛòÜ³ï1-4JœÛìø™³µ‚©Ÿ	”6ûáãê(MVn<#†PÞmI_õMr»›÷?3ï3m_ˆ`ß™ûÒì“^•…8íåf[ŠƒM7Î¾ÏÐ„ùOU¬™îY8Ñ’¶Y–ƒ<Y/ÊUãäûŒ^¾´\l?¹¶p¤‰Ö?UðÑ®SÌÐì¶Q‚Á·š7Îýú†ý=5Î¯âÈrÂ–-Œ9Iø|\¥Å‰þÏ³×RžC)Ü›gt”ARwÈÓˆ—8â• ÞrÞ¦O\2×?1“4¹±-§O!ù­íÞ¶˜=°hgeù5ŠE,C‹5ÙpÙ¸W¼ë±!®ªˆŸ—?u VÛä_wìÞéÅ×ZòLpE’÷|Jçuð<56Û?2«X†úÏ^±Î­°²(ôKô²Lw]Öäþ‡u‰ÛÉ;ó¬åÏv;Ë;„ø¥YÞÌÂvj¢gB¨Ö¤\˜üÅ
+qNÔDÊ!%_q7Ëž}8(ô©x¯áI!\æ?lÔ‚DQF¾—Ø¢3btÜú6Ê_}¢{ZG½øT£…ÿŠ¨6Œœx Böö¶GøU,Üíôóp¹)¬
švÃÑß¾1’Gw®]±úô#.Ë=>ð;/G7W…®hu&;ì)Ò‰T¾³	É}MO}ÎÄùM‘Ð¢ÅÝ°E×x*¾½–\NWÞ…Í	Âïyqý¢DÐäž"ì;¼ôÅïBmžG†ÒZ˜aÿbž~ˆIÝ÷]¿\íÀÚìc'ÊfZÅîòbÃÉsûY±ÝGò&¯nÔµNhIq6ïsLÙQ.{/sI\b|½lÞ¸
‹Åê'í1ý¥O€ù@?êï6[Äe^gÙ¯Ü;Þ%;`]Øä	3¬[ÒÛ\:¸÷Íà¿†4XkïP‹1w6Öu?áØm‹Øï¿`‡ÂFëza ÖUþ4%9ÂpD²q2w0ô¢¹øV©Äƒ¹&å()Ë˜oçnCëÞ•’Á“Z0øzÍõñ'7Xñÿç—„‡ˆû~ÓÿÁÕSówx°)ÛâE€<ŒBÍð©ra¬fmé¤-Å>ŸïÈ}²hƒ§eßÉ¡Ï?F—ð‡’Ï^~$ý×¸OÐÔvë„6=Bð+éh’_»þ$ô+ŒËÈ½þóç%Ÿ%[™â­Ë5_gb¡`«èæ<˜ß0ã)uÂÙ…ž8bOÔwÇ:ð )ÒKW$l¶*Í‚:ô%°‡êšö¢ÕCX¸Ðgá»Á-—%¿Zô‘aúPöc'× XÛéPI¦bì½o1Ëmv6½'ÿ>°6CÒ;ýSIÅY0ý1ê¥1{(ŒÉ(¸¯2—Ã:IÉ–×O*&ù5®šàòåG©Ì©0pîßAæèv£î>è—`.$%<Á…]6›ó1°Ô`²ïÚ?ì9£Q©­<W§bì¦q2Át÷‡¼‹0îv	ÿáì^º2Æ`ahÍÄ|t
—./]nS†Q±:v3
0A)¨õîUé)Ëxíx]çµÆ4“4üÜ JÁpŒÕÞ	/xãò©~Ÿ™R82‘ÍÄˆ£²­bùƒØ»ê59sáÎwÝúïï.5»Í÷¨¦íøØCøZ AlÈ:ê?os¬ÿ’·DØÇÔ1ï^Ó‘¢	“1°àÆx¦5æŽ|ü^ôÉl’Ex”â^àQ`sN¶œªš¼umaöÖ‹¢ûÊÍØ½Æ0¸õ”Èml%Üg±W–3óžðûuÖÎjÍjR§ÒÞ"Ùu×=(áÃôéžˆ–àÌm>>#ã@œ›X:áz '/¥·´­Ža=ûYå‹´0Ïpoþçú%<¦rEP‚nÇsäÊIþ†
² Û5. )žÊø÷^rÒ†c¼Ÿ¯ËQ(_	hÀåð¦¡q¨þ}öJ’¥ ,õÕ~ 6öâÜVšˆµúiØ0Šôº»¨
ƒ/½—_ÌæãX·ö—r0õ¥6*êxÁŽû)ÖcŽ­…h)û-âÝà¥³ET°4ÓÁÝÜs	Æ)·Ìô›èq´jõD¬iXœ’6‹†ÑŸ×HÓ©@ì“Ÿôžë…Ú£¬dVèq<Bžë€êO WZTJ5þ‡ƒQCÝ&gqbÓRDqÅfþM>­5­ÅÎ­«›xßÁ£S¥÷äY ûù\ÞîÆzŽ§g¿¥@þæ¼õ·È»J!ïcÚtqƒNOkVcô^/I´‘ºƒ£ÚG$Ô.aûf0ÝÓ¿¼÷jWö)\ÆÜüL\zäüûŸØv§éMˆDËaœoÖ7¥Ý8'/ðã7,<=åýí¡?¶ëîíK“£Ú}SsÏâ\ì+ ›º€“Ë§Øíéæ)ùjØõ)ÔVÄ—iÒž®t@ùCíeÒª³U‡ñË¤á(•Æ÷¤7JØ[ºÙ}ú»".H·&°?B²ó0ÈÅ[B‡Á}»×û?cå1wÎa‹•âñ£ô²°˜L0 ~‰…öZç¸ð_:Åm~y˜|¹~€ä­ Ó‹‡ïþ¸LµË'%Ÿ“§`éIÑ´Â¾ýÊêÏ§ÆžNb×òD`¬ÝMƒeóvwdå¦yÙb·Uë­[O¶!²ëö#ma´µsÊ•h…®rŠéwÁìöžß†º¯vòfåB°ÄS¨ HF×S‹ãÈ÷]¶ÿT6`På²ý4­(Ì?»X{ÜôŽÏß%Mfa§Éé3uNN8lq‹¨ÏÝ‰sDsÖTØQ$˜ûÒ‹}þØ¹'{†<no–#ôó¾áŒ¶üËûEM^ü{©:Jâ8‘üÐx\h¼@aú„-Š{?Ñi{kVx qšwoö‘Ï°ïÄ4nÙ
DºÈÚ7vÁ„sXR˜¬(¥”:[û`WÓõtQ*ô*õÑ€ñ­šÌÚ’0²"?+øá4ô\Û{ë]6$wí.·ÛÆ¿aBTñµ	XO6øC'¦ËŽ¬Ì÷ovc7SøØ}ãë@¼Á™±…7ßÅ4è<{„ÕY±%\ß}&ùã-\ömã=š¿ýù–Yç/Å(Iw³Âü™ë'ßyî†þ,Ñé˜lÌ"\î‘XÆâÆÕ»§nŽCé¼1¥ˆŠŽ—o¿¯ÏÄšá«‘_?†CœtœtªÌQ çþJ IÌÀÙcR…”ÎHâ:æ+©ÛüÍ÷¶¨ä¨H2²ý¼0ûK™•÷qÖF:ì9 ƒý§íu’Ÿw@[ÂãÍîÜ ìšºîý–5».‰ÈQl\OœÇ{]G*Ô	P¤ñÎ›¢jlWøu€óõy$U”Ûkè™Á€‰ŽÀ‹¯z°rrÚÕR7>
j3eÃ¡ó¦‰ñ… ¥³N+êå
vµÉ§ï_vÀ®F¥êÐª0Fï¢>¸¦6éPgËDG†Ï.ôç±Ûñµ©arÎ‡½\
µÂÙZÝ–{wøÿl^Wÿ3ì?£ÀW2uJ5³rÒmŠž$ø‹Â´ßyUZµ)èTý]ô Yëg.ßr’Ø•‹ªO/þ¥"c A8ÜÔ,ø
a¬ƒúÏÃÃ;=ój¸ƒiædµ${kz`6åyÂzœ%–S>Œè¼‡¼nvEùMX›Õyëµ	Ët¦<¢oÇ†üwäk·aYWú´b
iIšu&sþèU–(áÄÄ£ŒC5Ü0}Èóë[ÀN•»™L÷qúhh
Ýp’WÞþúËƒóëµ¯Rê`l¡/í6{/N3<ÈZšŠ#_½ùÏÆ,>–Ðý©Vk~ôÕ°dCòo•hÝŒ-,Âæ¤—÷cG‹ñ­¹èÅT*xá.îù{¤‹~(ñÌáÜ% S§7øí¿¨&Öd,‘¼?yúžŒ2”´nf¡Qðö–6$Õÿôù¶†Uµ=j^°"ì­)ämßgvi)]„ÖKn³rCð]$ç)û1Øb[Vvù~fv[^íç†¥t;3ÏÏá0`ðïM‹ÇkìêŠL2‚±A•òD™7Ð°‡ÒÍAš@)ðf°b.	¦½ž×œÑUû8èŽó§4õE]³v8]ì6™§:öœJcòƒy¢iöxòw˜8ÛUBûÇ%ÎT|„iEwéµ	ýü:dTú¦¶,“˜¥!DéáÒôn KXj^ƒ¶´3¿•Ýwø4+…óà$»_>§ý	Gì«¸ÓÕ`½úÛ]éWPž$ùëŠT(mâÊÃ5kÃäÂ~\Y’ÜŸË*…^[Ü4iI¸Ýn/ªµ…kŒ«Vûþb_J¢³ÇF´ÇÍFÇJ1ó6	æ­#Š¬ea¶!+ø”8/®Q2MÞ“—„5ÿÏïÛ×PÛ½•-ÍïÀW:z[î(“¤ìÌûµ¯‚?YáÓöóß<oq.iSèù?eX­Ûk,p	Ié©&lÄ°frÊ™}áŽÙxþ‘Ñ—cEœ{¡'*&c†á$†Vf–¬<ƒÊ¯cÌœ†¦°2R³uÎ;ª×j§ÙCÃ5+á,fœo:ÍŸøå2\åÿ²i_ˆäÏû&DTqNEå³rûeÌôÓyrQa'¬9Ìœ–u`À¡î!E6®”]9È¹WnÈ+nâE²f„QhÀ>œ°ˆ“Pu…uu+­1µ˜Ú·ŸjÔM†·~—¨y%(eƒèÚ®ÊQ=Ég¢¸_+IJbýì¡8¾¾ÇÌJsXŽÂÝI_F‡Rk¦î2ñA‘•@Õwç?HŒºáW³ óõáñNR¦8ÊåMã”„ËïîöCÃí¼x!m >´§<ƒ²U±Û÷å(^þäØÏß‰kOÙ!‡‘ øªõ˜:O’õ“@¢Ùý«–9l&ò8(‰k÷™>_ŽHÁ¢£¥ÄL÷ÿ`‰}S'¢ì3¶?¹œK×ÞÞVx©}^IÃw‚+a*þ?aÍ·qžg²~ÚzßZ'Ð0ÑÀpòYò’ ±m’Z9©ÿ£Jyå0+GÉAÌŽ‹q‚	+&ú¨ë×aàIA!Ó§~ ù«3âŸ¹TW„,ŸžÚ¶7ƒÚƒG>wyÃz2Qq=ÖþfaPÖ†5×ÙÉÕ;ùP¬£hÍpSzÔ½Í>’K ÚR7â,Ù„æÊ/?¡;Ï@©á Î•«‹/VÄaó¨pMÁwÞýtù;9/
Ú§vcëÛ eÞ¯f0Å+ÛçSíB 2M“f²‚Uß…†‹”0W¸â¨¸Û
[Ý:Nkˆâü÷g,jÏxp„'ÍÄ^#	$>Û*ðê`…Õù¤£Û	ÐÆïð÷x¥t­
‰ŠA¡×	†å$º
[‰'ÙÂœ½Øë}S˜Êg5”hÅYò5yÖ@¬73„YÆV\ª~ÖÓ¤„3|ùWq.žbÁón$v~.›YÿN œ=øðktÌhågé;‡$îsöÖ±Ø÷Þ~Ð/nR™åùñàz°éñßÝÉØäEã¡ì¸HÚÁŽ³ÁäZ¡þûq_ ™]:ãëÊ2æXÎã¨d†Fé¬¼-Úuì› ,L|Müg„c4îÜ+#‚PkpÛŒ–å ´Yë«i(ÈÁKH‚(U Žf}!ŠÅZáÈ•^væÕõ>Ú¢Ò×ÃÉÜ]ZÉ7(a@`0£o˜&žF7iéÁÄ½];û 
­Cè´pðz.…ÿø3(äÉ[ãÃÛÍ|J®{XâÉúXvôN,+¾ãZÇ>Óá[W&a`;'n¿töHxaPU‹SyCìg/`÷·©ðMéîŸ3^ÊLæÁ"»mO¿ƒ¸‘§-’“ßO	L²Ì YRñ÷1>˜ÿ†3ò;•T¨Ø&™qësÏšÈAÕK#813×¾E¼f¡†ãñ//=`F¤Ø½Þ!±éŠæï8^œŒÊ~ñSp³0¿½}x–ÅÛIÞ^ù0ˆ•F]áj&Çé
)Jœv‹·î<måÂ?Cb`ZéÓ²f'V…žÑÀèÇlW‹òòpcî@vïÃ),²®˜p-vÜñ»>Cº«°ö!Óq¯Â8ÎðÅ…š¦CÏ™ØWm3±¯æËþ\Óvþ*ŸË M ~Ú¿ç¯š¤…Ç¯^þ¹Ãj—ñ–ülÔºÖÈ9‡‚.%jÅ™ã¶<9Ò­ðV¯æt}Ðw$)ž;~Íú¤9$Ôš`O‚0Yì¥?vícþNy^ë›Ä_ñB²[ïš«Ööí‰ø®“ˆeR“4ßÓà÷é½µçC1—)ÒÅ.¡	pœfuÀâÐ×»{…{°Ó:HƒsÇk*\Î×ßøö‡ûN¿òMÂóæÛeA°û\;CYy³åÑõß’@×<èQ»Æ
YÿÓC¢<ŸEØ^Nlä&ž—1w…‚Qê#u‚ßaüW`²°àg¾ÅÓÈÒ8†]ÛÌeÜ<§°)ÄûîÞ'PQÞ&
<¼Ž“7MÞæjâìÃ¾“A'	{XÞ*ì§…¼ÛÜo-×˜pú´ÈÀ£Ð;ã³Ú£Jó¶Tò(41ºáâ‹ë<:÷ˆ˜­]ï“º/ªd·c|hpý²ÂYÊ#z8B­°˜°iŽÄs7~yLvA¿€ktOW4ò¼Òkv‚|Ý½YF–áØ¦”Vs‡÷s¾Ü×sNŽÒ ó  =t=:uìo™n„/µ‡ó#™gµ;vÂêËN¼±Q.þÿs˜ŸRš­v®{ÈÀG¹“|fê·v¸;5Y&ùÅ7lž¿¯ÀÐ¼Ë/ÂmšæR’¥jëÂˆÛ{Lß(Ž+xÜx€æùòÝ´Å!aè½B}D!´‰–zÄ1‚ÁûoJNpcSu§×÷Ñ4\zû9”ùØ:’œÜå$PrF–~ß.×$P<9õ¡”‰4áV‚§pãJ°õÉ4ø”ºÉu±Úè)œ.B/·Ìq®Ä,(¿Óúñ¦Ô, ½Zçf¤OŸ?ßñ:ãV{5ÉÜ>°Ðô©pñ'NŸ[.¥!Ü–c×zcþxbUîCÜ\gÄ»¾ß¡&ÞÁ¹¦ŒÑÍQ,°?C_o–ü(âL¶P€Õ”¼Ð;»ÀË‡ë©Ð ’ôùÏg—oàX¨¯q“ŽÄ)•eèpàU}ÕiQ˜¡ó|0Ô€Ã¹zéu2/±_è9eUBŽ¿hï®è¿Ä?Îúpe`kV:•I‚’žm0ßáÁ±ßªŸ*Á¿ñòÛ`lÊÔ=Ú{ý0,™_úÑß„SŸcf÷TØAWªµ¡@ÊÐâÂ¶,ô©~,?‡Q¶7	¸¢Ú³—†•€å½[‡½†¹ó
?EÿÆé‘{-&°ÓÀ3qA ‹”xÖE©p¶—‹i/=,p2uµH·b}ð9]¾;;ÞÇ'ñÕ9H†h$D“¡+CÆpf~þ¾û#¬<H³‰zSŽÐ.M”òÙ«¥‡¾tÕ†°dÎg}!ö……lîÈ9¦o<áOTÑ;EÕ\u‹8Ý˜àà©íû¥²2ÓT¥s¡îŠ¬å¾ZXÅý?÷…Ù³°5)·nªí/LÂõ	'ÚaÑÓ”AéV(ö+µì»É÷ŸÜç	žƒ®{¶$Ý—;ó_pnåøÄ‰là—ÝÿÿûÈ’sÛ4sßW®~"Ðªz¥'(üÆv&]ÛS\iÈ0õ}‹Ã®š·Öýƒù{<Ù_üù1²ç––æ=[Øbº»[¸qúòY–´wE„Ý<“¯²)±éÍ]õ\”£Ì/w¼ô3–9¥.ßHÂµ®Þd§«q¾|Ê`@ó.ßàÖ~NG páˆÑÏô„½³wýÀ’"¹&J¾ÈB×x$’)p¹Üs~€.ó·®E¾ç!ÁÀnøàüúõ=ãÃY~Bû}%æ!y9Š¶{^~fÂèËV\0xiÓüž­ Î'ê^,ô{ƒk§Só|oâø¾@¿¦ÍPZ—øIPÿäðJÁë“0C 5¿âÃŒ#%¡¹kŠÏ`“l@W& ¤ÁÌn›œC0•kò<êôŠh>6·À‘±•ÜO,[0xÇÕÿÎ0F†èô–ÞtáüQQÎÖ°ÈÚlïðÀ¶¸®æO¡ÿÌ¹Á1Œ0z·á6Ïp-NRÛÙqF?—òc¾9[Ò\c&…+oôOZ.âènWñó*öæ’‹ ÄfÔ~œ”ÄÄc¿i]†`PP%V4tëåÜ±ÝP'+ÕWL…¢pºZýÇ½¬ì¥¾òýáÞÐÊúÎÒCCÊSB×¸ï ñÞ©¹ž¸x(:àlz!L|?6c§}þq_n:Ø‹g*y
ÄÓaVôk·à¦öÒë~	ŒÂMšŸ7eÌŸã¢–Ó¶è¿¸ysñTîœØþD™ñúSn	b±^À“¸’Eêqx0´»Œò_ï§Ä•\£¸ÕG°ìxHYvÌg·¥ƒ
ù ¹¯Ö¥€a§ÇqJÉõD.®Mn'ÆØScÏÍ£gGG[ ô?ÅMåÞÈÊxrüßÓ!¤.v{»³.­ô×~3¸0Cÿþª!Uª×8¦Èùš›’JÖ,5zþÂ¸~ýíºú§ØÄ¬äó ©Rl|yÅ ¿:{& êV˜Ö'qkÁÀéü#’8c{Éyä?/\'åç'ê0—–hÿñï t½9;ãòcÍCÔaŠ/ýHôøyºl~æ=+¦ßj:2	[çýÍ%ØùØ÷)ÏïýŽOšguüuÆ¶Ž É-æ»ØÞÿUÀíï ¬u¯Þºñì´o¼ø´#Ö_tãMÒ ·ã¥ÿ¨,¿ÅÇ?òÚß.ÂèQr²ûæi§Ùÿ˜¢;5öŒý„KZYi—eèÌxù0J¯]Ž2€ìúÏá-”PÍÞÄõCç
b52`BTîèM-Iø‘—ãóz.ïeÍâ8«-‡âŸh¿x‡Ó¡Ží™Pº|¢ŠO¶'üÈ`ÌWÐÂ@NþyññÜ×}àÝº»tu§?´îc­ö× ?©SÐUÄ>sdÏAxLØ­ÿó,Œ¥ò{…ä\€ºªÛ¾ÝgBpØaoS«Ÿ–Q˜pV±á¥Žäµõ§@ª»(3/,Ÿ[­ÃÊ³]°g¯Ÿ¦Ö{Q˜è"ÿ÷"cþ<ùOå®‹ËC~9bÔ“8Ä{ô¦¢WÎ2œ;­›Ãû\Ü˜>Wá ‰sƒ€Û},jàx_ óe…ã¯t¸!EasÛe¶I¡YÀzU`¨­>G·[4°›âÅÓ–hŸ@K^®o«:¤­Ow¥«Ä¥¡¡ñ£#X%}6ïÙ‹Iÿ1H	‡AæLº²< <[é‚"¾öÏÞv~°R³ç×…Âÿ`ø¢
mW’®Zß¡oÿí “[GÑ-H—Š$){¼“£Ò®û@æRø—UÆhc¼“rý/¿ÝÄÖÃ?{ê¤~Â
%#Ÿ©		IB®‹5/hp”ãhî¿âÊ7s‹ÁSPØÙzuéÔzQÊºšA7‡`K¿…iúè©ŸæIUû¸kfò¾•F÷ÀÀ¤¯LÌul­˜æ)€&]OÂB 7¶
k©˜Fè`õý›Îl²58ÛyÃ°¿˜Éq=ïèŽïFGÁ‹¿œ£S±×óÉ¢ôUF$­¾è±8-{ßSH»C³¯¸Ÿún{\	¸ºRuÕ†ã;Ô÷¦[ÂOá®§Jß/ÁÂß
7×+8”|»»µÚ '‰Éso“vüUòžoùÂ+8sÉTiYŽ2Ç²lÏOqXU¯m†¯ú,Â$S.÷.†|€Éá—aQ;ÈÞ»šV%	}2¼îAó3ÕâsÁwqtèüÁhÞ}8þåÁ#ŸÃr{UNFò,ìøãë.+ÖiØ ”Xšeó‚v÷
àÄ«¿¥ÂêðoX?'½f¶Ø]~m±ã¼üC7ÉXFÌp“„tJÇš€°&˜Í%Ñ[ÿr¾&œ‚ÉÛUÙZnã¸,ßûG"î-¤Ê¸¦|§9ŠõS•Z+L·	TüíiÇ` O—³@ß
¡Åö‹¬¢&ðžäãTì×YŠ¼ÔäÙÿ=âp õø=¹An9
×ó‚—U¬páÈýû¥ž»`þ(W©òÀ}ì0”ÜØ¬†qHøÐ„Kœ\ù~°lŸ"´õ-»ÁñàÅÑH,æ.e¿zHoÌ$©=ê¡5°•ð¡* ™]YÈWs°éÓ@óGAøÒ;˜®:Lëº—Ò¸,`D]%öø£ièâ-O+rã¯oŽV$À‹ó(—ø +ÔŽÞ<úQRÚÍ»ØÐI^æuª+U@4+tkšíƒ­\sÒI1µGúyõÒe×^õWç¡ƒYåˆÓÕŸquüæ¹ÿ²!!÷å“KÔP©1v`+ö(ØÛj,½Èq~“sµ¤J9áO¨–¶!Pþ)ë¾¹TöÕ
ÎàRÊåZ-êÅú‚ç1ƒ¿­÷eÉŽgŸ9U<2¾“Ï	?ö>Žƒ±I¼DõÃ@l´b¬gå¾rÝ;{¨¶ª/PàŠpÝ™É…  Þq4äÔÊÇ6Ó?ÂvaHX–v•‘°ƒ¥p>ë³BÖ8~Öíà‡0¸H^«¼þ7Ž”½Üxp>²ªßÖó‡¥?¶ÿq6ÊÃüuq6—À~º-ÎÊ‹°ƒdÂó}ÓDc~„MÝ…‘¾gg±ˆ¢c¤®àŒêHÅsÿÂ2/÷ÇL^Á@~ÛÒóÄ@&9yNYÞ¿
¤ªëBOˆÀè×ßñ'±þÏ'_Gh,?»k7C'®VUð.âØ¦At½•CHá†“XJžPwÍÂqe÷§)Û9ØÃ6–[sÚJYaûµ¶Ì_ßpT&àô_ÓN»Noü#?ùìåb:Ì+~ÔÔ‚ÆøË³­þÅøÅ¬oÑeÅW®û=ÒsÇò°ÏA¯ÇÅ°£òH	­všæ6f»ãÄs¦öF±Hyžî´œÞ$%û?ÇÏ<^ò­“'¥¾ã¬*iæâû3@Ö7ÞÅ¤‰é

	5/hLü^½iyQûþ…òãÂ£}þnê‡	»8žjn[¬ÀôGwN²¼8Lx_ù¹ýŸô¹JÇê¿}Š‹KG%Ï2êc×­©«‰Ê¸éŸqÞØ*'æ~†õ!,nKžxwÇ¦v}ý°ë–6yÿ“ÌÄ	óË¿Ô÷Ð—>Ò={|—^)0hÓ¼Âq·1½™î£Ðß”yÅ[Dz—½ÿš†öfýËºóûa6ŒiämÚnl-ì7ÝSöÚV7ý<_áöé¢|Ïmaã…	£P+fSÄ}Ù(†MþÇ¿Ïé¾ÀIš÷Ô}eÐ¨Av\/±…f)}1¶7ý°iÛîñút,Ïp¹æSÊá¨gèŠ{ù5$ZÎ%|ø×‹«Å¿Ö´L$¡ 4–k_@z›œñßÄÑË„ÛÆ3ß¡§=_õ¡
,Ñ¿ð=1ukMŸvÆiKJ½¸s[hÆü …’{¼>;bÿMÍÞ;Ü|=OR}J§À¿<Ïu/ô~d¿®ÀÛ
Tõ®‹œÐ^‘\ßó$
Ùå9ÉXÝ°”£4ßCío…,ä`Q-NçáÛ`èòðon’éÁ©·ªë†ÏÃòžIÎ§ïJq†öÐ;ûÈF£KSNyC+GÉÖû£T¡îŠÕ¯ÐOI;OÒÏÇ‘¶tŸ=ã<CÙ¼=8¤ó,ìgm~ ‰>†Ès¶më	ƒ8¡Í¡èÆ¿Ÿ¿¡õº€¹;Ì×‘ÎqÍ6áïž€2°…‘§±_3˜[ñ{?“Ño-˜ }¼~ô0N~14ýSA„¡}a+]ÚE816ªÐá!lÎX/=qÕ¡IK`è­°Œú‹L¨üj!¡ªƒDuúYOjØ.ý¹è3þVèO]DâM^ËÏgnaõ3~VíK¸:móDZö¦8Ò&–XåañR{7îÂÑ_v¬æ–`àz_yÆŠƒu¾¯¼¢Õ ?Íá.y=ttÇ¯KcF¼ÆŒËd&&KoÞ™Š3á­‡>»3ÀJž«´Hº-Ì±S‹m5	à¨mÑmërX µnÿàmÅŽËJUcHz'²/ûÆ$,œ	];QŽDÖRâ7# ^àšˆ\ùs+ÖC—q!éøFý=8¡Ø¨+½û1ŒÆ7~–üyëJýSAUR}N‹¦¬Ïdz;¹ÿjÍ~5ih©=>yDI‡^9l©©c¥€#áÕýÓX@uC*8Ó»ù6]ynAjm…ãË»0ÉVÞþæ5Ô?ª)H¯¼ŽC|¹#‡s†pe™y$ÕÚV.ynDÏ¾dáœyÓÏ_rà6,ì·¼CåRÓ§#þ¶a†XTÔEœc}&Âp:¿¨ÜaØ„3Î7i¯ÁúþC1õ¢P~¶¯Çÿp©E¹”àÆ® çâ=@¸3ÖûA‰ú-³kB~ÀÐ-ßÓ‡©pŽ÷÷´[Î	1¢zÆdv·(öë`«á—'‘‰8ôãæ²=«L÷Ç;góðãâk’ÙŠ,nw+$Ä~Ë‚U	]ÕÁoÁ|•îÌNÏ‹·Ã™¯ÿ :V¿ŽQšFÙÂœx¬1RáÂìí×ïåh^¨©ueÀâgîvF¯ $ïæ‹+§PÅùô!ÃpVt¥­j¾xSå&{BíqØ€8\'÷ËcÛ=‰×|q^üµ¾úKè_OP0/!Â_ÖQ·gÛ©°àÓfh×øûBœÅÏ¼Âbß¢+µå7°dòŠÕ?áx&GFòÝ]Ç´5šz³D9Ê0…Ò7Iª0L5AQç‚Ù„mÝG¥8hìu“Üâ¿Èß—í½^#×&
cQÝ•ß\®Lr”ýŒ	0oÞûUÿZF¶²Ò4ÇI†½/âEÝa©tVýËFŠù×Ø9_ÂæwÙÚzc0¬ÆÐpÓXÞíÄY½xû[üùMÆu·oòcN0j7çð@r}:\õW^ÁôsºËÏ“–`ë‡–é¾JØLc¼üí'L{³ÍJìq†5ú~zê•P(P j}ˆÍ¥}¯•mŸãèÑM‚S 
&³jæä©úâJÄÅ;ºnX˜_ŒÎ˜)üu^¡	:O~øWnùÔŸ¯Œmã’âÅ6¶0^ õ4f¸œß›¶:šz	ZEQ^\úÇ³_R÷4ˆŽ4œo”£ô­˜é{%Ò”Ò5‰^ÐB=BåpÔæ9lüKƒqùáEÌþYæ~qÌúŠzD»Ëua”>¹D#yr›Ù…ë9—qôJ[ÛãœÜÃIžûé‘mGm’†1ï
’—Í¡Ëäõ•ÑA$U±â˜²„Û 9û.®‘ïx¹OCõRÐÃ£ë
ÐÑyf,9fÆs¦¬n—˜ÁÐ¦M²|Ð;eði|‡§uhZ÷ü‚yRO†ð÷˜¶»ÍÐè‹CVmÔÞ‡Þ«Aù…Q˜L§'›°O{”NLT­„™w·ùÔÄh0GÔ´„F`<Øƒ\GrCÁ¾]p°âµ¡­ƒ"vÐ-9z$ð§ìáŸ¸vî·äœ\Ô}‡KÙŒêE_ÃªãÁr›"Èž–:%…dw©©‘!üv¹¨÷f;¬¹~¡zÚ•Ýþ]å÷AK”¥O"³?üc)1Z‹Ç˜öz©Ÿ8ÝÀëÐÁrüuž
¡w•¿KJÛ…ÿvx#@x­ð-’--nÝ'Cïã
ºŒt5l²Ïb¿XpÖÃ™MFî¸Âhš²Ñ˜¸
a—Ö¿¾}ÛÇqqë=UG²)ôïæèÉ>Š£)AýÝkfÐíõö±ûYh|C›çJ^Âž[ç?ß1ÀÆûÑ·qì«·ÊÎ¼–íb‹÷|†cÇ™DÉ$ûeÎtp7N,mÚñ}Ûñ<íå¹Fœ~¨ô#ð#‹Üw?/¯ýÊASqïß@î}ažQ‡‹/µOúZ{bYÅ’×_4<~&V®—T®–³kšÃðPÂ«tÛR¬êª*.“s¦ý-G—RodÒ>qRüÞÜg®KÃtû9›4é,ß¥"+‘Ðˆõ—Oh¾,»
›ÜúZfÌÎ0Hvåòø†q
J1Žþ8{6-,|t“÷qäF°â
u·žp7lð¦³Ø\Çþ×N×kXþƒùìslŸe°V‡F¤:D'¨u>ê‡“ÒJ¤Ýå„=Å%‡NÙÄïÜ/hœ@¶Âù+NµË?©päùƒ¹.Q!œŠé	ùÊŠý¶z—çë‰|ðñå7Ü¸P"ë"tž(÷$‡Ã°,ug¬TµªmªáLiaîÚÜE¨ÊŠ2úÓÄÍÍß>Í-•Áð¹Ë{Ÿvvà†Ì¶@Þ=â›WÇÍ¦èˆ—~&PhcÖÚ”½ˆ]7ËÏÔ­Cûö¯UbJ\Q¸tBIË·ëÞÞ¼¼Šƒ">7Sž7átÿ1_Ù’˜sJ—áŸÄsÓ“É0/^ê­b˜ØÙ6­v§VÙnÖÌ™ˆh¹«ËBÉ¸|w<hÖBúÒ}è÷Ò+CùñÆñÛiU@þ¸ “»q°Úô&YÃ1-´XÇz	Z_/=£FShùv-ûxÞt(ÂÇWôaÈ>\ãîkZè¾b•k¼zV5ü‰W®æAæŸ´UœGÁCõ¢B¤0èö=\	6ò4ËÏ4Yl>ËïÃÍÉùÕ’—_ÁZOš.Û+ìb»Õç×€ubO+VÒã’m‡Ëâ«8œÚ¸mòi&RZ÷Ñ»âü‚ðìÓ.è³/v‡éŽ0–ÞVšja½‡_À
wÉ [)NdÓÉxŸ0ÀÜÃ™^ú)¸üÐ,3¦?¦Œê¿?N äú•~¿0‰§,Œ%h‘öWoÁÉ¡x5ÖO=ðäfäìÑqÉl€yƒc¡÷„_b]œøt¡e=Ž™G,Zd>Ã%g'§‚70!ÞÚz8Ã˜@ßÜxš	~âJåÆª¸è·Ñ¥nM ´«Nº,ÒÝËó#”ù™0¾ÀÊ”e'Õµc¸aH÷þóÓYå°,WòkI^
ˆ÷ƒ®¤ÜYÄî½;ÿ-´a+GÄK30XGe,üžg"c@óÚtÒ©g8ËÅõ9o®bõ‰•ûE°~$¥1ôËgÉ>·!¯dawŽÐzFòÂä›y±ñ"¸ò”óø±E˜<ý=;‡½‘aÉ–˜Ž8Œ{Ïà„Ýkêo˜¸Põ0 ¢Æ¦óß½YéÆÎý?‰þ~ë?‡&p[ÂN¤r÷v)âþIw–)™v)÷Yâ°$ŸÐc–œÏ i¾“ß¥+6Fîà–å.'ƒfk¡}öŠë<Æ”ß¬2­ƒ¡»Ù—[º€¸wÕÏrÛo~oQ‚Å}2_LöàH÷˜Ã:Lõô±Ñ`“ z¾ûïºþŸŠÿX:]j¯¤-Ö;Þ^¹†PKyƒåÕU˜â8ñiv©âW&Å]a5ãÏk“1Xü&œIÅ1-jK—=q`æXóXÿ`ÿÂôŒYæ=¾Q	“•4å/„‚aL!w‹]<çÊ½
^Táòíª'z$$û4mš´*cb4W[»ÑU,ÖuéÍ^x&Gýæè]…ô?V¼ixè-ä
ì¾]¼<m“M‹¯ß—a»ÌÜ=¡¤È|q–4w±ÊÊ.•:¹€cž•¼Â06Ãr&èº–ÊäÿaÏÏÂp±ý™°¬;ì¾ö`8®óOûÀþãó'ºÕ°bO6-~¬ÝA¬lB©­Xö»t·$Žó©N1¦nã,ãÛïû>C¸oË§¨5…\ÕÏ¬÷˜jôÙ T'G½—Mõòcqlöˆ–×¦z=ë-^T§Á÷ªBvg,°ÿ½í^Šx¹Ýsjƒ!O˜ü<CçF‡ëí–ÉÙê8µåqêÍq\ã^
þðšZCë§TŸBÐ^ÞzËŸ*0eÿNóu z±“z‚Æ¡ËõíçºŽ~Øø%ñJ”.JŽâB[nÔW\¥¤6‡uˆžÛl}ƒf,ÇŸÁuþ«„/¯áv•Í±r%hÎ0ðiþ Ûôb×d^ËQY;Þc¥†:óã¹ì‰UHê¬çÞì¤‡yÇÑ3{ w“¬Öµ©s˜´‘±‚œDý’; G­§/Wårš*ô¿uDR­ü]oU[Xª,T¹yÎæEÜÂë±€›|’pHÉ·¶êmNaÛ	ïoûS`XìNh+¬&NË^ÑÃ®ð3)ÏJ`ÕÙ_Fw+Ck+ÕÕ§?Ó ýµ|µ€º	Ù†¹j0ä÷4’ú¬Ý€ç,_”±ŒùÚ:íh\ôùNa”„+ç•M=#ÙàÏ¥È¬€RØXqòfC
ô<¶Ã5‡ˆÕzªÐ§°¿ °ø„"îÌv›œÌ}z×|8ú½nã„þ4·îClã?îÕÀPGýua·m ±X×„ÿ±‡1wæ@}N˜; ÆŸ#;…ÒÊAÈÂlÂÕöä£Ô¸¨•íñßn("Øki|‚	~ÇØcoÙ %úÎ¼æÅQœ2,Tø.W½ˆKcŽ +ZPLH<J™=›|h¼pM@”·:ÐÖ½–=¾Í‡‘€.<] ­®õTHžu8-üä}xQ$NX„­*]ƒ1ñ{wâ}`àÛÕ„ØÁ)Üzðê‚…#LŽžW½Ü¿³.ë3JaöÉ?¡_£Í0™=µÂET‚b>gy«ö9œ¹ÕÃXÔÅ¤Èg×TZ¨°IÉeâH™+,.tßxø¹ë?Çh„ÑJú˜>ì>%rhÛ®R²½?žúýV,•\Çß"±j}Fz¶ÕÝÛ›–9âîZÿÅ…ï.e#°ØõeõF¯*awŒy‚¯Ž|žûjâóâ©¯SìË:S/þQi„åË­{¦	»‰×%fÔ(ü£y•b=öLÞ¤ÒÂ.«¸ýëÍ!0ð÷õM)9
sS!—Aû’·R÷‹ÂC9ù“óaæ1ÝzX¡,Œ6ïjGk˜v—uùâ“Š¤ã.WÍG`2MsR¤é"Ôö7”¸–¡Ø©?äPs%4)´ÞöÝ{g\N¹ùj+9ÎO*•ÀB˜SK•è$LÍ•þÍœÀŽ;¿“×Šw¸j1÷þ´¤jXÖ½þ‰DÓxÓ°¿¥0!±aÃëÊ…ËªÅ‡®Ÿœ~Ó‹„¾1nìþònpÓÚ	­Ý´?V.g¸´€DmØÛ‚½(¯{áP0´–Ò:¾Ü\ÁÑ.£j°múØ—¦ß›ñDgp‹‡y°À˜û9W„ó©¾ÂfÞtØ‘´ œbà"j1OËQp=Ý-nÇÃÞüÚ²“ÛsÔ²Ò€•ûÆœV?Pã2Û©“Sä˜˜î{âµ]2nÔv…”&„¼„ÃÖÙ7Ù`\èî¬`ó7QPú<D	3SÇœ¾_Á%ßj¥™?/¡3×K3é-#o¨ke2ÛAm!ñÌ±V\s)¾U'G¹÷0×ÙXG dð|ÚéˆO4¼{Íq$ÁCîRêw|w˜‡·­”ˆõùo§ãšqyúÛÉ¢A¹]‡\6áÁ¹%šœ§é"P~˜†Vá
4]N<U~Øú/_ŠS‡&n©×Ïe`•˜WåvNœ@å¤ÔðaÍãÊ¿þW{Ÿkâï¡¾Ãƒ«“×däTþÂÆ€‰j³4£¡Q?˜´hKÌúÉŠ
3žæéB—CÒ~“è%\€¨?ÒÌù”ø½ ÇZª${k°Ç]Ux©T»6†|7=‹‹çól>9ˆä-vÂÛ1\íÅ¶uì5¿^zh`—%ÇßñŸ©ÿNO$"*|ÇoÏ~¹í¾Ó¿¢œZw» k€‹· q§ïi#.× à×\»Û’´°ð¨N™Äy'T
Y:Ý`¤¥_¸Z)[zcž¹?‡ómÜ%4bØÖóÖ„*‘Vuëú>xÇÑ³Q¼{žÙC—¯¹Uà¸59mÀý(Gnž?Vxt7¬ÊÛ”ÿý•ÎìÎÍeÒ0Èï%¹ØÑ‹)çÎ:þÂB¡[e±@”|$1UH	‹2Td{©f _UÚG¡kÄ’gï~H]‚J×Õ'0&ïTïù’VµH•L.áÀ}wÖæFìxHŸÞ8c1½wÔE2'W÷þþ¹ŒóÔâyj£ŠXÃ\.¬¼›V<³žuJÅÂÛÄR}©Ég5’`sÑéŽA.üzs³÷kë3È“®ÓÚeŠ«c^Ï½ÔãlÍónÃºjh2jù*eqGðœHˆ-ÀDa-™#2)â’ñ·øÄÊ¢+Ø4ƒ+}’÷mpŽÖñÉàÀlý2ýCâÖ~Ô8:ÅŒÌº‚ü«¸Æ¨zmT†
ŸÕM?‰û‰õÂ´ÝíGoO¼áð€Aß°y¹"99Šb³¹”Ûòr»5”ã7}%px¬E;ÝHOŸo#øà\·ûÕì#Juí$Zþ—˜&´.w‡§¾'0ënÒ?š¦Â®Ë8ô©¢È“b7lW¾fn–D\c»§ž
ÿ…ß?¹ŽCúN¼T<ëª#ã}&ò‘”žé£vK;MÇjÆÞÀÄÓ)fºì1Vm·ó(ƒ.Ñ)úþ´…üZ¶Yßã×pãÇ$»^,L8Yþ<³ÿ†R½“%±Æä³ c7°ú/šá¸OÈ‘{†Å@t5í	-áçJþ’œ&{§–(z`^òðesöoØ´´ÏAfŸü4!	e^ÛBnß{‘Èclþå-´³{;ÑÜùfFã%ËÂ J„ƒz('·(è˜MFÂ„JãùÓQ86v)—öðØþ¸XcÖCÆwKô³$>·ïZ—¦ÇNæã¦Ü0î(0È’»äÞ¾¼µè
ìW£xôvF,Vme`7RF1ïå‹ýØhü@¾v%K1÷ÝÂDK‡‹›Œ@:µvV7ð.:eLœ¬ƒ¥@ù~¦ì4„”úý8â)wS>û Îþ2Mxš[	5Î÷nŒq®¥,©Ìˆâéc²`×ë~†Rè2Ì^§‡‘ÿXÊØLãÊKŽS=ÍÒ8õ_=ƒßñ
¨~e²Jb†>S‘4†ès&†²%pVª–Ãø	…`'"œ&w;)òTœÅÎA‹KkÈqf_w¾¿«e  Ú[ËHLÁÂ½Š‚!èüpª'™”Ë÷½SüüÁ5ôèá«Bò€†ªÃãz–(óð7¾	54ê¦ßÂé»g|þfYC»Ãè`;£ÞNŸ„_¶ÄÑDÇ&‘½;óïyëYãn\	ôÐ_Dƒn;>ë°½'cáN›Ž‡g00ÝD“¨÷&½w9°³Xç¤Xë0nFš<nËBbÛ÷ÿÊ?@qM™·:ûkÖQ$ÜýíˆƒRw9Vç°§¸øJÂQf¬%“¥u¸™‘˜(Ì¬ëxˆº{é<·bd>ùå-nß‰H¯çÆqÞõú›u‹XZOêà;{VçÝ¢8ÏÀôÉ¬ÉŽZ+ Äš^=/±ã	bnÙŽúsX=]ôŸ‹ÖeøäË­™‰£¢ë-ÛU½°Ø=\rÄdódüÇ›|Æ4îñÁÃ]ÿ€àûK0‚	*,½>t+_ŸéÎéjŽõ§£®|Xq¿Ný[NN%LiÀPG®H;TLP?1tÈ‡ó¤/ßvÉQÿQô¬9¥!¿ÜgÕ±WkåTàqsìßØrô¹vç"ª-ÇßƒÁ±~âgîœ‘Ú	þj¤JÊ?>««µžqø¼Ÿ:lçX3yaäôR%— ~>)–>ñº]º8XÌöU¬_wàPs£»—5väï’ÊñÀIÿ¢êK·ïËíJc–M^ÄUÍÞƒÖß‰°å³ÎÎF/‡-ÇïœM¿µ m¿V®¤JÓ!ùl–ß";ŒîÉzîæóÃ×›Ë¥·qDóUŠÖßsRýßR€ Nåè2WAÙ"Y'Õô>LémFŽOÂˆª%m|,þØ\ÉlÆÂèîˆÀñnNà.]t„Å³§eÎ†h`×çÈj°@²Šð“È¼	üîÔ[BŸpáÜqþøçÂ@ÔâqH÷}óâ™3¾_q"°6Üð“n
w½&Ÿº
]—¼­^ìxç@æ_#ÙÚ¸pÕŒn];ÉJ=çŽ±~ÂŠ/[·ô
	˜uPüÆ€&vœzGsçbŒsTu™Ú@ÿW*¯¿bÁ¦O-Q©­?‘äÞCºõÈ@ŽrüÔô¬ÂjPØ`åê6Œ.>åà}Žëï)g,¦`:ªÈs¦3—§VÞz±€Ë¯Åø	Ô
f·NŽÀª?çˆùÅ"èi?hµßºèî™z¾Æö‹{D;Ù'°ró¡F›)öê»:¹3™áêsžªŒûØ=¼Æþ('Â2Ÿ4Òb·ìgúÒn~p’7û(GñãÇF %#ôŒ¶ç5ó„a£Š—Îå)S¿Ï”ÐVyiÛ¾ÿ+TÞ¢ð=gŒM<v·?ÛÂ\»ø“ÉûÝr',î}0á‡%Ë£ŽÞ{Ø!å¤ÏÚ®‹¡ÐCáþñíÉ»¸pãá©›WnàHVùkoH”^˜b(â‚CÏÆ71ö·Tëè^ìb^•K|…ØÐÂ²v{gÿSéR<ÍÃÕR¡olíXÏ]ÐbÃß.Gè+Ç¼N¸6æ1rïÇaáû¼ÑØÙiû±*’±JôÏ%+&Î|¶+(ÙÇÔÛ8íJ°€šèÎrQ–ÄœÄ´/=Ã]ö.¯…«qüÂøëóv¸vÇyU™ÒFö«ÜhÇ¥Í•ã÷Á¸oæfâ\Ú+qðÐŽgtXy_Å…é6šÍwq8-ã/P—l…›ÿÆŒ³9±±8çè–Ù4ŽþÌŸ­è/„Ø$ÛÈg[+P AÏqÆjRÙ9¢<f°¹›¨ñÄÝHÎ_kþEf`ÏEAËUeÜˆ³¢¿E™Žs¦Ý%ýß… ÔQ9û‚ÀàJôA×k‡0ÖâäÃ÷h¼ü~–ÍÃ¾û?|˜ÄÙ[6èµŒ%iïê.qáõK†dÓK0tì¤NÖÜ	èQ¤uWz;ŒÉ5üß4ÏÀj°Ë‘h/Üb·¡X|¶Ç˜ÿ)è“'aL÷Ÿ±í/žŽÔ1(‚?*ÏÖ„1Ò¬Ü*ï(.šKpD·9À’Ù©·Ca;üKúì3¿„ë)a2æ)ö@î»ÄÝŽË*ËHcqé‰ï2OYaƒ§ºò=ñÏzÝÿŽ3—ò¾>ð'½½ ýƒõû#ÓýÁÇ‰Þ ÖúÄÈ<ÓŠÐç–ÇzLô*çúeë­Àz™Ý/šdœ3öJ<¶ 34šýÅ«q,eN(eTg£˜4Òµpx»_²8nFÂýõ.w™ÃÊ³zþt~h´åë¸æ{æÏ÷+RáÂ%® C	sGXb8ÃqñöÝnü‘a‰­Ú§XÞ+P@Zç>ŠÏ>PÜßÜ1˜ÕÄ«t§çˆ8¾Ûº¢d¿Ì2ªÇµÚšÂ”U¨¨(tQ6]·ì€EÆÔ­Yf[3à$‚sª’ŒT°ty¦¯ø‹.Înü#ùU Y‚†u8­Ý/)ÌÊÚæÀ;Î™æOÞ…;þ.M¸l.}«ÔccýÐQmWVÑs»|yÄDõV“o÷ôÚ«â!)-y—>>	k,¦V…Â‘×‘ÇÕÈØéÏzRž˜‰í/WÞ?‹ï÷|ÜÚú]º…¬m'¥ íÛ)Ÿ£Ê\8zGô[¤½/Ü=g'wZÌW›?ÜÃAíc‡t¾â¢À¤]ä?~hö—ììé‡u†4ù†rÐŠW|;°n¥¼°@“‡ž½H•üô ºßÜ•‚þ´ÁÓÃ&Ðcÿµt\jrg>¨¶š†Zq åÛÉ©.À¾õƒ¶&±RkŸöê‘ÿÿn™±¯72n§¯q(6»ÂÐ¾g¹†oa9/æ¸µÞ?è:7'ý*
çí;G	Ä§üâwÄ{±!ð£ÃcøŠclG<Ë~Ñb3ý_GãÝ8è|ë×è%X·tÔ–_=Ã½¹E6µX´›ÛøQ l±PŸÃYÀ×çŽ-góÌo!1õ¼qìÃp(2½vš#X|e¤^ešÙ}‚êKÛqDr¶ºÞá/¬Éû¼È^Ž¿Ø?ÆÕ”Ÿ‚¥ÞïòJË@Ž‘c¸çpgÖv)øµWccî…Ö§FÜ0p§¯©T¦’Þ)¹¼ €C)ze_¾cóDryuÇ+˜ý¬ÿë–8k¯gÅÔÏÂ¶J¦*gÚ^Xi¥ç\Íî€àtçmç8úçÕ.ÕÍ+r»»_+ÛüÓƒvAl·ü¾Wî×y¨ªÙW½.%ÿ]ÑëzEW„óÅa6¹ÎAšWÈ–B”%ŽèdþN5‡´ÌãKÁ&@5%ì‰¾
œÜ)g`ÚZ°}ò!Åî‡2»`ˆŽmÀ×I ºúÒK;§.ž7XžñÂc­«¢–|0úóÇVþAm˜7jY¹•¦Çt®· Ñ›&C•<sž¿ž…(ù_ÏŸÂjq”Åµ×˜W¿!kmÔ€COtáYºTº×œÉ"1æäƒ=œ82ÒD+»Î5ÃòÛƒzà]ZÀß0×‡„ŒÅi—ˆçH8“| 3w§g–Ü®qêíxÊƒ¸ÖÛ_Âlû•Ów%`úÏ9/-YH64<³_±òFJß)_;œŸùNTyº…Kc„ëþá× æÑ|VÓ®HXxñ´#û?hz<Á'öÇè¿Œ…=î‡!éÛÍü Õ¤ã˜ù¦¬?½F÷ÃgùìÓ£ä¨x6(BOEâ|Ü²fW½<T
5ÿa2Ç9¹'KJOhþnÆÒ³÷vpj1Ü¹ê6á×L°ÿÓ‡UkXù\„?æÑ:,Ñ»¥gxVÁòzšBÍ_ØVM^^ç]Àõþ‰=-â›ØAVùMRpHõÜNƒÉ(ï£oÕ0’t÷.ß©˜RkÊwïúI˜ÌÙÌó~ýú¹üCÇn@›æë´1æy(>qÃ4àª;´¼àqyô(JD“¤U`öÕƒ]:D.œtÔÝr÷.Ì)è+ÍÿÜ©
ãV9âØ÷¾“³iH¶:Ç#ŸB]¨óèÃfX}âktz
Æ•ºš2Ždã ýf†g¯,´ß¿9‘åÃ±„ù	DÇ	ÙŠü\´ª³TÙUËÙ×,#arW›q‰?’ŽñHvæÙó{I[µ0t×ÅRW8pË´Ý¸ò•ñx’†Ñý05³ª1ˆžÁ6ú\>¡Ëï±¢iZÈ·LúiîÿTÉz…Ã¼ö,]g‹q2¢ýXÓ?\ø%V©U5‹ÃŸÏ¦Üûm 3­Òƒ®ÏÇpxñÀ{=7	$~JOÐ¥´ P(ZûÙƒ\½ãG/‘¦`0îÌ–=ª°j½÷„Öârníò#ºª(±A$2ø«è.Ž4fF2aápm›cû1l‹÷
Toò«eiöQÃTGí ¶³L*=ßó;Î6Ë­ù"™D‘<£¯‰áA£C%ÍXê8åôé}ŒûÛ¬ƒ¯¤!¡ÐIŽò¸³¿éâ”^ÿÅo7GFMÎB¡ÌýërÔO-}>SuYÁ*V—ŒÝ{^K…µBû¼{ñÒ—*¿o"<²2v]uûg/ƒ‡È2Ì?“à÷ùUƒµô{Â7¬¨^³ÞùKùôc8Úé-}Fö=ô$ÑEÕØà}ûúiMgR%_.%‘÷ó„­ñI¸Ö¶²=ˆ8ÆË–j¡Â¶ã‹Žõ‰Ç í›,ëÓºÐãÛYyeú&Toî¾Ó'Šsß®ÖÊìÅöxXf<§+ÖS¬U Ëù7mHN'Ô±<|¼ÛHæ÷Óg|‹cöQ¯×‹qIíŸ?÷ËM\ºï=G±òˆq»?˜äB[£Sµ9#ÄÖœ¸•7+­ÿ~7q¸°R,Û[hëq§ˆãHRt%A±	Ç¿¯×Ã*?SøÑŽbX¡¡üö]	‡[ì|¸F­qxÓÐUÈ…ó&mcaÑHúòçìúIC$µì=Xîî‹t×ŠŠ®à žýUK[YØv£Ý½µ…S²†–ÛžKØuMu0Prtüqgâ=öÄžUÝYo<†6'NÂbí%Û¦ï`F4#5çì/œ~ßu8xj-Ë»£i±·-kZé+Ôþ~iÛf¿ä7—Ì˜-æ±ë*ó	ÁYlV1úmþ_äSs«¾
•+bÒ¹
aùY¡O[¨UwúÌºþÎÕ7ÈâXç(ÿØ´‡§dcš´6a¾@/S§Ê/r0ë4]„zö+†–ÏH}(R´çé¯ÿî0…	æ‹_lo6AùÒžwÓ%¡žxá÷öþ«0»Gî9‹Kt’Ž_apj®+£`7‡FW	ò8›×1=i‡CÎt'ÝrÁ–/Ï}6þƒI½åäÑl(gØëQ¤‚³Žl^†Š¾88ï_f~†ó²Ÿ­¸5: Þ³9›EÅyÇëU@3-›ç¨¥6Žlº¹w{Ö:†ŸK`ÇAå“·/ê‡cÛ¢®˜»²%K•É$îËÐfWÓkzÇùì™ç™©qæ(cãñ°×Ðkš~#ÇîüÉè}Z$JÄtmgBÔL¿1zýù$eª6“†Š¬ª/zî°V™ZV›¤…-ÇV´@å.vÈ5ïýsµÌÉêŠ-AÐ«½êáŸJ_qÙµ6bËô…r”YÇK‚:„qQ[èQQŸÛüC‚`L$8Û¨}7´xT—þ¨_ÊºýûÉFù…œ÷Ã”ËßŒƒÌë0ú"²êU*-}ý1Œ‹Å_o1“àwJg¦ãeh©>Þž£Ðw‚|›þH,,	?æªÜ/˜3œ´mq€(Ð<ÂÊ†	¦×ë» ?¨IFžÚgê|.)mÿÅ¶âcv"{±5Ëÿ:ìRS1ûòÓWHVó»p6~§/ÊÜo7`°ÒâGˆü~Œ¿ÓëÀrq»¸òr‹EáÌz/ã”ý?úIÒ$[cÓ]ýaÖ8ÐÒÉ•j³'rÜ½ØMUÆÜDQè%åû­Û—_¡íöåõ?ôü°÷Dv¯,’-å©‰¯²`JP³%ìÑ]è> ÄâƒýFl.TåÈí
ß›Sóò&ÔzWo+êÉâ¨½‘„øà2v}–wéc„¶ÜÀÖÔŸúP;ÐÕ¾,ØõlAïbÏ4—žâíì§ƒå†-Îƒv‡a2-çV‚ß~$hžnz4c‹KWÞ+Ô¸ï…Å‹÷é¯1ŠàtÄz¤–w"šbE6]³'š5sîpÏFk’EŒ/sÛÏbÿ9žóÊ’Ñô³”9ëVö·°îy§`)Ú›~"gÿá’»QN)íe\ZWÔ†s0œcô~>•Gä¾9ÄÏiÀ`‡óšÕ`	Ž©McÞ0á(å¿Ø¦T5ìY?>ýg‡ç-•ß4ß¾$GyPí{a…„SçˆVÑ‰`ËµuOê E#ó«ö;¨1éq<úâ/æ¦H”?ªfÇžëWÇïR‚ñ*îÖ7iFØ¿Ì~•Œ3nßr-?Cý7ŠÅfÒ
¬^$—:x|‚5ÏdUÓ8÷„î¦€Òi¨‹ ¼ˆùŠÃ+¾#Ø «àøQ¡ûP_üú
+žÃ‘ðµOoÛR±ýîE‡)¿–™¡½KG÷tpð¨?î·Ùà­Ñò»Û[h¡&,_5€¾gö9OÅMýA¿ +PibxT
7Þ(±9=’BâËÃr²§´±Ûv|vèP!L$6•Ê¦¾Âµ3‹NMË8p¨|€Ö¦{þ»n›S‡ÃÁcN÷Ga kŒ8›)awìqŒH7-ÆjÕÊì…¡
ÎçÎáûÛ…\`èÕë–¦-œâføH‹%ûËY>ý™„êš·Ó·pø—ù¥óí`fKïý|!tSäÆ)nîÂA;cÆ‡$˜\I"ù$<ÄNí¡a—'˜>à?"ì9ƒñÚsïówz`Ø7PÖU»œ*Î¼˜»cÑ¶ÑŒ1õ¸to¼ò½o(—³Üš>C¯8¨þW^L¡²a`’Æ•~–Û³gqŽ~?Ñý)håå…¼_/¼Ý?ÁØ§ƒ½Y"–¸5öö	…Ð.¨<Ÿ*À¬p<O_8çü©¼c5¦ 7‹ Ãû~ôÖÅðàsaX¸¡°ævI‹‚¯„>Â¨BÔæÕçØÉ¨ÜxBecdŽA¿]µÏŠg00kŸa;¢E„ÇÅÙÏ±—gW~ÙF›‚ÕŸ
aÍÂ´MH¿6TGþ¹WpëL°7|ÚÂõÌ	ß#ÙÆ0b}î¡ãÌÜ˜?¬'qëîDuÖàªèýó›½P¡"ÁoÅ‰uÍÓ},(µÓ#ŒTÎ0Nòæu>4W×¹cƒ$ÿ˜¿ó8’vlü}4ÌlH{ß¾ç³Ã„a£/cH“ëcÝYß…w_ÏÍžÇaBRGŸD^âÚ_£þ¬Kû;$`–dyÄ/–[ožu“Ñ–£òÜ3Æ÷¯OÑ[¹DÂ wß[ŸÉk8zÿ¦¼'Ù¶N´V¿›ÅÆIÃÊF×Û eÉïbx¢ŠPŽòNÖÃ9\XkµŠ¸|­×îhéºá–^ÒÙ AFè‹_wX6ÜáêB9‡ý"0Ïsã®‚4,ùQÿå{=b·™._É€>{éÃíLž8}i)bÌ=Ï0r¤º±É{i•ü•	«Ü[çÍ .óú×ð!8Ÿ*Q~÷’åý~¦ˆ<ÁE~¥†_5YHúÄ˜ãm¡‹ì)'Z›±æDà½›Û2¸åï^D€1îKÃ4ý0~«¼Oó>´7¥Œz1×<Ìå@çw•:žï5^ÔÄñPƒ+Mìˆø‚ÃIS´ˆœA‡ª“Í`v3&dîcZÒ(flé,ë¹Íc§±‡Ð;|†	*p|Ý· …I“sâ°¸Þq³%Y xÍ`‰Áí—´þ\¦ü²É¥	£&F‡e›1µ,ÁkNzýHnûÎ­ïäbÊÂÉDh¥T{Þ s_Ü³C†&p^¿®ôá~ÈµKÙ÷[lºÏJ½ûçaŒï¯¹í½º‹ÙÜUGé?ÈQp]üº&«§Ç;jIÐ¸œÓYaãQ1Ù¿Þöáòù^žçÏ`®Þâ6we#4JªtÅ‰¤SÍ‚P¬¸ðôz.?Ì‰2ÔÇúÁ,ÙÌî›@¹å‹Ò±ýÝïoŠ²Ž¸x|VÎÂµÒÔ»4”^@v/ø3ê±…óîk?¹4±‹#B„;Ý{ˆ÷è×ÞÍÁœç¥BÎ»ú¸¸!:?€üáâk<´Ð,ù’¥”ÉÏ<RGYØŠý_´e díÅÂ'¯1%©¹”dŽM<«'É ™HqJËBF|þL;žà‡Å»VS%”PHÅFêüõçö¬ˆIÆáß£¿¼„Ùzòû¹ï8©×‘5±[f–)þ˜õÀøñúªeA2:©.«>Ã~7ÓÔXzl®ma¤‚—óƒóA%jyàÑ‘b¬ZÔs´$™ò§¿Ç.’v‡Ò>AËù4£Äd ï9²ÿæ»C@¬ö"}+„¶°U‚¾VÅÆšÏ¨à@¨n	·öDý“«ÄÕgAçLXîù¢^»´Û)¼gÙÍÞ›‹©fr:ÒXphEÃ½~jï§
æødõŸ|Þ†á%ƒµ¯r±è„ü‰8m'è¤Þa®¡c{SçÌÊa>A7ÌôÞC$úŽ>\hÃñè Î-Â[h¬-;ÊêJÎœn,½påèïæX>Iìs>nôñ†yµæž¤-‹–EÃâ¯UB”z6ôù’‹sgYœÙß¿‡AÉcŒ‡þ`Úðiu!ù½"$oQ
“CÏë>ØñÂú%¯¿šêÛXõô÷©‡å cû¸1©‚‘ÀÀI§¡ÓŸí¶ËÏ·°º‘Ä!Àÿu‡ksÖ3±éÄ©WnNº0â~åˆ„>’n¾Èº˜*u¥-Wxk¡é[çµŸR/q8¢VÿFÊo˜±½(½Ø±Ã‰zcÇŒÉQ
™×}ø/\Ž©…»·(~Ê¥±„@óÜÕôó&¸²Ï/öy±NY©Ü-¤‚aMå¸Ë†q‰ê`—O4T=©LVáZƒaºF*ÖóN˜wjr4ø?OLýu"!¹CNœ6Ä¯_ï}(ÜqÙû”¹\¤ú}Ù{Âö“cìÅgú Eäe«‘@¬?ö|`}ê:öÓ}Ï‡!+†µKr1¸*7ïd&á@ô'–¢õl˜:ÿLódÄ.ètX –
_…©õ·/ìx5úÆnb¿hl‘®T÷.d	ÝÀÜ ýƒ+zJ®Â¿í¹;9ÐcâM"ÂTôw‘Þ}š„Ý¤ð¿Å¦ÐoQyÈhóž×-è½6Ý¥Z–éaõû7ÅgGÝqê’€ôG&oXu‘ÜËTŒI «¬vAŽ2@YˆÕõ+.ÄÏfÉºKa’DÛ7j&h²‘8¦râW6þûóÚÈc¬×Zµa(¿Ÿ.Bë:v4Y27Ð )#ý’þ?n¶f8Óækãà;o–Kîr»^(†DÛuÊQh/xdˆk=üý9”ŒÐØ>ÿ‰“ù ’$l¬bêR°îiß7i(í;/Ê`3/T èV>FÓEW´u§àôò½å•ÃƒP÷ü²Ùùå$ß´ë‹8yòŽyíëšŽZg‰"§X’PëÒ÷ÓÂ6ÉµÒ0÷ãÐk‡Á×w9cÛ?úÐ7Âå'/æ}øq&Npï’!®ÞKë–]‚²LjíûÖ˜Úph-¾·j([¯Jö±õïëNìÖD…Òg\æâˆÖcŒ€Ækï²mØ;Î:k‚EHöÞ¼bñ÷>'Üº>iõŽT6}ûoÒÿ¾Ö‘iÀ~C.z½‚=8ÈwÌÆ÷Âg?"0aR¬ýŒgÞ.@èÒ®Í¨â9½Ï÷Œ?J¯äV	ƒ$úf;;ÍŽ±Ø| tÿvpª]¯kÁÙóß6ÚÆùÎ—ºtåè{ãec– Î{xj]“ÿCeÝì{
¾Aÿ»šIîÓŽÐuû)#ƒš™^Ãø+‰Ðux¦Ñï|Žêsøle@»š\vÒûXŒ=^.SGÍ~š§­`]![­Û%ìS¹;ìôT‰´T¯©Làd¨Û%æP,|Iß•6vûkSín©ØÁt×Sçƒð×àUû{Ïø¡±íîž£0, µd$@Ø­®¤&>Î	=~†\áû0éZRÝÓTÍõ^â¦þíìÁíq©²Kâxè6Ö'ý¦c;c¿}’û¯”#¹°'‡™:c¾]Ÿ]Â6C™ZQß EjeÍëg¶{¿¹zY–Ù8è_ßÀ‘“Ç¸ƒfã«Ã³Æ8?ðÅcþ¹,®¶ETÐülÀV¥zc!$7×ZöuVBË™;‹ãVæ8f_³~CCfœz³ÒCq üYôµ2La
PV±¢†ú’ aÛ€£<=œ¾`{=[á‹×N0“œÅó@FžûËÆ(lBáão¼â‚à[ÔqëÞ¹r9K´‚cDüæ§:³‡1ˆ@q_?ø‰måSkmhÀÞ±ëµ™?qn†’nÝ¦Ú²8ÎÊ—C|nÜÀí?r”*ûˆs*cÅ}¾–ZÉãÐ™1?sœÆÇÏ+èžÊÁú5>CÎôØ–¦Ø—ý  [¨~ý‘pãÆz¦8µ¼KÔ0vžÎ±ç­6TÜ=þà¶ >}óêÄ-,«MGÎÍ{@ÇÈ-AŠØÛ°°Ë¨éNÐuØzüÀUñÊ&Œœ;Ó`½Åc¡¡Ÿ‘,{òæQÅ‹@Z¯¿vò	,Ý0ûï€Ã	ì`ºÁ¬”csÖáUû~#¹WN©KÔFþ®p“[âpôkÄÐŒ=Þbåo€«5a
GL3a¹éÜYaÖc8Îš"vH¼ˆ¥ªy´SPœg©7P…‰W2Dº/º`‡GÅ\÷<’(ø¨½Á„CC¬âÞ©0õØ÷Œ¢ð^¬ùy;åù:½úñæ)$’l×IŸ¦ä¨ßû./¯mâ‚ïOÖ?cû0¡Jœîz¹8–}c±6<6£2GcÆ€ÖýÛ9Êc¾zxº5ˆïí6¤€¨$ÌNÆž9×Âã^î¥…L£Ö#»:1i>:=@…Œ£¥¼D½¨‡0ž˜¶vŽædž•„ÝÄ¹Ô7Å:ß qž½ýèÐ'×Ì‡H5ì·,±"ÜüYÜj¶×ˆ÷|DŸÄ$;ˆåârïãÞÎlXt-2O¢Í¤æƒ0Ôô)|Àp‡#ø^¯x*Ã\öÉ¯‰»0#¹W¼83{G6òóü“åv‰JLœ\Ì&nìê´†¿™¬J“~ðÁÈzÇgÎjè¤ß#‚5ÓvÅg®ÆB§žüóö_TP9x.éPÄw\Èö,ŸþG¿o}®Ú}>=H³Ñèu
èJíº³z•/Âx±ð[ŸgDÛÇ2}¿øœ§ªs\lðŒBs,Ëé]b0QDòÆ~ýU	&îž¸ÞO*gÄæˆÙ=¡bð{—WoG–4}ÜÃòù,4.ÓÔÑb‹OVB˜mNº¥Ôlê‡qE7°r·òWlÚ¾›=6&Z‚#}ÍTFa?##è|$¶/T2»Ò^z)á‡+PpÈsMÿ« f©ºË#è'RH>ç¥ PùÚg}@Žª›6KÂ—çkÆž[/ûâœµãÂoëX½NÇœí€ÍÅÚ.ww<|(:‚‘
±ñÛ øEó(ÉSwò×ËÁQc_©†8•geð·û.Þšu¸$x~ŠªLt‚AÚîñOó·a õë†‚*tÄÝsøhÈˆó­—YVŒ1ˆûæ_G¦hœ™!ðß [Íô³ÓµRå(FÎ»NÜ!á‚Zª¦Ž¯/v1éÿhõW¨t-ñ`MèÂÉy^iˆè÷¸QÂäóË5S>„ó0z¯‹éé¹Ðü°Â¹ÕÓˆeæ”9+c@Ö? ~=‰Ý®ÛÙàüRÕî¿–!õ×£‡mG!‡ñÖ´Á›eXx`ËÉ0Ôï\Õ—]úÿ{”[Æîzc½®ËŸC #Ú•¾yŠ80ÿðÞñÅQìþùdã6ÕAt½¥Ì7¦½:GÞf rTGkÙî½Ûå¸×úFr
V©µ©hHƒb]Ý+ï0SOÎ§çi*ö·]Õ©}óÖŠu,æÿÿ–üƒ•‚Å&#¹4al!H½þÙõHåŠ–èü`F/žÛñ\Ž¥¦}sk8.ù¼|v­V:_.VÿPÁÊˆ¬#Ò°“Î¸"{ê\›ö™>þc‡óSö±8³;Ï˜0ŠïQƒé‚õÄ]rPC8nîC@b!Í5ÕÆMô{Iv8]
£#oïâòbg¥Á`Œî?&\ßÈSÝµù‰ægaÁ>D^^aW,ïE3˜ÄÁšÂÞ‰·Oú çÊ—†IÛxì±XÎe> ?-«FöÞ†_§E“S a]hØùâ®ÍÞ^kÑ‡ºˆÃªsÜ÷a€3¿R/Âž@±1ÝÃáb„$ÛÂ2¹¤.XÿäÿJBä¾jÍá¬LéŠËþ¶óŸÆ}‚³vß¢ÓÓzŠS·OïóV~…Mê’²{ÞCÖÙ‡~.ìœ6èy	Ãì]c|QOak9S$Ú4ˆ'
5(lª±¥ìÙ-æã{±ó•¿õÓxW“4¿^ÊïÄqa«¾ëAŽ	¦²ŸQá…F>ÇöSd•ÉVåí00)ùmQôäoÛ&ˆã´¶#£6%‡µN Í—êØ’û¡=-_Ä<ïOhû=­Ýì‰å?8öN/˜§§­#w-à<±Õü¹á	˜²­›V¬5†ÁšµS/Ú©¡ ¤óè•KXeç]`–¡Âõ_ã®q )¾÷N1NêÓh|{)ÛL·.‚ÿàâ‡î}û`œë…—ÔÔcßæ£tmœ*ùqÄh^DŽº_JqWs;L
d¸|Ú/?×8ùµH?ÅÔÛFY1'ò”Ù3w¾²×íc?öË¬Áœˆi‰ þ{ ödšV}U€/C>ÈQã“QÆvŽ¥æ\ohtH]Vƒ¬?‡¯œTgÃŽõqÛ¿Õpê¯@W2æ&äG'tB?Gºó¹Ll‰_mQ¢†ÁÝ»>Z‡…!³gÌY`ÊÑ‡ÒöÞnÂî¤Úñ†¢$hrcJXÚ©sù¼9?â@e¸eïmØrÑœœæÇ‘®õ»“¬Øsûe¡Î	l¸ìR¡ëý/î¾[áê€U­L¹Øl9ŠÛÿþ|ZÝÄÚ	_]¯@åweæ”jY¨z§á&¶õ
r—<¬Ù¡éÞêVaì:aW¾³¦ÿ)1œÈïìcªS=‘—<ÁXàl{3+Œ‹kZ;¢U%M=Êï< ½õÜ×ŒNö$9…NgÁr4ëMå©Ò,£/wÛõl	oJ_CÑä~{ug\šÎQRªéÅAÆû{·WCFâ{ëÐûÓX‘zO¯‚‰Ê8n)$^y,ÎÜpûZ~¸Öp•Âð‘f.6?ÜtUq»¼«rÏ¥4OWãÌj.mËt 1ŒKËåªÃäœžêi'ÿö_ÉïWªr”ºQÚ ÿòa	Óò»°lÄËý /nrâoðôc:Gˆ¯šûy,%ªO¹ÄIaÿmºFõV8FõêáïÚ%\ee|97‚}Vo˜hxA6s]ì¡Ürõsø‹Kþüžy8£±ôûwÉoßøapÜr–´ˆó£NHgWüÊ„d­}Ò36{`S<Ã^f‡ß
ÈSYbÅÌ œÎa)ÜâbbîÀ%Å¼6y¿nØŠá»J<è‹«Y¢ÚV!¸±]¥X;¾’«;g"ôHQ¡?¢EÅqƒÁ’S
+ÔïV³=ØÆ©µOG$aùÛ§¹üCÑÐ__clÁŒ@i|½òn’O&±¶
ÅÉ–íWe¯ŸA!ÃIÛû{‹`4!Læ˜PÎDëQZÁ2ûá“>š˜ê&é7nc ƒ3¸Ÿ^Âi^Æmýb3T)ö‰ÚpÁ½¬w»x°5æÅùZŠ8uçß¨€ü˜=ý¡©óó,Ž\à/m-ùÅ§Îª¾ù#ì<î¹ÕÐÞ©“=8
#Y†¥—õ}a:lÓ®ý«´ýHT0ãÅÚM×§ÖqB±••ÆÃ&*2XÙ?1Á°!;øJkÁòÁ¬Ïa¹oÛ8Zjc'ÏT¹ÛwiÉáõ§“{ þò©Æ†Ç8cÕðäÈuHVTØâ~Ã@ x¥ÞjÏ¹M¢…Ú¤Ñ8ù’Mûß±»rRß®Ùä&àø–Øœz_ú/79Ü†ÃL‚ufp‡óSRÂHJXyaWïK±ÓÐbT‡¾—Œ°ÿÆ/+z† z›ñAþ2:×Œ=®‹†ÒMt’T@ª¹ š]¦[*ZÞÝ3ÖH·Z›8ØñŽ5îîº0½^bñùï+(N½(À·Ã-F)Z"c2ÐÑxjR Û 9—j*§Cq¼å"³™¬Ã/K·që¬ ÿe9
‰;“2á@žëR³¾uWØÞU¿·u.<I¿äÖ‘tþò»¾¸cØfotßÌû;"%3³¯¥Ê›<YÜra‘YÏŠõåN?îî™m»ôúëR„lïß‡vêß3•9ÜÐ¢Å{Ç~QG:ôTQÁÀÓê)A¶.èàÿ÷žÉ7g„ÙÒ:AcÙ*gê8†¥åóljÃØIó[é½[Øvs¾¬Ù×IÜF.¬£ŒP/´^bÔñ
ú½G­òŒîÙŒ/ËgY'?<ùËøIÖ”¦-3ËG ¥èéÚüýnRN?zðÏCì2“+ï¼ã×—
ãÉ`Z.jxí
S´í­WÍ±×†fµkD	ÇwSþ5(†bZ“bBKMGàû07±GŸ}#¶‡?¬ØžÄyŠ¨‡œ,`æÚÖßÂ0ë¹8i”Œk%÷óÞÑC«DŸ.Uñoì™·Ðô~{VSs"pk¶0<of;Ãh?Ù™¿yU«RclßtT¯ßësZ‡÷ÉÃ‚»ÅÏYlH:*¿·Œ\¥þr[c½ùPå¥ÎÛˆÓtï.2Ã9û»­Viì±qüÔe9Ëe†gâý bêdµûDÆÞˆ¿ŽSVùûç$a8à9OÊ ®6T{µªÏÂìk³AC±HXxh—HûÙ>Ô|ïIð‚&»‘ÐÛUPä{d)ŽÞûEýSyÎ “²sd³óX%øñOÛ2.^´:¨õ†²´ýÔGwø›™é'‹NnÑ2ñìxC¿ÀþR§¸.}8¸ÀÃ
Ã-öûÈ°Æ{­êX{:´tk­¨ßÇÉŒyßÞü•£¾œâ¹Ž-Koë\™øaZÌ•.‚BR4lq$äxIÈ¶Øq$²ÇÀ¤ÁËþW;ý×~ýÏç%+LÓ\8bÎîƒ³o.Ü¥·	Ç‰•¬'uœ{¼[ÊÆý7Œ¿?|“/æç¾<³¥a£ =®§•‰Á?6wr¼íÜvýZAŠ?þÄDÍ‰ßˆ—9è>`¿pÍ‘]b¸ Ë¢½µÃ[ïT½–ªÆaî‘ó-Aè»¿&°ôc'—b>3/è/)šÖ˜‘=§ìxÎ_c+ÄæàQÁ¿Xœµ’îNK	½4¼Ú‹c
Í_~kþ·!Ô›‡Ë’:úôá²¦Ç¾ÏÞç0b:£ àfŒõL­>Ù2ˆ¼,SÅ§Ñ,†ZêLe¨ó|S‡q¸½¼÷ö™“_Ãð/ÿ¯W.bÓË1§ ¿Jä&²Ž“.Wî•jA3[ÈçO$Ý£b²q*Z®•;L2â„§èoŽCR€Eg#ŽÚÝ…úÏ)ç™?öÂ
»Á®ïç+±O¯È6_q…¿˜¾üaŽ}á£ÔWà…A•Ï]L\8D*à6É¢‚õ7ébôÊ°—²<F#(+¥b<OñCËšEÍˆ"=°‹’š?bŸ±Ö'µNX–=ô(¯Ãû˜%NWÅ¸ø9=)v$šÜ*þ;¤øDÞÝÝ±íÆF±NÏ~Øú#|æ†‹.vnësy» ³–´óïUh±][ûœ˜‰1öoßyº+·¹kq—Â’G{ž@,°Xï{6~ÖÔ/rSÝ„™3­‚g÷ÈQÖjdf†AaÍµU–Uú^f#
n\óÞ¼s¤¢fë¾P®3@ƒüÇ"åzìa*ü¦/Ž½n6­$B©%uIœ´€Å}OB»]¶pþLÞ\^°NOþ´ø¢Nµ\'|½=$vÎyMjÞFV†-mm%ÁšgëeƒÍPP8p)Ä¶{o'^Õ°„1Áù°»DlÐ^9¾-…óÁR×ÎØ«ÀÂ2kÀdÆÆÏšÁ§>fbGC½l(Å9ìd; !u±fžD¯©‰ãÄ©–¬æ»°¤[Ç^4-šÚÇüß`Ò_®•÷Æ8ÐAÝËò»{~^p^³ÄÂÙ4Ï®%C§ÜÆiXgõHØí|»¯[Ûh©K@òf|·£#Ls§ÿá“€Íg–û4öÀHñâ'æÆÐ^_zÑ»‰ÊÔÙŠÏqÝ¯tøZ%j²u¬°[xÒ@7ë T?˜ÝN.Ä!·ÿ¶ª®ðc‡Ì¼Vå³R(þ÷¾)Ý9&ö…7½ „9û€H®³D¬ÿ´t©ßÎVSe™Ÿ¬aÊú[Ž
V‘.È/ÿ€…ÇúîÄ©ž‡%²qåŸ‚×@f*à:rsÇjÛªª%píÖÀ­¸øAë½•±tY—J×ÿŽªyC»mûAË}¼ð»G_BbW2Nn/–EjÞÁ|µï™ÎA¸Ðèz‹6P›:iþZè¦ÃøllTÒ@l¬ô~)g=,~Ÿ?ªÑãM¥’cgbZ!äAXÄöIq™ÈúF€R/®’óe[¸1ËvØ?á²e‚xOàÔ7 †VOfoC›É_Þ¥t58´ñðØÅ§µ0X´rÛ¹ä0&Æ>²ÓJ¼
“ï.²~7j£qØ|úp«Å+%FKó`úecŽámìÓÏvÚìÛƒ63¼„Í®W¸ðüßÝƒCÐ¤Î}BùN’Ì_;é²%C“ýˆO$¦Nü¯¯7¦úûâ‡‘¡Dš¥4)ÕGƒh+ET*IŠ$$¢RÑ,Í)©H
É”9™Û<Ïó<\®Ùu]÷š‡Ÿóþ>ë÷Ç³žõ|Öê³×9g¯=žó¾«µ<™»¤ÉÔõÐ–«¾»£™*ŽfZZXnMÀ²Š#¬[Sx¸b¿Å¶az`_íÏ øúêý¸ƒwÚîè±Â&0ååíHQ'ì?³32äÒ4T7J~*\ìSnV]vÄzµ/ÿãŒ¤ðm3ˆ~…nXûa[ÖÕÝYw½›<^Ö4Í^¾“9—N$í«‡Ö˜1“K²Uæd<xvNð®z~]ò.ŽÝÊÙ¡ÂÛÖom9&ßùu¹r£èPqýÇðÆÂ½`ú˜wZoÉ3,ùø"d¡;Ò‹øl.y\Ã©Îë<Øà@jÏ‚‡§p?Ì?§tˆõv_S?þH„>žœ›1›b±d{ÌÌ±—0oCô·€C>8­¹SIyöíÓ9dð3˜~[´l¢z W4|6Ð±ƒ¾ìGGÜßÊC‡ZBÈ·@¶
—àÁ¨‡JÛU¸WDÙ.ÍvÜQSQ)üYµƒ~D *|n•ù<ûî)Øfx3ê8¸6iÜ3Ç:ò…’EBë]Í‹c½PazløÚÅ.dfÌÀóÿ^ ƒÿn~tÖ +>+<cs¶t}w_½Fw~×,ZÌ‰×…2"'¡5ÌåL ú+d®ª(:°ºÄe…hØ±VèïÔ÷X|uÛ-Aþ&°Žûõ/5ÅÏÀõ—£¤`èÖÆwÏïKCË[~©70rá¿ŽñGalÕDÛ—eyÐ¸^ Î`ÏŸÂISÄ¡éÍÃ‘VXíssŒ?„‰´ºÒ»€Î÷{QRÍ1dDÏy]Y‡õQ,ZuÒWÍýhmrêNYÜ9¢VLy§€ÁC0º×ï¥B™öøî~è\úhÀý{\*< Y%–¹
ª^Õ[lÍ^†ù*s·bÙ‡›Gî=‡&vÛ¶l|_ÜÉªÇÞ`ÿ+]ƒÐ·ìnÃ­ÒH×–ˆæŸó§–¦Î¹“ï Iåvo"ü±m·ÖƒŸm±»³ÁNæº´òæ1‚Î¿›#vÁHÛÝí£_ ×³1òr²–
w}Îy‡›'±½+Á0&1¿F¸/=ßUê
Î/Ö) K]¡üLt4m´6Ud ³òôÙß5î@“”K–ª¾À‰ÉâÕÆüÚw=Ë~b‰jÒ­©þîs³¶ÿ6üyº#LeÍ,Þ[÷².@)GÙij.†ƒ,v¥üÂ¶âßu
sì°:ø–˜­€8t<ÎüxËPèpœç™U?´8ŽO¶>·@½¯fßªÛ‘=Æ¨à—/†	ã]‰ùÏ#¦ÑÇÜ¶ ŠWZÎØò©ÁÄ‚-ß8:¯¡Q÷Jê]­ûÐÑ`ç.SZ³,ŸŠ†Éê/ÒKŠ égø–þÝC0™ ½§¦¼ èë”æènŠ†Ýí]RÇl¡~(|o;ëvñÑï\vk»7</r³ÌŸŸrÜ 2¶.—À”qýÎk÷ãôÞ3Ü·¾\„ÊÖn-+èSì4çû5F¯6“ÇWÿhÐ¨^Ý·MpW0•#T¾	Ô]€…±ì³™ÄYk˜Ç@öË„½ý>PµDiñûp¬þ¹õD<ÜN™ócì\þEAè?&výp«(¤ùòšnÐƒ)ž&$]Ã‰RÅ“ÐÊÙ{ˆ£2_ÑÚ?¡ú‡CUòL¯eØ^È¨Ø,,¿ê‰Z/pbgòRé'ó±’'ÌÛ²Ž,¥þÌ[7€žÝçòÜf4MEÈ=ƒú¤ÏK¹{WAž^¦3ôd	XVñßì¨r³>²ûïç¯â”¦c‹ºÑ?õªÙïÒç‘E7, ÿËÝŸr¯÷bÙF¾¨ŸWÂ!goÓžˆa)–«•a‡·¯åÇ}0øêŸFh4,‰(i/lUá²÷V+éÅc'3BÕÔ•-W¬ ˆó>wã=_¨(|´þå—&”Ï9zûÀgè-åeÕjÊ«ð.ûTž~XÆ6emÿÈJì…”°ÁôéÝ»“ýà§'­`1’–få6ySÓP®DÿBY$sGõr;œ¨­Š›?´‹Þ—sƒ¨íÏîù.8Tœwd«÷3¬y° ñ ›1þpÜ2”¡2Çäebîš8ºðOeÜzHÙóÕ­sùbh?hûÈù–õª¾7ZœHC›eÛR!PÒÙSB+½—Š$™ÜHÀæø%—ÏîÀw®COj ÝLeX³rŠEšïwvcòíÄÑŽò…ÀZ¹æÆ¿	 Iñ:ˆ*¼
©¶[ç7@¶Ó¿aÎqY,µ?´p¹Õ;Ë±—­ìÆŽØ]}ó<Ë°ýã†’doŒº|ö…ç›Vlsoâ™ëšéC»|
HáR¥Äbý£gs¢Uø ‡áîÐòZÓt˜Û[e ªŽ¼¥´Š*ô=Ö‹ùaïâ%ë5ŒÅ ôgÝ‚?OA‡XÏ÷W¢ñÐòýÞ‡ùg¹‘eW fIïDfLIèÌó±þÆUM+hÙë÷yœGtÙ3//Çž&´ü…s`Dìsëñc¬Úÿ"a0CÓdj^CW¢C^fà ŒU·Le}½Y¾©å7Àô«cõ@^gÁaŽÅB2‡cöî+pròmga÷ïÃîf8­³;ÓzÇè3UYäþo>rÞVÝ¼¤h¥}²³~´d¾àî€¿D*š’†s	¬ƒë{°•Ïp/Wp Öž7æþG³Ïé­}Þ¿—_•ÊÝ7[ºrþ•§þ`mZ½½ùu/¬
²þ/b¥9xÏ«Lç±óÅž¹Ý] /n…‘å…1r–ïíÞ²óY#=û°ýÝ¾Kû#3¡”]ºŽé¬üšµÃØ‚¼ Jö¼¾Ø½µœJ@7ÕPaßOGº±ÓñÝ¨†­?xçpíù
Ì|–Mñ,¶Ù·Î×¨/ÇÂþ2ÖÆØîyáüÛ˜=0´ðnqÀO=ì·»»müé4öšþ´J¤ÃØ÷3nw`ûÓ6ƒÈýÿArü>‡yY³yÞ¶­«æ“D×lY{gzNz_Ðçæ
÷¾pã)èºÜ65ì CÚäSá"Ì^Yz änŽØcuì©
4‰È–?NòÄæ¨¬ñeê ÔŒ}º/üæ	~œ¾qXrd+‚÷\Ä¢h§VŒí†Ší÷¶' ËðæÜŒvd•{W&[ðwÐ½=r8Úb`y
XOÖ^«‡ãµw¯Ì5±Ýp¢jFToèÍvFEÔ5ìÜäûš˜"vî”žcÏ‰‡)úF~‡ŸËñ7k}}ØÈvh±/û%Ùû¬œ[L0d´'€›{‘)Q•çt<¿áÌ§Ñ&];UÌ’f¤|†Ñ£”Y:`÷×§¬+ß Ö/:+¾{Ž;Î˜\ßÈÝ'¤ì±MÊijÆ+2:¿Å‡ñV€§)ëÛ“ç¡ú½÷£Îw‡19cz«pŠ&¬«*à†T—t+¡¿UÀ(‰î}m'‹Ýfy‡ÿöÀNf†EÏyùÌž¿ü3ö	eÔ/JlBæóÃ6þj,l[ÿ+mN+«~:žÁg½ïŽ<™ïâƒY[žñ*à@õ½›ùXØc-¹Õ:ð(f>¿†kg!ÄnÙì&vKßjóöÆ†•n=†!~õŠ%~o¿A«ÀîÖÖ7âÐRg~âÛÚ¬»]±P<Ir
¤^»Eb_ÑÈÕkÐþK¹Ã"V·zûHôA·£òÜöXwìœ§ß»×ìT9rÝkÇÐTŸ~'»û6oØ>Î.€ 7·Mn}~;ìÝ¼†ë¡»pÎ83á–ÈÓ7]ÑØƒ!M2³Z°UÐËêô8š<ÙÓap‹ûc<jç¸`<j\pÜzRuÍ{¥<R'ï•üØþ•‡«+ Y,ÌÌ¸xÐ÷G‰žÛzÛ4¾ilÀŽëBÖÛW/0ÎyŒQ5ó1kÓÉE·ª±å·B×˜×å®Ýñ]™ož·MMø‹3v½9Øøñ¨4ÉuË«¯Ã¶Ž¥5R{O‡ÿ¼pžô×0ö«lWPB'&Øˆá‹Är—œX)õý+é§÷OÉ+	åC±»ÈÙ¹¯ó 3ðá¦J‘Móã•bÇ5 ñ’7,X	ìüô†Ž¸zhû·j×©°=Xõ'[kå&,uÍÝQ³ §¾ÆùãÁÆÅ¼+=rZ l®“qoùJ`Þ?sæû}n­­í"çÁvuUÃ…7ÒØ¶öÊ5q[èòÏ¸fT?Ìy3á>mk w÷«¹“¡8yÌÖmïqd5ÙVcsSÞeüg#“Ý[ælx€©ƒåöË6Š`°ê_£Ë•|Àx¿TQæš/ÄœþÀÇ|Ã2Å+BŽ¸ËDÿ9 ÙÞÊ>ì
mÁ<:RVà´àË…‰…ÍgÖ7d"‰×šJß9`{Ë™B«|¤1ÎoÊn>	#O¶d!]aj_ÈózLšs$ü‰ïjhø]Å;Y'÷³­ÅÜ=Ïct'Ó†ÙgÄ_ØÙC±§ñBŸ2'¬?tÓÚ¡Ð	Æþ¾ÿ3ú¬z¦ÿˆ•ª¹Aê¸A‚ö%(È˜wÈe0]*g¢M¤±ùõÙ£©aPdfhÏµrèw·9Â»×*ü£{&&åT¸”³³²da”çeWœº°Íõyª¦ K‡kšû¤9p”‚4£›>£;MÑ`*  ‡øß--z—gØ¬mÛy¾;y2Ux³„ojZãàêÅ¼A~Ât¢Ñå§mŠPÅÅ‰1ÞqJ“ïŠÉJA/3E-ý6vþ%ïÛ4Ž=¯Ë„O/EæÆ¥)ôWÀÊ³_öŒ¡uåg²¤÷?ÆD±cg‰Ê<™Ãg*ìÂÌ%Cýùµ½Èã÷“v~”³j-¶Ìïû‘øœƒ52+Ž4å`]ZÍS÷x¨iÔ}kpÚv©+pÕw ­ÒSHBÂ†º6ß\÷Ä§ãÏË9¼‘Åæw<¿‚*L°µÌ§¥Æí7~Ù/äì[S¥',ô¯zBÃr÷†®?óíHªÍ“ÀŠIª¹«,Œh"6Èÿ´n×ø&˜Œ`­¯Y®cñÏ¿¬1AF~–n|ù{O)WÖ'áÀÙùñ;ÏáTÛN›y¿ã ¦‹Û¬ÜE+y¥“—):`ß— ïEm› Ô‚»h³í,72+ßUõé_»:<ìe¡´0êÊøïË@Kxæ²9‰Zsö-qYÇ›"ø]ýúaD‰ß«m47›.vŸç
­ë8÷db‹¯Œ8Ó£‹'éÌ 'ð»½ÂyMØ ¯ç÷
jh…þÚýZÚçwBJS÷•šZX~±&íM°6åz±Ž¬Äßo4»…?26-z ÖŒL˜ïuÔ¾=÷_ëç½Šñ÷M¹oèÇ>‘À†¦bÐ>¹¬çÝ²×0ºìîÜÌ„ûà’qP!m8~ßm—Øši„t#ïïW×c¹îÇ›ÍtUh*V{œu”Zãcµû`èÚSw¦
Æáµó¥uRÕV<3sÚ¯	®rØ¶
8[ÜBK—@{†·;	Y_6¾îzŒí¶2ûB¤Uá—#wPìŸ
Ì”èý'd‡Ì]Fé7c}_øS>m ÛÄoà†I£±òªùS0­Lµ‹gqðÆ£=kÛýa"ÊÉì?»3P¾ÐÈý„ÍjìuÒëZbc ŒcÑ¿Uþë„ž£Î+üfª¡Ï?LI==†¿ú¥Þ4ƒö+º›~V¿ƒh¿éÀìGŸÀ;"ú‚IE:0%rÌ.Ì7ÄîºCÖk°ñ×3»àÊ1Ìl[BçôÁ¼Ü´×ílu¡Ëîtž9…i—5m[qYMËcW@63¢áåwüm½ò™šæ<Ïÿö2FºÕ^:*zi#=¶VÉþ^+v­NèQƒií_=ªyõ"É[ònêÀµ‘÷ü\ +Ç­?üp	À–Ï¿¯Õ]ÙìO:Oüt$°R7ŽÛæ²°®m;á“võÓt£UØ+«;z>$‡ÿ?Ÿç/€Ó|æ“r	`B(­øó—Øõè]ªqh&¤ØgÙ|^3kÿ¤4gcíŠÇ»\>üÃÑGc´Â½Tø¿‡íš³Ù:ÏÝ³êN‡AÛ'Ý?»þÁH­MNàþ_ÈxEãýÛþ:êe]m„zúçG±‡oÁwþ¢à§aäýÇ›\+¡3K{Ð{n 4äýÜ•Ã†¼ù…ÜãÃ)<†Za¯àð®õ¿o.‡b+îòò\ì3Þ“#v°0¸õê¯Æ¤«D9øL~‚–¦¼t»ÔN•9üœÂ¯¹ç Wì§§~û}jÊôø>' ho¬v5eÌæßnÍÏóo!=u³Ú|÷­zoFÇ_Õƒ{ûæ ;ý†•«¶¶V]ë9©eéNÖ|¹|ÀòË½ àÚ€ƒøãÃû§’X*XµRdFr…ÇzÊŸ¼‡"[¿S6ÐÀº¹É7à=vlŽ;z®À‡<ÜòÞœL^%‡O¨p]„»U;J°sJ¾¯Ùù+t<k8ç±lÍcý-ÜZXœç°\mmXA×Ø˜â¾K‡ëf)´$njÙ±Í †îî/àÕPGæ›Ï÷¤nîºâ•ÍÅœ¡£ƒñÃ`N6´…ÎÉPPWÅaSoóÅ‰ƒÐõìy?¿5ŽÜùkXÂ„­½¹+·Æ`¾”Î·Çk¯#ó»œ`·Ô«òhI~ÆŒçìëË}°?lçñsÌç˜[°·¦}ü;¦éþ™3±JSsoÐ6¿Á!·rqMº
×õû¯Âl>B«ìÆ=«be arM‹m©-Œ>Ž6©öªÁnUã?ÿAJÃ^%9ƒ0¤J?Sy¾1"^7Aeeí!õÓ¿Íýlf(X«£vjž»‡ôÌxncK˜0¯§¯4Îðnš¤kBOÓ“­KR¸Bü2ý…N`ÙæOú¼ÙL¨bˆõÖÆAáˆ“õvÕ80v'OÀà9æ´½Zã³BÊJn8T™ak¼¾%ÿ®&¬¨6öØ4h¹ñOö˜Ä1«<ânýcróÇP¿dêfÚ}¬r¸÷6Éô?˜Nmìy…Lûyí¼‚ë±¦x€÷Ì·~RYíòât
–²ÕšopùÀà¶ôãÎ‹6`÷!i“òþ—ÐQÕ(uŽGzÜŠBxªo"}ýõ•½ßBDjPãqaìb;æ‹>®Â-êÊ”ØTŠ¼Ò	«¦ù¡ÞK@”¹Žò«r`DÈâø…³°DlµgäS_,I´¾œû
YvžªÎ‰8øI*z´¤E…OpH$*û)”¶}û{Är›­}c™ýhœM+ÕJF„’¶±ž¶'Ä„#0(×»%Ðù?¬•ÊÍî|Þ‡ÃÖGšÞ¤–aÛ€HÆK91 Ý6þFÛ-Õ­ß“Øí'6¬Wí¹nµæq½Ðáwë·Ì§TìÚÖQ»}nÊ\&=\hÏì}Âõï‚ð”Ä»ýÝ7{¯½v.ÆÎ4m–ìÎD¬óöý6%±§v~ÊÁò¥§íÜ:LI¥ìOï{‹ö™Ú¯ðÀèÏA¿MÇ» e£‰×5„®n.´/ã‚A+Œ ‰áˆ­Í©zjöÈ5uvÌV¥íž@ìt´8‘pÕ{œ’¤WÜ~ìå-þAjõ›èWU˜jœ8°L}	–†Oî¸R 'šlCwÚ8­þøQp¸Ño´Œ'…ëù§em_ðûAmø³·Ðÿo“ê®P¬91oµó±OÈ|yúä¥î“Ø¿ïÑµÑç×päOàë1Øf>;¹… ­Ôð‘zx?tŒ9qÉ!Úî}ê7™¹hî¡töôl±–ú ó …;Ç)<d­3f¼áž\ã‡å‹O¿üÕ»ïü[õoçm©šÅ¡Ð½óÅ~µBù[…ŸÂì Ñ3W»<Cztä6ñOku{ÛOÝrà´¼ü}Fþ(V»µmqáÌÇáïDO8hCŸÊwI“ƒ¹Eã­ËNÃ¯ÛOÿæYä„=æB4Ÿqd…èä×EASŸ¼žLŒËU/Ÿ+-ÿ"'>ú¬@îæŸÑOfû%³Ý¥KSt^;­ÿ½ ÛþŠH8ŽÈÊ6Ki¾†¡†öÕg >Õ!haB0­}×n7ŽÂ¿ÚÏöýŒ“ÃÚ›>+×ãX¹ÃöÎåä(lðYþ×íÉUÏìnOZýF¼·Êè+Ó«ÁKðg”3š¼xì}~÷RßÀˆc
Gåo§ðR>u ™r»îy cËz–*Ò0°ÿ¾åXWLûA>¿£(üë”—Ø<õ ê_8mÚ
=Ê™"O@uùïï½spâ\{÷þƒU0T{®aÇ¸Œ*0_:Ž~o½]yrg0ù€oò-¡*\ÛVH|xÊÆîÉû198Ì‘øáõw#Vçoe†kJÂ¸îYæÙˆ§Àh±; ÉýúkVsz¶m¦îçg{2±öžTWôKìþÌ~))€>º#YA:Ý}¨ÝféQl˜[ýãbÃ+o Ï•¢‹EìyScK¡»YâS—¨$ÔVe2cô {ñáï&Ÿ5Á=Ív‰Æðw˜¨hMzòÑU!ÔcïhRó_ÚW¬òx7‰}šHÏß²·‡6:N5Œªš[à'†Žtª_$°2w*^
©Ç© ‘º·Ýoq°a•å°Èäùišgˆyùí“Ž§ùa°4hgè™"h™~-8¶=Z…ûBóWËE>Ÿ¦“qOŽB]Ôò§‡Šå BInçÆM¨ïâT‹‹®þµµ.ÆÁc5ù×!=ª.öEÚIl³š#~É#:¹9‘Ë~ØÁV9'Ó]°UŽŸ¹ßAÉÉ±/¥g6ÀàÅIv©E=²Kœå„×ÃäRÆßŽkqÕÞ ž¿	ú¿üý”¯
¥‹ø
wÔb¨mÈŠ=a|ôªâv»Ql^˜ö¼']JvÛ=¼ÿcGU—yñé‘ý¶cI(ûüòýsÐwéñµ¿’B0.ÑdÔ’ÏÄròŒ úuýFM7—þê÷	rCÙ!þ˜V+'Ìú]qÍÖÆê"™ü¾;aþ›ÛÃó½±ÃèõTâ- Yyð]˜{	s.>ûT»
íMCe&cÏ±oVG½ûpj±—väz '¸×–Ôâðû8yÖA-¨>Ó4øÐæV®:`	[¨p¯ITdbÉÒ¼‚K¼×±ý¸Jøìg›
ßþÈ)ÏÇ°„.È—;1ƒï
Üû¦S‘Î³ì(G‚FöÈÎ/¼	Ý½¼ÔN+b»ÔÞ<›8`½NÛð&Ó{Õ^l¹7ˆÐQy03îevn½–wÚÐX;òÒèºA™q¹×Ùxsì­:¦ðÎz™Ñ£ÂYa¢¹Sm7W¸xCMö0´-Þw™1ï	&ÿ8Àä¾1ÌQ½Ì7+ö`MÔ"ñq:¶hî[+ñ¯Þ‰Yé	¥í3¬e¼ØaÙ¿ õ¿8ºNçWÝñ;ÈxÄwäç6D¾9¹Pt=Ð|ú×+ñ
#-•/=@ å'œû4›¿9ïæ¯Þ‰½èÉ7qð´ÛÐ‹ŸñŸ½¥Û÷˜$®G÷“ùý@”“ì…ê˜EI·¥©p=õR¾,¶O©ÝCvƒÒäO>`:,µU¾4ëéƒcÁ“GÄGÖ_’µ«l”šq°q²EüŽ]gØ™É=ÃöV¨Æu[¦™2_²=°DiÿÜ»	ÎØnù“ó`—0Œ]á³þ¦àìLvï
AœÚ¿é¢SèJhà5ç×rãî÷ÖI…Û_ËiqR*öøkýÞtúTN·>¬ÕßØz—8n¨4ù:"yk-¦t_\Î#«5uÖj'ÛÖCŸ`ŽŒÆhXSèLx/2ª‹57Øöƒ«­¨gBÝì»ÿöŠlãC6Übyù¢_²ªØ2™ÁSº?.É`ïzM¾À¦žLý=â·cKÁ´ýÑˆ¹pÖmÉ	kœÜº;¨À–Ž#Ÿ˜ø#ÓÐÿ†éÝ„ä{ø.»Ñ×îï[(ñ:sVÑu-T¾æ/X}ø<0ZxÚÞ½´¬?IÃÊ5_¾.æÇxÆÂ;oÞÖBÇ´ùæOv@¯†Ž§T‰ÒóŒùR¦ëòž3§‘~ìdÓœGÐY.f’!»=·Û
õ·nv	ü.„Þ­™«ZÖàHK§Ø:f,Z*é¦‡þûN[iØBB„ÀÝ1O ™Ô;¾ék„§rTqŠ|ÇemVè«»¬¸Š5þ7æ^û;[yW{^î/„¾Q›õmËðïÁ"ti6´}®Òaø½ò;ÿôæÍØpÊªÇ;_JôMþó[4„å¿Îî¹U„r´÷ÃIë¡ímª¦£O	Ô·™tü{—Œ½ÎÖšüVáNjVy¨|{ÖŸcË˜eðKeÅ’W#àÈ”?Ÿpš‡‰f¿¤ùdØèþ=:ëæ§B,M‘:l»ç=¸(œ1êìÇ´Œo«sÿ<Ç»¶¿*<”Â³kâšÿh’êµ¬	ìyOdƒ,þ@ÊõÎ—¯@þ‰eLñ€zì_'s'R6zëcžº©ˆ¤pÝËNˆÔèÇ©¤ÑûêÏ0Ìwi•S|ÆŸvó¨Ýî&?D¡ÅÐw‘¢§/ä›†Ôú®ø‚þ&›ÎtŠâ€h©^Ê~h©®:Þ=öžOG…ä>€>Eëª[ì¡£6±âIò(´Æl¿0ÕÃõY2.ÊK¡êsÔªÏ!¾Pv×ÅwÑïØ£²du»ÜÄFÿƒÁZ8˜Y<¢ìg ÂëøkIÌ²ÈÌ¨´jh’ƒ‰#g
cmÑÖ—¯ z3^š©Œ”ù2 Xó•´üin£‰35xå`¨uÎÔÑŸ¹³yªÛe±†ç‡UÏ§BËHˆó¨a„s½Ù3—]’ºA÷7A¹Yî!ÑšÇÈNº,|Ä¬PX³–i;­Rä•è0ÌÈNcÌú³TÁÇY,Ö¼às/Âšr%¶_ÞÍ/>¾¬cf`¾-Ú¶	˜Cìs?EëqÏnÍoq[¤E¦ùGXïÂZ¹•û‹±äêÈŸ€£eØ¾ÎðÕU¦æp%¿i;œyÓv'v«¾™ý~;åõv‰*ž‹Œ?–Yf>÷¬» r#9øÝ`•­wN¹]£§ÇÂ/ßGÖuE.ßVß³÷¨ðŸãÑïo[Ž´çMV;“S`$½ÞyƒµÈìwehKž—ÖèZ–™=‰Â.‘ ­µ¾Žd*Sß°Ò	ûi‚CÓw¤±R?ÛïÁ\È¸²~N×¥0˜Èk"Å%mOÄÞÊ¾˜µªü’)WuÄoÇ†?)Kv;ÎWƒi?½˜a#X_«îüûH6”‡/˜y 3”»—ÖŸÄ¦âLÚYÉr wõ÷}üKÃï’ÊC¬¤	H[§!ZuYƒÉNüK´ ç¶í¡Ä¥Ð¦?´ÞYŽ‚öú½Ë¡à«Ñ‘­ YcZÐÔ²ªlçŸÚ•%jîš©…Wpâ·ŽúÃþÐºûK¬§óŽ<KWk÷ÃÁwÓò­†!8œ}éñ‰-Ò“î*p£,ÆÇÝeI"0ž¡#à•$ˆ‡¢Ë.š`aøl¯’ÅXó¾ŠÂ¡Em­•íÁØßôëÝ‘Ây0™sÝ³Y8ËtÏimÛˆ£	Ü~gË‘Ó…/ïüœmçß´ˆJ@y…ñýím{ ökáêŸ‘v+}€¯¢Ç»ìÇrµjTæ.õ¬ðvÂ1¥éËÊ¡€¾åLù†Ÿ âû™}‹–\Fæ¼J1ž¤½½tMkåO`ö
Ï˜ÿYŠqS/æ/Å½.&UXú¤ûnð€ Î¾õÜF7Í¾÷‹æ˜Î‰‡öos‹ÍæWÀˆì­_´Äc0”ÓÓ2—?›þ­Ö^ÌÝ
cBû|æÈ²¦ö‰¦ý
‡ö×mÐ­ÍA]à÷tÏUœ`€VŠË-hˆL~P³ãt'=X~Ý»—G—·Ø	â7„ý/AÕÞÍÖ×aóÓô·	3+°ç›Ð¤ÚÔi±2r°JWá~â½-è&d\ž©ÿýE§,Jl/ð?‚˜³ý˜*ÃPk|2YG!9÷†É¨„Ž¯KŽTTû@æÊîí8Üþ­Šæ†çÔaJ2â†LI ökýzÏ{/zWÝû“,ý‡…îH¦¨i“ÅX|ˆŸGï®Qö>,‹Ì¼·õK|Ë±Œûq¼•HVÛìì—.yŒ_?aJ4öÝ­mŒacIßî#"Ý? !7 {ì‡oÜõŽk'”/ð3[ôý¼¡ÑGÏqÌî…cBÃ½oÊc×áÛÊê»A×/ceÛŒDq*ZEoðô-„F›t¦û0²Ÿ­T:_µ8/Ni¶ Ç—}Ø7õ60g®¿›_7kÇ¬Há?M`u7rÇŽÆÔsfë=¡âj°‰–./²’Å»÷óÊcz[®e•\	tóó<ÿq~#´ªK+_èÃ“cíüðÇ|½ÄxL–%J5c<×¦Ÿ‹õz°ëX Äîv@Mª²=ErNO2qæëÂWfï±^k#FÒtgîu=lÄUY¡«'†k±ñUÕr¡K¿‘Æ/w¼K¼k„­6ý3‡.ßQqí†ÐÿÇòl†^¸M«W'»èà¸¨þ*#·ƒÐj¿±©Uû)VÓ¤ÿ¿‚™¥wm³7žƒŽmeÏ«ïâP}E”ÿ ‡6œT^{ÎX—:MíÄ°Ûß«ºâ¶'VŠ8X×•a·ÚªPn¹èx!úOù4–/øéi×œ}Uw¼6¤õël„´7[†¢XCùª|_ò¨ÂS¶ª¨§œ˜—$Îû~Œ„?Œ]Ä»´s´ÎqÕ¥\(Û¹Û\BÆg.ü*}9†Ö}:ÄˆÃQ9>ÝßÁ“Ð›ÞwL˜%¦Âu»Z09ñ)üi‹IF¨óº[|ÜqÇöžÊoßŠi°à-kö»sÜPž/¶Ì__L8Yf>i¶ž.FØ21¸Íùùs˜Œà¬¾–°Ù½Ú]7~AËšµÝaø±EFÍoÉÛ)ûd!ï‹6ÐqåÊk¿Ô·P3þóDÉ	/ìÞµxþÞÕyØ¯î´Ã<Ê´Ë\›N†?M	éÆ¦ÉÐµwÓà;í°Æ­æžå]±Y¬WÅNÅ¢eÖÇ\ltº7Í×ƒWŽ3?õ¦ïOáÞ1­3³âW”ÙŸP†‘ÆîÕábPjéP""·zíö÷}|‹Ÿtš+ÚÃrúwK³P(és^Q©
©÷×,ßŒƒJ)F?/óŸ‘ñ¹lü¸%ÁGËÿ%E¹ZßRÁ¡÷É®B»±fè¾%ÌzgÊ€==þˆ^É—¾ýF‡#Ãjæ§ð¬»®wàðþåo½2çaÙÚPß3Çc`zMqò÷iÈKig»:Âp·sCwF	L5Vž{ýÍëWfÞŒêx‰ìÛb’JONàÌ¨N§Ro)´¿üO6ìû_®›ËVº}þ­z~ß|qäÞ—ñ>1Ðs5/iÌ$;ÒÒjÆ[UøN(jîžÀöæ ˜ûWX’å^Ñeý¿U®**[1Û¯ûe˜áÀÇ,¹ÇîLäœ\ ˜Ã©%§5B–C©wUå@€/°Ó›ä/hÚûšoñ†{!Gà‚‹Ð`,ÙIDü

ÄŽ[Ñ×,”¡Y×sK.-ùþþ¨
ß	Zð‚|`„&(WÌÇq3Úc£;ØÔÛí&¯é	Œª‹ª‘ösqÜÔª9éìô×IåZ»¯~öÝâ4lêŒ^KB¿TÖdbr‡‰IÃ÷Eàÿe~ãdäiïŸYö¼X.".–øJÿ¨'']AŽ¸vÐX½6®zZ6À#’ÿŽ4^n‚¼ÓŸyäÇ!ZñÙs/‘í8ò¹Úýyv°‚÷½7/†Q±Ãô<ew s‹WÄì†aÁÓÛÄºÂ ~â¯c>£r]åaîY¬
ª²bÕ
bsìLÕZ×DÈp«Ð
œ<ƒ½ï2þ3ÓÊ‡Š}Ùº§ÒSxY¯ÞËª/€ö,©Eƒýä?;x¥[*ÿ“Ûç¼c!o©„LFÍ^MÖt˜eÎ~‡?^®±"Šî8~Äh6oHŒƒîÛµÏ¬zŠ­‚»Æœ>ƒ*Çñ¹Ú6[±nåÁÛgÌí ¶o4¨G_»yˆŠ;HawËçàIÿ˜Z˜õ¨óí(4ëDDžÅˆ¥í:êÇäC+.„é¬;V¯ó0ÀêÓ‚ÜðÅÀ(š:u¡Ûg®ÖE\^Œ¬)w·u{R ór–X†-Ä>|‘k¡ˆew·)<šìÂò½ãowW€ëÁõ·;^± öÜÈØí’Øî¼þ«g~rÌ«f&s.ã$×’òƒmI0Ø)õZ¯ó1-Z¶ó”ÕCð]Ë—]œŒ¾¯òŸûû„žÜü¨Ï
eØc¬eYvJF÷ÐÜW¬„š³bÅZ‹ìçÛbè¦ï°2¿ßr<	êJ]ö¯cÎ`‡5íJ›ÉÈr»+ÈõmT9Ù¨Ýƒ¥]©'ì¡²ïŒÀ•‰¬Nt2Ú³ëöõÈåjž°Sáq,úê¸ÍZ\*òþë‘±ófýìý_ý·v¿€ž‰ŠÜµÿ.c¡äÉ…+/©ðV(-µŠØ,·/IËu`Øqù°×íˆvüFî¤ÙïÂößÿödä§ÖRaýæ&¨Œú'ÌÙþ'JrMR¸Žé{*nu…®B•§F?b”®´öŸ„Cè»ÐuúÏÀ]Œ<É½O‚w¼±FÃw¾*¼©-ê7þt¾6ÀÅýö½‘q)sÇt×þPD†ŒØØò*9l›_Ý^äeÌZÙÐ¸Ò!dŒJýå½!0úúí],˜ª¾é} ÖÇ>Vj[qoöj =m1ri(Óü<ûmòÀL©?	ù¤Ôûa“À|áúTgìéé¼ŸP0û=?O¬Xú®"8ŠÚ½Þ°&…k÷ÉãC;!í °ï²ÐûH¯VòßÐ§»NC°å–…ñ?Ž)¦Cç˜Æ†otŽ¬N”ªòƒ.®rêªÀÚ­t5tvÞÐ;’õìÒÕ°6MùëîxóW_ÏcxkÖx´o¸%/35ÜtöB‘JÄ õoåä¾Œ[ƒCMuÞ“·½°Îvu“ØåÓØ‘£[óˆúFbÇe¾C÷’CP«½*\ß$æ'xãø-?“…Ð’ê£—¢Ì|—Ërå.8Æ+,ÿ.[B^6˜hþ
ÅìÇú7Ç·Â´Tì7Ë¾Ø›úúç#³ßÏ‡õ—E†ß‚VÁS‡®e×"kÍÌ«âP~H;þußR6Ö†z)…Ë¾GÆìƒZ÷Uv
ßšþžâìMP±ãŽðù³¥øçú:¯#˜çtOêT0VlŠëùÄ9!2²÷`­'Ç/à’4œ¤[sÅ7blr½Í~U/ÙQÃlÄ¡FºgES–(ÕÞÈháBÖ*^aQÕePÃÿ”që%Tœ°{²m»²O‹g˜¹i#ëfˆ\gÆ6h(Ìææ¼‹M\.YÜ¯bW`ÅÕû±¶}^]E”2î}ÑÈ¬7Ç¶"¹5w%°D?þÑ«Ùwi_å	™¡çX¶,Faíêh{f+.Äg‰ÍÆ~¯'ù#`R·dóÜ;0ìmôbé¸:²Ž,´s‘ŸãÇŽ¼¦Š¹oŠ×¦UBÓßdoUíËÐY(¹N'_ûCê”»]¡Ý÷RMœ€*²ÆN¬?Îj—®Wn‘„žmÇ¢.ìÁNåRËƒZ[`¨ñú¢È•‚Ø¶ÝsÔcTmËúËš‡¾'$ƒÜbõU»ÝCŠŸ$ÕÒ±Ëç™òXà%¤dÏŠÁéx·êGP?#Þð^ÉZÆ{²¿$‚.3ÙZñå*0dþ4¬h~¶„ÐËÓNm’¦™øQû1óEEyŽr ”½ÑLm˜ÆQQ£(É/0|«#dÍM>»/gYäŠÌñ2ÿG~ÐX®R[¢ŽÍ‡¯¯³ÕMá1Ë“›âÄ`k[B¸ó‡þnÏ¡ªwncþ'Ø{±]ÆMþ›PÍÀoŒy¾üÈœ}eEo„²ÇûŸ9ºy#óµÀ¹S ó#ÓÉ=±÷¯@è.-dž½zýïz¾T|VD
²ú¨ÙlM‚v%kŠW¾Zº·S„t¸Ä((¹€PfâóŒ¨»½é|@¡tÚ½u»ñv=ä:œ]+þÔÞÐðÁÖšÝ.!g§q<Ùµ§p£t¼Òãæ‰šøÊoAqd‰=þ¹¸^<
.‰m™4©š<çÍ— cO¡¢ü¥X±@”W¢U
§8Y½oIÀç…>ç½Àõ¤VPŽÕì=³UT€µ7¿Ú|øv&¹n8ý%hÇÇ–äöak’âU¶5v®K‘Ùí‹SW4x^KbOröh)ÌÞ“yy>‡õ`4g^Uòå
luµéÁþ=+KzÄ±¤ö²Úµ%*Ü‚–Xx%"KCöâ§«±%bd—æª'0Øà§g¥) íKÃîÖUÊcçë×;C]0Cok¡×Õ,:ùÌx™ž(Æ•m¯U‚ÿ‹¾žï…°©fš¡¢:‰ìxþøÖ; :.ý–˜)¶=Ô<x—}¦
ßS%B°ï ûZE†ôKÚ
D¤ÛÃËµ×+Bû`F'XµWz=ÅÏo¼í‹}]¹Ë¥Œ‘mÓö`‡sví¶SR‘è„žÕ}š\Dþ=±oc3Øç¬í¸ë:"åsFV=ÂÉö´+sq¤¶l¢wè†)OpŸfB÷žß|¡_€söO
ßUçL.3ÒÉÃ’zEûp‹7¥-²F"œé7?xféªðv®eFýÃî¶š5›ÊþKáŽÕÝg'ÌòæŠ½l]ìyp^î$¶øEßß’LõoßI›Í~Ug?/øŽ¢}eÅvŒAùÒÃ'›yÎåáãCç¡¨ð–Ú·æ“8Ü^°Å¶}J:uføDJöªŒAÛéEÛ"»±íèÝøÊû' å~Üäb¥›Ø.ZRÞ"ù~û>ÝVý×Â;kfüS¸¶_{ÍÅ+µoYUCšï ½è‹EGÂG¨©©º¸f<8!÷œlZ´8ÿt×È/ü‘j>{ÿ”ðÜ»]»Nó½Ùû[‡®IØ}Öž7ÞO’æa¯Æv±ˆß0só€w*¯Ê.åÊ¨€n9«ýeŽ[0'vïý¨Ô»­/Ä¶Ã/¾·zœt¡wl»üÞÚ5PdzàÊ¶ìuØv¦™çÉ’z¬¾P)~ôñ/ìÜXð}ÓsïìD[eSŠ`À–9^-†0öž÷º¾†.0ÃØVÞÛ´}ï ZÑ¿o×–¹ô!LŠ,Ù·ÎXFTÇãé¢˜õCÛË°š£»Ì,Â®`Ÿx×=©Ê+P½èé´Ê Òâ]
ì®•!s~¨~¿šLMúÛß~u>†y¬¼`TQ¸+åèn¬z²þÕäÃýÙ¨Û?B?™¶{Q¹ÀùÐ¢bëë|év…›S±yqìÞSÛÚ!V$TÒ`é3ž_ù ý/ö/ùñß–!`¬VÓ‘s
JÆŸ^ÑwÅâ÷:’ßœ Òð¹åŸ‹F³ï5Ãòú{P•ï`\=rêÊUEavþål½ë·ºu&Ïò4 ­½òú¥‡E0¸úÀ€ÝÒÞÙxr­::Ù‹E²Çãw‚îíê) ½pö}”½åÚá`ª5ô‹¸ƒSr‘S­l Âl›ë‰Çµ˜7wA€éÈ2Ì—.øpÓÜé¹së¥òÍÝÝ„‰çÍcTÍíaÀåÿ¥ËH‹Š¸º­Þÿ;ß5YÂnç5e3ƒŽ–/Q¹ƒ´ÏF££EÖ³s5‹¯Gø9ÐNÍ›³ï&/4)oÐ¹2*\öï½4n1¡%Oi³m®rtÄyÂ¸' :M§q-2Ž[>?hÈÅÅËÃÅÅÅÍÅË5o–Î1µ¸6K„gÿÌnË.¤Ž¸¸¦ÿ_l<ÆÛgÿ·`vã=×ÿó´©>‹,™¥GsLågéxcÃÌÒY:ã®ê|}–²ïŒ |ÃKwÜ'çc9tgéHä«SdŸýìÏ÷¹d__z_Ñ§¤f¢BäÇ–ß™¥­-Úßë@#±Ó¿mè¡Ó‰Æµ‘³tPt÷vóYÚÖùžìW¸=%x"TÊSfiÏzæ£Y:ySn'±Ã¼pm'‘ï›_ØIáæÕ[Môx»Š¼í÷ÄW_$xOZúëÏÒ¡Ùn x¦2B[Þ±½ÌYÚ¥ È"~°µžÞ$vgÌ6½!z¦6þ¹´a–Ž®ŠyDôOˆî!rœáAIb$=ëS<¡´}Äým_¡½¹	ß¤·¼‘§{Û³‰üXÊ³Ãä|Ä!=:‡Ä×©HÄ…õµ7ˆð3ž¶"ÁÑß ›MðwÔ÷#þ²sC¤ÿTM)‰ßØÄ‡p‰ÄwˆÿÌKƒB”ýÃuˆ–®wI~˜:r‰K“^GüŸØ«èIäFÌ­w¿G¾¾±Ö qT¼hÎWüªo…ˆñ…
·H<Ú–T’ý©Ü<„ŽWIl%~=r%qêÜ©FôröÏYHðOÝ“Ÿ!¸[fb|	.Î.nW
_¦›ÙŸž¯^Oò<õòÇ]‚£Çn,”ØŸv½ñ †Ä!¤Kª««š‰Ñ%;š^<æÓ"ö:D.×Sxî;:§n×˜ï!þÙ¾›àèÎÚ!Bò<¹ÊÚˆÈÍü(« öFuuTH:Íÿý¬î÷s®éS‚<„dQåz*žÉffA¤^”V+{ýñ>I<ºB¹iÄîðÖï¨úÌ¨à¥p½£EìwÖÝ, z&®6ž"~Mk~œ ë)a‚“SùŽáAô‡Ág‡™w±L‚—þqØžäæ\f$É×(‹ñ™ê£"‘¿T=/ÏN%}0*ÿÐ—ì·Ð¯3}H~Ò®PuÐ^Fôµ]ô6 yç\«4!zŸ	'8{8?ZÎµÎz$Îm½*‚kððRoRŸ]B¾Äþhæ³ûDßtCŠÄ½7aÿwÂ?Ñ4Lù9°$>#Û;³Éº={ácªž[u™$®m{¢×Rüÿ~î#8»†°ø×yWûçžËõ$Ž£Zr—È|`³dDHœO¯'ûôú]ñT]K–}&~´»›û’ó¡Ö[êdØ;@åWÊ‡—Šï¡¢[Äó“£ÉïDûÏy”ÿ‡»¯{ã+Zû.¦ÂU2ä ½…ÿ5ÌM®øˆê“8²L°ø?üá ©—‰±mŸQgÅãÄî'¼“à|TM«¸AÎY!–ž.·}s©ú7p›Ä¥ÓD)‰ªû*–2±ßó0áÉÏÄƒå[ÈzD%Ž‡èí:ÕoÆåKˆ?^õa¤?Gä’¼|Èî$ùîÖU#ûSÉ¸š#ÊrIÑäRsqŒOP•œw¬~±‘ø3}!N—ÐÎEùÏÉù¸ôž·$ŸýQ²ÄÏ¶¿éíd0¸÷#±K[úi#Y·¹¤UP~ùÐ¢ã©þúèDðö÷ÞYOä˜7DSñ”tXLò;í´wˆôIß¥ù$®Ó~šüdžMÌÛFêjŠþp7Á?daù…äehŸüQ‡)ýæ“T?Z.ô¡ê\9.•è?D/"ú§Ï¹Ð¨~Ðªé%þÓK½Iž;wtzPu_8ø„Ø’ò8Dôu)¸\¤ü9öšœ÷×ÄxyÚÑö9ÄŸiÜÊ¦æH“ÃK’ß±Æ‹úÄg?Óàf<ÝÆ"øF,¿—}ãí$={€èkË}ðŒª¥ÿT‰–Ú®WG„;‹šg½ºkH>Fu¶&‘ù5êY¥DòÁŽŒ¬!uÖ>ðáÁ?Ø³ÿ ÑÃÄsy$n“9Õ(»"K>Rù¸çIä‡´mÍ©º¥{RqípþBæËð/}j^Òç§p>å!~2t˜ÁdÝjYIôM¬>üÐ–ËqävŽãÉªn,ÔýÈa_:Gâ0x(s)¥×pAô?*ª'þµÔË)Sõ'É½Ê{KÀ‚gìÓ‹rª>…·'\ÝÙóæý#ƒkI=wTÿj&óvús±?þak<‰ËpûkM‚}e/±?©á}‚øÉ<n)DÕ…Ó/9â?{íGboÌë¦)‰×è—s¨yú¥5™àÍ69LÕëÎ”åºD/k5¿;:9‚ÏT÷E?B­t 8G~ôœ%yßþÄ{P…ß‰ì÷l.h!vØ)\ÉÔ½*zqÙïnä*¢ìÛ?{G(gÔu’œ÷p.?Çï¿(¢ú#Q·ôm÷†f±Ç^´>—Ì…Éí‘óIÜ&„“<·nÖ¿BpNN¯Îâ¢â7ž@Ö#¹BJ$^#FæÒ'3¶c[ÈzÒæ©$%¿X<Øc‰\œÏµ}ÔüˆuXIåW.qÁÅ©{û¿w‡§Î ‰ûÀ“CT¿/6'ýÑÙgCpŒ…„ì úH.c'ÑÇR:CÝ‹=ÅD_Ï6éoä¼=˜ç>5_‹6’ýÁŒ-ùÄÏ‰²	Ô}]ŸLÝæm'8ó›¦Iœ:v.¦úCL)Üþ§Þ“xÌ´IÆ{cZ|Äï6gƒ8"7và·ÉËhÎý³¤>Ú<F©z;®UIüiM(n&|œ¦[žÄ¯ÁI”SÃˆÞñkóôH<Xµ¶Ô½æòE2Gzj·PïÑ¾ð®ƒÔœþçMâÎ1O3 rSù*‰ßQÁj‚spQŸ6‘›¼¨ý‚ø9C?¶ø7Â}~Ñ3a½bñ#ª^j,H=N?X*OÖ£\dž°¹}ôI]s©þ£òhî¿€Ôõtï‰R¢g|ôÆf’§iqÖK‚gôq‘Õ/×¤hK©8@=ÑÇù«É$ò}§ïð¹áÕM|÷ÐD7‹ØVÛIâ1´gk‘ãXcáŸ†N’¯>C)jŽ¡4±3m‹×ÔÍxŠ@W†Ä•#&¹…ÊÇ¢•_†üAâçô¹)b§¯#«‹è¡Ï/xOÅ_âôUjŽß\©Bò4Ù÷ŠÄeôú°‰{—ÿõt¢—vÿ›ägª,ó•w‡*DÃNg’èëù´{ŠšÃ=$Þ3_‘z™´+šœõÿ_&<3\ÿ÷«…ú&ùÿüj1ý¿_-P»g©ÎìŽÒYë©î·³8G¢‘ŸbtìÓÅ¨ÛaÜT1€¬K«÷Ù¾ÉMñŸH”‡œ/ÈÙ¦õ‹¬9aÏêfå‘æ{•Dû?à¬<Ž4VrÚe•KözïV:Ò»"…èg†EQSÊ0¨n–b{h>u+=CèX‰c>‘öS¾NÎiç¹ýñ«Ttþ2'ëžý?¾™á/uTLîÿ@Ö£oãŽ‘uÎ2Äf³4RDé™:AÎ§Ë¾:’ó&þ®*r>-óÖ˜œš-§ðõ)í ú;ôÂ©êe¼"]Œõq7G	ÿøõ„ "?º,_ŽÐIÅÅ›_ÚÇß/¨8Î‹0'ënÅß‰½9Ûv¹‘S’l².ZOÖ-ONKþIÞkïÈz¸HÞŸÄsÜ ¼B0ý]N(9gÑ¥âÑ±ù0Ùï†›T×Ü.%rµF|ö„KžüA(m^9GÚ‰¥dÝÿ¥ô…K×ÍƒÈõšF“sŽê±ãdŸ}õ‡;á+^FÅ£½P‘ÔÔÚEÎYO×¸~æåÊ«ðDÏ˜{¡¥§…6à*Ü¾À€ðgvÙjùQ¾þZB»¤m	Í•ÔÙDèÌÔêëTüî7þŸ:¨ºŠ<GèÔèÓ×DßÔ^åI
_¶:U§JŸ#‰ü@¾L5Õíú•§ˆýÎAm}ªkî6\Í"¦‰\å¯¤²?¡³H€ðõÚæÔóF÷Ûäƒ‡UîÜ%yNÔ · \ï¹Eåƒ}2‹ð¿o>ÍEíëóËõ`¯º5áŸ~£0—¬'ék¥)ÂÇR	^–´ëN‚³y……?¥?çw?±Gû$x…Š›ÞÃqÊ>3É‰Èå‡3I]CÚý_Tÿ•¨j] ëîÅo©¸Òþû·ˆÐ¸ÕËHcÆ%9g-—]Iáäyõšª?-“7Äî ò72±åb6Õ# ²ß»¢Õ‘ªçÇ!Ä>gõm*/N^TµÍcg’õ”Ûò*ÇÎEÂÿ—¡JêËŸøÕQù™ž$_‰8± yŠØmîµ¦ò,h*KôªEœ$|ICKÈyÔ»iJnŸŠ*E¿ôSñŒ{ü•²÷¢øÕ—&{£©¼ëký¡ú¶`Y÷¯ZNü`{ÄQøºEÒH\`äÉÝBÙ+Ïm$òìjFboªyc8‘cd]<IÿŽ6%òS+ÿ#òc;ÞäþÙ}”?Ñ§]ÞPõÔ4ÔBèxE¹0áïj˜Ï"çÝŒïo©ú^çHá˜#ÿÈs¶®]Cø+,ìÂ_­¢©kl´j~EùñÉnÁSþìåwKµu;•)®¢ìH}3O*»I¼{]® Õgù‘eDn¨ºz-å‡ßábª_íÛbÉzæ 5G†¿~Ò"8:‹­æSýQ ]ü¿>UŒ&ûe:™T}õî8¨EìxØGÆl<ý´­ˆ>ÖF*.Œˆ^oª>%ûÈœÇÑ0ã-T=¿Í<Ep¹,û_­Ì%u„%NTÒž¸P¸¦v#¯
ì?¾@™Â{Q©šòKÕÒ‘ð÷í´%ñÅ'äÇšY|N÷Èùt}ùZÄHµÛˆ½Q*þéÀ æ³Ë;€œW<]DÕíåäk"7ür¿9¯–¸x–Pg¦—à(Ó¯õ¡êÛ5™¨×'W VO[Qú†®“¯`œJ|¤Mõ…»»"9³¬¾Cñ©L‘k+­»Ó¨8´hPõÇê²µ$üÌÛ[I^¦â$®¡#BKˆ¬UýGˆþÁÞ÷»ÛÃT]‡ž%þ§%SsÕ¿‹úUƒíhIpt¼šCÍõÞíçb‰žÑÕÔ¯ œîä_d=öØÊ™ÈÕjì¢ú™•3éCä[1ž´û«®“óÖ’ïÂ_bJ~eÄ§¯VSöo~§^%ƒbã3ÞF‚gªmö½NpÊÎ“&rÓ¾RõºÌ¨Šèí\þÃˆÚ¨Iì³	®Æ#VJŸÃ¡6*ž´<Â7™vEŒì—Žî't‚#´Ð‘àê«D~Æ»º'ºë½¨ùÓ»bÉ ‘ŸN‰!û­÷(=Œ…kK	m|yâ;ÁýWÔé•÷«âÔ=Ü}µ¶œÂUÐ©CÕgþRÈyÐäJõÕð¶…TÌ›“Ø<rÈ„Ð™ë6ä¼~ùeê|ðí2êÝÐPë¬@öG¥Ú¨ûœv6ƒô9tT\R ”óß±O”wõ3Ä–±Yá›ð‹ úføó>âöÜç&÷>VÉ©%‘óÉí®„¿&ßŸ¬«ô&HßA‰ª%™Û8™âÑ[ôoÅªÞw<!ûC/”.Rqæìþ_¾Å¤íIÞs;©ûkÒ,\™Øi_ž°’êÚå¢DOÄË¿d=–W%FÎÙŸ«/R}WfHætvZP~µHì§æå˜sÁm¢wt’íLä§oÌ»LøÇ$&íl˜;AÕÏ²~êüµñB‡ŸÜ¹AèÈ„ç>Â×ÔÚMå½Wå5áoKMþMìç¥ìP¤ð¹ž9Cì1LÉœƒÞe"û(ük·’5ë}õ+G¡¹…ècÎ[H~ež}ç•äSõ@»Gèxâ¹,—aõ÷‰„Q(Gê'Û?Qù‰x¿•èN¶ÜIÕÃÅ`ê×›±´%fT_m¶7%òÂ
ÔüñXAÅ9ÊªŽš;¥göšúVÊ×ÈÞcD~’­#@ôOD®‚+«©¹7©Åÿ˜È·®|OÍWzx(U¿˜~„Î¼<N½³F«ÿ²©xsxx©¾[¹ˆ¼`Êâ¿d*³éÑÏ:ÆMÎ‡îËR}QêÛ×Lô²¼2®ó¾À‡{©¾Ì¿âHéß}›ªÛÌZ2¯ å^ÆEB›=.“¾Áé&…„¯ÑÓœÔöLNRóˆ¥§£AìUšRïÔA›#ŸMó‰>FÅ¡êß®hVBhéõqjŸ³²å2¡Ó¡–T>û¹oRýÞ CýÚÝ±ÝÉ–Ø¹ä‘@ðö~™ ~Åž¸$ÞCÎ»—ÇSy¦OœÑŸÝÿÿÿjášþ?šííhVR ]0;kveldkamp49@int5:~/rgmirt/parameters[kveldkamp49@int5 parameters]$ 1;2c[K[K[K[Kls [K[K[KR [K

R version 4.1.0 (2021-05-18) -- "Camp Pontanezen"
Copyright (C) 2021 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[?2004h> load [K('[7mtrue_1_1_0.9_[27m[7m.RData'[27m[C[C[C[C[C[C[C[Ctrue_1_1_0.9_.RData')
[?2004l[?2004h> a1
[?2004l            [,1]
  [1,] 0.0000000
  [2,] 0.6019929
  [3,] 0.9780008
  [4,] 1.6791658
  [5,] 1.9744296
  [6,] 1.1304204
  [7,] 1.3809075
  [8,] 1.6114515
  [9,] 1.4806007
 [10,] 1.2828871
 [11,] 1.5840189
 [12,] 0.6011073
 [13,] 1.9985419
 [14,] 0.5470476
 [15,] 1.9966448
 [16,] 0.9121034
 [17,] 1.9207476
 [18,] 1.0667030
 [19,] 0.8050431
 [20,] 1.9268985
 [21,] 0.9901432
 [22,] 0.8345822
 [23,] 1.7783634
 [24,] 1.0232975
 [25,] 0.8764409
 [26,] 0.9779073
 [27,] 1.1014567
 [28,] 0.6401463
 [29,] 1.3953654
 [30,] 1.2090533
 [31,] 1.8791339
 [32,] 1.3108310
 [33,] 0.7564749
 [34,] 1.2686810
 [35,] 1.9624429
 [36,] 1.8226818
 [37,] 1.5074973
 [38,] 1.6924708
 [39,] 1.3727885
 [40,] 1.4852968
 [41,] 1.4927324
 [42,] 0.6735748
 [43,] 0.8664554
 [44,] 1.7888644
 [45,] 0.6757159
 [46,] 1.6095031
 [47,] 1.4674718
 [48,] 1.6571791
 [49,] 1.1630665
 [50,] 0.9537209
 [51,] 0.9331440
 [52,] 0.7143456
 [53,] 1.2992355
 [54,] 1.8654426
 [55,] 1.6239192
 [56,] 1.7331805
 [57,] 1.0243998
 [58,] 0.6650210
 [59,] 0.5283887
 [60,] 1.0309818
 [61,] 1.1430415
 [62,] 1.7014719
 [63,] 1.4629957
 [64,] 1.4754757
 [65,] 0.6270791
 [66,] 0.6526515
 [67,] 0.8519960
 [68,] 1.6289572
 [69,] 0.5966601
 [70,] 1.8481455
 [71,] 1.6772663
 [72,] 0.9802859
 [73,] 0.7250160
 [74,] 1.3276396
 [75,] 1.8428202
 [76,] 0.5312145
 [77,] 1.3256851
 [78,] 0.6803682
 [79,] 1.8777531
 [80,] 1.8461022
 [81,] 0.8265351
 [82,] 1.9105105
 [83,] 0.9584848
 [84,] 1.4637145
 [85,] 1.5056637
 [86,] 0.7605006
 [87,] 0.6893796
 [88,] 1.8431354
 [89,] 1.8417591
 [90,] 1.0181133
 [91,] 0.8054438
 [92,] 1.7574295
 [93,] 1.9772518
 [94,] 1.5196068
 [95,] 0.7350353
 [96,] 1.1820221
 [97,] 1.8957615
 [98,] 1.4420978
 [99,] 1.0464844
[100,] 1.2021792
[101,] 0.9287874
[102,] 0.7709970
[103,] 1.3863607
[104,] 1.9230538
[105,] 1.8309253
[106,] 0.7454170
[107,] 1.7138341
[108,] 1.8929643
[109,] 0.8163219
[110,] 1.3646392
[111,] 1.0422970
[112,] 1.9725866
[113,] 0.6744339
[114,] 1.9599053
[115,] 1.5593096
[116,] 1.6128080
[117,] 1.0690382
[118,] 1.5118405
[119,] 0.5280080
[120,] 1.6652550
[121,] 0.9891228
[122,] 0.6055447
[123,] 1.3393148
[124,] 1.0952247
[125,] 0.8424849
[126,] 0.9729640
[127,] 0.9469399
[128,] 1.0798575
[129,] 0.7515624
[130,] 1.5482240
[131,] 1.9240552
[132,] 0.8663629
[133,] 1.7419338
[134,] 0.9734802
[135,] 1.4496839
[136,] 0.6492999
[137,] 1.4925088
[138,] 0.6006714
[139,] 1.7335551
[140,] 0.7797546
[141,] 0.7335575
[142,] 1.9322260
[143,] 1.5185980
[144,] 1.3091174
[145,] 1.0835256
[146,] 0.6830095
[147,] 1.6947809
[148,] 0.6434825
[149,] 1.2425435
[150,] 0.9831916
[151,] 0.7851105
[152,] 1.8917985
[153,] 1.0364945
[154,] 1.7433205
[155,] 1.3300566
[156,] 1.6318073
[157,] 1.0130420
[158,] 0.6523468
[159,] 1.9629845
[160,] 0.9706790
[161,] 1.1491088
[162,] 1.2288992
[163,] 1.7484677
[164,] 1.5325263
[165,] 1.8724813
[166,] 1.0939505
[167,] 1.1100659
[168,] 1.1668493
[169,] 0.7679725
[170,] 1.3380112
[171,] 0.7307419
[172,] 1.3649771
[173,] 0.8280914
[174,] 1.7182867
[175,] 1.4532995
[176,] 0.9267883
[177,] 0.8556915
[178,] 1.7257954
[179,] 1.0992887
[180,] 0.9866676
[181,] 1.4319613
[182,] 1.8590689
[183,] 1.5774356
[184,] 0.5683912
[185,] 1.5637305
[186,] 0.6914712
[187,] 1.8983682
[188,] 0.7210443
[189,] 1.6338430
[190,] 0.9278994
[191,] 0.6165485
[192,] 1.1039844
[193,] 0.5655008
[194,] 0.6111769
[195,] 1.1642787
[196,] 1.8431592
[197,] 0.9349938
[198,] 1.0283830
[199,] 1.0071965
[200,] 1.9070377
[201,] 0.8871402
[202,] 1.9148646
[203,] 1.6896278
[204,] 1.8685295
[205,] 1.2132364
[206,] 1.2019504
[207,] 1.8341974
[208,] 1.5258948
[209,] 1.5775678
[210,] 1.6418207
[211,] 1.8973531
[212,] 1.9562616
[213,] 1.4311081
[214,] 0.7249639
[215,] 1.6752791
[216,] 1.1952136
[217,] 0.7574218
[218,] 1.1038347
[219,] 0.9327038
[220,] 0.5717640
[221,] 1.9216756
[222,] 1.5543161
[223,] 1.6165470
[224,] 1.3278661
[225,] 0.9536361
[226,] 1.4635304
[227,] 1.6808315
[228,] 0.8202773
[229,] 0.6183465
[230,] 1.1396983
[231,] 1.1418978
[232,] 0.7089348
[233,] 1.9324495
[234,] 1.5193317
[235,] 1.5378020
[236,] 1.2931374
[237,] 0.6542446
[238,] 1.1196883
[239,] 1.0467184
[240,] 1.7988675
[241,] 1.4411846
[242,] 1.0917278
[243,] 1.2063546
[244,] 1.0131584
[245,] 1.9312798
[246,] 1.4165883
[247,] 0.6720724
[248,] 1.6572313
[249,] 0.9472583
[250,] 0.5442894
[251,] 1.6953808
[252,] 0.5124164
[253,] 1.3426094
[254,] 1.5882021
[255,] 1.4971651
[256,] 1.0792895
[257,] 1.3976917
[258,] 1.4064473
[259,] 0.5267550
[260,] 0.9722906
[261,] 1.0548462
[262,] 1.5990074
[263,] 1.0657213
[264,] 0.8055463
[265,] 1.4782573
[266,] 0.7138266
[267,] 0.5730699
[268,] 1.6606891
[269,] 1.4307969
[270,] 1.2751942
[271,] 1.7677301
[272,] 1.0198765
[273,] 1.2196447
[274,] 1.2584424
[275,] 1.6006969
[276,] 1.5374408
[277,] 1.7250688
[278,] 1.5486777
[279,] 0.5688172
[280,] 1.4341383
[281,] 0.7158151
[282,] 1.8694769
[283,] 1.0815701
[284,] 1.4772743
[285,] 1.3799300
[286,] 1.0781312
[287,] 0.8178467
[288,] 1.2968757
[289,] 1.8167421
[290,] 0.8082279
[291,] 1.5914369
[292,] 1.3731861
[293,] 0.9052684
[294,] 1.6556480
[295,] 1.1707314
[296,] 0.7862396
[297,] 1.2544315
[298,] 1.7621308
[299,] 1.6907978
[300,] 0.5365412
[301,] 1.8120430
[302,] 1.5991161
[303,] 1.4865839
[304,] 1.4605493
[305,] 1.9653255
[306,] 1.7772256
[307,] 1.6928908
[308,] 1.1301216
[309,] 1.3493289
[310,] 1.7320500
[311,] 1.6986648
[312,] 1.3658575
[313,] 0.6750869
[314,] 1.1893332
[315,] 1.6304570
[316,] 0.6465971
[317,] 1.6044113
[318,] 1.3861734
[319,] 1.1422504
[320,] 1.9948263
[321,] 0.8182548
[322,] 0.6456311
[323,] 0.8065978
[324,] 1.1103943
[325,] 1.7207410
[326,] 1.8661488
[327,] 0.7266890
[328,] 1.1122732
[329,] 0.6936474
[330,] 1.1340937
[331,] 1.1653648
[332,] 1.9929483
[333,] 1.5996819
[334,] 0.6100286
[335,] 1.5785389
[336,] 1.5489477
[337,] 0.6124233
[338,] 1.5823487
[339,] 0.5539321
[340,] 1.3668114
[341,] 1.1085790
[342,] 1.2494456
[343,] 1.6516202
[344,] 1.1779990
[345,] 1.0213369
[346,] 0.8390104
[347,] 0.8963510
[348,] 0.6144698
[349,] 1.3380760
[350,] 1.8579157
[351,] 1.3166607
[352,] 1.0671199
[353,] 1.7735114
[354,] 1.9934828
[355,] 1.4378328
[356,] 1.7143813
[357,] 0.8178522
[358,] 1.9057848
[359,] 1.5002202
[360,] 1.2503971
[361,] 1.3750646
[362,] 1.9630480
[363,] 1.9324520
[364,] 1.6856567
[365,] 1.8801141
[366,] 1.5316907
[367,] 1.4641417
[368,] 1.5784300
[369,] 1.3579807
[370,] 0.8855553
[371,] 1.3830242
[372,] 1.2490024
[373,] 1.3891785
[374,] 1.2012166
[375,] 1.3395383
[376,] 1.7913207
[377,] 0.8860303
[378,] 0.9608326
[379,] 1.8981235
[380,] 1.8409961
[381,] 1.3709260
[382,] 1.3171665
[383,] 1.5669218
[384,] 0.9433861
[385,] 1.3335838
[386,] 0.9031710
[387,] 0.6576903
[388,] 1.3177094
[389,] 1.8408473
[390,] 1.8041301
[391,] 1.5275789
[392,] 0.7701954
[393,] 0.5777964
[394,] 1.8639580
[395,] 1.9674399
[396,] 0.9514542
[397,] 0.8307152
[398,] 1.1225661
[399,] 1.9753974
[400,] 1.7780294
[?2004h> head(a1
[?2004l[?2004h+ )
[?2004l          [,1]
[1,] 0.0000000
[2,] 0.6019929
[3,] 0.9780008
[4,] 1.6791658
[5,] 1.9744296
[6,] 1.1304204
[?2004h> exit [K()
[?2004lError in exit() : could not find function "exit"
[?2004h> quit [K()
[?2004l[?2004hSave workspace image? [y/n/c]: n
[?2004lshell-init: error retrieving current directory: getcwd: cannot access parent directories: No such file or directory
]0;kveldkamp49@int5:~/rgmirt/parameters[kveldkamp49@int5 parameters]$ ls [K
]0;kveldkamp49@int5:~/rgmirt/parameters[kveldkamp49@int5 parameters]$ cd ..
]0;kveldkamp49@int5:~/rgmirt[kveldkamp49@int5 rgmirt]$ ls [K
[0m[38;5;33mdata[0m  [38;5;33mEN-MIRT[0m  [38;5;33mparameters[0m  [38;5;33mresults[0m
]0;kveldkamp49@int5:~/rgmirt[kveldkamp49@int5 rgmirt]$ cd data/
]0;kveldkamp49@int5:~/rgmirt/data[kveldkamp49@int5 data]$ ls -1 | wc -l
180
]0;kveldkamp49@int5:~/rgmirt/data[kveldkamp49@int5 data]$ cd ..
]0;kveldkamp49@int5:~/rgmirt[kveldkamp49@int5 rgmirt]$ ls [K
[0m[38;5;33mdata[0m  [38;5;33mEN-MIRT[0m  [38;5;33mparameters[0m  [38;5;33mresults[0m
]0;kveldkamp49@int5:~/rgmirt[kveldkamp49@int5 rgmirt]$ cd EN-MIRT/mirts[K[K[K[K[Kfitss[Kc[K[K[K[K[Kscripts/
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ Rscript fitscript.R 0 0 3 1 .85
Loading required package: stats4
Loading required package: lattice
[1] "initializing pars..."
[1] "fitting model..."
Iteration: 1, Log-Lik: -1151562.107, Max-Change: 23.54328Iteration: 2, Log-Lik: -283412.264, Max-Change: 8.16770Iteration: 3, Log-Lik: -251464.713, Max-Change: 5.76194Iteration: 4, Log-Lik: -243356.778, Max-Change: 7.71550Iteration: 5, Log-Lik: -238816.786, Max-Change: 6.66958Iteration: 6, Log-Lik: -235741.028, Max-Change: 3.02796Iteration: 7, Log-Lik: -234495.538, Max-Change: 3.85519Iteration: 8, Log-Lik: -233629.539, Max-Change: 2.91821Iteration: 9, Log-Lik: -233036.676, Max-Change: 3.26450Iteration: 10, Log-Lik: -232571.295, Max-Change: 1.20770
EM cycles terminated after 10 iterations.
Error in acc_f1_at_n(true = resp.true, pred = resp.predm, n = 10) : 
  object 'resp.predm' not found
Calls: cv.mirt -> acc_f1_at_n
Execution halted
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ vim fiy[Ktsct[Kript.R 
[?2004h[?1049h[22;0;0t[?1h=[?2004h[1;76r[?12h[?12l[27m[23m[29m[m[H[2J[?25l[76;1H"fitscript.R" 220L, 8045C[2;1Hâ–½[6n[2;1H  [1;1H[>c]10;?]11;?[1;7H[34m# [m[34m[103mif[m[34m there are rows without responses, they have no theta estimates, so we have to fill in some empty rows to make the dimensions correct[m[2;7H[38;5;130m[103mif[m[35m([m[36msum[m[35m([memptyrows[35m)[m[38;5;130m>[m[31m0[m[35m){[m[3;9Hp.pred [38;5;130m=[m [36minsertEmptyRows[m[35m([mp.pred[35m,[m [36mwhich[m[35m([memptyrows[35m))[4;7H}[m[5;7H[38;5;130m[103mif[m[35m([m[36msum[m[35m([memptycols[35m)[m[38;5;130m>[m[31m0[m[35m){[m[6;9Hp.pred [38;5;130m=[m [36minsertEmptyCols[m[35m([mp.pred[35m,[m [36mwhich[m[35m([memptycols[35m))[7;7H}[m[8;7H[34m# calculate true and predicted responses[m[9;7Hresp.pred [38;5;130m=[m [36mround[m[35m([mp.pred[35m,[m [31m0[m[35m)[m[10;7Hresp.true [38;5;130m=[m [36mround[m[35m([mp.true[35m,[m [31m0[m[35m)[m[12;7H[34m# calculate metrics and save them[m[13;7Hrmses [38;5;130m<-[m [36mc[m[35m([mrmses[35m,[m [36mRMSE[m[35m([mest[38;5;130m=[mp.pred[35m[[mper.ind[35m,[m item.ind[35m],[m par[38;5;130m=[mp.true[35m[[mper.ind[35m,[m item.ind[35m]))[m[14;7Hbiases [38;5;130m<-[m [36mc[m[35m([mbiases[35m,[m [36mbias[m[35m([mest[38;5;130m=[mp.pred[35m[[mper.ind[35m,[m item.ind[35m],[m par[38;5;130m=[mp.true[35m[[mper.ind[35m,[m item.ind[35m]))[m[15;7Htop10 [38;5;130m<-[m [36macc_f1_at_n[m[35m([mtrue[38;5;130m=[mresp.true[35m,[m pred[38;5;130m=[mresp.predm[35m,[m n[38;5;130m=[m[31m10[m[35m)[m[16;7Htop20 [38;5;130m<-[m [36macc_f1_at_n[m[35m([mtrue[38;5;130m=[mresp.true[35m,[m pred[38;5;130m=[mresp.predm[35m,[m n[38;5;130m=[m[31m20[m[35m)[m[17;7Hacc10 [38;5;130m<-[m [36mc[m[35m([macc10[35m,[m top10[35m[[m[31m1[m[35m])[m[18;7Hf110 [38;5;130m<-[m [36mc[m[35m([mf110[35m,[m top10[35m[[m[31m2[m[35m])[m[19;7Hacc20 [38;5;130m<-[m [36mc[m[35m([macc20[35m,[m top20[35m[[m[31m1[m[35m])[m[20;7Hf120 [38;5;130m<-[m [36mc[m[35m([mf120[35m,[m top20[35m[[m[31m2[m[35m])[22;5H}
[m  [35m}[m
  [38;5;130mreturn[m[35m([m[36mc[m[35m([m[36mmean[m[35m([mrmses[35m),[m [36mmean[m[35m([mbiases[35m),[m [36mmean[m[35m([macc10[35m),[m [36mmean[m[35m([macc20[35m),[m [36mmean[m[35m([mf110[35m),[m [36mmean[m[35m([mf120[35m)))
}[m

[34m# read appropriate data file[m
data1 [38;5;130m=[m [36mread.csv[m[35m([m[36mpaste[m[35m([m[31m'~/rgmirt/data/'[m[35m,[m ndim[35m,[m iteration[35m,[m sparsity[35m,[m [31m'.csv'[m[35m,[m sep[38;5;130m=[m[31m'_'[m[35m),[m row.names[38;5;130m=[m[31m1[m[35m)[m

[34m# load true parameter values[m
[36mload[m[35m([mfile[38;5;130m=[m[36mpaste[m[35m([m[31m'~/rgmirt/parameters/true/true'[m[35m,[m ndim[35m,[m iteration[35m,[m sparsity[35m,[m [31m'.RData'[m[35m,[m sep[38;5;130m=[m[31m'_'[m[35m))[m

[34m# initialize paramters[m
[36mprint[m[35m([m[31m'initializing pars...'[m[35m)[m
pars [38;5;130m<-[m [36mmirt[m[35m([mdata1[35m,[mndim[35m,[m pars [38;5;130m=[m [31m'values'[m[35m,[m technical [38;5;130m=[m [32mlist[m[35m())[m

[34m# set some loadings to zero[m
[38;5;130m[103mif[m[35m([mndim[38;5;130m==[m[31m1[m[35m){[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
[35m}[m [38;5;130melse[m [38;5;130m[103mif[m [35m([mndim[38;5;130m==[m[31m2[m[35m){[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m:[m[31m5[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m:[m[31m5[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a2'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m6[m[35m:[m[31m10[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a2'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m6[m[35m:[m[31m10[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
[35m}[m[38;5;130melse[m [38;5;130m[103mif[m [35m([mndim[38;5;130m==[m[31m3[m[35m){[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m:[m[31m10[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m:[m[31m10[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a2'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m11[m[35m:[m[31m20[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a2'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m11[m[35m:[m[31m20[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a3'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m21[m[35m:[m[31m30[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a3'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m21[m[35m:[m[31m30[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
[35m}[m

[34m# fit model[m
[36mprint[m[35m([m[31m'fitting model...'[m[35m)[m
start [38;5;130m=[m [36mSys.time[m[35m()[m
metrics [38;5;130m<-[m [36mcv.mirt[m[35m([mdata1[35m,[m ndim[35m,[m[59;17Hmethod [38;5;130m=[m [31m'EM'[m[35m,[m[60;17Hrandompars [38;5;130m=[m [31mF[m[35m,[m k [38;5;130m=[m [36mc[m[35m([m[31m3[m[35m,[m[31m2[m[35m),[m[61;17Hlambda [38;5;130m=[m [36mc[m[35m([mlambda1[35m,[mlambda2[35m),[m[62;17Ha_true [38;5;130m=[m a1[35m,[m[63;17Hd_true [38;5;130m=[m d1[35m,[m[64;17Htheta_true [38;5;130m=[m theta1[35m,[m[65;17Hpars [38;5;130m=[m pars[35m)[m
end [38;5;130m=[m [36mSys.time[m[35m()[m
time [38;5;130m=[m end[38;5;130m-[mstart
[36mprint[m[35m([mtime[35m)[m

[34m# save results[m
fileConn[38;5;130m<-[m[36mfile[m[35m([m[36mpaste0[m[35m([m[31m'~/rgmirt/results/'[m[35m,[m lambda1[35m,[m[31m'_'[m[35m,[mlambda2[35m,[m[31m'_'[m[35m,[mndim[35m,[m [31m'_'[m[35m,[miteration[35m,[m[31m'_'[m[35m,[m sparsity[35m,[m [31m'.txt'[m[35m))[m
[36mwriteLines[m[35m([m[36mc[m[35m([m[36mas.character[m[35m([mmetrics[35m[[m[31m1[m[35m]),[m [36mas.character[m[35m([mmetrics[35m[[m[31m2[m[35m]),[m [36mas.character[m[35m([mmetrics[35m[[m[31m3[m[35m]),[m [36mas.character[m[35m([mmetrics[35m[[m[31m4[m[35m]),[m [36mas.character[m[35m([mmetrics[35m[[m[31m5[m[35m]),[m [36mas.character[m[35m([mmetrics[35m[[m[31m6[m[35m])),[m fileConn[35m)[m
[36mclose[m[35m([mfileConn[35m)[m[76;253H216,32[8CBot[71;32H[?25h[27m[23m[29m[m[H[2J[?25l[1;7H[96m# [m[30m[103mif[m[96m there are rows without responses, they have no theta estimates, so we have to fill in some empty rows to make the dimensions correct[m[2;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[3;9Hp.pred [93m=[m [1m[96minsertEmptyRows[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m))[4;7H}[m[5;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[6;9Hp.pred [93m=[m [1m[96minsertEmptyCols[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m))[7;7H}[m[8;7H[96m# calculate true and predicted responses[m[9;7Hresp.pred [93m=[m [1m[96mround[m[38;5;224m([mp.pred[38;5;224m,[m [95m0[m[38;5;224m)[m[10;7Hresp.true [93m=[m [1m[96mround[m[38;5;224m([mp.true[38;5;224m,[m [95m0[m[38;5;224m)[m[12;7H[96m# calculate metrics and save them[m[13;7Hrmses [93m<-[m [1m[96mc[m[38;5;224m([mrmses[38;5;224m,[m [1m[96mRMSE[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[14;7Hbiases [93m<-[m [1m[96mc[m[38;5;224m([mbiases[38;5;224m,[m [1m[96mbias[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[15;7Htop10 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mtrue[93m=[mresp.true[38;5;224m,[m pred[93m=[mresp.predm[38;5;224m,[m n[93m=[m[95m10[m[38;5;224m)[m[16;7Htop20 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mtrue[93m=[mresp.true[38;5;224m,[m pred[93m=[mresp.predm[38;5;224m,[m n[93m=[m[95m20[m[38;5;224m)[m[17;7Hacc10 [93m<-[m [1m[96mc[m[38;5;224m([macc10[38;5;224m,[m top10[38;5;224m[[m[95m1[m[38;5;224m])[m[18;7Hf110 [93m<-[m [1m[96mc[m[38;5;224m([mf110[38;5;224m,[m top10[38;5;224m[[m[95m2[m[38;5;224m])[m[19;7Hacc20 [93m<-[m [1m[96mc[m[38;5;224m([macc20[38;5;224m,[m top20[38;5;224m[[m[95m1[m[38;5;224m])[m[20;7Hf120 [93m<-[m [1m[96mc[m[38;5;224m([mf120[38;5;224m,[m top20[38;5;224m[[m[95m2[m[38;5;224m])[22;5H}
[m  [38;5;224m}[m
  [93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([m[1m[96mmean[m[38;5;224m([mrmses[38;5;224m),[m [1m[96mmean[m[38;5;224m([mbiases[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc10[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc20[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf110[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf120[38;5;224m)))
}[m

[96m# read appropriate data file[m
data1 [93m=[m [1m[96mread.csv[m[38;5;224m([m[1m[96mpaste[m[38;5;224m([m[95m'~/rgmirt/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m

[96m# load true parameter values[m
[1m[96mload[m[38;5;224m([mfile[93m=[m[1m[96mpaste[m[38;5;224m([m[95m'~/rgmirt/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m))[m

[96m# initialize paramters[m
[1m[96mprint[m[38;5;224m([m[95m'initializing pars...'[m[38;5;224m)[m
pars [93m<-[m [1m[96mmirt[m[38;5;224m([mdata1[38;5;224m,[mndim[38;5;224m,[m pars [93m=[m [95m'values'[m[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m())[m

[96m# set some loadings to zero[m
[30m[103mif[m[38;5;224m([mndim[93m==[m[95m1[m[38;5;224m){[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
[38;5;224m}[m [93melse[m [30m[103mif[m [38;5;224m([mndim[93m==[m[95m2[m[38;5;224m){[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m5[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m5[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m6[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m6[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
[38;5;224m}[m[93melse[m [30m[103mif[m [38;5;224m([mndim[93m==[m[95m3[m[38;5;224m){[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m11[m[38;5;224m:[m[95m20[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m11[m[38;5;224m:[m[95m20[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a3'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m21[m[38;5;224m:[m[95m30[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a3'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m21[m[38;5;224m:[m[95m30[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
[38;5;224m}[m

[96m# fit model[m
[1m[96mprint[m[38;5;224m([m[95m'fitting model...'[m[38;5;224m)[m
start [93m=[m [1m[96mSys.time[m[38;5;224m()[m
metrics [93m<-[m [1m[96mcv.mirt[m[38;5;224m([mdata1[38;5;224m,[m ndim[38;5;224m,[m[59;17Hmethod [93m=[m [95m'EM'[m[38;5;224m,[m[60;17Hrandompars [93m=[m [95mF[m[38;5;224m,[m k [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m[61;17Hlambda [93m=[m [1m[96mc[m[38;5;224m([mlambda1[38;5;224m,[mlambda2[38;5;224m),[m[62;17Ha_true [93m=[m a1[38;5;224m,[m[63;17Hd_true [93m=[m d1[38;5;224m,[m[64;17Htheta_true [93m=[m theta1[38;5;224m,[m[65;17Hpars [93m=[m pars[38;5;224m)[m
end [93m=[m [1m[96mSys.time[m[38;5;224m()[m
time [93m=[m end[93m-[mstart
[1m[96mprint[m[38;5;224m([mtime[38;5;224m)[m

[96m# save results[m
fileConn[93m<-[m[1m[96mfile[m[38;5;224m([m[1m[96mpaste0[m[38;5;224m([m[95m'~/rgmirt/results/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[38;5;224m))[m
[1m[96mwriteLines[m[38;5;224m([m[1m[96mc[m[38;5;224m([m[1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m1[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m2[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m3[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m4[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m5[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m6[m[38;5;224m])),[m fileConn[38;5;224m)[m
[1m[96mclose[m[38;5;224m([mfileConn[38;5;224m)[m[76;253H216,32[8CBot"fitscript.R" 220L, 8045C[71;32H[?25h[?25l[76;243H~@k[71;32H[76;243H   [72;32H[76;255H7[72;32H[?25h[?25l[76;243H~@k[72;32H[76;243H   [73;15H[73;6H[38;5;224m[46m([8C)[m[76;255H8,15[73;15H[?25h[?25l[73;6H[38;5;224m([8C)[m[76;255H9,0-1[74;1H[?25h[?25l[76;254H20[75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;254H19[74;1H[?25h[?25l[73;6H[38;5;224m[46m([8C)[m[76;255H8,15 [73;15H[?25h[?25l[73;6H[38;5;224m([8C)[m[76;255H7,32[72;32H[?25h[?25l[76;243H~@k[72;32H[76;243H   [71;32H[76;255H6[71;32H[?25h[?25l[76;255H7[72;32H[?25h[?25l[73;6H[38;5;224m[46m([8C)[m[76;255H8,15[73;15H[?25h[?25l[73;6H[38;5;224m([8C)[m[76;255H9,0-1[74;1H[?25h[?25l[76;254H20[75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [74;1H[76;254H19[74;1H[?25h[?25l[76;243H~@k[74;1H[76;243H   [73;15H[73;6H[38;5;224m[46m([8C)[m[76;255H8,15 [73;15H[?25h[?25l[73;6H[38;5;224m([8C)[m[76;255H7,32[72;32H[?25h[?25l[76;255H6[71;32H[?25h[?25l[76;243H~@k[71;32H[76;243H   [70;14H[76;255H5,14[70;14H[?25h[?25l[76;255H4,0-1[69;1H[?25h[?25l[68;6H[38;5;224m[46m([mtime[38;5;224m[46m)[m[76;255H3,11 [68;11H[?25h[?25l[38;5;224m([mtime[38;5;224m)[m[76;255H2,16[67;16H[?25h[?25l[76;243H~@k[67;16H[76;243H   [66;16H[38;5;224m[46m()[m[76;255H1[66;16H[?25h[?25l[58;19H[38;5;224m[46m([65;28H)[m[66;15H[38;5;224m()[m[76;255H0,28[65;28H[?25h[?25l[58;19H[38;5;224m([65;28H)[m[76;254H09,32[64;32H[?25h[?25l[76;255H8,29[63;29H[?25h[?25l[76;243H~@k[63;29H[76;243H   [62;29H[76;255H7[62;29H[?25h[?25l[76;255H6,32[61;32H[?25h[?25l[76;243H~@k[61;32H[76;243H   [60;32H[76;255H5[60;32H[?25h[?25l[76;255H4,30[59;30H[?25h[?25l[76;255H3,32[58;32H[?25h[?25l[76;243H~@k[58;32H[76;243H   [57;18H[38;5;224m[46m()[m[76;255H2,18[57;18H[?25h[?25l[56;6H[38;5;224m[46m([18C)[m[57;17H[38;5;224m()[m[76;255H1,25[56;25H[?25h[?25l[56;6H[38;5;224m([18C)[m[76;255H0,11[55;11H[?25h[?25l[76;253H199,0-1[54;1H[?25h[?25l[46;19H[38;5;224m[46m{[53;1H}[m[76;255H8,1  [53;1H[?25h[?25l[46;19H[38;5;224m{[53;1H}[m[76;255H7,32[52;32H[?25h[?25l[76;243H~@k[52;32H[76;243H   [51;32H[76;255H6[51;32H[?25h[?25l[76;243H~@k[51;32H[76;243H   [50;32H[76;255H5[50;32H[?25h[?25l[76;243H~@k[50;32H[76;243H   [49;32H[76;255H4[49;32H[?25h[?25l[76;255H3[48;32H[?25h[?25l[76;255H2[47;32H[?25h[?25l[46;19H[38;5;224m[46m{[53;1H}[m[76;255H1,19[46;19H[?25h[?25l[76;243H~@k[46;19H[76;243H   [45;32H[46;19H[38;5;224m{[53;1H}[m[76;255H0,32[45;32H[?25h[?25l[76;254H89[44;32H[?25h[?25l[76;255H8[43;32H[?25h[?25l[76;243H~@k[43;32H[76;243H   [42;32H[76;255H7[42;32H[?25h[?25l[41;20H[38;5;224m[46m{[46;1H}[m[76;255H6,20[41;20H[?25h[?25l[38;5;224m{[46;1H}[m[76;255H5,32[40;32H[?25h[?25l[76;243H~@k[40;32H[76;243H   [39;32H[76;255H4[39;32H[?25h[?25l[38;12H[38;5;224m[46m{


}[m[76;255H3,1[38;12H[?25h[?25l[38;5;224m{


}[m[76;255H2,27[37;27H[?25h[?25l[76;255H1,0-1[36;1H[?25h[?25l[76;255H0,32 [35;32H[?25h[?25l[34;6H[38;5;224m[46m([22C)[m[76;254H79,29[34;29H[?25h[?25l[34;6H[38;5;224m([22C)[m[76;255H8,22[33;22H[?25h[?25l[76;243H~@k[33;22H[76;243H   [32;6H[76;255H7,6 [32;6H[?25h[?25l[76;255H6,32[31;32H[?25h[?25l[76;255H5,28[30;28H[?25h[?25l[76;243H~@k[30;28H[76;243H   [29;1H[76;255H4,0-1[29;1H[?25h[?25l[76;255H3,32 [28;32H[?25h[?25l[76;255H2,28[27;28H[?25h[?25l[76;255H1,0-1[26;1H[?25h[?25l[76;243H~@k[26;1H[76;243H   [25;1H[76;255H0,1  [25;1H[?25h[?25l[76;254H69,32[24;32H[?25h[?25l[76;255H8,3 [23;3H[?25h[?25l[76;255H7,5[22;5H[?25h[?25l[76;255H6,6[21;6H[?25h[?25l[20;16H[38;5;224m[46m([14C)[m[76;255H5,31[20;31H[?25h[?25l[19;30H[38;5;224m[46m[[1C][m[20;16H[38;5;224m([14C)[m[76;255H4,32[19;32H[?25h[?25l[18;16H[38;5;224m[46m([14C)[m[19;30H[38;5;224m[[1C][m[76;255H3,31[18;31H[?25h[?25l[76;243H~@k[18;31H[76;243H   [17;32H[38;5;224m[46m[[1C][m[18;16H[38;5;224m([14C)[m[76;255H2,32[17;32H[?25h[?25l[38;5;224m[[1C][m[76;255H1[16;32H[?25h[?25l[76;255H0[15;32H[?25h[?25l[76;243H~@k[15;32H[76;243H   [14;32H[76;254H59[14;32H[?25h[?25l[76;255H8[13;32H[?25h[?25l[76;255H7[12;32H[?25h[?25l[76;255H6,6 [11;6H[?25h[?25l[76;255H5,32[10;32H[?25h[?25l[76;243H~@k[10;32H[76;243H   [9;32H[76;255H4[9;32H[?25h[?25l[76;255H3[8;32H[?25h[?25l[5;27H[38;5;224m[46m{[7;7H}[m[76;255H2,7 [7;7H[?25h[?25l[5;27H[38;5;224m{[7;7H}[m[76;255H1,32[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[6;27H[38;5;224m[46m{[8;7H}[m[76;1H[K[76;253H150,27[8C99%[6;27H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hp.true [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma_true[38;5;224m,[m [1m[96mas.vector[m[38;5;224m([md_true[38;5;224m),[m theta_true[38;5;224m)[m[4;27H[38;5;224m[46m{[6;7H}[m[7;27H[38;5;224m{[9;7H}[m[76;253H[K[76;253H149,7[9C98%[6;7H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hp.pred [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)[5;27H{[7;7H}[m[76;253H[K[76;253H148,32[8C97%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[96m# calculate true and predicted probablities[m[6;27H[38;5;224m[46m{[8;7H}[m[76;253H[K[76;253H147,27[8C97%[6;27H[?25h[?25l[1;75r[1;1H[L[1;76r[7;27H[38;5;224m{[9;7H}[m[76;253H[K[76;253H146,32[8C96%[6;32H[?25h[?25l[76;243H~@k[6;32H[76;243H   [6;6H[1;75r[1;1H[L[1;76r[1;7Htheta [93m<-[m [1m[96mfscores[m[38;5;224m([mfit[38;5;224m)[m[76;253H[K[76;253H145,6[9C95%[6;6H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hd [93m<-[m itempars[38;5;224m[,[m [1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m2[m[38;5;224m][m[76;253H[K[76;253H144,32[8C95%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Ha [93m<-[m itempars[38;5;224m[,[m[95m1[m[38;5;224m:([m[1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m3[m[38;5;224m)][m[76;253H[K[76;253H143,32[8C94%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hitempars [93m<-[m [1m[96mcoef[m[38;5;224m([mfit[38;5;224m,[m simplify [93m=[m [95mTRUE[m[38;5;224m)$[mitems[76;253H[K[76;253H142,32[8C93%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[96m# save parameters[m[76;253H[K[76;253H141,6[9C93%[6;6H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hfit [93m<-[m [1m[96mmirt[m[38;5;224m([mtrain[38;5;224m,[m model[38;5;224m,[m [95m'2PL'[m[38;5;224m,[m method[93m=[mmethod[38;5;224m,[m GenRandomPars[93m=[mrandompars[38;5;224m,[m lambda[93m=[mlambda[38;5;224m,[m pars[93m=[mpars[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m([mNCYCLES[93m=[m[95m10[m[38;5;224m))[m[6;23H[38;5;224m[46m([mfit[38;5;224m[46m)[m[76;253H[K[76;253H140,27[8C92%[6;27H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[96m# fit model[m[7;23H[38;5;224m([mfit[38;5;224m)[m[76;253H[K[76;253H139,32[8C91%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H138,32[8C91%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[38;5;224m}[m[76;253H[K[76;253H137,32[8C90%[6;32H[?25h[?25l[76;243H~@k[6;32H[76;243H   [6;23H[1;75r[1;1H[L[1;76r[1;9Hitem.ind [93m=[m item.ind[38;5;224m[[m[93m![mitem.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m)][m[76;253H[K[76;253H136,23[8C89%[6;23H[?25h[?25l[76;243H~@k[6;23H[76;243H   [6;32H[1;75r[1;1H[L[1;76r[1;9Htrain [93m=[m train[38;5;224m[,[m[93m![memptycols[38;5;224m][m[76;253H[K[76;253H135,32[8C88%[6;32H[?25h[?25l[76;243H~@k[6;32H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[1;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H134,17[8C88%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[96m# do the same for columns[m[76;253H[K[76;253H133,6[9C87%[6;6H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[38;5;224m}[m[3;27H[38;5;224m[46m{[6;7H}[m[76;253H[K[76;253H132,7[9C86%[6;7H[?25h[?25l[76;243H~@k[6;7H[76;243H   [6;32H[1;75r[1;1H[L[1;76r[1;9Hper.ind [93m=[m per.ind[38;5;224m[[m[93m![mper.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m)][4;27H{[7;7H}[m[76;253H[K[76;253H131,32[8C86%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;9Htrain [93m=[m train[38;5;224m[[m[93m![memptyrows[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H130,32[8C85%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[6;27H[38;5;224m[46m{[9;7H}[m[76;253H[K[76;253H129,27[8C84%[6;27H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hemptycols [93m=[m [1m[96mcolSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mnrow[m[38;5;224m([mtrain[38;5;224m)[7;27H{[10;7H}[m[76;253H[K[76;253H128,31[8C84%[6;31H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hemptyrows [93m=[m [1m[96mrowSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mncol[m[38;5;224m([mtrain[38;5;224m)[m[3;27H[38;5;224m[46m{[6;7H}[m[76;253H[K[76;253H127,7[9C83%[6;7H[?25h[?25l[76;243H~@k[6;7H[76;243H   [6;32H[1;75r[1;1H[L[1;76r[1;7H[96m# [m[30m[103mif[m[96m some rows contain no responses after the leave out set, remove them from the training set, and adjust person indices accordingly[m[4;27H[38;5;224m{[7;7H}[m[76;253H[K[76;253H126,32[8C82%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H125,32[8C82%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Htrain[38;5;224m[[mper.ind[38;5;224m,[mitem.ind[38;5;224m][m [93m<-[m [95mNA[m[6;27H[38;5;224m[46m{[9;7H}[m[76;253H[K[76;253H124,27[8C81%[6;27H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Htrain [93m<-[m data[6;32H[38;5;224m[46m([mtrain[38;5;224m[46m)[m[7;27H[38;5;224m{[10;7H}[m[76;253H[K[76;253H123,32[8C80%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Htest [93m<-[m data[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m][m[6;32H[38;5;224m[46m([mtrain[38;5;224m[46m)[m[7;32H[38;5;224m([mtrain[38;5;224m)[m[76;253H[K[76;253H122,32[8C80%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[96m# create train and test folds[m[7;32H[38;5;224m([mtrain[38;5;224m)[m[76;253H[K[76;253H121,32[8C79%[6;32H[?25h[?25l[76;243H~@k[6;32H[76;243H   [6;6H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H120,6[9C78%[6;6H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hitem.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.items[93m==[mj[38;5;224m)[m[76;253H[K[76;253H119,32[8C77%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hper.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.persons[93m==[mi[38;5;224m)[m[76;253H[K[76;253H118,19[8C77%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[96m# save the persons and items that belong to the hold out test set[m[76;253H[K[76;253H117,32[8C76%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[38;5;224m{[m[76;253H[K[76;253H116,32[8C75%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[93mfor[m [38;5;224m([mj [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H115,6[9C75%[6;6H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[38;5;224m{[m[76;253H[K[76;253H114,32[8C74%[6;32H[?25h[?25l[76;243H~@k[6;32H[76;243H   [6;32H[1;75r[1;1H[L[1;76r[1;3H[93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H113,32[8C73%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[96m# loop though cross validation folds[m[76;253H[K[76;253H112,32[8C73%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[6;5H[38;5;224m[46m{[62;5H}[m[76;253H[K[76;253H111,5[9C72%[6;5H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hf1s [93m=[m [1m[96mc[m[38;5;224m()[m[6;9H[38;5;224m[46m([11C)[m
    [38;5;224m{[63;5H}[m[76;253H[K[76;253H110,21[8C71%[6;21H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Haccuracies [93m=[m [1m[96mc[m[38;5;224m()[m[6;3H[38;5;224m[46m{[m[7;9H[38;5;224m([11C)[m[65;3H[38;5;224m[46m}[m[76;253H[K[76;253H109,3[9C71%[6;3H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hbiases [93m=[m [1m[96mc[m[38;5;224m()[m[6;7H[38;5;224m[46m([11C)[m
  [38;5;224m{[66;3H}[m[76;253H[K[76;253H108,19[8C70%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hrmses [93m=[m [1m[96mc[m[38;5;224m()[7;7H([11C)[m[76;253H[K[76;253H107,32[8C69%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H106,2[9C68%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hfolds.items [93m<-[m [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mncol[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m2[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[6;10H[38;5;224m[46m()[m[76;253H[K[76;253H105,11[8C68%[6;11H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hfolds.persons [93m<-[m  [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mnrow[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m1[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[6;17H[38;5;224m[46m()[m[7;10H[38;5;224m()[m[76;253H[K[76;253H104,18[8C67%[6;18H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[96m# calculate to which fold each person and item belongs[m[6;13H[38;5;224m[46m()[m[7;17H[38;5;224m()[m[76;253H[K[76;253H103,14[8C66%[6;14H[?25h[?25l[1;75r[1;1H[L[1;76r[6;12H[38;5;224m[46m()[m[7;13H[38;5;224m()[m[76;253H[K[76;253H102,13[8C66%[6;13H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m{[7;12H()[m[76;253H[K[76;253H101,0-1[7C65%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hpars[38;5;224m)[m[10C[96m# parameters object from mirt[m[6;32H[38;5;224m[46m([mdata[38;5;224m[46m)[m[76;253H[K[76;253H100,32[8C64%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Htheta_true[38;5;224m,[m    [96m# true parameter values[m[7;32H[38;5;224m([mdata[38;5;224m)[m[76;253H[K[76;253H99,32[9C64%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hd_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H98,32[9C63%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Ha_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H97,2[10C62%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hlambda[38;5;224m,[m[8C[96m# l1 and l2 penalty[m[76;253H[K[76;253H96,1[10C62%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hk [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m    [96m# number of folds for 2d cross validation[m[76;253H[K[76;253H95,32[9C61%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hrandompars[38;5;224m,[m    [96m# mirt argument for whether to use random paramters values[m[76;253H[K[76;253H94,32[9C60%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hmethod[38;5;224m,[m[8C[96m# method of esitmation, e.g. EM[m[76;253H[K[76;253H93,32[9C60%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hmodel[38;5;224m,[m[9C[96m# model to be passed to mirt, can be number of dimensions[m[76;253H[K[76;253H92,32[9C59%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hcv.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([mdata[38;5;224m,[m[10C[96m# matrix of responses[m[76;253H[K[76;253H91,32[9C58%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# Function that fits rgmirt model using cross validation and returns the average RMSE and average bias[m[76;253H[K[76;253H90,32[9C57%[6;32H[?25h[?25l[76;243H~@k[6;32H[76;243H   [6;32H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H89,32[9C57%[6;32H[?25h[?25l[76;243H~@k[6;32H[76;243H   [7;32H[76;253H90[7;32H[?25h[?25l[76;253H89[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H88,32[9C56%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[m[76;253H[K[76;253H87,32[9C55%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([mavg_topn_accuracy[38;5;224m,[m avg_topn_f1_score[38;5;224m))[m[76;253H[K[76;253H86,32[9C55%[6;32H[?25h[?25l[76;243H~@k[6;32H[76;243H   [6;32H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H85,32[9C54%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Havg_topn_f1_score [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_f1_scores[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H84,0-1[8C53%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Havg_topn_accuracy [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_accuracies[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H83,0-1[8C53%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[96m# Calculate the average top-n accuracy and top-n F1 score across all users[m[76;253H[K[76;253H82,1[10C52%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;32H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H81,32[9C51%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[38;5;224m}[m[76;253H[K[76;253H80,2[10C51%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htopn_f1_scores[38;5;224m[[mi[38;5;224m][m [93m<-[m f1_score[76;253H[K[76;253H79,32[9C50%[6;32H[?25h[?25l[76;243H~@k[6;32H[76;243H   [6;32H[1;75r[1;1H[L[1;76r[1;5Htopn_accuracies[38;5;224m[[mi[38;5;224m][m [93m<-[m topn_accuracy[76;253H[K[76;253H78,32[9C49%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H77,32[9C48%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hf1_score [93m<-[m [95m2[m [93m*[m precision [93m*[m recall [93m/[m [38;5;224m([mprecision [93m+[m recall[38;5;224m)[m[76;253H[K[76;253H76,2[10C48%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H75,3[10C47%[6;3H[?25h[?25l[76;243H~@k[6;3H[76;243H   [6;32H[1;75r[1;1H[L[1;76r[1;5Hrecall [93m<-[m true_positives [93m/[m actual_positives[76;253H[K[76;253H74,32[9C46%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hprecision [93m<-[m true_positives [93m/[m predicted_positives[76;253H[K[76;253H73,32[9C46%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H72,4[10C45%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hactual_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m[76;253H[K[76;253H71,32[9C44%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hpredicted_positives [93m<-[m [1m[96msum[m[38;5;224m([mpred_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m[76;253H[K[76;253H70,4[10C44%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htrue_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m[76;253H[K[76;253H69,32[9C43%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[96m# Calculate the top-n F1 score for the current user[m[76;253H[K[76;253H68,32[9C42%[6;32H[?25h[?25l[76;243H~@k[6;32H[76;243H   [6;4H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H67,4[10C42%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htopn_accuracy [93m<-[m [1m[96msum[m[38;5;224m([mtrue_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m [93m/[m n[76;253H[K[76;253H66,32[9C41%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[96m# Calculate the top-n accuracy for the current user[m[76;253H[K[76;253H65,32[9C40%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H64,32[9C40%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htopn_indices [93m<-[m [1m[96morder[m[38;5;224m([m[93m-[mpred_relevance[38;5;224m)[[m[95m1[m[38;5;224m:[mn[38;5;224m][m[76;253H[K[76;253H63,32[9C39%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[96m# Get the indices of the top-n predicted relevance[m[76;253H[K[76;253H62,4[10C38%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H61,32[9C37%[6;32H[?25h[?25l[76;243H~@k[6;32H[76;243H   [6;32H[1;75r[1;1H[L[1;76r[1;5Hpred_relevance [93m<-[m pred[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H60,32[9C37%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htrue_relevance [93m<-[m true[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H59,4[10C36%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mnum_users[38;5;224m)[m [38;5;224m{[m[76;253H[K[76;253H58,32[9C35%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H57,32[9C35%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Htopn_f1_scores [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m[76;253H[K[76;253H56,4[10C34%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Htopn_accuracies [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m[6;27H[38;5;224m[46m[[3C][m[76;253H[K[76;253H55,31[9C33%[6;31H[?25h[?25l[1;75r[1;1H[L[1;76r[6;27H[38;5;224m[46m[[3C][m[7;27H[38;5;224m[[3C][m[76;253H[K[76;253H54,31[9C33%[6;31H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hnum_movies [93m<-[m [1m[96mdim[m[38;5;224m([mtrue[38;5;224m)[[m[95m2[m[38;5;224m][m[6;26H[38;5;224m[46m{[m[7;27H[38;5;224m[[3C][m[28;3H[38;5;224m[46m}[m[76;253H[K[76;253H53,26[9C32%[6;26H[?25h[?25l[76;243H~@k[6;26H[76;243H   [6;2H[1;75r[1;1H[L[1;76r[1;3Hnum_users [93m<-[m [1m[96mdim[m[38;5;224m([mtrue[38;5;224m)[[m[95m1[m[38;5;224m][7;26H{[29;3H}[m[76;253H[K[76;253H52,2[10C31%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H51,32[9C31%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hacc_f1_at_n [93m<-[m [38;5;121mfunction[m[38;5;224m([mtrue[38;5;224m,[m pred[38;5;224m,[m n[38;5;224m)[m [38;5;224m{[m[76;253H[K[76;253H50,32[9C30%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H49,2[10C29%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[m[6;26H[38;5;224m[46m[[1C][m[76;253H[K[76;253H48,28[9C28%[6;28H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[1m[96mmean[m[38;5;224m([mest[93m-[mpar[38;5;224m)[m[6;25H[38;5;224m[46m[[1C][m[7;26H[38;5;224m[[1C][m[76;253H[K[76;253H47,27[9C28%[6;27H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m{[7;25H[[1C][m[76;253H[K[76;253H46,0-1[8C27%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hbias [93m<-[m [38;5;121mfunction[m[38;5;224m([mpar[38;5;224m,[m est[38;5;224m)[m[76;253H[K[76;253H45,32[9C26%[6;32H[?25h[?25l[76;243H~@k[6;32H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;1H[96m# bias [m[76;253H[K[76;253H44,0-1[8C26%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[4;1H[38;5;224m[46m{

}[m[76;253H[K[76;253H43,1[10C25%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[5;1H{[m[6;7H[38;5;224m[46m([7C)[m
[38;5;224m}[m[76;253H[K[76;253H42,15[9C24%[6;15H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[1m[96msqrt[m[38;5;224m([m[1m[96msum[m[38;5;224m(([mest[93m-[mpar[38;5;224m)[m[93m^[m[95m2[m[38;5;224m)[m [93m/[m [1m[96mlength[m[38;5;224m([mpar[38;5;224m))[m[6;1H[38;5;224m[46m{[m[7;7H[38;5;224m([7C)[m
[38;5;224m[46m}[m[76;253H[K[76;253H41,1[10C24%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m{[m[6;17H[38;5;224m[46m([8C)[m
[38;5;224m{

}[m[76;253H[K[76;253H40,26[9C23%[6;26H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1HRMSE [93m<-[m [38;5;121mfunction[m[38;5;224m([mpar[38;5;224m,[m est[38;5;224m)[7;17H([8C)[m[76;253H[K[76;253H39,7[10C22%[6;7H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# Root mean square error[m[76;253H[K[76;253H38,0-1[8C22%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[4;1H[38;5;224m[46m{

}[m[76;253H[K[76;253H37,1[10C21%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;32H[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[5;1H{

}[m[76;253H[K[76;253H36,32[9C20%[6;32H[?25h[?25l[76;243H~@k[6;32H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;3H[93mreturn[m[38;5;224m([mnew[38;5;224m)[m[6;1H[38;5;224m[46m{

}[m[76;253H[K[76;253H35,1[10C20%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;26H[1;75r[1;1H[L[1;76r[1;3Hnew[38;5;224m[[m[93m-[mcs[38;5;224m,][m [93m<-[m m[6;17H[38;5;224m[46m([8C)[m
[38;5;224m{

}[m[76;253H[K[76;253H34,26[9C19%[6;26H[?25h[?25l[76;243H~@k[6;26H[76;243H   [6;24H[1;75r[1;1H[L[1;76r[1;3Hnew [93m=[m [38;5;121mmatrix[m[38;5;224m([m[95mNA[m[38;5;224m,[m nrow[93m=[m[1m[96mnrow[m[38;5;224m([mm[38;5;224m),[m ncol[93m=[m[1m[96mncol[m[38;5;224m([mm[38;5;224m)[m[93m+[m[1m[96mlength[m[38;5;224m([mcs[38;5;224m))[7;17H([8C)[m[76;253H[K[76;253H33,24[9C18%[6;24H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1HinsertEmptyCols [93m<-[m [38;5;121mfunction[m[38;5;224m([mm[38;5;224m,[m cs[38;5;224m){[m[76;253H[K[76;253H32,0-1[8C17%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;1H[96m# function that inserts NA rows at each index specified in m[m[2;35H[38;5;224m[46m{[6;1H}[m[76;253H[K[76;253H31,1[10C17%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;13H[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[3;35H{[m[6;9H[38;5;224m[46m([mnew[38;5;224m[46m)[m
[38;5;224m}[m[76;253H[K[76;253H30,13[9C16%[6;13H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mreturn[m[38;5;224m([mnew[38;5;224m)[7;9H([mnew[38;5;224m)[m[76;253H[K[76;253H29,16[9C15%[6;16H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hnew[38;5;224m[[m[93m-[mrs[38;5;224m,][m [93m<-[m m[76;253H[K[76;253H28,32[9C15%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hnew [93m=[m [38;5;121mmatrix[m[38;5;224m([m[95mNA[m[38;5;224m,[m nrow[93m=[m[1m[96mnrow[m[38;5;224m([mm[38;5;224m)[m[93m+[m[1m[96mlength[m[38;5;224m([mrs[38;5;224m),[m ncol[93m=[m[1m[96mncol[m[38;5;224m([mm[38;5;224m))[m[76;253H[K[76;253H27,32[9C14%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1HinsertEmptyRows [93m<-[m [38;5;121mfunction[m[38;5;224m([mm[38;5;224m,[m rs[38;5;224m){[m[76;253H[K[76;253H26,32[9C13%[6;32H[?25h[?25l[76;243H~@k[6;32H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;1H[96m# function that inserts NA rows at each index specified in m[m[2;35H[38;5;224m[46m{[6;1H}[m[76;253H[K[76;253H25,1[10C13%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[3;35H[38;5;224m{[m[6;9H[38;5;224m[46m([mnew[38;5;224m[46m)[m
[38;5;224m}[m[76;253H[K[76;253H24,13[9C12%[6;13H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[7;9H([mnew[38;5;224m)[m[76;253H[K[76;253H23,16[9C11%[6;16H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mreturn[m[38;5;224m([mprob[38;5;224m)[m[76;253H[K[76;253H22,32[9C11%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H21,32[9C10%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hprob [93m<-[m [1m[96mt[m[38;5;224m([m[1m[96mexp[m[38;5;224m([ma [93m%*%[m [1m[96mt[m[38;5;224m([mtheta[38;5;224m)[m [93m+[md[38;5;224m)[m [93m/[m [38;5;224m([m[95m1[m [93m+[m [1m[96mexp[m[38;5;224m([ma [93m%*%[m [1m[96mt[m[38;5;224m([mtheta[38;5;224m)[m[93m+[md[38;5;224m)))[m[76;253H[K[76;253H20,32[10C9%[6;32H[?25h[?25l[76;243H~@k[6;32H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;1H[38;5;224m{[m[76;253H[K[76;253H19,0-1[9C8%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;1Hpredict.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)[m
[38;5;224m[46m{[6;1H}[m[76;253H[K[76;253H18,1[11C8%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;14H[1;75r[1;1H[L[1;76r[1;1H[96m# predict probabilities based on mirt parameters[m

[38;5;224m{[m[6;9H[38;5;224m[46m([mprob[38;5;224m[46m)[m
[38;5;224m}[m[76;253H[K[76;253H17,14[10C7%[6;14H[?25h[?25l[76;243H~@k[6;14H[76;243H   [6;2H[1;75r[1;1H[L[1;76r[7;9H[38;5;224m([mprob[38;5;224m)[m[76;253H[K[76;253H16,2[11C6%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;81mlibrary[m[38;5;224m([mmirt[38;5;224m)[m[76;253H[K[76;253H15,32[10C6%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# load adapted version of mirt library (rgmirt)[m[6;1H[38;5;224m[46m{[10;1H}[m[76;253H[K[76;253H14,1[11C5%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;32H[1;75r[1;1H[L[1;76r[7;1H[38;5;224m{[11;1H}[m[76;253H[K[76;253H13,32[10C4%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hsparsity [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m5[m[38;5;224m])[m  [96m# sparsity of the dataset [m[76;253H[K[76;253H12,32[10C4%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hiteration [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m4[m[38;5;224m])[m [96m# number of the current iteration[m[76;253H[K[76;253H11,0-1[9C3%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hndim [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m3[m[38;5;224m])[m      [96m# number of latent dimensions[m[6;8H[38;5;224m[46m([mmirt[38;5;224m[46m)[m[76;253H[K[76;253H10,13[10C2%[6;13H[?25h[?25l[76;243H~@k[6;13H[76;243H   [6;32H[1;75r[1;1H[L[1;76r[1;1Hlambda2 [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m2[m[38;5;224m])[m   [96m# l2 penalty[m[7;8H[38;5;224m([mmirt[38;5;224m)[m[76;253H[K[76;253H9,32[11C2%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hlambda1 [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m1[m[38;5;224m])[m   [96m# l1 penalty [m[76;253H[K[76;253H8,0-1[10C1%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hargs [93m=[m [1m[96mcommandArgs[m[38;5;224m([mtrailingOnly[93m=[m[95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H7,32[11C0%[6;32H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# read command line arguments[m[76;253H[K[76;253H6,32[10CTop[6;32H[?25h[?25l[76;253H5[5;32H[?25h[?25l[76;243H~@k[5;32H[76;243H   [4;32H[76;253H4[4;32H[?25h[?25l[76;243H~@k[4;32H[76;243H   [3;32H[76;253H3[3;32H[?25h[?25l[76;243H~@k[3;32H[76;243H   [4;32H[76;253H4[4;32H[?25h[?25l[76;243H~@k[4;32H[76;243H   [5;32H[76;253H5[5;32H[?25h[?25l[76;253H6[6;32H[?25h[?25l[76;253H7[7;32H[?25h[?25l[76;243H~@k[7;32H[76;243H   [8;1H[76;253H8,0-1[8;1H[?25h[?25l[76;253H9,32 [9;32H[?25h[?25l[10;8H[38;5;224m[46m([mmirt[38;5;224m[46m)[m[76;253H10,13[10;13H[?25h[?25l[38;5;224m([mmirt[38;5;224m)[m[76;254H1,0-1[11;1H[?25h[?25l[76;243H~@k[11;1H[76;243H   [12;32H[76;254H2,32 [12;32H[?25h[?25l[76;254H3[13;32H[?25h[?25l
[38;5;224m[46m{[18;1H}[m[76;254H4,1 [14;1H[?25h[?25l[38;5;224m{[18;1H}[m[76;254H5,32[15;32H[?25h[?25l[76;243H~@k[15;32H[76;243H   [16;2H[76;254H6,2 [16;2H[?25h[?25l[17;9H[38;5;224m[46m([mprob[38;5;224m[46m)[m[76;254H7,14[17;14H[?25h[?25l[14;1H[38;5;224m[46m{[m[17;9H[38;5;224m([mprob[38;5;224m)[m
[38;5;224m[46m}[m[76;254H8,1 [18;1H[?25h[?25l[14;1H[38;5;224m{[18;1H}[m[76;254H9,0-1[19;1H[?25h[?25l[76;253H20,32 [20;32H[?25h[?25l[76;243H~@k[20;32H[76;243H   [21;32H[76;254H1[21;32H[?25h[?25l[76;254H2[22;32H[?25h[?25l[76;254H3,16[23;16H[?25h[?25l[24;9H[38;5;224m[46m([mnew[38;5;224m[46m)[m[76;254H4,13[24;13H[?25h[?25l[21;35H[38;5;224m[46m{[m[24;9H[38;5;224m([mnew[38;5;224m)[m
[38;5;224m[46m}[m[76;254H5,1 [25;1H[?25h[?25l[21;35H[38;5;224m{[25;1H}[m[76;254H6,32[26;32H[?25h[?25l[76;243H~@k[26;32H[76;243H   [27;32H[76;254H7[27;32H[?25h[?25l[76;254H8[28;32H[?25h[?25l[76;254H9,16[29;16H[?25h[?25l[30;9H[38;5;224m[46m([mnew[38;5;224m[46m)[m[76;253H30,13[30;13H[?25h[?25l[27;35H[38;5;224m[46m{[m[30;9H[38;5;224m([mnew[38;5;224m)[m
[38;5;224m[46m}[m[76;254H1,1 [31;1H[?25h[?25l[27;35H[38;5;224m{[31;1H}[m[76;254H2,0-1[32;1H[?25h[?25l[76;243H~@k[32;1H[76;243H   [33;24H[76;254H3,24 [33;24H[?25h[?25l[76;243H~@k[33;24H[76;243H   [34;26H[34;17H[38;5;224m[46m([8C)[m[76;254H4,26[34;26H[?25h[?25l[76;243H~@k[34;26H[76;243H   [35;1H[34;17H[38;5;224m([8C)[m
[38;5;224m[46m{

}[m[76;254H5,1 [35;1H[?25h[?25l[38;5;224m{

}[m[76;254H6,32[36;32H[?25h[?25l[35;1H[38;5;224m[46m{

}[m[76;254H7,1 [37;1H[?25h[?25l[76;243H~@k[37;1H[76;243H   [38;1H[35;1H[38;5;224m{

}[m[76;254H8,0-1[38;1H[?25h[?25l[76;254H9,7  [39;7H[?25h[?25l[40;17H[38;5;224m[46m([8C)[m[76;253H40,26[40;26H[?25h[?25l[40;17H[38;5;224m([8C)[m
[38;5;224m[46m{

}[m[76;254H1,1 [41;1H[?25h[?25l[38;5;224m{[m[42;7H[38;5;224m[46m([7C)[m
[38;5;224m}[m[76;254H2,15[42;15H[?25h[?25l[76;243H~@k[42;15H[76;243H   [43;1H[41;1H[38;5;224m[46m{[m[42;7H[38;5;224m([7C)[m
[38;5;224m[46m}[m[76;254H3,1 [43;1H[?25h[?25l[41;1H[38;5;224m{

}[m[76;254H4,0-1[44;1H[?25h[?25l[76;254H5,32 [45;32H[?25h[?25l[76;254H6,0-1[46;1H[?25h[?25l[47;25H[38;5;224m[46m[[1C][m[76;254H7,27 [47;27H[?25h[?25l[38;5;224m[[1C][m[48;26H[38;5;224m[46m[[1C][m[76;254H8,28[48;28H[?25h[?25l[76;243H~@k[48;28H[76;243H   [49;2H[48;26H[38;5;224m[[1C][m[76;254H9,2 [49;2H[?25h[?25l[76;253H50,32[50;32H[?25h[?25l[76;254H1[51;32H[?25h[?25l[76;254H2,2 [52;2H[?25h[?25l[76;243H~@k[52;2H[76;243H   [53;26H[38;5;224m[46m{[75;3H}[m[76;254H3,26[53;26H[?25h[?25l[38;5;224m{[m[54;27H[38;5;224m[46m[[3C][m[75;3H[38;5;224m}[m[76;254H4,31[54;31H[?25h[?25l[76;243H~@k[54;31H[76;243H   [55;31H[54;27H[38;5;224m[[3C][m[55;27H[38;5;224m[46m[[3C][m[76;254H5[55;31H[?25h[?25l[38;5;224m[[3C][m[76;254H6,4 [56;4H[?25h[?25l[76;254H7,32[57;32H[?25h[?25l[76;254H8[58;32H[?25h[?25l[76;254H9,4 [59;4H[?25h[?25l[76;253H60,32[60;32H[?25h[?25l[76;243H~@k[60;32H[76;243H   [61;32H[76;254H1[61;32H[?25h[?25l[76;243H~@k[61;32H[76;243H   [62;4H[76;254H2,4 [62;4H[?25h[?25l[76;243H~@k[62;4H[76;243H   [63;32H[76;254H3,32[63;32H[?25h[?25l[76;243H~@k[63;32H[76;243H   [64;32H[76;254H4[64;32H[?25h[?25l[76;243H~@k[64;32H[76;243H   [65;32H[76;254H5[65;32H[?25h[?25l[76;254H6[66;32H[?25h[?25l[76;243H~@k[66;32H[76;243H   [67;4H[76;254H7,4 [67;4H[?25h[?25l[76;243H~@k[67;4H[76;243H   [68;32H[76;254H8,32[68;32H[?25h[?25l[76;243H~@k[68;32H[76;243H   [69;32H[76;254H9[69;32H[?25h[?25l[76;243H~@k[69;32H[76;243H   [70;4H[76;253H70,4 [70;4H[?25h[?25l[76;243H~@k[70;4H[76;243H   [70;32H[1;75r[75;1H
[1;76r[76;253H[K[76;253H71,32[10C0%[70;32H[?25h[?25l[76;243H~@k[70;32H[76;243H   [70;4H[1;75r[75;1H
[1;76r[75;3H[96m# Calculate the average top-n accuracy and top-n F1 score across all users[m[76;253H[K[76;253H72,4[11C1%[70;4H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Havg_topn_accuracy [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_accuracies[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H73,32[10C2%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Havg_topn_f1_score [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_f1_scores[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H74,32[10C2%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[48;26H[38;5;224m[46m{[70;3H}[m[76;253H[K[76;253H75,3[11C3%[70;3H[?25h[?25l[76;243H~@k[70;3H[76;243H   [70;2H[1;75r[75;1H
[1;76r[47;26H[38;5;224m{[69;3H}[m[75;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([mavg_topn_accuracy[38;5;224m,[m avg_topn_f1_score[38;5;224m))[m[76;253H[K[76;253H76,2[11C4%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m[76;253H[K[76;253H77,32[10C4%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H78,32[10C5%[70;32H[?25h[?25l[76;243H~@k[70;32H[76;243H   [70;32H[1;75r[75;1H
[1;76r[76;253H[K[76;253H79,32[10C6%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# Function that fits rgmirt model using cross validation and returns the average RMSE and average bias[m[76;253H[K[76;253H80,2[11C6%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;32H[1;75r[75;1H
[1;76r[75;1Hcv.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([mdata[38;5;224m,[m[10C[96m# matrix of responses[m[76;253H[K[76;253H81,32[10C7%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[33;40H[38;5;224m[46m{[70;1H}[m[75;21Hmodel[38;5;224m,[m[9C[96m# model to be passed to mirt, can be number of dimensions[m[76;253H[K[76;253H82,1[11C8%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[32;40H[38;5;224m{[69;1H}[m[75;21Hmethod[38;5;224m,[m[8C[96m# method of esitmation, e.g. EM[m[76;253H[K[76;253H83,0-1[9C8%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;21Hrandompars[38;5;224m,[m    [96m# mirt argument for whether to use random paramters values[m[76;253H[K[76;253H84,0-1[9C9%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;32H[1;75r[75;1H
[1;76r[75;21Hk [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m    [96m# number of folds for 2d cross validation[m[76;253H[K[76;253H85,32[9C10%[70;32H[?25h[?25l[76;243H~@k[70;32H[76;243H   [70;32H[1;75r[75;1H
[1;76r[75;21Hlambda[38;5;224m,[m[8C[96m# l1 and l2 penalty[m[76;253H[K[76;253H86,32[9C11%[70;32H[?25h[?25l[76;243H~@k[70;32H[76;243H   [70;32H[1;75r[75;1H
[1;76r[75;21Ha_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H87,32[9C11%[70;32H[?25h[?25l[76;243H~@k[70;32H[76;243H   [70;32H[1;75r[75;1H
[1;76r[75;21Hd_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H88,32[9C12%[70;32H[?25h[?25l[76;243H~@k[70;32H[76;243H   [70;32H[1;75r[75;1H
[1;76r[75;21Htheta_true[38;5;224m,[m    [96m# true parameter values[m[76;253H[K[76;253H89,32[9C13%[70;32H[?25h[?25l[76;243H~@k[70;32H[76;243H   [70;32H[1;75r[75;1H
[1;76r[75;21Hpars[38;5;224m)[m[10C[96m# parameters object from mirt[m[76;253H[K[76;253H90,32[9C13%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[38;5;224m{[m[76;253H[K[76;253H91,32[9C14%[70;32H[?25h[?25l[76;243H~@k[70;32H[76;243H   [70;32H[1;75r[75;1H
[1;76r[76;253H[K[76;253H92,32[9C15%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[75;3H[96m# calculate to which fold each person and item belongs[m[76;253H[K[76;253H93,32[9C15%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hfolds.persons [93m<-[m  [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mnrow[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m1[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[76;253H[K[76;253H94,32[9C16%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hfolds.items [93m<-[m [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mncol[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m2[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[76;253H[K[76;253H95,32[9C17%[70;32H[?25h[?25l[76;243H~@k[70;32H[76;243H   [70;1H[1;75r[75;1H
[1;76r[76;253H[K[76;253H96,1[10C17%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;3Hrmses [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H97,2[10C18%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;32H[1;75r[75;1H
[1;76r[75;3Hbiases [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H98,32[9C19%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Haccuracies [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H99,32[9C20%[70;32H[?25h[?25l[76;243H~@k[70;32H[76;243H   [70;32H[1;75r[75;1H
[1;76r[70;32H[38;5;224m[46m([mdata[38;5;224m[46m)[m[75;3Hf1s [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H100,32[8C20%[70;32H[?25h[?25l[76;243H~@k[70;32H[76;243H   [70;1H[1;75r[75;1H
[1;76r[69;32H[38;5;224m([mdata[38;5;224m)[m[76;253H[K[76;253H101,0-1[7C21%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;13H[1;75r[75;1H
[1;76r[70;12H[38;5;224m[46m()[m[75;3H[96m# loop though cross validation folds[m[76;253H[K[76;253H102,13[8C22%[70;13H[?25h[?25l[76;243H~@k[70;13H[76;243H   [70;14H[1;75r[75;1H
[1;76r[69;12H[38;5;224m()[m[70;13H[38;5;224m[46m()[m[75;3H[93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H103,14[8C22%[70;14H[?25h[?25l[76;243H~@k[70;14H[76;243H   [70;18H[1;75r[75;1H
[1;76r[69;13H[38;5;224m()[m[70;17H[38;5;224m[46m()[m[75;3H[38;5;224m{[m[76;253H[K[76;253H104,18[8C23%[70;18H[?25h[?25l[76;243H~@k[70;18H[76;243H   [70;11H[1;75r[75;1H
[1;76r[69;17H[38;5;224m()[m[70;10H[38;5;224m[46m()[m[75;5H[93mfor[m [38;5;224m([mj [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H105,11[8C24%[70;11H[?25h[?25l[1;75r[75;1H
[1;76r[69;10H[38;5;224m()[75;5H{[m[76;253H[K[76;253H106,2[9C24%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# save the persons and items that belong to the hold out test set[m[76;253H[K[76;253H107,32[8C25%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[70;7H[38;5;224m[46m([11C)[m[75;7Hper.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.persons[93m==[mi[38;5;224m)[m[76;253H[K[76;253H108,19[8C26%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[69;7H[38;5;224m([11C)[m[75;7Hitem.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.items[93m==[mj[38;5;224m)[m[76;253H[K[76;253H109,3[9C26%[70;3H[?25h[?25l[76;243H~@k[70;3H[76;243H   [70;21H[1;75r[75;1H
[1;76r[70;9H[38;5;224m[46m([11C)[m[76;253H[K[76;253H110,21[8C27%[70;21H[?25h[?25l[1;75r[75;1H
[1;76r[69;9H[38;5;224m([11C)[m[75;7H[96m# create train and test folds[m[76;253H[K[76;253H111,5[9C28%[70;5H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htest [93m<-[m data[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m][m[76;253H[K[76;253H112,32[8C28%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htrain [93m<-[m data[76;253H[K[76;253H113,32[8C29%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htrain[38;5;224m[[mper.ind[38;5;224m,[mitem.ind[38;5;224m][m [93m<-[m [95mNA[m[76;253H[K[76;253H114,32[8C30%[70;32H[?25h[?25l[76;243H~@k[70;32H[76;243H   [70;6H[1;75r[75;1H
[1;76r[76;253H[K[76;253H115,6[9C31%[70;6H[?25h[?25l[76;243H~@k[70;6H[76;243H   [70;32H[1;75r[75;1H
[1;76r[75;7H[96m# [m[30m[103mif[m[96m some rows contain no responses after the leave out set, remove them from the training set, and adjust person indices accordingly[m[76;253H[K[76;253H116,32[8C31%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hemptyrows [93m=[m [1m[96mrowSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mncol[m[38;5;224m([mtrain[38;5;224m)[m[76;253H[K[76;253H117,32[8C32%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hemptycols [93m=[m [1m[96mcolSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mnrow[m[38;5;224m([mtrain[38;5;224m)[m[76;253H[K[76;253H118,19[8C33%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H119,32[8C33%[70;32H[?25h[?25l[76;243H~@k[70;32H[76;243H   [70;6H[1;75r[75;1H
[1;76r[75;9Htrain [93m=[m train[38;5;224m[[m[93m![memptyrows[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H120,6[9C34%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Hper.ind [93m=[m per.ind[38;5;224m[[m[93m![mper.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m)][m[76;253H[K[76;253H121,32[8C35%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[70;32H[38;5;224m[46m([mtrain[38;5;224m[46m)[m[75;7H[38;5;224m}[m[76;253H[K[76;253H122,32[8C35%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[69;32H[38;5;224m([mtrain[38;5;224m)[m[70;32H[38;5;224m[46m([mtrain[38;5;224m[46m)[m[75;7H[96m# do the same for columns[m[76;253H[K[76;253H123,32[8C36%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[69;32H[38;5;224m([mtrain[38;5;224m)[m[70;27H[38;5;224m[46m{[73;7H}[m[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H124,27[8C37%[70;27H[?25h[?25l[1;75r[75;1H
[1;76r[69;27H[38;5;224m{[72;7H}[m[75;9Htrain [93m=[m train[38;5;224m[,[m[93m![memptycols[38;5;224m][m[76;253H[K[76;253H125,32[8C37%[70;32H[?25h[?25l[76;243H~@k[70;32H[76;243H   [70;32H[1;75r[75;1H
[1;76r[75;9Hitem.ind [93m=[m item.ind[38;5;224m[[m[93m![mitem.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m)][m[76;253H[K[76;253H126,32[8C38%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[67;27H[38;5;224m[46m{[70;7H}[m[75;7H[38;5;224m}[m[76;253H[K[76;253H127,7[9C39%[70;7H[?25h[?25l[1;75r[75;1H
[1;76r[66;27H[38;5;224m{[69;7H}[m[76;253H[K[76;253H128,31[8C40%[70;31H[?25h[?25l[1;75r[75;1H
[1;76r[70;27H[38;5;224m[46m{[73;7H}[m[75;7H[96m# fit model[m[76;253H[K[76;253H129,27[8C40%[70;27H[?25h[?25l[1;75r[75;1H
[1;76r[69;27H[38;5;224m{[72;7H}[m[75;7Hfit [93m<-[m [1m[96mmirt[m[38;5;224m([mtrain[38;5;224m,[m model[38;5;224m,[m [95m'2PL'[m[38;5;224m,[m method[93m=[mmethod[38;5;224m,[m GenRandomPars[93m=[mrandompars[38;5;224m,[m lambda[93m=[mlambda[38;5;224m,[m pars[93m=[mpars[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m([mNCYCLES[93m=[m[95m10[m[38;5;224m))[m[76;253H[K[76;253H130,32[8C41%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# save parameters[m[76;253H[K[76;253H131,32[8C42%[70;32H[?25h[?25l[76;243H~@k[70;32H[76;243H   [70;7H[1;75r[75;1H
[1;76r[67;27H[38;5;224m[46m{[70;7H}[m[75;7Hitempars [93m<-[m [1m[96mcoef[m[38;5;224m([mfit[38;5;224m,[m simplify [93m=[m [95mTRUE[m[38;5;224m)$[mitems[76;253H[K[76;253H132,7[9C42%[70;7H[?25h[?25l[76;243H~@k[70;7H[76;243H   [70;6H[1;75r[75;1H
[1;76r[66;27H[38;5;224m{[69;7H}[m[75;7Ha [93m<-[m itempars[38;5;224m[,[m[95m1[m[38;5;224m:([m[1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m3[m[38;5;224m)][m[76;253H[K[76;253H133,6[9C43%[70;6H[?25h[?25l[76;243H~@k[70;6H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;7Hd [93m<-[m itempars[38;5;224m[,[m [1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m2[m[38;5;224m][m[76;253H[K[76;253H134,17[8C44%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htheta [93m<-[m [1m[96mfscores[m[38;5;224m([mfit[38;5;224m)[m[76;253H[K[76;253H135,32[8C44%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H136,23[8C45%[70;23H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# calculate true and predicted probablities[m[76;253H[K[76;253H137,32[8C46%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hp.pred [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)[m[76;253H[K[76;253H138,32[8C46%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hp.true [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma_true[38;5;224m,[m [1m[96mas.vector[m[38;5;224m([md_true[38;5;224m),[m theta_true[38;5;224m)[m[76;253H[K[76;253H139,32[8C47%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[70;23H[38;5;224m[46m([mfit[38;5;224m[46m)[m[76;253H[K[76;253H140,27[8C48%[70;27H[?25h[?25l[1;75r[75;1H
[1;76r[69;23H[38;5;224m([mfit[38;5;224m)[m[75;7H[96m# [m[30m[103mif[m[96m there are rows without responses, they have no theta estimates, so we have to fill in some empty rows to make the dimensions correct[m[76;253H[K[76;253H141,6[9C48%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H142,32[8C49%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Hp.pred [93m=[m [1m[96minsertEmptyRows[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m))[m[76;253H[K[76;253H143,32[8C50%[70;32H[?25h[?25l[76;243H~@k[70;32H[76;243H   [70;32H[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H144,32[8C51%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H145,6[9C51%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Hp.pred [93m=[m [1m[96minsertEmptyCols[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m))[m[76;253H[K[76;253H146,32[8C52%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[70;27H[38;5;224m[46m{[72;7H}[m[75;7H[38;5;224m}[m[76;253H[K[76;253H147,27[8C53%[70;27H[?25h[?25l[1;75r[75;1H
[1;76r[69;27H[38;5;224m{[71;7H}[m[75;7H[96m# calculate true and predicted responses[m[76;253H[K[76;253H148,32[8C53%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[68;27H[38;5;224m[46m{[70;7H}[m[75;7Hresp.pred [93m=[m [1m[96mround[m[38;5;224m([mp.pred[38;5;224m,[m [95m0[m[38;5;224m)[m[76;253H[K[76;253H149,7[9C54%[70;7H[?25h[?25l[76;243H~@k[70;7H[76;243H   [70;27H[1;75r[75;1H
[1;76r[67;27H[38;5;224m{[69;7H}[m[70;27H[38;5;224m[46m{[72;7H}[m[75;7Hresp.true [93m=[m [1m[96mround[m[38;5;224m([mp.true[38;5;224m,[m [95m0[m[38;5;224m)[m[76;253H[K[76;253H150,27[8C55%[70;27H[?25h[?25l[1;75r[75;1H
[1;76r[69;27H[38;5;224m{[71;7H}[m[76;253H[K[76;253H151,32[8C55%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[68;27H[38;5;224m[46m{[70;7H}[m[75;7H[96m# calculate metrics and save them[m[76;253H[K[76;253H152,7[9C56%[70;7H[?25h[?25l[1;75r[75;1H
[1;76r[67;27H[38;5;224m{[69;7H}[m[75;7Hrmses [93m<-[m [1m[96mc[m[38;5;224m([mrmses[38;5;224m,[m [1m[96mRMSE[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[76;253H[K[76;253H153,32[8C57%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hbiases [93m<-[m [1m[96mc[m[38;5;224m([mbiases[38;5;224m,[m [1m[96mbias[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[76;253H[K[76;253H154,32[8C57%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htop10 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mtrue[93m=[mresp.true[38;5;224m,[m pred[93m=[mresp.predm[38;5;224m,[m n[93m=[m[95m10[m[38;5;224m)[m[76;253H[K[76;253H155,32[8C58%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htop20 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mtrue[93m=[mresp.true[38;5;224m,[m pred[93m=[mresp.predm[38;5;224m,[m n[93m=[m[95m20[m[38;5;224m)[m[76;253H[K[76;253H156,6[9C59%[70;6H[?25h[?25l[76;243H~@k[70;6H[76;243H   [70;32H[1;75r[75;1H
[1;76r[75;7Hacc10 [93m<-[m [1m[96mc[m[38;5;224m([macc10[38;5;224m,[m top10[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H157,32[8C60%[70;32H[?25h[?25l[76;243H~@k[70;32H[76;243H   [70;32H[1;75r[75;1H
[1;76r[75;7Hf110 [93m<-[m [1m[96mc[m[38;5;224m([mf110[38;5;224m,[m top10[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H158,32[8C60%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hacc20 [93m<-[m [1m[96mc[m[38;5;224m([macc20[38;5;224m,[m top20[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H159,32[8C61%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hf120 [93m<-[m [1m[96mc[m[38;5;224m([mf120[38;5;224m,[m top20[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H160,32[8C62%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H161,32[8C62%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[70;30H[38;5;224m[46m[[1C][m[75;5H[38;5;224m}[m[76;253H[K[76;253H162,32[8C63%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[69;30H[38;5;224m[[1C][m[70;16H[38;5;224m[46m([14C)[m[75;3H[38;5;224m}[m[76;253H[K[76;253H163,31[8C64%[70;31H[?25h[?25l[76;243H~@k[70;31H[76;243H   [70;32H[1;75r[75;1H
[1;76r[69;16H[38;5;224m([14C)[m[70;30H[38;5;224m[46m[[1C][m[75;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([m[1m[96mmean[m[38;5;224m([mrmses[38;5;224m),[m [1m[96mmean[m[38;5;224m([mbiases[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc10[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc20[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf110[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf120[38;5;224m)))[m[76;253H[K[76;253H164,32[8C64%[70;32H[?25h[?25l[76;243H~@k[70;32H[76;243H   [70;31H[1;75r[75;1H
[1;76r[69;30H[38;5;224m[[1C][m[70;16H[38;5;224m[46m([14C)[m[75;1H[38;5;224m}[m[76;253H[K[76;253H165,31[8C65%[70;31H[?25h[?25l[76;243H~@k[70;31H[76;243H   [69;32H[38;5;224m[46m[[1C][m[70;16H[38;5;224m([14C)[m[76;255H4,32[69;32H[?25h[?25l[68;16H[38;5;224m[46m([14C)[m[69;30H[38;5;224m[[1C][m[76;255H3,31[68;31H[?25h[?25l[67;30H[38;5;224m[46m[[1C][m[68;16H[38;5;224m([14C)[m[76;255H2,32[67;32H[?25h[?25l[76;243H~@k[67;32H[76;243H   [66;32H[67;30H[38;5;224m[[1C][m[76;255H1[66;32H[?25h[?25l[67;30H[38;5;224m[46m[[1C][m[76;255H2[67;32H[?25h[?25l[38;5;224m[[1C][m[68;16H[38;5;224m[46m([14C)[m[76;255H3,31[68;31H[?25h[?25l[68;16H[38;5;224m([14C)[m[69;30H[38;5;224m[46m[[1C][m[76;255H4,32[69;32H[?25h[?25l[38;5;224m[[1C][m[70;16H[38;5;224m[46m([14C)[m[76;255H5,31[70;31H[?25h[?25l[76;243H~@k[70;31H[76;243H   [70;6H[1;75r[75;1H
[1;76r[69;16H[38;5;224m([14C)[m[76;253H[K[76;253H166,6[9C66%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[14;5H[38;5;224m[46m{[70;5H}[m[75;1H[96m# read appropriate data file[m[76;253H[K[76;253H167,5[9C66%[70;5H[?25h[?25l[1;75r[75;1H
[1;76r[11;3H[38;5;224m[46m{[m[13;5H[38;5;224m{[69;5H}[m
  [38;5;224m[46m}[m[75;1Hdata1 [93m=[m [1m[96mread.csv[m[38;5;224m([m[1m[96mpaste[m[38;5;224m([m[95m'~/rgmirt/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[76;253H[K[76;253H168,3[9C67%[70;3H[?25h[?25l[1;75r[75;1H
[1;76r[10;3H[38;5;224m{[69;3H}[m[76;253H[K[76;253H169,32[8C68%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# load true parameter values[m[76;253H[K[76;253H170,1[9C68%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[1m[96mload[m[38;5;224m([mfile[93m=[m[1m[96mpaste[m[38;5;224m([m[95m'~/rgmirt/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m))[m[76;253H[K[76;253H171,0-1[7C69%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H172,28[8C70%[70;28H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# initialize paramters[m[76;253H[K[76;253H173,32[8C71%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[1m[96mprint[m[38;5;224m([m[95m'initializing pars...'[m[38;5;224m)[m[76;253H[K[76;253H174,0-1[7C71%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1Hpars [93m<-[m [1m[96mmirt[m[38;5;224m([mdata1[38;5;224m,[mndim[38;5;224m,[m pars [93m=[m [95m'values'[m[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m())[m[76;253H[K[76;253H175,28[8C72%[70;28H[?25h[?25l[76;243H~@k[70;28H[76;243H   [70;32H[1;75r[75;1H
[1;76r[76;253H[K[76;253H176,32[8C73%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# set some loadings to zero[m[76;253H[K[76;253H177,6[9C73%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[30m[103mif[m[38;5;224m([mndim[93m==[m[95m1[m[38;5;224m){[m[76;253H[K[76;253H178,22[8C74%[70;22H[?25h[?25l[1;75r[75;1H
[1;76r[70;6H[38;5;224m[46m([22C)[m[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H179,29[8C75%[70;29H[?25h[?25l[1;75r[75;1H
[1;76r[69;6H[38;5;224m([22C)[m[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H180,32[8C75%[70;32H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m [93melse[m [30m[103mif[m [38;5;224m([mndim[93m==[m[95m2[m[38;5;224m){[m[76;253H[K[76;253H181,0-1[7C76%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m5[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H182,27[8C77%[70;27H[?25h[?25l[76;243H~@k[70;27H[76;243H   [70;12H[1;75r[75;1H
[1;76r[70;12H[38;5;224m[46m{


}[m

  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m5[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H183,12[8C77%[70;12H[?25h[?25l[76;243H~@k[70;12H[76;243H   [70;32H[1;75r[75;1H
[1;76r[69;12H[38;5;224m{


}[m[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m6[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H184,32[8C78%[70;32H[?25h[?25l[76;243H~@k[70;32H[76;243H   [69;12H[38;5;224m[46m{


}[m[76;255H3,1[69;12H[?25h[?25l[76;243H~@k[69;12H[76;243H   [68;27H[69;12H[38;5;224m{


}[m[76;255H2,27[68;27H[?25h[?25l[76;243H~@k[68;27H[76;243H   [67;1H[76;255H1,0-1[67;1H[?25h[?25l[76;243H~@k[67;1H[76;243H   [66;32H[76;255H0,32 [66;32H[?25h[?25l[76;243H~@k[66;32H[76;243H   [65;29H[65;6H[38;5;224m[46m([22C)[m[76;254H79,29[65;29H[?25h[?25l[76;243H~@k[65;29H[76;243H   [64;22H[65;6H[38;5;224m([22C)[m[76;255H8,22[64;22H[?25h[?25l[76;243H~@k[64;22H[76;243H   [63;6H[76;255H7,6 [63;6H[?25h[?25l[76;243H~@k[63;6H[76;243H   [62;32H[76;255H6,32[62;32H[?25h[?25l[76;243H~@k[62;32H[76;243H   [61;28H[76;255H5,28[61;28H[?25h[?25l[76;243H~@k[61;28H[76;243H   [60;1H[76;255H4,0-1[60;1H[?25h[?25l[76;243H~@k[60;1H[76;243H   [59;32H[76;255H3,32 [59;32H[?25h[?25l[76;243H~@k[59;32H[76;243H   [58;28H[76;255H2,28[58;28H[?25h[?25l[76;243H~@k[58;28H[76;243H   [57;1H[76;255H1,0-1[57;1H[?25h[?25l[76;243H~@k[57;1H[76;243H   [56;1H[76;255H0,1  [56;1H[?25h[?25l[76;243H~@k[56;1H[76;243H   [55;32H[76;254H69,32[55;32H[?25h[?25l[76;243H~@k[55;32H[76;243H   [54;3H[76;255H8,3 [54;3H[?25h[?25l[76;243H~@k[54;3H[76;243H   [53;5H[76;255H7,5[53;5H[?25h[?25l[76;243H~@k[53;5H[76;243H   [52;6H[76;255H6,6[52;6H[?25h[?25l[76;243H~@k[52;6H[76;243H   [51;31H[51;16H[38;5;224m[46m([14C)[m[76;255H5,31[51;31H[?25h[?25l[76;243H~@k[51;31H[76;243H   [50;32H[38;5;224m[46m[[1C][m[51;16H[38;5;224m([14C)[m[76;255H4,32[50;32H[?25h[?25l[76;243H~@k[50;32H[76;243H   [49;31H[49;16H[38;5;224m[46m([14C)[m[50;30H[38;5;224m[[1C][m[76;255H3,31[49;31H[?25h[?25l[76;243H~@k[49;31H[76;243H   [48;32H[38;5;224m[46m[[1C][m[49;16H[38;5;224m([14C)[m[76;255H2,32[48;32H[?25h[?25l[76;243H~@k[48;32H[76;243H   [47;32H[48;30H[38;5;224m[[1C][m[76;255H1[47;32H[?25h[?25l[76;243H~@k[47;32H[76;243H   [47;33H[76;258H3[47;33H[?25h[?25l[76;243H~@k[47;33H[76;243H   [47;34H[76;258H4[47;34H[?25h[?25l[76;243H~@k[47;34H[76;243H   [47;35H[76;258H5[47;35H[?25h[?25l[76;243H~@k[47;35H[76;243H   [47;36H[76;258H6[47;36H[?25h[?25l[76;243H~@k[47;36H[76;243H   [47;37H[76;258H7[47;37H[?25h[?25l[76;243H~@k[47;37H[76;243H   [47;38H[76;258H8[47;38H[?25h[?25l[76;243H~@k[47;38H[76;243H   [47;39H[76;258H9[47;39H[?25h[?25l[76;243H~@k[47;39H[76;243H   [47;40H[76;257H40[47;40H[?25h[?25l[76;243H~@k[47;40H[76;243H   [47;41H[76;258H1[47;41H[?25h[?25l[76;243H~@k[47;41H[76;243H   [47;42H[76;258H2[47;42H[?25h[?25l[76;243H~@k[47;42H[76;243H   [46;42H[76;255H0[46;42H[?25h[?25l[76;243H[[46;42H[?25h[?25l[76;244Hi[46;42H[76;243H[K[76;1Hacc_f1_at_n <- function(true, pred, n) {[46;42H[76;253H160,42[8C78%[46;42H[?25h[?25l[76;243H~@k[46;42H[76;243H   [46;43H[76;258H3[46;43H[?25h[?25l[76;243H~@k[46;43H[76;243H   [46;42H[76;258H2[46;42H[?25h[?25l[76;243H~@k[46;42H[76;243H   [46;43H[76;258H3[46;43H[?25h[?25l[76;243H~@k[46;43H[76;243H   [46;44H[76;258H4[46;44H[?25h[?25l[76;243H~@k[46;44H[76;243H   [46;45H[76;258H5[46;45H[?25h[?25l[76;243H~@k[46;45H[76;243H   [46;46H[76;258H6[46;46H[?25h[?25l[76;243H~@k[46;46H[76;243H   [46;47H[76;258H7[46;47H[?25h[?25l[76;243H~@k[46;47H[76;243H   [46;48H[76;258H8[46;48H[?25h[?25l[76;243H~@k[46;48H[76;243H   [46;49H[76;258H9[46;49H[?25h[?25l[76;243H~@k[46;49H[76;243H   [46;50H[76;257H50[46;50H[?25h[?25l[76;243H~@k[46;50H[76;243H   [46;51H[76;258H1[46;51H[?25h[?25l[76;243H~@k[46;51H[76;243H   [46;52H[76;258H2[46;52H[?25h[?25l[76;243H~@k[46;52H[76;243H   [46;53H[76;258H3[46;53H[?25h[?25l[76;243H~@k[46;53H[76;243H   [46;54H[76;258H4[46;54H[?25h[?25l[76;243H~@k[46;54H[76;243H   [46;55H[76;258H5[46;55H[?25h[?25l[76;243H~@k[46;55H[76;243H   [46;56H[76;258H6[46;56H[?25h[?25l[76;243H~@k[46;56H[76;243H   [46;57H[76;258H7[46;57H[?25h[?25l[76;243H~@k[46;57H[76;243H   [46;58H[76;258H8[46;58H[?25h[?25l[76;243H~@k[46;58H[76;243H   [46;59H[76;258H9[46;59H[?25h[?25l[76;243H~@k[46;59H[76;243H   [46;60H[76;257H60[46;60H[?25h[?25l[76;243H~@k[46;60H[76;243H   [46;61H[76;258H1[46;61H[?25h[?25l[76;243H~@k[46;61H[76;243H   [46;60H[76;258H0[46;60H[?25h[?25l[76;243H~@k[46;60H[76;243H   [46;59H[76;257H59[46;59H[?25h[?25l[76;243H~@k[46;59H[76;243H   [46;58H[76;258H8[46;58H[?25h[?25l[76;243H~@k[46;58H[76;243H   [47;58H[76;255H1[47;58H[?25h[?25l[76;243Hi[47;58H[76;243H [47;58H[76;1H[1m-- INSERT --[m[76;13H[K[76;253H161,58[8C78%[47;58H[?25h[?25l[76;255H0[46;58H[?25h[?25l[76;258H9[46;59H[?25h[?25l[38;5;224m,[m n[93m=[m[95m10[m[38;5;224m)[m[46;65H[K[76;258H8[46;58H[?25h[?25l[76;255H1[47;58H[?25h[?25l[76;258H9[47;59H[?25h[?25l[38;5;224m,[m n[93m=[m[95m20[m[38;5;224m)[m[47;65H[K[76;258H8[47;58H[?25h[?25l[76;258H7[47;57H[?25h[?25l[76;258H6[47;56H[?25h[?25l[76;258H5[47;55H[?25h[?25l[76;258H4[47;54H[?25h[?25l[76;258H3[47;53H[?25h[?25l[76;258H2[47;52H[?25h[?25l[76;258H1[47;51H[?25h[?25l[76;258H0[47;50H[?25h[?25l[76;257H49[47;49H[?25h[?25l[76;258H8[47;48H[?25h[?25l[76;258H7[47;47H[?25h[?25l[76;258H6[47;46H[?25h[?25l[76;258H5[47;45H[?25h[?25l[76;258H4[47;44H[?25h[?25l[76;258H3[47;43H[?25h[?25l[76;255H0[46;43H[?25h[?25l[76;258H2[46;42H[?25h[?25l[38;5;224m[,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[53;5H}
[m  [38;5;231m[101m}

}[m[76;258H3[46;43H[?25h[?25lp[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H4[46;44H[?25h[?25le[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H5[46;45H[?25h[?25lr[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H6[46;46H[?25h[?25l.[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H7[46;47H[?25h[?25li[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H8[46;48H[?25h[?25ln[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H9[46;49H[?25h[?25ld[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;257H50[46;50H[?25h[?25l [38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H1[46;51H[?25h[?25l[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[46;73H[K[76;258H0[46;50H[?25h[?25l[1C[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H1[46;51H[?25h[?25l [38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H2[46;52H[?25h[?25li[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H3[46;53H[?25h[?25lt[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H4[46;54H[?25h[?25le[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H5[46;55H[?25h[?25lm[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H6[46;56H[?25h[?25l.[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H7[46;57H[?25h[?25li[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H8[46;58H[?25h[?25ln[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H9[46;59H[?25h[?25ld[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;257H60[46;60H[?25h[?25l [38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H1[46;61H[?25h[?25l[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[46;83H[K[76;258H0[46;60H[?25h[?25l[38;5;224m[,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H1[46;61H[?25h[?25l[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[46;83H[K[76;258H0[46;60H[?25h[?25l[38;5;224m],[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m10[m[38;5;224m)[53;5H}
[m  [38;5;224m}

}[m[46;42H[38;5;224m[46m[[17C][m[76;258H1[46;61H[?25h[?25l[46;42H[38;5;224m[[17C][m[76;258H2[46;62H[?25h[?25l[76;258H3[46;63H[?25h[?25l[76;258H4[46;64H[?25h[?25l[76;258H5[46;65H[?25h[?25l[76;258H6[46;66H[?25h[?25l[76;258H7[46;67H[?25h[?25l[76;258H8[46;68H[?25h[?25l[76;258H9[46;69H[?25h[?25l[76;257H70[46;70H[?25h[?25l[76;258H1[46;71H[?25h[?25l[76;258H2[46;72H[?25h[?25l[76;258H3[46;73H[?25h[?25l[76;258H4[46;74H[?25h[?25l[76;258H5[46;75H[?25h[?25l[76;258H6[46;76H[?25h[?25l[76;258H7[46;77H[?25h[?25l[38;5;224m[,[m n[93m=[m[95m10[m[38;5;231m[101m)[53;5H}
[m  [38;5;231m[101m}

}[m[76;258H8[46;78H[?25h[?25lp[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H9[46;79H[?25h[?25le[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;257H80[46;80H[?25h[?25lr[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H1[46;81H[?25h[?25l.[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H2[46;82H[?25h[?25li[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H3[46;83H[?25h[?25ln[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H4[46;84H[?25h[?25ld[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H5[46;85H[?25h[?25l [38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H6[46;86H[?25h[?25l[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[46;92H[K[76;258H5[46;85H[?25h[?25l[1C[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H6[46;86H[?25h[?25l [38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H7[46;87H[?25h[?25li[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H8[46;88H[?25h[?25lt[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H9[46;89H[?25h[?25le[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;257H90[46;90H[?25h[?25lm[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H1[46;91H[?25h[?25l.[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H2[46;92H[?25h[?25li[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H3[46;93H[?25h[?25ln[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H4[46;94H[?25h[?25ld[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H5[46;95H[?25h[?25l [38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H6[46;96H[?25h[?25l[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[46;102H[K[76;258H5[46;95H[?25h[?25l[38;5;224m[,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[76;258H6[46;96H[?25h[?25l[38;5;224m,[m n[93m=[m[95m10[m[38;5;231m[101m)[m[46;102H[K[76;258H5[46;95H[?25h[?25l[38;5;224m],[m n[93m=[m[95m10[m[38;5;224m)[53;5H}
[m  [38;5;224m}

}[m[46;77H[38;5;224m[46m[[17C][m[76;258H6[46;96H[?25h[?25l[46;77H[38;5;224m[[17C][m[47;27H[38;5;224m[46m([36C)[m[76;255H1,65[47;65H[?25h[?25l[76;258H4[47;64H[?25h[?25l[47;27H[38;5;224m([36C)[m[76;258H3[47;63H[?25h[?25l[76;258H2[47;62H[?25h[?25l[76;258H1[47;61H[?25h[?25l[76;258H0[47;60H[?25h[?25l[76;257H59[47;59H[?25h[?25l[76;258H8[47;58H[?25h[?25l[76;258H7[47;57H[?25h[?25l[76;258H6[47;56H[?25h[?25l[76;258H5[47;55H[?25h[?25l[76;258H4[47;54H[?25h[?25l[76;258H3[47;53H[?25h[?25l[76;258H2[47;52H[?25h[?25l[76;258H1[47;51H[?25h[?25l[76;258H0[47;50H[?25h[?25l[76;257H49[47;49H[?25h[?25l[76;258H8[47;48H[?25h[?25l[76;258H7[47;47H[?25h[?25l[76;258H6[47;46H[?25h[?25l[76;258H5[47;45H[?25h[?25l[76;258H4[47;44H[?25h[?25l[76;258H3[47;43H[?25h[?25l[76;258H2[47;42H[?25h[?25l[38;5;224m[,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[53;5H}
[m  [38;5;231m[101m}

}[m[76;258H3[47;43H[?25h[?25lp[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H4[47;44H[?25h[?25le[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H5[47;45H[?25h[?25lr[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H6[47;46H[?25h[?25l.[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H7[47;47H[?25h[?25li[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H8[47;48H[?25h[?25ln[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H9[47;49H[?25h[?25ld[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;257H50[47;50H[?25h[?25l [38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H1[47;51H[?25h[?25l[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[47;73H[K[76;258H0[47;50H[?25h[?25l[1C[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H1[47;51H[?25h[?25l [38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H2[47;52H[?25h[?25li[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H3[47;53H[?25h[?25lt[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H4[47;54H[?25h[?25le[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H5[47;55H[?25h[?25lm[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H6[47;56H[?25h[?25l [38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H7[47;57H[?25h[?25l[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[47;79H[K[76;258H6[47;56H[?25h[?25l.[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H7[47;57H[?25h[?25li[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H8[47;58H[?25h[?25ln[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H9[47;59H[?25h[?25ld[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;257H60[47;60H[?25h[?25l [38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H1[47;61H[?25h[?25l[38;5;224m,[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[47;83H[K[76;258H0[47;60H[?25h[?25l[38;5;224m],[m pred[93m=[mresp.pred[38;5;224m,[m n[93m=[m[95m20[m[38;5;224m)[53;5H}
[m  [38;5;224m}

}[m[47;42H[38;5;224m[46m[[17C][m[76;258H1[47;61H[?25h[?25l[47;42H[38;5;224m[[17C][m[76;258H2[47;62H[?25h[?25l[76;258H3[47;63H[?25h[?25l[76;258H4[47;64H[?25h[?25l[76;258H5[47;65H[?25h[?25l[76;258H6[47;66H[?25h[?25l[76;258H7[47;67H[?25h[?25l[76;258H8[47;68H[?25h[?25l[76;258H9[47;69H[?25h[?25l[76;257H70[47;70H[?25h[?25l[76;258H1[47;71H[?25h[?25l[76;258H2[47;72H[?25h[?25l[76;258H3[47;73H[?25h[?25l[76;258H4[47;74H[?25h[?25l[76;258H5[47;75H[?25h[?25l[76;258H6[47;76H[?25h[?25l[76;258H7[47;77H[?25h[?25l[38;5;224m[,[m n[93m=[m[95m20[m[38;5;231m[101m)[53;5H}
[m  [38;5;231m[101m}

}[m[76;258H8[47;78H[?25h[?25lp[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H9[47;79H[?25h[?25le[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;257H80[47;80H[?25h[?25lr[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H1[47;81H[?25h[?25l [38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H2[47;82H[?25h[?25l[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[47;88H[K[76;258H1[47;81H[?25h[?25l.[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H2[47;82H[?25h[?25li[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H3[47;83H[?25h[?25ln[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H4[47;84H[?25h[?25ld[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H5[47;85H[?25h[?25l [38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H6[47;86H[?25h[?25l[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[47;92H[K[76;258H5[47;85H[?25h[?25l[1C[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H6[47;86H[?25h[?25l [38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H7[47;87H[?25h[?25li[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H8[47;88H[?25h[?25lt[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H9[47;89H[?25h[?25le[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;257H90[47;90H[?25h[?25lm[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H1[47;91H[?25h[?25l.[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H2[47;92H[?25h[?25li[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H3[47;93H[?25h[?25ln[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H4[47;94H[?25h[?25ld[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H5[47;95H[?25h[?25l [38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H6[47;96H[?25h[?25l[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[47;102H[K[76;258H5[47;95H[?25h[?25l[38;5;224m[,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[76;258H6[47;96H[?25h[?25l[38;5;224m,[m n[93m=[m[95m20[m[38;5;231m[101m)[m[47;102H[K[76;258H5[47;95H[?25h[?25l[38;5;224m],[m n[93m=[m[95m20[m[38;5;224m)[53;5H}
[m  [38;5;224m}

}[m[47;77H[38;5;224m[46m[[17C][m[76;258H6[47;96H[?25h[76;1H[K[47;95H[?25l[76;243H^[[47;95H[76;243H  [47;96H[76;253H161,95[8C78%[47;95H[?25h[?25l[76;243H:[47;95H[76;243H[K[76;1H:[?2004h[?25hw[?25l[?25h[?25l [?25h[?25l[?25h[?25l"fitscript.R" 220L, 8119C written[47;95H[76;253H161,95[8C78%[76;253H[K[76;253H161,95[8C78%[47;95H[?25h[?25l[76;243H~@k[47;95H[76;243H   [46;95H[46;77H[38;5;224m[46m[[17C][m[47;77H[38;5;224m[[17C][m[76;255H0[46;95H[?25h[?25l[76;243H~@k[46;95H[76;243H   [45;93H[45;18H[38;5;224m[46m([74C)[m[46;77H[38;5;224m[[17C][m[76;254H59,93[45;93H[?25h[?25l[76;243H~@k[45;93H[76;243H   [44;91H[44;17H[38;5;224m[46m([73C)[m[45;18H[38;5;224m([74C)[m[76;255H8,91[44;91H[?25h[?25l[76;243H~@k[44;91H[76;243H   [43;39H[44;17H[38;5;224m([73C)[m[76;255H7,39[43;39H[?25h[?25l[76;243H~@k[43;39H[76;243H   [42;6H[76;255H6,6 [42;6H[?25h[?25l[76;243H~@k[42;6H[76;243H   [41;34H[41;24H[38;5;224m[46m([9C)[m[76;255H5,34[41;34H[?25h[?25l[40;24H[38;5;224m[46m([9C)[m[41;24H[38;5;224m([9C)[m[76;255H4[40;34H[?25h[?25l[40;24H[38;5;224m([9C)[m[76;255H3,46[39;46H[?25h[?25l[76;243H~@k[39;46H[76;243H   [38;7H[36;27H[38;5;224m[46m{[38;7H}[m[76;255H2,7 [38;7H[?25h[?25l[76;243H~@k[38;7H[76;243H   [37;58H[36;27H[38;5;224m{[m[37;33H[38;5;224m[46m([24C)[m[38;7H[38;5;224m}[m[76;255H1,58[37;58H[?25h[?25l[76;243H~@k[37;58H[76;243H   [36;27H[38;5;224m[46m{[m[37;33H[38;5;224m([24C)[m[38;7H[38;5;224m[46m}[m[76;255H0,27[36;27H[?25h[?25l[33;27H[38;5;224m[46m{[35;7H}[m[36;27H[38;5;224m{[38;7H}[m[76;254H49,7 [35;7H[?25h[?25l[76;243H~@k[35;7H[76;243H   [34;58H[33;27H[38;5;224m{[m[34;33H[38;5;224m[46m([24C)[m[35;7H[38;5;224m}[m[76;255H8,58[34;58H[?25h[?25l[76;243H~@k[34;58H[76;243H   [33;27H[38;5;224m[46m{[m[34;33H[38;5;224m([24C)[m[35;7H[38;5;224m[46m}[m[76;255H7,27[33;27H[?25h[?25l[76;243H~@k[33;27H[76;243H   [32;95H[33;27H[38;5;224m{[35;7H}[m[76;255H6,95[32;95H[?25h[?25l[76;255H5,6 [31;6H[?25h[?25l[30;29H[38;5;224m[46m([37C)[m[76;255H4,67[30;67H[?25h[?25l[29;29H[38;5;224m[46m([11C)[m[30;29H[38;5;224m([37C)[m[76;255H3,41[29;41H[?25h[?25l[76;243H~@k[29;41H[76;243H   [28;49H[29;29H[38;5;224m([11C)[m[76;255H2,49[28;49H[?25h[?25l[76;255H1,6 [27;6H[?25h[?25l[26;23H[38;5;224m[46m([mfit[38;5;224m[46m)[m[76;255H0,27[26;27H[?25h[?25l[25;20H[38;5;224m[46m[[18C][m[26;23H[38;5;224m([mfit[38;5;224m)[m[76;254H39,39[25;39H[?25h[?25l[24;20H[38;5;224m[46m[[21C][m[25;20H[38;5;224m[[18C][m[76;255H8,42[24;42H[?25h[?25l[76;243H~@k[24;42H[76;243H   [23;50H[24;20H[38;5;224m[[21C][m[76;255H7,50[23;50H[?25h[?25l[76;255H6,23[22;23H[?25h[?25l[76;255H5,95[21;95H[?25h[?25l[76;243H~@k[21;95H[76;243H   [20;17H[76;255H4,17[20;17H[?25h[?25l[76;255H3,6 [19;6H[?25h[?25l[15;27H[38;5;224m[46m{[18;7H}[m[76;255H2,7[18;7H[?25h[?25l[76;243H~@k[18;7H[76;243H   [17;60H[15;27H[38;5;224m{[m[17;28H[38;5;224m[46m[[31C][m[18;7H[38;5;224m}[m[76;255H1,60[17;60H[?25h[?25l[16;22H[38;5;224m[46m[[11C][m[17;28H[38;5;224m[[31C][m[76;255H0,34[16;34H[?25h[?25l[15;27H[38;5;224m[46m{[m[16;22H[38;5;224m[[11C][m[18;7H[38;5;224m[46m}[m[76;254H29,27[15;27H[?25h[?25l[38;5;224m{[18;7H}[m[76;255H8,31[14;31H[?25h[?25l[10;27H[38;5;224m[46m{[13;7H}[m[76;255H7,7 [13;7H[?25h[?25l[10;27H[38;5;224m{[m[12;26H[38;5;224m[46m[[30C][m[13;7H[38;5;224m}[m[76;255H6,57[12;57H[?25h[?25l[11;22H[38;5;224m[46m[[12C][m[12;26H[38;5;224m[[30C][m[76;255H5,35[11;35H[?25h[?25l[76;243H~@k[11;35H[76;243H   [10;27H[38;5;224m[46m{[m[11;22H[38;5;224m[[12C][m[13;7H[38;5;224m[46m}[m[76;255H4,27[10;27H[?25h[?25l[9;48H[38;5;224m[46m([mtrain[38;5;224m[46m)[m[10;27H[38;5;224m{[13;7H}[m[76;255H3,54[9;54H[?25h[?25l[8;48H[38;5;224m[46m([mtrain[38;5;224m[46m)[m[9;48H[38;5;224m([mtrain[38;5;224m)[m[76;255H2[8;54H[?25h[?25l[38;5;224m([mtrain[38;5;224m)[m[76;255H1,95[7;95H[?25h[?25l[76;255H0,6 [6;6H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hitem.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.items[93m==[mj[38;5;224m)[m[76;1H[K[76;253H119,35[8C77%[6;35H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hper.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.persons[93m==[mi[38;5;224m)[m[76;253H[K[76;253H118,19[8C77%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;37H[1;75r[1;1H[L[1;76r[1;7H[96m# save the persons and items that belong to the hold out test set[m[6;19H[38;5;224m[46m[[17C][m[76;253H[K[76;253H117,37[8C76%[6;37H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[38;5;224m{[7;19H[[17C][m[76;253H[K[76;253H116,35[8C75%[6;35H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[93mfor[m [38;5;224m([mj [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H115,6[9C75%[6;6H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[38;5;224m{[m[6;24H[38;5;224m[46m([14C)[m[76;253H[K[76;253H114,39[8C74%[6;39H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m1[m[38;5;224m])[m[6;23H[38;5;224m[46m([16C)[m[7;24H[38;5;224m([14C)[m[76;253H[K[76;253H113,40[8C73%[6;40H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[96m# loop though cross validation folds[m[7;23H[38;5;224m([16C)[m[76;253H[K[76;253H112,71[8C73%[6;71H[?25h[?25l[1;75r[1;1H[L[1;76r[6;5H[38;5;224m[46m{[62;5H}[m[76;253H[K[76;253H111,5[9C72%[6;5H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hf1s [93m=[m [1m[96mc[m[38;5;224m()[m[6;9H[38;5;224m[46m([11C)[m
    [38;5;224m{[63;5H}[m[76;253H[K[76;253H110,21[8C71%[6;21H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Haccuracies [93m=[m [1m[96mc[m[38;5;224m()[m[6;3H[38;5;224m[46m{[m[7;9H[38;5;224m([11C)[m[65;3H[38;5;224m[46m}[m[76;253H[K[76;253H109,3[9C71%[6;3H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hbiases [93m=[m [1m[96mc[m[38;5;224m()[m[6;7H[38;5;224m[46m([11C)[m
  [38;5;224m{[66;3H}[m[76;253H[K[76;253H108,19[8C70%[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hrmses [93m=[m [1m[96mc[m[38;5;224m()[7;7H([11C)[m[76;253H[K[76;253H107,38[8C69%[6;38H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H106,2[9C68%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hfolds.items [93m<-[m [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mncol[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m2[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[6;10H[38;5;224m[46m()[m[76;253H[K[76;253H105,11[8C68%[6;11H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hfolds.persons [93m<-[m  [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mnrow[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m1[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[6;17H[38;5;224m[46m()[m[7;10H[38;5;224m()[m[76;253H[K[76;253H104,18[8C67%[6;18H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[96m# calculate to which fold each person and item belongs[m[6;13H[38;5;224m[46m()[m[7;17H[38;5;224m()[m[76;253H[K[76;253H103,14[8C66%[6;14H[?25h[?25l[1;75r[1;1H[L[1;76r[6;12H[38;5;224m[46m()[m[7;13H[38;5;224m()[m[76;253H[K[76;253H102,13[8C66%[6;13H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m{[7;12H()[m[76;253H[K[76;253H101,0-1[7C65%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;64H[1;75r[1;1H[L[1;76r[1;21Hpars[38;5;224m)[m[10C[96m# parameters object from mirt[m[6;21H[38;5;224m[46m([42C)[m[76;253H[K[76;253H100,64[8C64%[6;64H[?25h[?25l[76;243H~@k[6;64H[76;243H   [6;67H[1;75r[1;1H[L[1;76r[1;21Htheta_true[38;5;224m,[m    [96m# true parameter values[m[6;24H[38;5;224m[46m([42C)[m[7;21H[38;5;224m([42C)[m[76;253H[K[76;253H99,67[9C64%[6;67H[?25h[?25l[76;243H~@k[6;67H[76;243H   [6;56H[1;75r[1;1H[L[1;76r[1;21Hd_true[38;5;224m,[m[8C[96m# true parameter values[m[7;24H[38;5;224m([42C)[m[76;253H[K[76;253H98,56[9C63%[6;56H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Ha_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H97,2[10C62%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hlambda[38;5;224m,[m[8C[96m# l1 and l2 penalty[m[76;253H[K[76;253H96,1[10C62%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hk [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m    [96m# number of folds for 2d cross validation[m[76;253H[K[76;253H95,64[9C61%[6;64H[?25h[?25l[76;243H~@k[6;64H[76;243H   [6;58H[1;75r[1;1H[L[1;76r[1;21Hrandompars[38;5;224m,[m    [96m# mirt argument for whether to use random paramters values[m[76;253H[K[76;253H94,58[9C60%[6;58H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hmethod[38;5;224m,[m[8C[96m# method of esitmation, e.g. EM[m[76;253H[K[76;253H93,58[9C60%[6;58H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hmodel[38;5;224m,[m[9C[96m# model to be passed to mirt, can be number of dimensions[m[76;253H[K[76;253H92,58[9C59%[6;58H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hcv.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([mdata[38;5;224m,[m[10C[96m# matrix of responses[m[76;253H[K[76;253H91,54[9C58%[6;54H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# Function that fits rgmirt model using cross validation and returns the average RMSE and average bias[m[76;253H[K[76;253H90,76[9C57%[6;76H[?25h[?25l[76;243H~@k[6;76H[76;243H   [6;93H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H89,93[9C57%[6;93H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H88,66[9C56%[6;66H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[m[76;253H[K[76;253H87,92[9C55%[6;92H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([mavg_topn_accuracy[38;5;224m,[m avg_topn_f1_score[38;5;224m))[m[76;253H[K[76;253H86,56[9C55%[6;56H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H85,95[9C54%[6;95H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Havg_topn_f1_score [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_f1_scores[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H84,0-1[8C53%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;3Havg_topn_accuracy [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_accuracies[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H83,0-1[8C53%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[96m# Calculate the average top-n accuracy and top-n F1 score across all users[m[76;253H[K[76;253H82,1[10C52%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[6;9H[38;5;224m[46m([39C)[m[76;253H[K[76;253H81,49[9C51%[6;49H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[38;5;224m}[7;9H([39C)[m[76;253H[K[76;253H80,2[10C51%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htopn_f1_scores[38;5;224m[[mi[38;5;224m][m [93m<-[m f1_score[6;28H[38;5;224m[46m([28C)[m[76;253H[K[76;253H79,57[9C50%[6;57H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htopn_accuracies[38;5;224m[[mi[38;5;224m][m [93m<-[m topn_accuracy[6;28H[38;5;224m[46m([29C)[m[7;28H[38;5;224m([28C)[m[76;253H[K[76;253H78,58[9C49%[6;58H[?25h[?25l[1;75r[1;1H[L[1;76r[7;28H[38;5;224m([29C)[m[76;253H[K[76;253H77,76[9C48%[6;76H[?25h[?25l[76;243H~@k[6;76H[76;243H   [6;2H[1;75r[1;1H[L[1;76r[1;5Hf1_score [93m<-[m [95m2[m [93m*[m precision [93m*[m recall [93m/[m [38;5;224m([mprecision [93m+[m recall[38;5;224m)[m[76;253H[K[76;253H76,2[10C48%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H75,3[10C47%[6;3H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hrecall [93m<-[m true_positives [93m/[m actual_positives[76;253H[K[76;253H74,33[9C46%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hprecision [93m<-[m true_positives [93m/[m predicted_positives[76;253H[K[76;253H73,39[9C46%[6;39H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H72,4[10C45%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hactual_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m[6;42H[38;5;224m[46m([18C)[m[76;253H[K[76;253H71,61[9C44%[6;61H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hpredicted_positives [93m<-[m [1m[96msum[m[38;5;224m([mpred_relevance[38;5;224m[[mtopn_indices[38;5;224m])[7;42H([18C)[m[76;253H[K[76;253H70,4[10C44%[6;4H[?25h[?25l[76;243H~@k[6;4H[76;243H   [6;47H[1;75r[1;1H[L[1;76r[1;5Htrue_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m[76;253H[K[76;253H69,47[9C43%[6;47H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[96m# Calculate the top-n F1 score for the current user[m[76;253H[K[76;253H68,53[9C42%[6;53H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H67,4[10C42%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htopn_accuracy [93m<-[m [1m[96msum[m[38;5;224m([mtrue_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m [93m/[m n[6;28H[38;5;224m[46m([28C)[m[76;253H[K[76;253H66,57[9C41%[6;57H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[96m# Calculate the top-n accuracy for the current user[m[6;31H[38;5;224m[46m([28C)[m[7;28H[38;5;224m([28C)[m[76;253H[K[76;253H65,60[9C40%[6;60H[?25h[?25l[1;75r[1;1H[L[1;76r[6;26H[38;5;224m[46m([28C)[m[7;31H[38;5;224m([28C)[m[76;253H[K[76;253H64,55[9C40%[6;55H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htopn_indices [93m<-[m [1m[96morder[m[38;5;224m([m[93m-[mpred_relevance[38;5;224m)[[m[95m1[m[38;5;224m:[mn[38;5;224m][7;26H([28C)[m[76;253H[K[76;253H63,55[9C39%[6;55H[?25h[?25l[76;243H~@k[6;55H[76;243H   [6;4H[1;75r[1;1H[L[1;76r[1;5H[96m# Get the indices of the top-n predicted relevance[m[76;253H[K[76;253H62,4[10C38%[6;4H[?25h[?25l[76;243H~@k[6;4H[76;243H   [6;58H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H61,58[9C37%[6;58H[?25h[?25l[76;243H~@k[6;58H[76;243H   [6;55H[1;75r[1;1H[L[1;76r[1;5Hpred_relevance [93m<-[m pred[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H60,55[9C37%[6;55H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htrue_relevance [93m<-[m true[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H59,4[10C36%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mnum_users[38;5;224m)[m [38;5;224m{[m[6;43H[38;5;224m[46m[[3C][m[76;253H[K[76;253H58,47[9C35%[6;47H[?25h[?25l[1;75r[1;1H[L[1;76r[7;43H[38;5;224m[[3C][m[76;253H[K[76;253H57,54[9C35%[6;54H[?25h[?25l[76;243H~@k[6;54H[76;243H   [6;4H[1;75r[1;1H[L[1;76r[1;3Htopn_f1_scores [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m[76;253H[K[76;253H56,4[10C34%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Htopn_accuracies [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m[6;27H[38;5;224m[46m[[3C][m[76;253H[K[76;253H55,31[9C33%[6;31H[?25h[?25l[1;75r[1;1H[L[1;76r[6;27H[38;5;224m[46m[[3C][m[7;27H[38;5;224m[[3C][m[76;253H[K[76;253H54,31[9C33%[6;31H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hnum_movies [93m<-[m [1m[96mdim[m[38;5;224m([mtrue[38;5;224m)[[m[95m2[m[38;5;224m][m[6;26H[38;5;224m[46m{[m[7;27H[38;5;224m[[3C][m[28;3H[38;5;224m[46m}[m[76;253H[K[76;253H53,26[9C32%[6;26H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hnum_users [93m<-[m [1m[96mdim[m[38;5;224m([mtrue[38;5;224m)[[m[95m1[m[38;5;224m][7;26H{[29;3H}[m[76;253H[K[76;253H52,2[10C31%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[6;27H[38;5;224m[46m([20C)[m[76;253H[K[76;253H51,48[9C31%[6;48H[?25h[?25l[76;243H~@k[6;48H[76;243H   [6;49H[1;75r[1;1H[L[1;76r[1;1Hacc_f1_at_n [93m<-[m [38;5;121mfunction[m[38;5;224m([mtrue[38;5;224m,[m pred[38;5;224m,[m n[38;5;224m)[m [38;5;224m{[m[6;28H[38;5;224m[46m([20C)[m[7;27H[38;5;224m([20C)[m[76;253H[K[76;253H50,49[9C30%[6;49H[?25h[?25l[1;75r[1;1H[L[1;76r[7;28H[38;5;224m([20C)[m[76;253H[K[76;253H49,2[10C29%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[m[6;26H[38;5;224m[46m[[1C][m[76;253H[K[76;253H48,28[9C28%[6;28H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[1m[96mmean[m[38;5;224m([mest[93m-[mpar[38;5;224m)[m[6;25H[38;5;224m[46m[[1C][m[7;26H[38;5;224m[[1C][m[76;253H[K[76;253H47,27[9C28%[6;27H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m{[7;25H[[1C][m[76;253H[K[76;253H46,0-1[8C27%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hbias [93m<-[m [38;5;121mfunction[m[38;5;224m([mpar[38;5;224m,[m est[38;5;224m)[m[6;40H[38;5;224m[46m{[43;1H}[m[76;253H[K[76;253H45,40[9C26%[6;40H[?25h[?25l[76;243H~@k[6;40H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;1H[96m# bias [m[7;40H[38;5;224m{[44;1H}[m[76;253H[K[76;253H44,0-1[8C26%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[4;1H[38;5;224m[46m{

}[m[76;253H[K[76;253H43,1[10C25%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[5;1H{[m[6;7H[38;5;224m[46m([7C)[m
[38;5;224m}[m[76;253H[K[76;253H42,15[9C24%[6;15H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[1m[96msqrt[m[38;5;224m([m[1m[96msum[m[38;5;224m(([mest[93m-[mpar[38;5;224m)[m[93m^[m[95m2[m[38;5;224m)[m [93m/[m [1m[96mlength[m[38;5;224m([mpar[38;5;224m))[m[6;1H[38;5;224m[46m{[m[7;7H[38;5;224m([7C)[m
[38;5;224m[46m}[m[76;253H[K[76;253H41,1[10C24%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m{[m[6;17H[38;5;224m[46m([8C)[m
[38;5;224m{

}[m[76;253H[K[76;253H40,26[9C23%[6;26H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1HRMSE [93m<-[m [38;5;121mfunction[m[38;5;224m([mpar[38;5;224m,[m est[38;5;224m)[7;17H([8C)[m[76;253H[K[76;253H39,7[10C22%[6;7H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# Root mean square error[m[76;253H[K[76;253H38,0-1[8C22%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[4;1H[38;5;224m[46m{

}[m[76;253H[K[76;253H37,1[10C21%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;38H[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[5;1H{[m[6;7H[38;5;224m[46m([30C)[m
[38;5;224m}[m[76;253H[K[76;253H36,38[9C20%[6;38H[?25h[?25l[76;243H~@k[6;38H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;3H[93mreturn[m[38;5;224m([mnew[38;5;224m)[m[6;1H[38;5;224m[46m{[m[7;7H[38;5;224m([30C)[m
[38;5;224m[46m}[m[76;253H[K[76;253H35,1[10C20%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;26H[1;75r[1;1H[L[1;76r[1;3Hnew[38;5;224m[[m[93m-[mcs[38;5;224m,][m [93m<-[m m[6;17H[38;5;224m[46m([8C)[m
[38;5;224m{

}[m[76;253H[K[76;253H34,26[9C19%[6;26H[?25h[?25l[76;243H:[6;26H[76;243H[K[76;1H:[?2004h[?25hq[?25l[?25h[?25l[?2004l[76;1H[K[76;1H[?2004l[?1l>[?25h[?1049l[23;0;0t]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ vim fitscript.R Rscript fitscript.R 0 0 3 1 .85
Loading required package: stats4
Loading required package: lattice
[1] "initializing pars..."
[1] "fitting model..."
Iteration: 1, Log-Lik: -1151562.107, Max-Change: 23.54328Iteration: 2, Log-Lik: -283412.264, Max-Change: 8.16770Iteration: 3, Log-Lik: -251464.713, Max-Change: 5.76194Iteration: 4, Log-Lik: -243356.778, Max-Change: 7.71550Iteration: 5, Log-Lik: -238816.786, Max-Change: 6.66958Iteration: 6, Log-Lik: -235741.028, Max-Change: 3.02796Iteration: 7, Log-Lik: -234495.538, Max-Change: 3.85519Iteration: 8, Log-Lik: -233629.539, Max-Change: 2.91821Iteration: 9, Log-Lik: -233036.676, Max-Change: 3.26450Iteration: 10, Log-Lik: -232571.295, Max-Change: 1.20770
EM cycles terminated after 10 iterations.
Error in cv.mirt(data1, ndim, method = "EM", randompars = F, k = c(3,  : 
  object 'acc10' not found
Execution halted
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ vim fitscript.R 
[?2004h[?1049h[22;0;0t[?1h=[?2004h[1;76r[?12h[?12l[27m[23m[29m[m[H[2J[?25l[76;1H"fitscript.R" 220L, 8119C[2;1Hâ–½[6n[2;1H  [1;1H[>c]10;?]11;?[1;1H[34m# read command line arguments[m
args [38;5;130m=[m [36mcommandArgs[m[35m([mtrailingOnly[38;5;130m=[m[31mTRUE[m[35m)[m
lambda1 [38;5;130m=[m [36mas.numeric[m[35m([margs[35m[[m[31m1[m[35m])[m   [34m# l1 penalty [m
lambda2 [38;5;130m=[m [36mas.numeric[m[35m([margs[35m[[m[31m2[m[35m])[m   [34m# l2 penalty[m
ndim [38;5;130m=[m [36mas.numeric[m[35m([margs[35m[[m[31m3[m[35m])[m      [34m# number of latent dimensions[m
iteration [38;5;130m=[m [36mas.numeric[m[35m([margs[35m[[m[31m4[m[35m])[m [34m# number of the current iteration[m
sparsity [38;5;130m=[m [36mas.numeric[m[35m([margs[35m[[m[31m5[m[35m])[m  [34m# sparsity of the dataset 

# load adapted version of mirt library (rgmirt)[m
[35mlibrary[m[35m([mmirt[35m)[m

[34m# predict probabilities based on mirt parameters[m
predict.mirt [38;5;130m<-[m [32mfunction[m[35m([ma[35m,[m d[35m,[m theta[35m)
{[m
  prob [38;5;130m<-[m [36mt[m[35m([m[36mexp[m[35m([ma [38;5;130m%*%[m [36mt[m[35m([mtheta[35m)[m [38;5;130m+[md[35m)[m [38;5;130m/[m [35m([m[31m1[m [38;5;130m+[m [36mexp[m[35m([ma [38;5;130m%*%[m [36mt[m[35m([mtheta[35m)[m[38;5;130m+[md[35m)))[m

  [38;5;130mreturn[m[35m([mprob[35m)
}[m

[34m# function that inserts NA rows at each index specified in m[m
insertEmptyRows [38;5;130m<-[m [32mfunction[m[35m([mm[35m,[m rs[35m){[m
  new [38;5;130m=[m [32mmatrix[m[35m([m[31mNA[m[35m,[m nrow[38;5;130m=[m[36mnrow[m[35m([mm[35m)[m[38;5;130m+[m[36mlength[m[35m([mrs[35m),[m ncol[38;5;130m=[m[36mncol[m[35m([mm[35m))[m
  new[35m[[m[38;5;130m-[mrs[35m,][m [38;5;130m<-[m m
  [38;5;130mreturn[m[35m([mnew[35m)
}[m
[34m# function that inserts NA rows at each index specified in m[m
insertEmptyCols [38;5;130m<-[m [32mfunction[m[35m([mm[35m,[m cs[35m){[m
  new [38;5;130m=[m [32mmatrix[m[35m([m[31mNA[m[35m,[m nrow[38;5;130m=[m[36mnrow[m[35m([mm[35m),[m ncol[38;5;130m=[m[36mncol[m[35m([mm[35m)[m[38;5;130m+[m[36mlength[m[35m([mcs[35m))[m
  new[35m[[m[38;5;130m-[mcs[35m,][m [38;5;130m<-[m m
  [38;5;130mreturn[m[35m([mnew[35m)
}[m

[34m# Root mean square error[m
RMSE [38;5;130m<-[m [32mfunction[m[35m[106m([mpar[35m,[m est[35m[106m)[m
[35m{[m
  [36msqrt[m[35m([m[36msum[m[35m(([mest[38;5;130m-[mpar[35m)[m[38;5;130m^[m[31m2[m[35m)[m [38;5;130m/[m [36mlength[m[35m([mpar[35m))
}[m

[34m# bias [m
bias [38;5;130m<-[m [32mfunction[m[35m([mpar[35m,[m est[35m)
{[m
  [36mmean[m[35m([mest[38;5;130m-[mpar[35m)
}[m

acc_f1_at_n [38;5;130m<-[m [32mfunction[m[35m([mtrue[35m,[m pred[35m,[m n[35m)[m [35m{[m

  num_users [38;5;130m<-[m [36mdim[m[35m([mtrue[35m)[[m[31m1[m[35m][m
  num_movies [38;5;130m<-[m [36mdim[m[35m([mtrue[35m)[[m[31m2[m[35m][m

  topn_accuracies [38;5;130m<-[m [32mvector[m[35m([m[31m"numeric"[m[35m,[m num_users[35m)[m
  topn_f1_scores [38;5;130m<-[m [32mvector[m[35m([m[31m"numeric"[m[35m,[m num_users[35m)[m

  [38;5;130mfor[m [35m([mi [38;5;130min[m [31m1[m[35m:[mnum_users[35m)[m [35m{[m
    true_relevance [38;5;130m<-[m true[35m[[mi[35m,[m [35m][m
    pred_relevance [38;5;130m<-[m pred[35m[[mi[35m,[m [35m][m[57;5H[34m# Get the indices of the top-n predicted relevance[m
    topn_indices [38;5;130m<-[m [36morder[m[35m([m[38;5;130m-[mpred_relevance[35m)[[m[31m1[m[35m:[mn[35m][m[60;5H[34m# Calculate the top-n accuracy for the current user[m
    topn_accuracy [38;5;130m<-[m [36msum[m[35m([mtrue_relevance[35m[[mtopn_indices[35m])[m [38;5;130m/[m n[63;5H[34m# Calculate the top-n F1 score for the current user[m
    true_positives [38;5;130m<-[m [36msum[m[35m([mtrue_relevance[35m[[mtopn_indices[35m])[m
    predicted_positives [38;5;130m<-[m [36msum[m[35m([mpred_relevance[35m[[mtopn_indices[35m])[m
    actual_positives [38;5;130m<-[m [36msum[m[35m([mtrue_relevance[35m[[mtopn_indices[35m])[m[68;5Hprecision [38;5;130m<-[m true_positives [38;5;130m/[m predicted_positives
    recall [38;5;130m<-[m true_positives [38;5;130m/[m actual_positives[71;5Hf1_score [38;5;130m<-[m [31m2[m [38;5;130m*[m precision [38;5;130m*[m recall [38;5;130m/[m [35m([mprecision [38;5;130m+[m recall[35m)[m[73;5Htopn_accuracies[35m[[mi[35m][m [38;5;130m<-[m topn_accuracy
    topn_f1_scores[35m[[mi[35m][m [38;5;130m<-[m f1_score
  [35m}[m[76;253H34,26[9CTop[34;26H[?25h[27m[23m[29m[m[H[2J[?25l[1;1H[96m# read command line arguments[m
args [93m=[m [1m[96mcommandArgs[m[38;5;224m([mtrailingOnly[93m=[m[95mTRUE[m[38;5;224m)[m
lambda1 [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m1[m[38;5;224m])[m   [96m# l1 penalty [m
lambda2 [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m2[m[38;5;224m])[m   [96m# l2 penalty[m
ndim [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m3[m[38;5;224m])[m      [96m# number of latent dimensions[m
iteration [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m4[m[38;5;224m])[m [96m# number of the current iteration[m
sparsity [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m5[m[38;5;224m])[m  [96m# sparsity of the dataset 

# load adapted version of mirt library (rgmirt)[m
[38;5;81mlibrary[m[38;5;224m([mmirt[38;5;224m)[m

[96m# predict probabilities based on mirt parameters[m
predict.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)
{[m
  prob [93m<-[m [1m[96mt[m[38;5;224m([m[1m[96mexp[m[38;5;224m([ma [93m%*%[m [1m[96mt[m[38;5;224m([mtheta[38;5;224m)[m [93m+[md[38;5;224m)[m [93m/[m [38;5;224m([m[95m1[m [93m+[m [1m[96mexp[m[38;5;224m([ma [93m%*%[m [1m[96mt[m[38;5;224m([mtheta[38;5;224m)[m[93m+[md[38;5;224m)))[m

  [93mreturn[m[38;5;224m([mprob[38;5;224m)
}[m

[96m# function that inserts NA rows at each index specified in m[m
insertEmptyRows [93m<-[m [38;5;121mfunction[m[38;5;224m([mm[38;5;224m,[m rs[38;5;224m){[m
  new [93m=[m [38;5;121mmatrix[m[38;5;224m([m[95mNA[m[38;5;224m,[m nrow[93m=[m[1m[96mnrow[m[38;5;224m([mm[38;5;224m)[m[93m+[m[1m[96mlength[m[38;5;224m([mrs[38;5;224m),[m ncol[93m=[m[1m[96mncol[m[38;5;224m([mm[38;5;224m))[m
  new[38;5;224m[[m[93m-[mrs[38;5;224m,][m [93m<-[m m
  [93mreturn[m[38;5;224m([mnew[38;5;224m)
}[m
[96m# function that inserts NA rows at each index specified in m[m
insertEmptyCols [93m<-[m [38;5;121mfunction[m[38;5;224m([mm[38;5;224m,[m cs[38;5;224m){[m
  new [93m=[m [38;5;121mmatrix[m[38;5;224m([m[95mNA[m[38;5;224m,[m nrow[93m=[m[1m[96mnrow[m[38;5;224m([mm[38;5;224m),[m ncol[93m=[m[1m[96mncol[m[38;5;224m([mm[38;5;224m)[m[93m+[m[1m[96mlength[m[38;5;224m([mcs[38;5;224m))[m
  new[38;5;224m[[m[93m-[mcs[38;5;224m,][m [93m<-[m m
  [93mreturn[m[38;5;224m([mnew[38;5;224m)
}[m

[96m# Root mean square error[m
RMSE [93m<-[m [38;5;121mfunction[m[38;5;224m[46m([mpar[38;5;224m,[m est[38;5;224m[46m)[m
[38;5;224m{[m
  [1m[96msqrt[m[38;5;224m([m[1m[96msum[m[38;5;224m(([mest[93m-[mpar[38;5;224m)[m[93m^[m[95m2[m[38;5;224m)[m [93m/[m [1m[96mlength[m[38;5;224m([mpar[38;5;224m))
}[m

[96m# bias [m
bias [93m<-[m [38;5;121mfunction[m[38;5;224m([mpar[38;5;224m,[m est[38;5;224m)
{[m
  [1m[96mmean[m[38;5;224m([mest[93m-[mpar[38;5;224m)
}[m

acc_f1_at_n [93m<-[m [38;5;121mfunction[m[38;5;224m([mtrue[38;5;224m,[m pred[38;5;224m,[m n[38;5;224m)[m [38;5;224m{[m

  num_users [93m<-[m [1m[96mdim[m[38;5;224m([mtrue[38;5;224m)[[m[95m1[m[38;5;224m][m
  num_movies [93m<-[m [1m[96mdim[m[38;5;224m([mtrue[38;5;224m)[[m[95m2[m[38;5;224m][m

  topn_accuracies [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m
  topn_f1_scores [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m

  [93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mnum_users[38;5;224m)[m [38;5;224m{[m
    true_relevance [93m<-[m true[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m
    pred_relevance [93m<-[m pred[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m[57;5H[96m# Get the indices of the top-n predicted relevance[m
    topn_indices [93m<-[m [1m[96morder[m[38;5;224m([m[93m-[mpred_relevance[38;5;224m)[[m[95m1[m[38;5;224m:[mn[38;5;224m][m[60;5H[96m# Calculate the top-n accuracy for the current user[m
    topn_accuracy [93m<-[m [1m[96msum[m[38;5;224m([mtrue_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m [93m/[m n[63;5H[96m# Calculate the top-n F1 score for the current user[m
    true_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m
    predicted_positives [93m<-[m [1m[96msum[m[38;5;224m([mpred_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m
    actual_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_relevance[38;5;224m[[mtopn_indices[38;5;224m])[m[68;5Hprecision [93m<-[m true_positives [93m/[m predicted_positives
    recall [93m<-[m true_positives [93m/[m actual_positives[71;5Hf1_score [93m<-[m [95m2[m [93m*[m precision [93m*[m recall [93m/[m [38;5;224m([mprecision [93m+[m recall[38;5;224m)[m[73;5Htopn_accuracies[38;5;224m[[mi[38;5;224m][m [93m<-[m topn_accuracy
    topn_f1_scores[38;5;224m[[mi[38;5;224m][m [93m<-[m f1_score
  [38;5;224m}[m[76;253H34,26[9CTop"fitscript.R" 220L, 8119C[34;26H[?25h[?25l[76;243H~@k[34;26H[76;243H   [35;1H[34;17H[38;5;224m([8C)[m
[38;5;224m[46m{

}[m[76;254H5,1 [35;1H[?25h[?25l[76;243H~@k[35;1H[76;243H   [36;1H[35;1H[38;5;224m{

}[m[76;254H6[36;1H[?25h[?25l[35;1H[38;5;224m[46m{

}[m[76;254H7[37;1H[?25h[?25l[35;1H[38;5;224m{

}[m[76;254H8,0-1[38;1H[?25h[?25l[76;243H~@k[38;1H[76;243H   [39;1H[76;254H9,1  [39;1H[?25h[?25l[76;243H~@k[39;1H[76;243H   [40;1H[76;253H40[40;1H[?25h[?25l
[38;5;224m[46m{

}[m[76;254H1[41;1H[?25h[?25l[38;5;224m{

}[m[76;254H2[42;1H[?25h[?25l[41;1H[38;5;224m[46m{

}[m[76;254H3[43;1H[?25h[?25l[76;243H~@k[43;1H[76;243H   [44;1H[41;1H[38;5;224m{

}[m[76;254H4,0-1[44;1H[?25h[?25l[76;254H5,1  [45;1H[?25h[?25l[76;254H6,0-1[46;1H[?25h[?25l[76;254H7,1  [47;1H[?25h[?25l[76;254H8[48;1H[?25h[?25l[76;254H9[49;1H[?25h[?25l[76;243H~@k[49;1H[76;243H   [50;1H[76;253H50[50;1H[?25h[?25l[76;254H1[51;1H[?25h[?25l[76;254H2[52;1H[?25h[?25l[76;254H3[53;1H[?25h[?25l[76;254H4[54;1H[?25h[?25l[76;254H5[55;1H[?25h[?25l[76;243H~@k[55;1H[76;243H   [56;1H[76;254H6[56;1H[?25h[?25l[76;254H7[57;1H[?25h[?25l[76;254H8[58;1H[?25h[?25l[76;254H9[59;1H[?25h[?25l[76;243H~@k[59;1H[76;243H   [60;1H[76;253H60[60;1H[?25h[?25l[76;254H1[61;1H[?25h[?25l[76;254H2[62;1H[?25h[?25l[76;243H~@k[62;1H[76;243H   [63;1H[76;254H3[63;1H[?25h[?25l[76;254H4[64;1H[?25h[?25l[76;254H5[65;1H[?25h[?25l[76;243H~@k[65;1H[76;243H   [66;1H[76;254H6[66;1H[?25h[?25l[76;254H7[67;1H[?25h[?25l[76;254H8[68;1H[?25h[?25l[76;254H9[69;1H[?25h[?25l[76;243H~@k[69;1H[76;243H   [70;1H[76;253H70[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;1H[K[76;253H71,1[11C0%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3H[96m# Calculate the average top-n accuracy and top-n F1 score across all users[m[76;253H[K[76;253H72,1[11C1%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Havg_topn_accuracy [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_accuracies[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H73,1[11C2%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Havg_topn_f1_score [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_f1_scores[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H74,1[11C2%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H75,1[11C3%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([mavg_topn_accuracy[38;5;224m,[m avg_topn_f1_score[38;5;224m))[m[76;253H[K[76;253H76,1[11C4%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m[76;253H[K[76;253H77,1[11C4%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[76;253H[K[76;253H78,1[11C5%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[76;253H[K[76;253H79,1[11C6%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;1H[96m# Function that fits rgmirt model using cross validation and returns the average RMSE and average bias[m[76;253H[K[76;253H80,1[11C6%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;1Hcv.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([mdata[38;5;224m,[m[10C[96m# matrix of responses[m[76;253H[K[76;253H81,1[11C7%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[33;40H[38;5;224m[46m{[70;1H}[m[75;21Hmodel[38;5;224m,[m[9C[96m# model to be passed to mirt, can be number of dimensions[m[76;253H[K[76;253H82,1[11C8%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[32;40H[38;5;224m{[69;1H}[m[75;21Hmethod[38;5;224m,[m[8C[96m# method of esitmation, e.g. EM[m[76;253H[K[76;253H83,0-1[9C8%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;21Hrandompars[38;5;224m,[m    [96m# mirt argument for whether to use random paramters values[m[76;253H[K[76;253H84,0-1[9C9%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;21Hk [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m    [96m# number of folds for 2d cross validation[m[76;253H[K[76;253H85,1[10C10%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;21Hlambda[38;5;224m,[m[8C[96m# l1 and l2 penalty[m[76;253H[K[76;253H86,1[10C11%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;21Ha_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H87,1[10C11%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;21Hd_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H88,1[10C12%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;21Htheta_true[38;5;224m,[m    [96m# true parameter values[m[76;253H[K[76;253H89,1[10C13%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;21Hpars[38;5;224m)[m[10C[96m# parameters object from mirt[m[76;253H[K[76;253H90,1[10C13%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[38;5;224m{[m[76;253H[K[76;253H91,1[10C14%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[76;253H[K[76;253H92,1[10C15%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3H[96m# calculate to which fold each person and item belongs[m[76;253H[K[76;253H93,1[10C15%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hfolds.persons [93m<-[m  [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mnrow[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m1[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[76;253H[K[76;253H94,1[10C16%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hfolds.items [93m<-[m [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mncol[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m2[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[76;253H[K[76;253H95,1[10C17%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H96,1[10C17%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;3Hrmses [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H97,1[10C18%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hbiases [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H98,1[10C19%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Haccuracies [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H99,1[10C20%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;3Hf1s [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H100,1[9C20%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H101,0-1[7C21%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3H[96m# loop though cross validation folds[m[76;253H[K[76;253H102,1[9C22%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;3H[93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H103,1[9C22%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3H[38;5;224m{[m[76;253H[K[76;253H104,1[9C23%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;5H[93mfor[m [38;5;224m([mj [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H105,1[9C24%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;5H[38;5;224m{[m[76;253H[K[76;253H106,1[9C24%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7H[96m# save the persons and items that belong to the hold out test set[m[76;253H[K[76;253H107,1[9C25%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hper.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.persons[93m==[mi[38;5;224m)[m[76;253H[K[76;253H108,1[9C26%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7Hitem.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.items[93m==[mj[38;5;224m)[m[76;253H[K[76;253H109,1[9C26%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[76;253H[K[76;253H110,1[9C27%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7H[96m# create train and test folds[m[76;253H[K[76;253H111,1[9C28%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htest [93m<-[m data[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m][m[76;253H[K[76;253H112,1[9C28%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htrain [93m<-[m data[76;253H[K[76;253H113,1[9C29%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7Htrain[38;5;224m[[mper.ind[38;5;224m,[mitem.ind[38;5;224m][m [93m<-[m [95mNA[m[76;253H[K[76;253H114,1[9C30%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H115,1[9C31%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# [m[30m[103mif[m[96m some rows contain no responses after the leave out set, remove them from the training set, and adjust person indices accordingly[m[76;253H[K[76;253H116,1[9C31%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hemptyrows [93m=[m [1m[96mrowSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mncol[m[38;5;224m([mtrain[38;5;224m)[m[76;253H[K[76;253H117,1[9C32%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7Hemptycols [93m=[m [1m[96mcolSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mnrow[m[38;5;224m([mtrain[38;5;224m)[m[76;253H[K[76;253H118,1[9C33%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H119,1[9C33%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Htrain [93m=[m train[38;5;224m[[m[93m![memptyrows[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H120,1[9C34%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;9Hper.ind [93m=[m per.ind[38;5;224m[[m[93m![mper.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m)][m[76;253H[K[76;253H121,1[9C35%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H122,1[9C35%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7H[96m# do the same for columns[m[76;253H[K[76;253H123,1[9C36%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H124,1[9C37%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Htrain [93m=[m train[38;5;224m[,[m[93m![memptycols[38;5;224m][m[76;253H[K[76;253H125,1[9C37%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Hitem.ind [93m=[m item.ind[38;5;224m[[m[93m![mitem.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m)][m[76;253H[K[76;253H126,1[9C38%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H127,1[9C39%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H128,1[9C40%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7H[96m# fit model[m[76;253H[K[76;253H129,1[9C40%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7Hfit [93m<-[m [1m[96mmirt[m[38;5;224m([mtrain[38;5;224m,[m model[38;5;224m,[m [95m'2PL'[m[38;5;224m,[m method[93m=[mmethod[38;5;224m,[m GenRandomPars[93m=[mrandompars[38;5;224m,[m lambda[93m=[mlambda[38;5;224m,[m pars[93m=[mpars[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m([mNCYCLES[93m=[m[95m10[m[38;5;224m))[m[76;253H[K[76;253H130,1[9C41%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7H[96m# save parameters[m[76;253H[K[76;253H131,1[9C42%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hitempars [93m<-[m [1m[96mcoef[m[38;5;224m([mfit[38;5;224m,[m simplify [93m=[m [95mTRUE[m[38;5;224m)$[mitems[76;253H[K[76;253H132,1[9C42%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Ha [93m<-[m itempars[38;5;224m[,[m[95m1[m[38;5;224m:([m[1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m3[m[38;5;224m)][m[76;253H[K[76;253H133,1[9C43%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7Hd [93m<-[m itempars[38;5;224m[,[m [1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m2[m[38;5;224m][m[76;253H[K[76;253H134,1[9C44%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htheta [93m<-[m [1m[96mfscores[m[38;5;224m([mfit[38;5;224m)[m[76;253H[K[76;253H135,1[9C44%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H136,1[9C45%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7H[96m# calculate true and predicted probablities[m[76;253H[K[76;253H137,1[9C46%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hp.pred [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)[m[76;253H[K[76;253H138,1[9C46%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7Hp.true [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma_true[38;5;224m,[m [1m[96mas.vector[m[38;5;224m([md_true[38;5;224m),[m theta_true[38;5;224m)[m[76;253H[K[76;253H139,1[9C47%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H140,1[9C48%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# [m[30m[103mif[m[96m there are rows without responses, they have no theta estimates, so we have to fill in some empty rows to make the dimensions correct[m[76;253H[K[76;253H141,1[9C48%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H142,1[9C49%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Hp.pred [93m=[m [1m[96minsertEmptyRows[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m))[m[76;253H[K[76;253H143,1[9C50%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H144,1[9C51%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H145,1[9C51%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Hp.pred [93m=[m [1m[96minsertEmptyCols[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m))[m[76;253H[K[76;253H146,1[9C52%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H147,1[9C53%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# calculate true and predicted responses[m[76;253H[K[76;253H148,1[9C53%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hresp.pred [93m=[m [1m[96mround[m[38;5;224m([mp.pred[38;5;224m,[m [95m0[m[38;5;224m)[m[76;253H[K[76;253H149,1[9C54%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hresp.true [93m=[m [1m[96mround[m[38;5;224m([mp.true[38;5;224m,[m [95m0[m[38;5;224m)[m[76;253H[K[76;253H150,1[9C55%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[76;253H[K[76;253H151,1[9C55%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7H[96m# calculate metrics and save them[m[76;253H[K[76;253H152,1[9C56%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7Hrmses [93m<-[m [1m[96mc[m[38;5;224m([mrmses[38;5;224m,[m [1m[96mRMSE[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[76;253H[K[76;253H153,1[9C57%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hbiases [93m<-[m [1m[96mc[m[38;5;224m([mbiases[38;5;224m,[m [1m[96mbias[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[76;253H[K[76;253H154,1[9C57%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htop10 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mtrue[93m=[mresp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m pred[93m=[mresp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m10[m[38;5;224m)[m[76;253H[K[76;253H155,1[9C58%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7Htop20 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mtrue[93m=[mresp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m pred[93m=[mresp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m20[m[38;5;224m)[m[76;253H[K[76;253H156,1[9C59%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hacc10 [93m<-[m [1m[96mc[m[38;5;224m([macc10[38;5;224m,[m top10[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H157,1[9C60%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hf110 [93m<-[m [1m[96mc[m[38;5;224m([mf110[38;5;224m,[m top10[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H158,1[9C60%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7Hacc20 [93m<-[m [1m[96mc[m[38;5;224m([macc20[38;5;224m,[m top20[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H159,1[9C61%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hf120 [93m<-[m [1m[96mc[m[38;5;224m([mf120[38;5;224m,[m top20[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H160,1[9C62%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[76;253H[K[76;253H161,1[9C62%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;5H[38;5;224m}[m[76;253H[K[76;253H162,1[9C63%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3H[38;5;224m}[m[76;253H[K[76;253H163,1[9C64%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([m[1m[96mmean[m[38;5;224m([mrmses[38;5;224m),[m [1m[96mmean[m[38;5;224m([mbiases[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc10[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc20[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf110[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf120[38;5;224m)))[m[76;253H[K[76;253H164,1[9C64%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m[76;253H[K[76;253H165,1[9C65%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H166,1[9C66%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;1H[96m# read appropriate data file[m[76;253H[K[76;253H167,1[9C66%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;1Hdata1 [93m=[m [1m[96mread.csv[m[38;5;224m([m[1m[96mpaste[m[38;5;224m([m[95m'~/rgmirt/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[76;253H[K[76;253H168,1[9C67%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H169,1[9C68%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# load true parameter values[m[76;253H[K[76;253H170,1[9C68%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[1m[96mload[m[38;5;224m([mfile[93m=[m[1m[96mpaste[m[38;5;224m([m[95m'~/rgmirt/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m))[m[76;253H[K[76;253H171,0-1[7C69%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H172,1[9C70%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;1H[96m# initialize paramters[m[76;253H[K[76;253H173,1[9C71%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[1m[96mprint[m[38;5;224m([m[95m'initializing pars...'[m[38;5;224m)[m[76;253H[K[76;253H174,0-1[7C71%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1Hpars [93m<-[m [1m[96mmirt[m[38;5;224m([mdata1[38;5;224m,[mndim[38;5;224m,[m pars [93m=[m [95m'values'[m[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m())[m[76;253H[K[76;253H175,1[9C72%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H176,1[9C73%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# set some loadings to zero[m[76;253H[K[76;253H177,1[9C73%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[30m[103mif[m[38;5;224m([mndim[93m==[m[95m1[m[38;5;224m){[m[76;253H[K[76;253H178,1[9C74%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H179,1[9C75%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H180,1[9C75%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [69;1H[76;254H79[69;1H[?25h[?25l[76;243H~@k[69;1H[76;243H   [68;1H[76;255H8[68;1H[?25h[?25l[76;243H~@k[68;1H[76;243H   [67;1H[76;255H7[67;1H[?25h[?25l[76;255H6[66;1H[?25h[?25l[76;255H5[65;1H[?25h[?25l[76;243H~@k[65;1H[76;243H   [64;1H[76;255H4,0-1[64;1H[?25h[?25l[76;255H3,1  [63;1H[?25h[?25l[76;255H2[62;1H[?25h[?25l[76;243H~@k[62;1H[76;243H   [61;1H[76;255H1,0-1[61;1H[?25h[?25l[76;255H0,1  [60;1H[?25h[?25l[76;254H69[59;1H[?25h[?25l[76;255H8[58;1H[?25h[?25l[76;243H~@k[58;1H[76;243H   [57;1H[76;255H7[57;1H[?25h[?25l[76;255H6[56;1H[?25h[?25l[76;255H5[55;1H[?25h[?25l[76;255H4[54;1H[?25h[?25l[76;255H3[53;1H[?25h[?25l[76;243H~@k[53;1H[76;243H   [52;1H[76;255H2[52;1H[?25h[?25l[76;243H~@k[52;1H[76;243H   [51;1H[76;255H1[51;1H[?25h[?25l[76;255H0[50;1H[?25h[?25l[76;254H59[49;1H[?25h[?25l[76;255H8[48;1H[?25h[?25l[76;243H~@k[48;1H[76;243H   [47;1H[76;255H7[47;1H[?25h[?25l[76;255H6[46;1H[?25h[?25l[76;255H5[45;1H[?25h[?25l[76;255H4[44;1H[?25h[?25l[76;243H~@k[44;1H[76;243H   [43;1H[76;255H3[43;1H[?25h[?25l[76;243H~@k[43;1H[76;243H   [42;1H[76;255H2[42;1H[?25h[?25l[76;255H1[41;1H[?25h[?25l[76;255H0[40;1H[?25h[?25l[76;243H~@k[40;1H[76;243H   [39;1H[76;254H49[39;1H[?25h[?25l[76;255H8[38;1H[?25h[?25l[76;255H7[37;1H[?25h[?25l[76;243H~@k[37;1H[76;243H   [36;1H[76;255H6[36;1H[?25h[?25l[76;243H~@k[36;1H[76;243H   [35;1H[76;255H5[35;1H[?25h[?25l[76;243H~@k[35;1H[76;243H   [34;1H[76;255H4[34;1H[?25h[?25l[76;243H~@k[34;1H[76;243H   [33;1H[76;255H3[33;1H[?25h[?25l[76;255H4[34;1H[?25h[?25l[76;255H5[35;1H[?25h[?25l[76;255H6[36;1H[?25h[?25l[76;243H~@k[36;1H[76;243H   [37;1H[76;255H7[37;1H[?25h[?25l[76;255H6[36;1H[?25h[?25l[76;255H5[35;1H[?25h[?25l[76;255H4[34;1H[?25h[?25l[76;255H3[33;1H[?25h[?25l[76;243H~@k[33;1H[76;243H   [32;1H[76;255H2[32;1H[?25h[?25l[76;255H1[31;1H[?25h[?25l[76;255H0[30;1H[?25h[?25l[76;254H39[29;1H[?25h[?25l[76;243H~@k[29;1H[76;243H   [28;1H[76;255H8[28;1H[?25h[?25l[76;255H7[27;1H[?25h[?25l[76;255H6[26;1H[?25h[?25l[76;255H5[25;1H[?25h[?25l[76;243H~@k[25;1H[76;243H   [24;1H[76;255H4[24;1H[?25h[?25l[76;255H3[23;1H[?25h[?25l[76;243H~@k[23;1H[76;243H   [22;1H[76;255H2[22;1H[?25h[?25l[76;255H1[21;1H[?25h[?25l[76;255H0[20;1H[?25h[?25l[76;254H29[19;1H[?25h[?25l[76;243H~@k[19;1H[76;243H   [18;1H[76;255H8[18;1H[?25h[?25l[76;255H7[17;1H[?25h[?25l[76;243H~@k[17;1H[76;243H   [16;1H[76;255H6[16;1H[?25h[?25l[76;255H5[15;1H[?25h[?25l[76;255H4[14;1H[?25h[?25l[76;255H3[13;1H[?25h[?25l[76;255H2[12;1H[?25h[?25l[76;255H1[11;1H[?25h[?25l[76;243H~@k[11;1H[76;243H   [10;1H[76;255H0[10;1H[?25h[?25l[76;243H~@k[10;1H[76;243H   [9;1H[76;254H19[9;1H[?25h[?25l[76;255H8[8;1H[?25h[?25l[76;255H7[7;1H[?25h[?25l[76;243H~@k[7;1H[76;243H   [6;1H[76;255H6[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[93mfor[m [38;5;224m([mj [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H115,1[9C75%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[38;5;224m{[m[76;253H[K[76;253H114,1[9C74%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H113,1[9C73%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;3H[96m# loop though cross validation folds[m[76;253H[K[76;253H112,1[9C73%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H111,1[9C72%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hf1s [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H110,1[9C71%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;3Haccuracies [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H109,1[9C71%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hbiases [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H108,1[9C70%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hrmses [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H107,1[9C69%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H106,1[9C68%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;3Hfolds.items [93m<-[m [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mncol[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m2[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[76;253H[K[76;253H105,1[9C68%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hfolds.persons [93m<-[m  [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mnrow[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m1[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[76;253H[K[76;253H104,1[9C67%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[96m# calculate to which fold each person and item belongs[m[76;253H[K[76;253H103,1[9C66%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H102,1[9C66%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m{[m[76;253H[K[76;253H101,0-1[7C65%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hpars[38;5;224m)[m[10C[96m# parameters object from mirt[m[76;253H[K[76;253H100,1[9C64%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Htheta_true[38;5;224m,[m    [96m# true parameter values[m[76;253H[K[76;253H99,1[10C64%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;21Hd_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H98,1[10C63%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;21Ha_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H97,1[10C62%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;21Hlambda[38;5;224m,[m[8C[96m# l1 and l2 penalty[m[76;253H[K[76;253H96,1[10C62%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hk [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m    [96m# number of folds for 2d cross validation[m[76;253H[K[76;253H95,1[10C61%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;21Hrandompars[38;5;224m,[m    [96m# mirt argument for whether to use random paramters values[m[76;253H[K[76;253H94,1[10C60%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hmethod[38;5;224m,[m[8C[96m# method of esitmation, e.g. EM[m[76;253H[K[76;253H93,1[10C60%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;21Hmodel[38;5;224m,[m[9C[96m# model to be passed to mirt, can be number of dimensions[m[76;253H[K[76;253H92,1[10C59%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hcv.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([mdata[38;5;224m,[m[10C[96m# matrix of responses[m[76;253H[K[76;253H91,1[10C58%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# Function that fits rgmirt model using cross validation and returns the average RMSE and average bias[m[76;253H[K[76;253H90,1[10C57%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H89,1[10C57%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H88,1[10C56%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[m[76;253H[K[76;253H87,1[10C55%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([mavg_topn_accuracy[38;5;224m,[m avg_topn_f1_score[38;5;224m))[m[76;253H[K[76;253H86,1[10C55%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H85,1[10C54%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Havg_topn_f1_score [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_f1_scores[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H84,0-1[8C53%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Havg_topn_accuracy [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_accuracies[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H83,0-1[8C53%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[96m# Calculate the average top-n accuracy and top-n F1 score across all users[m[76;253H[K[76;253H82,1[10C52%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H81,1[10C51%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;3H[38;5;224m}[m[76;253H[K[76;253H80,1[10C51%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [7;1H[76;254H1[7;1H[?25h[?25l[76;243H~@k[7;1H[76;243H   [8;1H[76;254H2[8;1H[?25h[?25l[76;243H~@k[8;1H[76;243H   [9;1H[76;254H3,0-1[9;1H[?25h[?25l[76;243H~@k[9;1H[76;243H   [10;1H[76;254H4[10;1H[?25h[?25l[76;243H~@k[10;1H[76;243H   [11;1H[76;254H5,1  [11;1H[?25h[?25l[76;243H~@k[11;1H[76;243H   [12;1H[76;254H6[12;1H[?25h[?25l[76;243H~@k[12;1H[76;243H   [13;1H[76;254H7[13;1H[?25h[?25l[76;243H~@k[13;1H[76;243H   [14;1H[76;254H8[14;1H[?25h[?25l[76;254H9[15;1H[?25h[?25l[76;243H~@k[15;1H[76;243H   [16;1H[76;253H90[16;1H[?25h[?25l[76;243H~@k[16;1H[76;243H   [17;1H[76;254H1[17;1H[?25h[?25l[76;254H2[18;1H[?25h[?25l[76;254H3[19;1H[?25h[?25l[76;243H~@k[19;1H[76;243H   [20;1H[76;254H4[20;1H[?25h[?25l[76;254H5[21;1H[?25h[?25l[76;243H~@k[21;1H[76;243H   [22;1H[76;254H6[22;1H[?25h[?25l[76;254H7[23;1H[?25h[?25l[76;243H~@k[23;1H[76;243H   [24;1H[76;254H8[24;1H[?25h[?25l[76;243H~@k[24;1H[76;243H   [25;1H[76;254H9[25;1H[?25h[?25l[76;243H~@k[25;1H[76;243H   [26;1H[76;253H100,1[26;1H[?25h[?25l[76;255H1,0-1[27;1H[?25h[?25l[76;255H2,1  [28;1H[?25h[?25l[76;243H~@k[28;1H[76;243H   [29;1H[76;255H3[29;1H[?25h[?25l[76;255H4[30;1H[?25h[?25l[76;255H5[31;1H[?25h[?25l[76;255H6[32;1H[?25h[?25l[76;243H~@k[32;1H[76;243H   [33;1H[76;255H7[33;1H[?25h[?25l[76;255H8[34;1H[?25h[?25l[76;255H9[35;1H[?25h[?25l[76;254H10[36;1H[?25h[?25l[76;255H1[37;1H[?25h[?25l[76;243H~@k[37;1H[76;243H   [38;1H[76;255H2[38;1H[?25h[?25l[76;243H~@k[38;1H[76;243H   [37;1H[76;255H1[37;1H[?25h[?25l[76;243H~@k[37;1H[76;243H   [36;1H[76;255H0[36;1H[?25h[?25l[76;254H09[35;1H[?25h[?25l[76;243H~@k[35;1H[76;243H   [34;1H[76;255H8[34;1H[?25h[?25l[76;243H~@k[34;1H[76;243H   [33;1H[76;255H7[33;1H[?25h[?25l[76;243H~@k[33;1H[76;243H   [32;1H[76;255H6[32;1H[?25h[?25l[76;243H~@k[32;1H[76;243H   [31;1H[76;255H5[31;1H[?25h[?25l[76;243H~@k[31;1H[76;243H   [31;2H[76;257H2[31;2H[?25h[?25l[76;243H~@k[31;2H[76;243H   [31;3H[76;257H3[31;3H[?25h[?25l[76;243H~@k[31;3H[76;243H   [31;4H[76;257H4[31;4H[?25h[?25l[76;243H~@k[31;4H[76;243H   [31;5H[76;257H5[31;5H[?25h[?25l[76;243H~@k[31;5H[76;243H   [31;6H[76;257H6[31;6H[?25h[?25l[76;243H~@k[31;6H[76;243H   [31;7H[76;257H7[31;7H[?25h[?25l[76;243H~@k[31;7H[76;243H   [31;8H[76;257H8[31;8H[?25h[?25l[76;243H~@k[31;8H[76;243H   [31;9H[76;257H9[31;9H[?25h[?25l[76;243H~@k[31;9H[76;243H   [31;10H[38;5;224m[46m()[m[76;257H10[31;10H[?25h[?25l[76;243H~@k[31;10H[76;243H   [31;11H[76;258H1[31;11H[?25h[?25l[76;243H~@k[31;11H[76;243H   [31;11H[?25h[?25l[76;243H~@k[31;11H[76;243H   [31;11H[?25h[?25l[76;243H~@k[31;11H[76;243H   [31;11H[?25h[?25l[76;243H~@k[31;11H[76;243H   [31;11H[?25h[?25l[76;243Hi[31;11H[76;243H [31;11H[76;1H[1m-- INSERT --[m[76;253H[K[76;253H105,11[8C51%[31;11H[?25h[?25l[76;258H2[31;12H[?25h[?25l[32;75r[32;1H[L[1;76r[76;253H[K[76;253H106,3[9C50%[31;10H[38;5;224m()
[m  [?25h[?25la[76;257H4[32;4H[?25h[?25lc[76;257H5[32;5H[?25h[?25lc[76;257H6[32;6H[?25h[?25l1[76;257H7[32;7H[?25h[?25l0[76;257H8[32;8H[?25h[?25l[76;257H9[32;9H[?25h[?25l[93m=[m[76;257H10[32;10H[?25h[?25l[76;258H1[32;11H[?25h[?25la[76;258H2[32;12H[?25h[?25lc[76;258H3[32;13H[?25h[?25lc[76;258H4[32;14H[?25h[?25l2[76;258H5[32;15H[?25h[?25l0[76;258H6[32;16H[?25h[?25l[76;258H7[32;17H[?25h[?25l[93m=[m[76;258H8[32;18H[?25h[?25l[76;258H9[32;19H[?25h[?25lf[76;257H20[32;20H[?25h[?25l1[76;258H1[32;21H[?25h[?25l1[76;258H2[32;22H[?25h[?25l0[76;258H3[32;23H[?25h[?25l[76;258H4[32;24H[?25h[?25l[93m=[m[76;258H5[32;25H[?25h[?25l[76;258H6[32;26H[?25h[?25lf[76;258H7[32;27H[?25h[?25l1[76;258H8[32;28H[?25h[?25l2[76;258H9[32;29H[?25h[?25l0[76;257H30[32;30H[?25h[?25l[76;258H1[32;31H[?25h[?25l[93m=[m[76;258H2[32;32H[?25h[?25l[76;258H3[32;33H[?25h[?25lc[76;258H4[32;34H[?25h[?25l[1m[96mc[m[38;5;224m([m[76;258H5[32;35H[?25h[?25l[38;5;224m)[m[38;5;224m[46m()[m[76;258H6[32;36H[?25h[76;1H[K[32;35H[?25l[76;243H^[[32;35H[76;243H  [32;36H[76;253H106,35[8C50%[32;35H[?25h[?25l[76;243H:[32;35H[76;243H[K[76;1H:[?2004h[?25hw[?25l[?25h[?25l [?25h[?25l[?25h[?25l"fitscript.R" 221L, 8155C written[32;35H[76;253H106,35[8C50%[76;253H[K[76;253H106,35[8C50%[32;35H[?25h[?25l[76;243H:[32;35H[76;1H[K[76;1H:[?2004h[?25hq[?25l[?25h[?25l [?25h[?25l[?25h[?25l[?2004l[76;1H[K[76;1H[?2004l[?1l>[?25h[?1049l[23;0;0t]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ vim fitscript.R Rscript fitscript.R 0 0 3 1 .85
Loading required package: stats4
Loading required package: lattice
[1] "initializing pars..."
[1] "fitting model..."
Iteration: 1, Log-Lik: -1151562.107, Max-Change: 23.54328Iteration: 2, Log-Lik: -283412.264, Max-Change: 8.16770Iteration: 3, Log-Lik: -251464.713, Max-Change: 5.76194Iteration: 4, Log-Lik: -243356.778, Max-Change: 7.71550Iteration: 5, Log-Lik: -238816.786, Max-Change: 6.66958Iteration: 6, Log-Lik: -235741.028, Max-Change: 3.02796Iteration: 7, Log-Lik: -234495.538, Max-Change: 3.85519Iteration: 8, Log-Lik: -233629.539, Max-Change: 2.91821Iteration: 9, Log-Lik: -233036.676, Max-Change: 3.26450Iteration: 10, Log-Lik: -232571.295, Max-Change: 1.20770
EM cycles terminated after 10 iterations.
Iteration: 1, Log-Lik: -1153891.849, Max-Change: 25.04452Iteration: 2, Log-Lik: -284392.489, Max-Change: 7.09703Iteration: 3, Log-Lik: -252667.681, Max-Change: 4.53886Iteration: 4, Log-Lik: -244633.384, Max-Change: 6.93663Iteration: 5, Log-Lik: -240956.355, Max-Change: 8.94854Iteration: 6, Log-Lik: -238015.093, Max-Change: 3.09802Iteration: 7, Log-Lik: -236568.398, Max-Change: 2.91318Iteration: 8, Log-Lik: -235704.300, Max-Change: 1.93976Iteration: 9, Log-Lik: -235152.897, Max-Change: 3.02155Iteration: 10, Log-Lik: -234642.307, Max-Change: 2.62664
EM cycles terminated after 10 iterations.
Iteration: 1, Log-Lik: -1156791.088, Max-Change: 25.56425Iteration: 2, Log-Lik: -285939.829, Max-Change: 8.90565Iteration: 3, Log-Lik: -253924.557, Max-Change: 4.97035Iteration: 4, Log-Lik: -245411.992, Max-Change: 4.67756Iteration: 5, Log-Lik: -241618.586, Max-Change: 11.13521Iteration: 6, Log-Lik: -237791.812, Max-Change: 4.99093Iteration: 7, Log-Lik: -235844.327, Max-Change: 1.94598Iteration: 8, Log-Lik: -234949.350, Max-Change: 2.04139Iteration: 9, Log-Lik: -234308.918, Max-Change: 2.17661Iteration: 10, Log-Lik: -233825.586, Max-Change: 3.51800
EM cycles terminated after 10 iterations.
Iteration: 1, Log-Lik: -1155972.745, Max-Change: 26.02839Iteration: 2, Log-Lik: -288650.228, Max-Change: 8.48431Iteration: 3, Log-Lik: -254336.992, Max-Change: 4.05930Iteration: 4, Log-Lik: -246248.363, Max-Change: 4.52624Iteration: 5, Log-Lik: -242469.534, Max-Change: 10.82829Iteration: 6, Log-Lik: -239208.549, Max-Change: 3.02150Iteration: 7, Log-Lik: -237442.065, Max-Change: 3.69017Iteration: 8, Log-Lik: -236663.766, Max-Change: 2.20770Iteration: 9, Log-Lik: -236140.500, Max-Change: 1.64378Iteration: 10, Log-Lik: -235730.510, Max-Change: 3.11639
EM cycles terminated after 10 iterations.
Iteration: 1, Log-Lik: -1158016.823, Max-Change: 24.78922Iteration: 2, Log-Lik: -285834.557, Max-Change: 7.31982Iteration: 3, Log-Lik: -253387.671, Max-Change: 5.47456Iteration: 4, Log-Lik: -244525.185, Max-Change: 5.26158Iteration: 5, Log-Lik: -239743.514, Max-Change: 8.50784Iteration: 6, Log-Lik: -236633.923, Max-Change: 3.79767Iteration: 7, Log-Lik: -235131.606, Max-Change: 3.21817Iteration: 8, Log-Lik: -234155.066, Max-Change: 3.22263Iteration: 9, Log-Lik: -233493.562, Max-Change: 2.77303Iteration: 10, Log-Lik: -232960.018, Max-Change: 0.98805
EM cycles terminated after 10 iterations.
Iteration: 1, Log-Lik: -1158695.277, Max-Change: 25.40901Iteration: 2, Log-Lik: -288126.412, Max-Change: 7.40579Iteration: 3, Log-Lik: -253733.529, Max-Change: 4.25926Iteration: 4, Log-Lik: -245756.748, Max-Change: 3.23991Iteration: 5, Log-Lik: -242280.076, Max-Change: 8.79265Iteration: 6, Log-Lik: -239503.276, Max-Change: 5.49731Iteration: 7, Log-Lik: -237676.743, Max-Change: 2.65510Iteration: 8, Log-Lik: -236622.527, Max-Change: 3.82094Iteration: 9, Log-Lik: -235912.003, Max-Change: 3.16119Iteration: 10, Log-Lik: -235369.928, Max-Change: 0.90765
EM cycles terminated after 10 iterations.
Time difference of 13.28767 mins
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ cd ..
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT[kveldkamp49@int5 EN-MIRT]$ cd ..
]0;kveldkamp49@int5:~/rgmirt[kveldkamp49@int5 rgmirt]$ ls [K
[0m[38;5;33mdata[0m  [38;5;33mEN-MIRT[0m  [38;5;33mparameters[0m  [38;5;33mresults[0m
]0;kveldkamp49@int5:~/rgmirt[kveldkamp49@int5 rgmirt]$ cd results/
]0;kveldkamp49@int5:~/rgmirt/results[kveldkamp49@int5 results]$ ls [K
0_0_3_1_0.85.txt
]0;kveldkamp49@int5:~/rgmirt/results[kveldkamp49@int5 results]$ cat a[K0_0_3_1_0.85.txt 
0.121554059016782
0.0186106629559692
0.747500201429861
0.731027606359916
0.869903118373118
0.872818141901976
]0;kveldkamp49@int5:~/rgmirt/results[kveldkamp49@int5 results]$ rm * [K
]0;kveldkamp49@int5:~/rgmirt/results[kveldkamp49@int5 results]$ cd ..
]0;kveldkamp49@int5:~/rgmirt[kveldkamp49@int5 rgmirt]$ ls [K
[0m[38;5;33mdata[0m  [38;5;33mEN-MIRT[0m  [38;5;33mparameters[0m  [38;5;33mresults[0m
]0;kveldkamp49@int5:~/rgmirt[kveldkamp49@int5 rgmirt]$ ls [K
[0m[38;5;33mdata[0m  [38;5;33mEN-MIRT[0m  [38;5;33mparameters[0m  [38;5;33mresults[0m
]0;kveldkamp49@int5:~/rgmirt[kveldkamp49@int5 rgmirt]$ cd EN-MIRT/
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT[kveldkamp49@int5 EN-MIRT]$ git add .
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT[kveldkamp49@int5 EN-MIRT]$ git commit -m 'fixed minor g[Kbugs [K'
[main 0dc1a6f] fixed minor bugs
 Committer: Karel Veldkamp <kveldkamp49@int5.local.snellius.surf.nl>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 2882 insertions(+), 6 deletions(-)
 create mode 100644 typescript
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT[kveldkamp49@int5 EN-MIRT]$ git push [K
Username for 'https://github.com': KarelVeldkamp  49  
Password for 'https://KarelVeldkamp49@github.com': 
Enumerating objects: 8, done.
Counting objects:  12% (1/8)Counting objects:  25% (2/8)Counting objects:  37% (3/8)Counting objects:  50% (4/8)Counting objects:  62% (5/8)Counting objects:  75% (6/8)Counting objects:  87% (7/8)Counting objects: 100% (8/8)Counting objects: 100% (8/8), done.
Delta compression using up to 96 threads
Compressing objects:  20% (1/5)Compressing objects:  40% (2/5)Compressing objects:  60% (3/5)Compressing objects:  80% (4/5)Compressing objects: 100% (5/5)Compressing objects: 100% (5/5), done.
Writing objects:  20% (1/5)Writing objects:  40% (2/5)Writing objects:  60% (3/5)Writing objects:  80% (4/5)Writing objects: 100% (5/5)Writing objects: 100% (5/5), 156.83 KiB | 5.23 MiB/s, done.
Total 5 (delta 2), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas:   0% (0/2)[Kremote: Resolving deltas:  50% (1/2)[Kremote: Resolving deltas: 100% (2/2)[Kremote: Resolving deltas: 100% (2/2), completed with 2 local objects.[K
To https://github.com/KarelVeldkamp/EN-MIRT
   ad58ffd..0dc1a6f  main -> main
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT[kveldkamp49@int5 EN-MIRT]$ git pull [K
remote: Enumerating objects: 7, done.[K
remote: Counting objects:  14% (1/7)[Kremote: Counting objects:  28% (2/7)[Kremote: Counting objects:  42% (3/7)[Kremote: Counting objects:  57% (4/7)[Kremote: Counting objects:  71% (5/7)[Kremote: Counting objects:  85% (6/7)[Kremote: Counting objects: 100% (7/7)[Kremote: Counting objects: 100% (7/7), done.[K
remote: Compressing objects:  50% (1/2)[Kremote: Compressing objects: 100% (2/2)[Kremote: Compressing objects: 100% (2/2), done.[K
remote: Total 4 (delta 2), reused 4 (delta 2), pack-reused 0[K
Unpacking objects:  25% (1/4)Unpacking objects:  50% (2/4)Unpacking objects:  75% (3/4)Unpacking objects: 100% (4/4)Unpacking objects: 100% (4/4), 937 bytes | 66.00 KiB/s, done.
From https://github.com/KarelVeldkamp/EN-MIRT
   0dc1a6f..bd53f39  main       -> origin/main
Updating 0dc1a6f..bd53f39
Fast-forward
 scripts/fitscript.R | 62 [32m++++++++++++++++++++++++++++++++++++++++++++[m[31m------------------[m
 1 file changed, 44 insertions(+), 18 deletions(-)
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT[kveldkamp49@int5 EN-MIRT]$ cd scripts/
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ cd scripts/[3Pgit pullshcommit -m 'fixed minor bugs'add .[Kcd EN-MIRT/ls[Kcd ..[1Prm *cat 0_0_3_1_0.85.txt ls[Kcd results/ls[Kcd ..Rscript fitscript.R 0 0 3 1 .85[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[15Pvim fitscript.R Rscript fitscript.R 0 0 3 1 .85[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[15Pvim fitscript.R Rscript fitscript.R 0 0 3 1 .85
Loading required package: stats4
Loading required package: lattice
[1] "initializing pars..."
[1] "fitting model..."
Iteration: 1, Log-Lik: -1151562.107, Max-Change: 23.54328Iteration: 2, Log-Lik: -283412.264, Max-Change: 8.16770Iteration: 3, Log-Lik: -251464.713, Max-Change: 5.76194Iteration: 4, Log-Lik: -243356.778, Max-Change: 7.71550Iteration: 5, Log-Lik: -238816.786, Max-Change: 6.66958Iteration: 6, Log-Lik: -235741.028, Max-Change: 3.02796Iteration: 7, Log-Lik: -234495.538, Max-Change: 3.85519Iteration: 8, Log-Lik: -233629.539, Max-Change: 2.91821Iteration: 9, Log-Lik: -233036.676, Max-Change: 3.26450Iteration: 10, Log-Lik: -232571.295, Max-Change: 1.20770
EM cycles terminated after 10 iterations.
Error in acc_f1_at_n(true = p.true[per.ind, item.ind], pred = p.pred[per.ind,  : 
  unused arguments (true = p.true[per.ind, item.ind], pred = p.pred[per.ind, item.ind])
Calls: cv.mirt
Execution halted
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ vim fitscript.R 
[?2004h[?1049h[22;0;0t[?1h=[?2004h[1;76r[?12h[?12l[27m[23m[29m[m[H[2J[?25l[76;1H"fitscript.R" 247L, 8749C[2;1Hâ–½[6n[2;1H  [1;1H[>c]10;?]11;?[1;1H[35m}[m

[34m# bias [m
bias [38;5;130m<-[m [32mfunction[m[35m([mpar[35m,[m est[35m)
{[m
  [36mmean[m[35m([mest[38;5;130m-[mpar[35m)
}[m

[34m# calcualte DCG based on relevance grades (ordered)[m
DCG [38;5;130m=[m [32mfunction[m[35m([mr[35m){[m
  k [38;5;130m=[m [31m1[m[35m:[m[36mlength[m[35m([mr[35m)[m

  D [38;5;130m=[m [36mlog[m[35m([mk[38;5;130m+[m[31m1[m[35m,[m base [38;5;130m=[m [31m2[m[35m)[m
  DCG [38;5;130m=[m [36msum[m[35m([mr[38;5;130m/[mD[35m)[m
  [38;5;130mreturn[m[35m([mDCG[35m)
}[m

[34m# NDCG[m
NDCG [38;5;130m=[m [32mfunction[m[35m([mr[35m){[m
  NDCG [38;5;130m=[m [36mDCG[m[35m([mr[35m)[m[38;5;130m/[m[36mDCG[m[35m([m[36msort[m[35m([mr[35m,[m decreasing[38;5;130m=[m[31mT[m[35m))[m
  [38;5;130mreturn[m[35m([mNDCG[35m)
}[m

acc_f1_at_n [38;5;130m<-[m [32mfunction[m[35m([mp_true[35m,[m p_pred[35m,[m n[35m)[m [35m{[m
  [34m# binarise probabilities to 0/1[m
  true_resp_matrix [38;5;130m<-[m [36mround[m[35m([mp_true[35m,[m [31m0[m[35m)[m
  pred_resp_matrix [38;5;130m<-[m [36mround[m[35m([mp_pred[35m,[m [31m0[m[35m)[m

  num_users [38;5;130m<-[m [36mdim[m[35m([mtrue[35m)[[m[31m1[m[35m][m
  num_movies [38;5;130m<-[m [36mdim[m[35m([mtrue[35m)[[m[31m2[m[35m][m

  topn_accuracies [38;5;130m<-[m [32mvector[m[35m([m[31m"numeric"[m[35m,[m num_users[35m)[m
  topn_f1_scores [38;5;130m<-[m [32mvector[m[35m([m[31m"numeric"[m[35m,[m num_users[35m)[m
  ndcgs [38;5;130m<-[m [32mvector[m[35m([m[31m"numeric"[m[35m,[m num_users[35m)[m

  [34m# for each user[m
  [38;5;130mfor[m [35m([mi [38;5;130min[m [31m1[m[35m:[mnum_users[35m)[m [35m{[m
    true_response [38;5;130m<-[m true_resp_matrix[35m[[mi[35m,[m [35m][m
    pred_response [38;5;130m<-[m pred_resp_matrix[35m[[mi[35m,[m [35m][m[41;5Hpred_relevance [38;5;130m<-[m p_pred[35m[[mi[35m,[m [35m][m[43;5H[34m# Get the indices of the top-n predicted relevance[m
    indices [38;5;130m<-[m [36morder[m[35m([m[38;5;130m-[mpred_relevance[35m)[m
    topn_indices [38;5;130m<-[m indices[35m[[m[31m1[m[35m:[mn[35m][m[47;5H[34m# Calculate the top-n accuracy for the current user[m
    topn_accuracy [38;5;130m<-[m [36msum[m[35m([mtrue_response[35m[[mtopn_indices[35m])[m [38;5;130m/[m n[50;5H[34m# Calculate the top-n F1 score for the current user[m
    true_positives [38;5;130m<-[m [36msum[m[35m([mtrue_response[35m[[mtopn_indices[35m][m[38;5;130m*[mpred_response[35m[[mtopn_indices[35m])[m
    predicted_positives [38;5;130m<-[m [36msum[m[35m([mpred_response[35m[[mtopn_indices[35m])[m
    actual_positives [38;5;130m<-[m [36msum[m[35m([mtrue_response[35m[[mtopn_indices[35m])[m[55;5Hprecision [38;5;130m<-[m true_positives [38;5;130m/[m n
    recall [38;5;130m<-[m true_positives [38;5;130m/[m actual_positives[58;5Hf1_score [38;5;130m<-[m [31m2[m [38;5;130m*[m precision [38;5;130m*[m recall [38;5;130m/[m [35m([mprecision [38;5;130m+[m recall[35m)[m[60;5Hordered_true_probabilities [38;5;130m=[m p_true[35m[[mi[35m,[m indices[35m][m
    ndcg [38;5;130m=[m [36mNDCG[m[35m([mordered_true_probabilities[35m)[m[63;5Htopn_accuracies[35m[[mi[35m][m [38;5;130m<-[m topn_accuracy
    topn_f1_scores[35m[[mi[35m][m [38;5;130m<-[m f1_score
    ndcgs[35m[[mi[35m][m [38;5;130m<-[m ndcg
  [35m}[m

  [34m# Calculate the average top-n accuracy and top-n F1 score across all users[m
  avg_topn_accuracy [38;5;130m<-[m [36mmean[m[35m([mtopn_accuracies[35m,[m na.rm [38;5;130m=[m [31mTRUE[m[35m)[m
  avg_topn_f1_score [38;5;130m<-[m [36mmean[m[35m([mtopn_f1_scores[35m,[m na.rm [38;5;130m=[m [31mTRUE[m[35m)[m
  avg_ndcg [38;5;130m<-[m [36mmean[m[35m([mndcgs[35m,[m na.rm [38;5;130m=[m [31mTRUE[m[35m)[m

  [38;5;130mreturn[m[35m([m[36mc[m[35m([mavg_topn_accuracy[35m,[m avg_topn_f1_score[35m,[m avg_ndcg[35m))
}[m[76;253H106,35[8C20%[70;35H[?25h[27m[23m[29m[m[H[2J[?25l[1;1H[38;5;224m}[m

[96m# bias [m
bias [93m<-[m [38;5;121mfunction[m[38;5;224m([mpar[38;5;224m,[m est[38;5;224m)
{[m
  [1m[96mmean[m[38;5;224m([mest[93m-[mpar[38;5;224m)
}[m

[96m# calcualte DCG based on relevance grades (ordered)[m
DCG [93m=[m [38;5;121mfunction[m[38;5;224m([mr[38;5;224m){[m
  k [93m=[m [95m1[m[38;5;224m:[m[1m[96mlength[m[38;5;224m([mr[38;5;224m)[m

  D [93m=[m [1m[96mlog[m[38;5;224m([mk[93m+[m[95m1[m[38;5;224m,[m base [93m=[m [95m2[m[38;5;224m)[m
  DCG [93m=[m [1m[96msum[m[38;5;224m([mr[93m/[mD[38;5;224m)[m
  [93mreturn[m[38;5;224m([mDCG[38;5;224m)
}[m

[96m# NDCG[m
NDCG [93m=[m [38;5;121mfunction[m[38;5;224m([mr[38;5;224m){[m
  NDCG [93m=[m [1m[96mDCG[m[38;5;224m([mr[38;5;224m)[m[93m/[m[1m[96mDCG[m[38;5;224m([m[1m[96msort[m[38;5;224m([mr[38;5;224m,[m decreasing[93m=[m[95mT[m[38;5;224m))[m
  [93mreturn[m[38;5;224m([mNDCG[38;5;224m)
}[m

acc_f1_at_n [93m<-[m [38;5;121mfunction[m[38;5;224m([mp_true[38;5;224m,[m p_pred[38;5;224m,[m n[38;5;224m)[m [38;5;224m{[m
  [96m# binarise probabilities to 0/1[m
  true_resp_matrix [93m<-[m [1m[96mround[m[38;5;224m([mp_true[38;5;224m,[m [95m0[m[38;5;224m)[m
  pred_resp_matrix [93m<-[m [1m[96mround[m[38;5;224m([mp_pred[38;5;224m,[m [95m0[m[38;5;224m)[m

  num_users [93m<-[m [1m[96mdim[m[38;5;224m([mtrue[38;5;224m)[[m[95m1[m[38;5;224m][m
  num_movies [93m<-[m [1m[96mdim[m[38;5;224m([mtrue[38;5;224m)[[m[95m2[m[38;5;224m][m

  topn_accuracies [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m
  topn_f1_scores [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m
  ndcgs [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m

  [96m# for each user[m
  [93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mnum_users[38;5;224m)[m [38;5;224m{[m
    true_response [93m<-[m true_resp_matrix[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m
    pred_response [93m<-[m pred_resp_matrix[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m[41;5Hpred_relevance [93m<-[m p_pred[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m[43;5H[96m# Get the indices of the top-n predicted relevance[m
    indices [93m<-[m [1m[96morder[m[38;5;224m([m[93m-[mpred_relevance[38;5;224m)[m
    topn_indices [93m<-[m indices[38;5;224m[[m[95m1[m[38;5;224m:[mn[38;5;224m][m[47;5H[96m# Calculate the top-n accuracy for the current user[m
    topn_accuracy [93m<-[m [1m[96msum[m[38;5;224m([mtrue_response[38;5;224m[[mtopn_indices[38;5;224m])[m [93m/[m n[50;5H[96m# Calculate the top-n F1 score for the current user[m
    true_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_response[38;5;224m[[mtopn_indices[38;5;224m][m[93m*[mpred_response[38;5;224m[[mtopn_indices[38;5;224m])[m
    predicted_positives [93m<-[m [1m[96msum[m[38;5;224m([mpred_response[38;5;224m[[mtopn_indices[38;5;224m])[m
    actual_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_response[38;5;224m[[mtopn_indices[38;5;224m])[m[55;5Hprecision [93m<-[m true_positives [93m/[m n
    recall [93m<-[m true_positives [93m/[m actual_positives[58;5Hf1_score [93m<-[m [95m2[m [93m*[m precision [93m*[m recall [93m/[m [38;5;224m([mprecision [93m+[m recall[38;5;224m)[m[60;5Hordered_true_probabilities [93m=[m p_true[38;5;224m[[mi[38;5;224m,[m indices[38;5;224m][m
    ndcg [93m=[m [1m[96mNDCG[m[38;5;224m([mordered_true_probabilities[38;5;224m)[m[63;5Htopn_accuracies[38;5;224m[[mi[38;5;224m][m [93m<-[m topn_accuracy
    topn_f1_scores[38;5;224m[[mi[38;5;224m][m [93m<-[m f1_score
    ndcgs[38;5;224m[[mi[38;5;224m][m [93m<-[m ndcg
  [38;5;224m}[m

  [96m# Calculate the average top-n accuracy and top-n F1 score across all users[m
  avg_topn_accuracy [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_accuracies[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m
  avg_topn_f1_score [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_f1_scores[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m
  avg_ndcg [93m<-[m [1m[96mmean[m[38;5;224m([mndcgs[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m

  [93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([mavg_topn_accuracy[38;5;224m,[m avg_topn_f1_score[38;5;224m,[m avg_ndcg[38;5;224m))
}[m[76;253H106,35[8C20%"fitscript.R" 247L, 8749C[70;35H[?25h[?25l[76;243H~@k[70;35H[76;243H   [70;35H[1;75r[75;1H
[1;76r[76;1H[K[76;253H107,35[8C21%[70;35H[?25h[?25l[76;243H~@k[70;35H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;1H[96m# Function that fits rgmirt model using cross validation and returns the average RMSE and average bias[m[76;253H[K[76;253H108,2[9C22%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;35H[1;75r[75;1H
[1;76r[75;1Hcv.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([mdata[38;5;224m,[m[10C[96m# matrix of responses[m[76;253H[K[76;253H109,35[8C22%[70;35H[?25h[?25l[76;243H~@k[70;35H[76;243H   [70;1H[1;75r[75;1H
[1;76r[20;44H[38;5;224m[46m{[70;1H}[m[75;21Hmodel[38;5;224m,[m[9C[96m# model to be passed to mirt, can be number of dimensions[m[76;253H[K[76;253H110,1[9C23%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[19;44H[38;5;224m{[69;1H}[m[75;21Hmethod[38;5;224m,[m[8C[96m# method of esitmation, e.g. EM[m[76;253H[K[76;253H111,0-1[7C23%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;21Hrandompars[38;5;224m,[m    [96m# mirt argument for whether to use random paramters values[m[76;253H[K[76;253H112,0-1[7C24%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;35H[1;75r[75;1H
[1;76r[75;21Hk [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m    [96m# number of folds for 2d cross validation[m[76;253H[K[76;253H113,35[8C25%[70;35H[?25h[?25l[1;75r[75;1H
[1;76r[75;21Hlambda[38;5;224m,[m[8C[96m# l1 and l2 penalty[m[76;253H[K[76;253H114,35[8C25%[70;35H[?25h[?25l[1;75r[75;1H
[1;76r[75;21Ha_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H115,35[8C26%[70;35H[?25h[?25l[1;75r[75;1H
[1;76r[75;21Hd_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H116,35[8C26%[70;35H[?25h[?25l[76;243H~@k[70;35H[76;243H   [70;35H[1;75r[75;1H
[1;76r[75;21Htheta_true[38;5;224m,[m    [96m# true parameter values[m[76;253H[K[76;253H117,35[8C27%[70;35H[?25h[?25l[76;243H~@k[70;35H[76;243H   [70;35H[1;75r[75;1H
[1;76r[75;21Hpars[38;5;224m)[m[10C[96m# parameters object from mirt[m[76;253H[K[76;253H118,35[8C27%[70;35H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[38;5;224m{[m[76;253H[K[76;253H119,35[8C28%[70;35H[?25h[?25l[76;243H~@k[70;35H[76;243H   [70;35H[1;75r[75;1H
[1;76r[76;253H[K[76;253H120,35[8C29%[70;35H[?25h[?25l[1;75r[75;1H
[1;76r[75;3H[96m# calculate to which fold each person and item belongs[m[76;253H[K[76;253H121,35[8C29%[70;35H[?25h[?25l[76;243H~@k[70;35H[76;243H   [70;35H[1;75r[75;1H
[1;76r[75;3Hfolds.persons [93m<-[m  [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mnrow[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m1[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[76;253H[K[76;253H122,35[8C30%[70;35H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hfolds.items [93m<-[m [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mncol[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m2[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[76;253H[K[76;253H123,35[8C30%[70;35H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H124,1[9C31%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hrmses [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H125,2[9C31%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hbiases [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H126,35[8C32%[70;35H[?25h[?25l[1;75r[75;1H
[1;76r[70;35H[38;5;224m[46m([mdata[38;5;224m[46m)[m[75;3Haccuracies [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H127,35[8C33%[70;35H[?25h[?25l[76;243H~@k[70;35H[76;243H   [70;35H[1;75r[75;1H
[1;76r[69;35H[38;5;224m([mdata[38;5;224m)[m[75;3Hf1s [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H128,35[8C33%[70;35H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hacc10 [93m=[m acc20 [93m=[m f110 [93m=[m f120 [93m=[m ndcg [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H129,0-1[7C34%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[70;12H[38;5;224m[46m()[m[76;253H[K[76;253H130,13[8C34%[70;13H[?25h[?25l[1;75r[75;1H
[1;76r[69;12H[38;5;224m()[m[70;13H[38;5;224m[46m()[m[75;3H[96m# loop though cross validation folds[m[76;253H[K[76;253H131,14[8C35%[70;14H[?25h[?25l[1;75r[75;1H
[1;76r[69;13H[38;5;224m()[m[70;17H[38;5;224m[46m()[m[75;3H[93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H132,18[8C36%[70;18H[?25h[?25l[1;75r[75;1H
[1;76r[69;17H[38;5;224m()[m[70;10H[38;5;224m[46m()[m[75;3H[38;5;224m{[m[76;253H[K[76;253H133,11[8C36%[70;11H[?25h[?25l[1;75r[75;1H
[1;76r[69;10H[38;5;224m()[m[75;5H[93mfor[m [38;5;224m([mj [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H134,35[8C37%[70;35H[?25h[?25l[76;243H~@k[70;35H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;5H[38;5;224m{[m[76;253H[K[76;253H135,2[9C37%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# save the persons and items that belong to the hold out test set[m[76;253H[K[76;253H136,35[8C38%[70;35H[?25h[?25l[1;75r[75;1H
[1;76r[70;7H[38;5;224m[46m([11C)[m[75;7Hper.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.persons[93m==[mi[38;5;224m)[m[76;253H[K[76;253H137,19[8C38%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[69;7H[38;5;224m([11C)[m[75;7Hitem.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.items[93m==[mj[38;5;224m)[m[76;253H[K[76;253H138,3[9C39%[70;3H[?25h[?25l[1;75r[75;1H
[1;76r[70;9H[38;5;224m[46m([11C)[m[76;253H[K[76;253H139,21[8C40%[70;21H[?25h[?25l[1;75r[75;1H
[1;76r[69;9H[38;5;224m([11C)[m[75;7H[96m# create train and test folds[m[76;253H[K[76;253H140,5[9C40%[70;5H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htest [93m<-[m data[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m][m[76;253H[K[76;253H141,35[8C41%[70;35H[?25h[?25l[76;243H~@k[70;35H[76;243H   [70;35H[1;75r[75;1H
[1;76r[75;7Htrain [93m<-[m data[76;253H[K[76;253H142,35[8C41%[70;35H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htrain[38;5;224m[[mper.ind[38;5;224m,[mitem.ind[38;5;224m][m [93m<-[m [95mNA[m[76;253H[K[76;253H143,35[8C42%[70;35H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H144,6[9C43%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# [m[30m[103mif[m[96m some rows contain no responses after the leave out set, remove them from the training set, and adjust person indices accordingly[m[76;253H[K[76;253H145,35[8C43%[70;35H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hemptyrows [93m=[m [1m[96mrowSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mncol[m[38;5;224m([mtrain[38;5;224m)[m[76;253H[K[76;253H146,35[8C44%[70;35H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hemptycols [93m=[m [1m[96mcolSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mnrow[m[38;5;224m([mtrain[38;5;224m)[m[76;253H[K[76;253H147,19[8C44%[70;19H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H148,35[8C45%[70;35H[?25h[?25l[76;243H~@k[70;35H[76;243H   [70;6H[1;75r[75;1H
[1;76r[75;9Htrain [93m=[m train[38;5;224m[[m[93m![memptyrows[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H149,6[9C45%[70;6H[?25h[?25l[76;243H~@k[70;6H[76;243H   [70;35H[1;75r[75;1H
[1;76r[75;9Hper.ind [93m=[m per.ind[38;5;224m[[m[93m![mper.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m)][m[76;253H[K[76;253H150,35[8C46%[70;35H[?25h[?25l[76;243H~@k[70;35H[76;243H   [70;35H[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H151,35[8C47%[70;35H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# do the same for columns[m[76;253H[K[76;253H152,35[8C47%[70;35H[?25h[?25l[76;243H~@k[70;35H[76;243H   [70;27H[1;75r[75;1H
[1;76r[70;27H[38;5;224m[46m{[73;7H}[m[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H153,27[8C48%[70;27H[?25h[?25l[1;75r[75;1H
[1;76r[69;27H[38;5;224m{[m[70;22H[38;5;224m[46m[[12C][m[72;7H[38;5;224m}[m[75;9Htrain [93m=[m train[38;5;224m[,[m[93m![memptycols[38;5;224m][m[76;253H[K[76;253H154,35[8C48%[70;35H[?25h[?25l[1;75r[75;1H
[1;76r[69;22H[38;5;224m[[12C][m[75;9Hitem.ind [93m=[m item.ind[38;5;224m[[m[93m![mitem.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m)][m[76;253H[K[76;253H155,35[8C49%[70;35H[?25h[?25l[1;75r[75;1H
[1;76r[67;27H[38;5;224m[46m{[70;7H}[m[75;7H[38;5;224m}[m[76;253H[K[76;253H156,7[9C50%[70;7H[?25h[?25l[76;243H~@k[70;7H[76;243H   [70;31H[1;75r[75;1H
[1;76r[66;27H[38;5;224m{[69;7H}[m[76;253H[K[76;253H157,31[8C50%[70;31H[?25h[?25l[1;75r[75;1H
[1;76r[70;27H[38;5;224m[46m{[73;7H}[m[75;7H[96m# fit model[m[76;253H[K[76;253H158,27[8C51%[70;27H[?25h[?25l[1;75r[75;1H
[1;76r[69;27H[38;5;224m{[m[70;22H[38;5;224m[46m[[11C][m[72;7H[38;5;224m}[m[75;7Hfit [93m<-[m [1m[96mmirt[m[38;5;224m([mtrain[38;5;224m,[m model[38;5;224m,[m [95m'2PL'[m[38;5;224m,[m method[93m=[mmethod[38;5;224m,[m GenRandomPars[93m=[mrandompars[38;5;224m,[m lambda[93m=[mlambda[38;5;224m,[m pars[93m=[mpars[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m([mNCYCLES[93m=[m[95m10[m[38;5;224m))[m[76;253H[K[76;253H159,34[8C51%[70;34H[?25h[?25l[1;75r[75;1H
[1;76r[69;22H[38;5;224m[[11C][m[75;7H[96m# save parameters[m[76;253H[K[76;253H160,35[8C52%[70;35H[?25h[?25l[76;243H~@k[70;35H[76;243H   [70;7H[1;75r[75;1H
[1;76r[67;27H[38;5;224m[46m{[70;7H}[m[75;7Hitempars [93m<-[m [1m[96mcoef[m[38;5;224m([mfit[38;5;224m,[m simplify [93m=[m [95mTRUE[m[38;5;224m)$[mitems[76;253H[K[76;253H161,7[9C52%[70;7H[?25h[?25l[76;243H~@k[70;7H[76;243H   [70;6H[1;75r[75;1H
[1;76r[66;27H[38;5;224m{[69;7H}[m[75;7Ha [93m<-[m itempars[38;5;224m[,[m[95m1[m[38;5;224m:([m[1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m3[m[38;5;224m)][m[76;253H[K[76;253H162,6[9C53%[70;6H[?25h[?25l[76;243H~@k[70;6H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;7Hd [93m<-[m itempars[38;5;224m[,[m [1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m2[m[38;5;224m][m[76;253H[K[76;253H163,17[8C54%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;35H[1;75r[75;1H
[1;76r[75;7Htheta [93m<-[m [1m[96mfscores[m[38;5;224m([mfit[38;5;224m)[m[76;253H[K[76;253H164,35[8C54%[70;35H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H165,23[8C55%[70;23H[?25h[?25l[76;243H~@k[70;23H[76;243H   [70;35H[1;75r[75;1H
[1;76r[75;7H[96m# calculate true and predicted probablities[m[76;253H[K[76;253H166,35[8C55%[70;35H[?25h[?25l[76;243H~@k[70;35H[76;243H   [70;35H[1;75r[75;1H
[1;76r[75;7Hp.pred [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)[m[76;253H[K[76;253H167,35[8C56%[70;35H[?25h[?25l[76;243H~@k[70;35H[76;243H   [70;35H[1;75r[75;1H
[1;76r[75;7Hp.true [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma_true[38;5;224m,[m [1m[96mas.vector[m[38;5;224m([md_true[38;5;224m),[m theta_true[38;5;224m)[m[76;253H[K[76;253H168,35[8C56%[70;35H[?25h[?25l[1;75r[75;1H
[1;76r[70;23H[38;5;224m[46m([mfit[38;5;224m[46m)[m[76;253H[K[76;253H169,27[8C57%[70;27H[?25h[?25l[1;75r[75;1H
[1;76r[69;23H[38;5;224m([mfit[38;5;224m)[m[75;7H[96m# [m[30m[103mif[m[96m there are rows without responses, they have no theta estimates, so we have to fill in some empty rows to make the dimensions correct[m[76;253H[K[76;253H170,6[9C58%[70;6H[?25h[?25l[76;243H~@k[70;6H[76;243H   [70;35H[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H171,35[8C58%[70;35H[?25h[?25l[76;243H~@k[70;35H[76;243H   [70;35H[1;75r[75;1H
[1;76r[75;9Hp.pred [93m=[m [1m[96minsertEmptyRows[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m))[m[76;253H[K[76;253H172,35[8C59%[70;35H[?25h[?25l[76;243H~@k[70;35H[76;243H   [70;35H[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H173,35[8C59%[70;35H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H174,6[9C60%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Hp.pred [93m=[m [1m[96minsertEmptyCols[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m))[m[76;253H[K[76;253H175,35[8C61%[70;35H[?25h[?25l[76;243H~@k[70;35H[76;243H   [70;27H[1;75r[75;1H
[1;76r[70;27H[38;5;224m[46m{[72;7H}[m[75;7H[38;5;224m}[m[76;253H[K[76;253H176,27[8C61%[70;27H[?25h[?25l[1;75r[75;1H
[1;76r[69;27H[38;5;224m{[71;7H}[m[76;253H[K[76;253H177,35[8C62%[70;35H[?25h[?25l[1;75r[75;1H
[1;76r[68;27H[38;5;224m[46m{[70;7H}[m[75;7H[96m# calculate metrics and save them[m[76;253H[K[76;253H178,7[9C62%[70;7H[?25h[?25l[1;75r[75;1H
[1;76r[67;27H[38;5;224m{[69;7H}[m[70;27H[38;5;224m[46m{[72;7H}[m[75;7Hrmses [93m<-[m [1m[96mc[m[38;5;224m([mrmses[38;5;224m,[m [1m[96mRMSE[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[76;253H[K[76;253H179,27[8C63%[70;27H[?25h[?25l[1;75r[75;1H
[1;76r[69;27H[38;5;224m{[71;7H}[m[75;7Hbiases [93m<-[m [1m[96mc[m[38;5;224m([mbiases[38;5;224m,[m [1m[96mbias[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[76;253H[K[76;253H180,35[8C63%[70;35H[?25h[?25l[76;243H~@k[70;35H[76;243H   [70;7H[1;75r[75;1H
[1;76r[68;27H[38;5;224m[46m{[70;7H}[m[75;7Htop10 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mtrue[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m pred[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m10[m[38;5;224m)[m[76;253H[K[76;253H181,7[9C64%[70;7H[?25h[?25l[1;75r[75;1H
[1;76r[67;27H[38;5;224m{[69;7H}[m[75;7Htop20 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mtrue[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m pred[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m20[m[38;5;224m)[m[76;253H[K[76;253H182,1[9C65%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hacc10 [93m<-[m [1m[96mc[m[38;5;224m([macc10[38;5;224m,[m top10[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H183,35[8C65%[70;35H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hf110 [93m<-[m [1m[96mc[m[38;5;224m([mf110[38;5;224m,[m top10[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H184,35[8C66%[70;35H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hacc20 [93m<-[m [1m[96mc[m[38;5;224m([macc20[38;5;224m,[m top20[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H185,35[8C66%[70;35H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hf120 [93m<-[m [1m[96mc[m[38;5;224m([mf120[38;5;224m,[m top20[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H186,35[8C67%[70;35H[?25h[?25l[76;243H~@k[70;35H[76;243H   [70;35H[1;75r[75;1H
[1;76r[75;7Hndcg [93m<-[m [1m[96mc[m[38;5;224m([mndcg[38;5;224m,[m top10[38;5;224m[[m[95m3[m[38;5;224m])[m[76;253H[K[76;253H187,35[8C68%[70;35H[?25h[?25l[76;243H~@k[70;35H[76;243H   [70;33H[1;75r[75;1H
[1;76r[70;17H[38;5;224m[46m([15C)[m[76;253H[K[76;253H188,33[8C68%[70;33H[?25h[?25l[76;243H~@k[70;33H[76;243H   [70;31H[1;75r[75;1H
[1;76r[69;17H[38;5;224m([15C)[m[70;16H[38;5;224m[46m([14C)[m[75;5H[38;5;224m}[m[76;253H[K[76;253H189,31[8C69%[70;31H[?25h[?25l[76;243H~@k[70;31H[76;243H   [70;33H[1;75r[75;1H
[1;76r[69;16H[38;5;224m([14C)[m[70;17H[38;5;224m[46m([15C)[m[75;3H[38;5;224m}[m[76;253H[K[76;253H190,33[8C69%[70;33H[?25h[?25l[76;243H~@k[70;33H[76;243H   [70;31H[1;75r[75;1H
[1;76r[69;17H[38;5;224m([15C)[m[70;16H[38;5;224m[46m([14C)[m[75;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([m[1m[96mmean[m[38;5;224m([mrmses[38;5;224m),[m [1m[96mmean[m[38;5;224m([mbiases[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc10[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc20[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf110[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf120[38;5;224m),[m [1m[96mmean[m[38;5;224m([mndcg[38;5;224m)))[m[76;253H[K[76;253H191,31[8C70%[70;31H[?25h[?25l[76;243H~@k[70;31H[76;243H   [70;31H[1;75r[75;1H
[1;76r[69;16H[38;5;224m([14C)[m[70;16H[38;5;224m[46m([14C)[m[75;1H[38;5;224m}[m[76;253H[K[76;253H192,31[8C70%[70;31H[?25h[?25l[76;243H~@k[70;31H[76;243H   [70;6H[1;75r[75;1H
[1;76r[69;16H[38;5;224m([14C)[m[76;253H[K[76;253H193,6[9C71%[70;6H[?25h[?25l[76;243H~@k[70;6H[76;243H   [70;5H[1;75r[75;1H
[1;76r[16;5H[38;5;224m[46m{[70;5H}[m[75;1H[96m# read appropriate data file[m[76;253H[K[76;253H194,5[9C72%[70;5H[?25h[?25l[1;75r[75;1H
[1;76r[13;3H[38;5;224m[46m{[m[15;5H[38;5;224m{[69;5H}[m
  [38;5;224m[46m}[m[75;1Hdata1 [93m=[m [1m[96mread.csv[m[38;5;224m([m[1m[96mpaste[m[38;5;224m([m[95m'~/rgmirt/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[76;253H[K[76;253H195,3[9C72%[70;3H[?25h[?25l[76;243H~@k[70;3H[76;243H   [70;35H[1;75r[75;1H
[1;76r[12;3H[38;5;224m{[69;3H}[m[76;253H[K[76;253H196,35[8C73%[70;35H[?25h[?25l[76;243H~@k[70;35H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;1H[96m# load true parameter values[m[76;253H[K[76;253H197,1[9C73%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;1H[1m[96mload[m[38;5;224m([mfile[93m=[m[1m[96mpaste[m[38;5;224m([m[95m'~/rgmirt/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m))[m[76;253H[K[76;253H198,0-1[7C74%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;28H[1;75r[75;1H
[1;76r[76;253H[K[76;253H199,28[8C75%[70;28H[?25h[?25l[76;243H~@k[70;28H[76;243H   [70;35H[1;75r[75;1H
[1;76r[75;1H[96m# initialize paramters[m[76;253H[K[76;253H200,35[8C75%[70;35H[?25h[?25l[76;243H~@k[70;35H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;1H[1m[96mprint[m[38;5;224m([m[95m'initializing pars...'[m[38;5;224m)[m[76;253H[K[76;253H201,0-1[7C76%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;28H[1;75r[75;1H
[1;76r[75;1Hpars [93m<-[m [1m[96mmirt[m[38;5;224m([mdata1[38;5;224m,[mndim[38;5;224m,[m pars [93m=[m [95m'values'[m[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m())[m[76;253H[K[76;253H202,28[8C76%[70;28H[?25h[?25l[76;243H~@k[70;28H[76;243H   [70;35H[1;75r[75;1H
[1;76r[76;253H[K[76;253H203,35[8C77%[70;35H[?25h[?25l[76;243H~@k[70;35H[76;243H   [70;6H[1;75r[75;1H
[1;76r[75;1H[96m# set some loadings to zero[m[76;253H[K[76;253H204,6[9C77%[70;6H[?25h[?25l[76;243H~@k[70;6H[76;243H   [70;22H[1;75r[75;1H
[1;76r[75;1H[30m[103mif[m[38;5;224m([mndim[93m==[m[95m1[m[38;5;224m){[m[76;253H[K[76;253H205,22[8C78%[70;22H[?25h[?25l[76;243H~@k[70;22H[76;243H   [70;29H[1;75r[75;1H
[1;76r[70;6H[38;5;224m[46m([22C)[m[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H206,29[8C79%[70;29H[?25h[?25l[76;243H~@k[70;29H[76;243H   [69;22H[70;6H[38;5;224m([22C)[m[76;255H5,22[69;22H[?25h[?25l[76;243H~@k[69;22H[76;243H   [68;6H[76;255H4,6 [68;6H[?25h[?25l[76;243H~@k[68;6H[76;243H   [67;35H[76;255H3,35[67;35H[?25h[?25l[76;243H~@k[67;35H[76;243H   [66;28H[76;255H2,28[66;28H[?25h[?25l[76;243H~@k[66;28H[76;243H   [65;1H[76;255H1,0-1[65;1H[?25h[?25l[76;243H~@k[65;1H[76;243H   [64;35H[76;255H0,35 [64;35H[?25h[?25l[76;243H~@k[64;35H[76;243H   [63;28H[76;253H199,28[63;28H[?25h[?25l[76;243H~@k[63;28H[76;243H   [62;1H[76;255H8,0-1[62;1H[?25h[?25l[76;243H~@k[62;1H[76;243H   [61;1H[76;255H7,1  [61;1H[?25h[?25l[76;243H~@k[61;1H[76;243H   [60;35H[76;255H6,35[60;35H[?25h[?25l[76;243H~@k[60;35H[76;243H   [59;3H[2;3H[38;5;224m[46m{[59;3H}[m[76;255H5,3 [59;3H[?25h[?25l[76;243H~@k[59;3H[76;243H   [58;5H[2;3H[38;5;224m{[m[4;5H[38;5;224m[46m{[58;5H}[m
  [38;5;224m}[m[76;255H4,5[58;5H[?25h[?25l[76;243H~@k[58;5H[76;243H   [57;6H[4;5H[38;5;224m{[58;5H}[m[76;255H3,6[57;6H[?25h[?25l[76;243H~@k[57;6H[76;243H   [56;31H[56;16H[38;5;224m[46m([14C)[m[76;255H2,31[56;31H[?25h[?25l[76;243H~@k[56;31H[76;243H   [55;31H[55;16H[38;5;224m[46m([14C)[m[56;16H[38;5;224m([14C)[m[76;255H1[55;31H[?25h[?25l[76;243H~@k[55;31H[76;243H   [54;33H[54;17H[38;5;224m[46m([15C)[m[55;16H[38;5;224m([14C)[m[76;255H0,33[54;33H[?25h[?25l[76;243H~@k[54;33H[76;243H   [53;31H[53;16H[38;5;224m[46m([14C)[m[54;17H[38;5;224m([15C)[m[76;254H89,31[53;31H[?25h[?25l[76;243H~@k[53;31H[76;243H   [52;33H[52;17H[38;5;224m[46m([15C)[m[53;16H[38;5;224m([14C)[m[76;255H8,33[52;33H[?25h[?25l[76;243H~@k[52;33H[76;243H   [51;35H[52;17H[38;5;224m([15C)[m[76;255H7,35[51;35H[?25h[?25l[76;243H~@k[51;35H[76;243H   [50;35H[76;255H6[50;35H[?25h[?25l[76;243H~@k[50;35H[76;243H   [50;34H[76;258H4[50;34H[?25h[?25l[76;243H~@k[50;34H[76;243H   [50;33H[76;258H3[50;33H[?25h[?25l[76;243H~@k[50;33H[76;243H   [50;32H[76;258H2[50;32H[?25h[?25l[76;243H~@k[50;32H[76;243H   [50;31H[76;258H1[50;31H[?25h[?25l[76;243H~@k[50;31H[76;243H   [50;30H[76;258H0[50;30H[?25h[?25l[76;243H~@k[50;30H[76;243H   [50;29H[76;257H29[50;29H[?25h[?25l[76;243H~@k[50;29H[76;243H   [50;28H[76;258H8[50;28H[?25h[?25l[76;243Hp[50;28H[76;243H [51;1H[51;75r[51;1H[L[1;76r[76;253H[K[76;253H187,0-1[7C78%[51;1H[?25h[?25l[76;243H_[51;1H[76;243H [51;1H[?25h[?25l[76;243H~@k[51;1H[76;243H   [50;96H[50;27H[38;5;224m[46m([68C)[m[76;255H6,96 [50;96H[?25h[?25l[76;243H~@k[50;96H[76;243H   [50;96H[?25h[?25l[76;243H~@k[50;96H[76;243H   [50;96H[?25h[?25l[76;243Hi[50;96H[76;243H [50;96H[76;1H[1m-- INSERT --[m[76;253H[K[76;253H186,96[8C78%[50;96H[?25h[?25l[76;258H7[50;97H[?25h[?25l[76;258H6[50;96H[?25h[?25l[76;258H7[50;97H[?25h[?25l[49;18H[38;5;224m[46m([74C)[m[50;27H[38;5;224m([68C)[m[76;255H5,94[49;94H[?25h[?25l[49;18H[38;5;224m([74C)[m[50;27H[38;5;224m[46m([68C)[m[76;255H6,97[50;97H[?25h[?25li[50;27H[38;5;224m([68C)[m[76;258H8[50;98H[?25h[?25l[50;27H[38;5;224m[46m([68C)[m[76;258H7[50;97H[?25h[?25l[76;258H6[50;96H[?25h[?25l[76;258H7[50;97H[?25h[?25l[50;27H[38;5;224m([68C)[m[76;258H8[50;98H[?25h[?25l[50;97H[K[50;27H[38;5;224m[46m([68C)[m[76;258H7[50;97H[?25h[?25l[76;258H6[50;96H[?25h[?25l[50;27H[38;5;224m([68C)[m[76;258H5[50;95H[?25h[?25l[76;258H4[50;94H[?25h[?25l[76;258H3[50;93H[?25h[?25l[76;258H2[50;92H[?25h[?25l[76;258H1[50;91H[?25h[?25l[50;71H[38;5;224m[46m[[17C][m[76;258H0[50;90H[?25h[?25l[76;257H89[50;89H[?25h[?25l[50;71H[38;5;224m[[17C][m[76;258H8[50;88H[?25h[?25l[76;258H7[50;87H[?25h[?25l[76;258H6[50;86H[?25h[?25l[76;258H5[50;85H[?25h[?25l[76;258H4[50;84H[?25h[?25l[76;258H3[50;83H[?25h[?25l[76;258H2[50;82H[?25h[?25l[76;258H1[50;81H[?25h[?25l[76;258H0[50;80H[?25h[?25l[76;257H79[50;79H[?25h[?25l[76;258H8[50;78H[?25h[?25l[76;258H7[50;77H[?25h[?25l[76;258H6[50;76H[?25h[?25l[76;258H5[50;75H[?25h[?25l[76;258H4[50;74H[?25h[?25l[76;258H3[50;73H[?25h[?25l[38;5;224m[46m[[17C][m[76;258H2[50;72H[?25h[?25l[76;258H1[50;71H[?25h[?25l[38;5;224m[[17C][m[76;258H0[50;70H[?25h[?25l[76;257H69[50;69H[?25h[?25l[76;258H8[50;68H[?25h[?25l[76;258H7[50;67H[?25h[?25l[76;258H6[50;66H[?25h[?25l[76;258H5[50;65H[?25h[?25l[76;258H4[50;64H[?25h[?25l[76;258H3[50;63H[?25h[?25l[76;258H2[50;62H[?25h[?25l[76;258H1[50;61H[?25h[?25l[76;258H0[50;60H[?25h[?25lppred[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m10[m[38;5;224m)[m[76;258H1[50;61H[?25h[?25l_pred[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m10[m[38;5;224m)[m[76;258H2[50;62H[?25h[?25l[76;258H1[50;61H[?25h[?25l[76;258H0[50;60H[?25h[?25l[76;257H59[50;59H[?25h[?25l[50;39H[38;5;224m[46m[[17C][m[76;258H8[50;58H[?25h[?25l[76;258H7[50;57H[?25h[?25l[50;39H[38;5;224m[[17C][m[76;258H6[50;56H[?25h[?25l[76;258H5[50;55H[?25h[?25l[76;258H4[50;54H[?25h[?25l[76;258H3[50;53H[?25h[?25l[76;258H2[50;52H[?25h[?25l[76;258H1[50;51H[?25h[?25l[76;258H0[50;50H[?25h[?25l[76;257H49[50;49H[?25h[?25l[76;258H8[50;48H[?25h[?25l[76;258H7[50;47H[?25h[?25l[76;258H6[50;46H[?25h[?25l[76;258H5[50;45H[?25h[?25l[76;258H4[50;44H[?25h[?25l[76;258H3[50;43H[?25h[?25l[76;258H2[50;42H[?25h[?25l[76;258H1[50;41H[?25h[?25l[38;5;224m[46m[[17C][m[76;258H0[50;40H[?25h[?25l[76;257H39[50;39H[?25h[?25l[38;5;224m[[17C][m[76;258H8[50;38H[?25h[?25l[76;258H7[50;37H[?25h[?25l[76;258H6[50;36H[?25h[?25l[76;258H5[50;35H[?25h[?25l[76;258H4[50;34H[?25h[?25l[76;258H3[50;33H[?25h[?25l[76;258H2[50;32H[?25h[?25l[76;258H1[50;31H[?25h[?25l[76;258H0[50;30H[?25h[?25l[76;257H29[50;29H[?25h[?25l[38;5;224m[46m([70C)[m[76;258H8[50;28H[?25h[?25lptrue[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m p_pred[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m1[m[95m[46m0[m[38;5;224m)[50;27H([m[70C[95m0[m[76;258H9[50;29H[?25h[?25l_true[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m p_pred[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m10[m[38;5;224m)[m[76;257H30[50;30H[?25h[?25l[76;255H7,1 [51;1H[?25h[?25l[76;255H8,30[52;30H[?25h[?25l[76;257H29[52;29H[?25h[?25l[38;5;224m[46m([68C)[m[76;258H8[52;28H[?25h[?25lptrue[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m pred[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m2[m[95m[46m0[m[38;5;224m)[52;27H([m[68C[95m0[m[76;258H9[52;29H[?25h[?25l_true[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m pred[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m20[m[38;5;224m)[m[76;257H30[52;30H[?25h[?25l[76;258H1[52;31H[?25h[?25l[76;258H2[52;32H[?25h[?25l[76;258H3[52;33H[?25h[?25l[76;258H4[52;34H[?25h[?25l[76;258H5[52;35H[?25h[?25l[76;258H6[52;36H[?25h[?25l[76;258H7[52;37H[?25h[?25l[76;258H8[52;38H[?25h[?25l[76;258H9[52;39H[?25h[?25l[76;257H40[52;40H[?25h[?25le[38;5;224m[46m[[17C][m[76;258H1[52;41H[?25h[?25l[76;258H2[52;42H[?25h[?25l[38;5;224m[[17C][m[76;258H3[52;43H[?25h[?25l[76;258H4[52;44H[?25h[?25l[76;258H5[52;45H[?25h[?25l[76;258H6[52;46H[?25h[?25l[76;258H7[52;47H[?25h[?25l[76;258H8[52;48H[?25h[?25l[76;258H9[52;49H[?25h[?25l[76;257H50[52;50H[?25h[?25l[76;258H1[52;51H[?25h[?25l[76;258H2[52;52H[?25h[?25l[76;258H3[52;53H[?25h[?25l[76;258H4[52;54H[?25h[?25l[76;258H5[52;55H[?25h[?25l[76;258H6[52;56H[?25h[?25l[76;258H7[52;57H[?25h[?25l[76;258H8[52;58H[?25h[?25l[52;41H[38;5;224m[46m[[17C][m[76;258H9[52;59H[?25h[?25l[76;257H60[52;60H[?25h[?25l[52;41H[38;5;224m[[17C][m[76;258H1[52;61H[?25h[?25l[76;258H2[52;62H[?25h[?25lppred[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m20[m[38;5;224m)[m[76;258H3[52;63H[?25h[?25l_pred[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m20[m[38;5;224m)[m[76;258H4[52;64H[?25h[?25l[76;255H7,1 [51;1H[?25h[?25l[76;255H6,64[50;64H[?25h[?25l[76;255H5[49;64H[?25h[?25l[76;255H3,40[47;40H[?25h[?25l[44;33H[38;5;224m[46m([24C)[m[76;255H0,59[44;59H[?25h[?25l[40;27H[38;5;224m[46m{[42;7H}[m[44;33H[38;5;224m([24C)[m[76;254H76,28[40;28H[?25h[?25l[36;29H[38;5;224m[46m([11C)[m[40;27H[38;5;224m{[42;7H}[m[76;255H2,42[36;42H[?25h[?25l[36;29H[38;5;224m([11C)[m[76;255H1,50[35;50H[?25h[?25l[31;20H[38;5;224m[46m[[21C][m[76;254H67,43[31;43H[?25h[?25l[31;20H[38;5;224m[[21C][m[76;255H5,24[29;24H[?25h[?25l[22;27H[38;5;224m[46m{[25;7H}[m[76;255H1,8 [25;8H[?25h[?25l[76;254H58,28[22;28H[?25h[?25l[38;5;224m{[25;7H}[m[76;255H7,32[21;32H[?25h[?25l[17;27H[38;5;224m[46m{[20;7H}[m[76;255H6,8 [20;8H[?25h[?25l[76;255H3,28[17;28H[?25h[?25l[16;48H[38;5;224m[46m([mtrain[38;5;224m[46m)[m[17;27H[38;5;224m{[20;7H}[m[76;255H2,55[16;55H[?25h[?25l[16;48H[38;5;224m([mtrain[38;5;224m)[m[76;254H48,36[12;36H[?25h[?25l[10;19H[38;5;224m[46m[[17C][m[76;255H6,38[10;38H[?25h[?25l[6;23H[38;5;224m[46m([16C)[m[10;19H[38;5;224m[[17C][m[76;255H2,41[6;41H[?25h[?25l[1;75r[1;1H[2L[1;76r[2;3H[96m# loop though cross validation folds[m[76;253H[K[76;253H140,6[9C77%[6;5H[38;5;224m[46m{[m[8;23H[38;5;224m([16C)[m[61;5H[38;5;224m[46m}[6;6H[?25h[?25l[1;75r[m[1;1H[3L[1;76r[1;3Haccuracies [93m=[m [1m[96mc[m[38;5;224m()[m
  f1s [93m=[m [1m[96mc[m[38;5;224m()[m
  acc10 [93m=[m acc20 [93m=[m f110 [93m=[m f120 [93m=[m ndcg [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H137,20[8C75%[6;7H[38;5;224m[46m([11C)[m[9;5H[38;5;224m{[64;5H}[6;20H[?25h[?25l[1;75r[m[1;1H[4L[1;76r[1;3Hfolds.items [93m<-[m [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mncol[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m2[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m

  rmses [93m=[m [1m[96mc[m[38;5;224m()[m
  biases [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H133,12[8C73%[6;10H[38;5;224m[46m()[m[10;7H[38;5;224m([11C)[6;12H[?25h[?25l[1;75r[m[1;1H[4L[1;76r[1;1H[38;5;224m{[m

  [96m# calculate to which fold each person and item belongs[m
  folds.persons [93m<-[m  [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mnrow[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m1[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[76;253H[K[76;253H129,1[9C71%[10;10H[38;5;224m()[6;1H[1;75r[m[1;1H[3L[1;76r[1;21Hd_true[38;5;224m,[m[8C[96m# true parameter values[m[2;21Htheta_true[38;5;224m,[m    [96m# true parameter values[m[3;21Hpars[38;5;224m)[m[10C[96m# parameters object from mirt[m[76;253H[K[76;253H126,57[8C69%[6;57H[?25h[?25l[1;75r[1;1H[4L[1;76r[1;21Hrandompars[38;5;224m,[m    [96m# mirt argument for whether to use random paramters values[m[2;21Hk [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m    [96m# number of folds for 2d cross validation[m[3;21Hlambda[38;5;224m,[m[8C[96m# l1 and l2 penalty[m[4;21Ha_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H122,59[8C67%[6;59H[1;75r[1;1H[4L[1;76r[1;1H[96m# Function that fits rgmirt model using cross validation and returns the average RMSE and average bias[m
cv.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([mdata[38;5;224m,[m[10C[96m# matrix of responses[m[3;21Hmodel[38;5;224m,[m[9C[96m# model to be passed to mirt, can be number of dimensions[m[4;21Hmethod[38;5;224m,[m[8C[96m# method of esitmation, e.g. EM[m[76;253H[K[76;253H118,64[8C64%[6;64H[?25h[?25l[1;75r[1;1H[4L[1;76r[1;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([mavg_topn_accuracy[38;5;224m,[m avg_topn_f1_score[38;5;224m,[m avg_ndcg[38;5;224m))
}[m[76;253H[K[76;253H114,57[8C62%[6;57H[?25h[?25l[1;75r[1;1H[4L[1;76r[1;3Havg_topn_accuracy [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_accuracies[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m
  avg_topn_f1_score [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_f1_scores[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m
  avg_ndcg [93m<-[m [1m[96mmean[m[38;5;224m([mndcgs[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H110,2[9C60%[6;2H[?25h[?25l[1;75r[1;1H[5L[1;76r[1;5Htopn_f1_scores[38;5;224m[[mi[38;5;224m][m [93m<-[m f1_score
    ndcgs[38;5;224m[[mi[38;5;224m][m [93m<-[m ndcg
  [38;5;224m}[m

  [96m# Calculate the average top-n accuracy and top-n F1 score across all users[m[76;253H[K[76;253H105,59[8C57%[6;28H[38;5;224m[46m([29C)[1;75r[m[1;1H[3L[1;76r[1;5Hndcg [93m=[m [1m[96mNDCG[m[38;5;224m([mordered_true_probabilities[38;5;224m)[m[3;5Htopn_accuracies[38;5;224m[[mi[38;5;224m][m [93m<-[m topn_accuracy[76;253H[K[76;253H102,4[9C55%[9;28H[38;5;224m([29C)[6;4H[?25h[?25l[1;75r[m[1;1H[L[1;76r[1;5Hordered_true_probabilities [93m=[m p_true[38;5;224m[[mi[38;5;224m,[m indices[38;5;224m][m[76;253H[K[76;253H101,21[8C54%[6;21H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H100,34[8C54%[6;34H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hf1_score [93m<-[m [95m2[m [93m*[m precision [93m*[m recall [93m/[m [38;5;224m([mprecision [93m+[m recall[38;5;224m)[m[76;253H[K[76;253H99,40[9C53%[6;40H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H98,5[10C53%[6;5H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hrecall [93m<-[m true_positives [93m/[m actual_positives[76;253H[K[76;253H97,44[9C52%[6;16H[38;5;224m[46m([26C)[?25h[?25l[1;75r[m[1;1H[4L[1;76r[1;5Hpredicted_positives [93m<-[m [1m[96msum[m[38;5;224m([mpred_response[38;5;224m[[mtopn_indices[38;5;224m])[m
    actual_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_response[38;5;224m[[mtopn_indices[38;5;224m])[m[4;5Hprecision [93m<-[m true_positives [93m/[m n[76;253H[K[76;253H93,5[10C50%[10;16H[38;5;224m([26C)[6;5H[?25h[?25l[1;75r[m[1;1H[4L[1;76r[1;5Htopn_accuracy [93m<-[m [1m[96msum[m[38;5;224m([mtrue_response[38;5;224m[[mtopn_indices[38;5;224m])[m [93m/[m n[3;5H[96m# Calculate the top-n F1 score for the current user[m
    true_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_response[38;5;224m[[mtopn_indices[38;5;224m][m[93m*[mpred_response[38;5;224m[[mtopn_indices[38;5;224m])[m[76;253H[K[76;253H89,57[9C47%[6;28H[38;5;224m[46m([27C)[1;75r[m[1;1H[2L[1;76r[2;5H[96m# Calculate the top-n accuracy for the current user[m[76;253H[K[76;253H87,64[9C46%[8;28H[38;5;224m([27C)[6;64H[?25h[?25l[1;75r[m[1;1H[3L[1;76r[1;5H[96m# Get the indices of the top-n predicted relevance[m
    indices [93m<-[m [1m[96morder[m[38;5;224m([m[93m-[mpred_relevance[38;5;224m)[m
    topn_indices [93m<-[m indices[38;5;224m[[m[95m1[m[38;5;224m:[mn[38;5;224m][m[76;253H[K[76;253H84,58[9C45%[6;58H[?25h[?25l[1;75r[1;1H[3L[1;76r[2;5Hpred_relevance [93m<-[m p_pred[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H81,33[9C43%[6;28H[38;5;224m[46m[[3C][?25h[?25l[1;75r[m[1;1H[3L[1;76r[1;3H[93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mnum_users[38;5;224m)[m [38;5;224m{[m
    true_response [93m<-[m true_resp_matrix[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m
    pred_response [93m<-[m pred_resp_matrix[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H78,5[10C41%[9;28H[38;5;224m[[3C][6;5H[1;75r[m[1;1H[3L[1;76r[1;3Hndcgs [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m

  [96m# for each user[m[76;253H[K[76;253H75,43[9C39%[6;38H[38;5;224m[46m[[3C][?25h[?25l[1;75r[m[1;1H[3L[1;76r[2;3Htopn_accuracies [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m
  topn_f1_scores [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m[76;253H[K[76;253H72,18[9C38%[9;38H[38;5;224m[[3C][6;18H[?25h[?25l[1;75r[m[1;1H[3L[1;76r[2;3Hnum_users [93m<-[m [1m[96mdim[m[38;5;224m([mtrue[38;5;224m)[[m[95m1[m[38;5;224m][m
  num_movies [93m<-[m [1m[96mdim[m[38;5;224m([mtrue[38;5;224m)[[m[95m2[m[38;5;224m][m[76;253H[K[76;253H69,49[9C36%[6;27H[38;5;224m[46m([20C)[?25h[?25l[1;75r[m[1;1H[L[1;76r[1;3Hpred_resp_matrix [93m<-[m [1m[96mround[m[38;5;224m([mp_pred[38;5;224m,[m [95m0[m[38;5;224m)[m[76;253H[K[76;253H68,50[9C35%[6;28H[38;5;224m[46m([20C)[m[7;27H[38;5;224m([20C)[6;50H[?25h[?25l[1;75r[m[1;1H[L[1;76r[1;3Htrue_resp_matrix [93m<-[m [1m[96mround[m[38;5;224m([mp_true[38;5;224m,[m [95m0[m[38;5;224m)[m[76;253H[K[76;253H67,3[10C35%[7;28H[38;5;224m([20C)[6;3H[?25h[?25l[1;75r[m[1;1H[L[1;76r[1;3H[96m# binarise probabilities to 0/1[m[76;253H[K[76;253H66,29[9C34%[6;26H[38;5;224m[46m[[1C][?25h[?25l[1;75r[m[1;1H[2L[1;76r[2;1Hacc_f1_at_n [93m<-[m [38;5;121mfunction[m[38;5;224m([mp_true[38;5;224m,[m p_pred[38;5;224m,[m n[38;5;224m)[m [38;5;224m{[m[76;253H[K[76;253H64,3[10C33%[8;26H[38;5;224m[[1C][6;3H[?25h[?25l[1;75r[m[1;1H[L[1;76r[1;1H[38;5;224m}[m[76;253H[K[76;253H63,39[9C32%[6;28H[38;5;224m[46m([9C)[?25h[?25l[1;75r[m[1;1H[L[1;76r[1;3H[93mreturn[m[38;5;224m([mNDCG[38;5;224m)[m[76;253H[K[76;253H62,39[9C32%[6;28H[38;5;224m[46m([9C)[m[7;28H[38;5;224m([9C)[6;39H[?25h[?25l[1;75r[m[1;1H[2L[1;76r[1;1HNDCG [93m=[m [38;5;121mfunction[m[38;5;224m([mr[38;5;224m){[m
  NDCG [93m=[m [1m[96mDCG[m[38;5;224m([mr[38;5;224m)[m[93m/[m[1m[96mDCG[m[38;5;224m([m[1m[96msort[m[38;5;224m([mr[38;5;224m,[m decreasing[93m=[m[95mT[m[38;5;224m))[m[76;253H[K[76;253H60,45[9C31%[6;44H[38;5;224m[46m{[m[8;28H[38;5;224m([9C)[m[56;1H[38;5;224m[46m}[6;45H[?25h[?25l[1;75r[m[1;1H[3L[1;76r[1;1H[38;5;224m}[m

[96m# NDCG[m[76;253H[K[76;253H57,15[9C29%[6;9H[38;5;224m[46m([mNDCG[38;5;224m[46m)[m[9;44H[38;5;224m{[59;1H}[6;15H[?25h[?25l[1;75r[m[1;1H[4L[1;76r[2;3HD [93m=[m [1m[96mlog[m[38;5;224m([mk[93m+[m[95m1[m[38;5;224m,[m base [93m=[m [95m2[m[38;5;224m)[m
  DCG [93m=[m [1m[96msum[m[38;5;224m([mr[93m/[mD[38;5;224m)[m
  [93mreturn[m[38;5;224m([mDCG[38;5;224m)[m[76;253H[K[76;253H53,1[10C27%[10;9H[38;5;224m([mNDCG[38;5;224m)[6;1H[?25h[?25l[m[76;254H4,7[7;7H[?25h[?25l[8;19H[38;5;224m[46m{


}[m[76;254H5,20[8;20H[?25h[?25l[38;5;224m{[m[10;9H[38;5;224m[46m([mNDCG[38;5;224m[46m)[m
[38;5;224m}[m[76;254H7,15[10;15H[?25h[?25l[38;5;224m([mNDCG[38;5;224m)[m[13;44H[38;5;224m[46m{[63;1H}[m[76;253H60,4[13;45H[?25h[?25l[38;5;224m{[63;1H}[m[76;254H1,34[14;34H[?25h[?25l[18;25H[38;5;224m[46m[[1C][m[76;254H5,28[18;28H[?25h[?25l[38;5;224m[[1C][m[23;18H[38;5;224m[46m([20C)[m[76;253H70,40[23;40H[?25h[?25l[23;18H[38;5;224m([20C)[m[27;38H[38;5;224m[46m[[3C][m[76;254H4,43[27;43H[?25h[?25l[38;5;224m[[3C][m[76;254H6,5 [29;5H[?25h[?25l[34;28H[38;5;224m[46m[[3C][m[76;253H81,33[34;33H[?25h[?25l[38;5;224m[[3C][m[76;254H2,5 [35;5H[?25h[?25l[76;254H5[38;5H[?25h[?25l[42;28H[38;5;224m[46m([27C)[m[76;254H9,57[42;57H[?25h[?25l[42;28H[38;5;224m([27C)[m[76;253H91,36[44;36H[?25h[?25l[49;40H[38;5;224m[46m[[10C][m[76;254H6,52[49;52H[?25h[?25l[49;40H[38;5;224m[[10C][m[76;254H9,40[52;40H[?25h[?25l[76;253H103,3[56;3H[?25h[?25l[76;255H4,64[57;64H[?25h[?25l[58;28H[38;5;224m[46m([29C)[m[76;255H5,59[58;59H[?25h[?25l[58;28H[38;5;224m([29C)[m[62;9H[38;5;224m[46m([49C)[m[76;255H9,60[62;60H[?25h[?25l[62;9H[38;5;224m([49C)[m[76;254H12,1 [65;1H[?25h[?25l[76;255H3,64[66;64H[?25h[?25l[76;255H4,57[67;57H[?25h[?25l[76;255H7,64[70;64H[?25h[?25l[1;75r[1;1H[3M[1;76r[73;21Hpars[38;5;224m)[m[10C[96m# parameters object from mirt[m
[38;5;224m{[m[76;253H[K[76;253H120,59[8C28%[70;59H[?25h[?25l[1;75r[1;1H[3M[1;76r[73;3H[96m# calculate to which fold each person and item belongs[m
  folds.persons [93m<-[m  [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mnrow[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m1[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m
  folds.items [93m<-[m [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mncol[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m2[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[76;253H[K[76;253H123,64[8C30%[70;64H[?25h[?25l[1;75r[1;1H[3M[1;76r[74;3Hrmses [93m=[m [1m[96mc[m[38;5;224m()[m
  biases [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H126,57[8C32%[70;57H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Haccuracies [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H127,64[8C32%[70;64H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hf1s [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H128,64[8C33%[70;21H[38;5;224m[46m([42C)[?25h[?25l[1;75r[m[1;1H[4M[1;76r[72;3Hacc10 [93m=[m acc20 [93m=[m f110 [93m=[m f120 [93m=[m ndcg [93m=[m [1m[96mc[m[38;5;224m()[m

  [96m# loop though cross validation folds[m
  [93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H132,19[8C35%[66;21H[38;5;224m([42C)[m[70;17H[38;5;224m[46m()[?25h[?25l[1;75r[m[1;1H[4M[1;76r[72;3H[38;5;224m{[m
    [93mfor[m [38;5;224m([mj [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m2[m[38;5;224m])
[m    [38;5;224m{[m[75;7H[96m# save the persons and items that belong to the hold out test set[m[76;253H[K[76;253H136,39[8C38%[66;17H[38;5;224m()[70;39H[1;75r[m[75;1H
[1;76r[75;7Hper.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.persons[93m==[mi[38;5;224m)[m[76;253H[K[76;253H137,20[8C38%[70;7H[38;5;224m[46m([11C)[?25h[?25l[1;75r[m[1;1H[6M[1;76r[70;7Hitem.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.items[93m==[mj[38;5;224m)[m[72;7H[96m# create train and test folds[m[73;7Htest [93m<-[m data[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m][m[74;7Htrain [93m<-[m data[75;7Htrain[38;5;224m[[mper.ind[38;5;224m,[mitem.ind[38;5;224m][m [93m<-[m [95mNA[m[76;253H[K[76;253H143,40[8C42%[64;7H[38;5;224m([11C)[m[70;24H[38;5;224m[46m([14C)[?25h[?25l[1;75r[m[1;1H[5M[1;76r[72;7H[96m# [m[30m[103mif[m[96m some rows contain no responses after the leave out set, remove them from the training set, and adjust person indices accordingly[m[73;7Hemptyrows [93m=[m [1m[96mrowSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mncol[m[38;5;224m([mtrain[38;5;224m)[m[74;7Hemptycols [93m=[m [1m[96mcolSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mnrow[m[38;5;224m([mtrain[38;5;224m)[m[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H148,36[8C45%[65;24H[38;5;224m([14C)[70;36H[1;75r[m[75;1H
[1;76r[75;9Htrain [93m=[m train[38;5;224m[[m[93m![memptyrows[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H149,7[9C45%[70;7H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Hper.ind [93m=[m per.ind[38;5;224m[[m[93m![mper.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m)][m[76;253H[K[76;253H150,64[8C46%[70;64H[?25h[?25l[1;75r[1;1H[7M[1;76r[69;7H[38;5;224m}[m[70;7H[96m# do the same for columns[m[71;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[72;9Htrain [93m=[m train[38;5;224m[,[m[93m![memptycols[38;5;224m][m[73;9Hitem.ind [93m=[m item.ind[38;5;224m[[m[93m![mitem.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m)][74;7H}[m[76;253H[K[76;253H157,32[8C50%[70;32H[?25h[?25l[1;75r[1;1H[4M[1;76r[72;7H[96m# fit model[m[73;7Hfit [93m<-[m [1m[96mmirt[m[38;5;224m([mtrain[38;5;224m,[m model[38;5;224m,[m [95m'2PL'[m[38;5;224m,[m method[93m=[mmethod[38;5;224m,[m GenRandomPars[93m=[mrandompars[38;5;224m,[m lambda[93m=[mlambda[38;5;224m,[m pars[93m=[mpars[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m([mNCYCLES[93m=[m[95m10[m[38;5;224m))[m[74;7H[96m# save parameters[m[75;7Hitempars [93m<-[m [1m[96mcoef[m[38;5;224m([mfit[38;5;224m,[m simplify [93m=[m [95mTRUE[m[38;5;224m)$[mitems[76;253H[K[76;253H161,8[9C52%[67;27H[38;5;224m[46m{[70;7H}[1;75r[m[1;1H[3M[1;76r[73;7Ha [93m<-[m itempars[38;5;224m[,[m[95m1[m[38;5;224m:([m[1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m3[m[38;5;224m)][m[74;7Hd [93m<-[m itempars[38;5;224m[,[m [1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m2[m[38;5;224m][m[75;7Htheta [93m<-[m [1m[96mfscores[m[38;5;224m([mfit[38;5;224m)[m[76;253H[K[76;253H164,64[8C54%[64;27H[38;5;224m{[67;7H}[70;64H[?25h[?25l[1;75r[m[75;1H
[1;76r[76;253H[K[76;253H165,24[8C54%[70;24H[?25h[?25l[1;75r[1;1H[2M[1;76r[74;7H[96m# calculate true and predicted probablities[m[75;7Hp.pred [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)[m[76;253H[K[76;253H167,43[8C56%[70;20H[38;5;224m[46m[[21C][?25h[?25l[1;75r[m[1;1H[4M[1;76r[72;7Hp.true [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma_true[38;5;224m,[m [1m[96mas.vector[m[38;5;224m([md_true[38;5;224m),[m theta_true[38;5;224m)[m[74;7H[96m# [m[30m[103mif[m[96m there are rows without responses, they have no theta estimates, so we have to fill in some empty rows to make the dimensions correct[m[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H171,50[8C58%[66;20H[38;5;224m[[21C][70;50H[?25h[?25l[1;75r[m[1;1H[3M[1;76r[73;9Hp.pred [93m=[m [1m[96minsertEmptyRows[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m))[74;7H}[m[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H174,7[9C60%[70;7H[1;75r[1;1H[2M[1;76r[74;9Hp.pred [93m=[m [1m[96minsertEmptyCols[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m))[75;7H}[m[76;253H[K[76;253H176,28[8C61%[70;27H[38;5;224m[46m{[72;7H}[70;28H[?25h[?25l[1;75r[m[1;1H[4M[1;76r[73;7H[96m# calculate metrics and save them[m[74;7Hrmses [93m<-[m [1m[96mc[m[38;5;224m([mrmses[38;5;224m,[m [1m[96mRMSE[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[75;7Hbiases [93m<-[m [1m[96mc[m[38;5;224m([mbiases[38;5;224m,[m [1m[96mbias[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[76;253H[K[76;253H180,59[8C63%[66;27H[38;5;224m{[68;7H}[m[70;33H[38;5;224m[46m([24C)[1;75r[m[1;1H[2M[1;76r[74;7Htop10 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mp_true[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m p_pred[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m10[m[38;5;224m)[m[76;253H[K[76;253H182,2[9C64%[68;33H[38;5;224m([24C)

[m [?25h[?25l[1;75r[1;1H[3M[1;76r[73;7Htop20 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mp_true[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m p_pred[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m20[m[38;5;224m)[m[74;7Hacc10 [93m<-[m [1m[96mc[m[38;5;224m([macc10[38;5;224m,[m top10[38;5;224m[[m[95m1[m[38;5;224m])[m[75;7Hf110 [93m<-[m [1m[96mc[m[38;5;224m([mf110[38;5;224m,[m top10[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H185,64[8C66%[70;64H[1;75r[1;1H[4M[1;76r[72;7Hacc20 [93m<-[m [1m[96mc[m[38;5;224m([macc20[38;5;224m,[m top20[38;5;224m[[m[95m1[m[38;5;224m])[m[73;7Hf120 [93m<-[m [1m[96mc[m[38;5;224m([mf120[38;5;224m,[m top20[38;5;224m[[m[95m2[m[38;5;224m])[m[74;7Hndcg [93m<-[m [1m[96mc[m[38;5;224m([mndcg[38;5;224m,[m top10[38;5;224m[[m[95m3[m[38;5;224m])[m[76;253H[K[76;253H189,34[8C68%[70;17H[38;5;224m[46m([15C)[?25h[m[76;1H[K[70;33H[?25l[76;243H^[[70;33H[76;243H  [70;34H[76;253H189,33[8C68%[70;33H[?25h[?25l[76;243H:[70;33H[76;243H[K[76;1H:[?2004h[?25hw[?25l[?25h[?25l [?25h[?25l[?25h[?25l"fitscript.R" 248L, 8758C written[70;33H[76;253H189,33[8C68%[76;253H[K[76;253H189,33[8C68%[70;33H[?25h[?25l[76;243H:[70;33H[76;1H[K[76;1H:[?2004h[?25hQ[?25l[?25h[?25l [?25h[?25l[?25h[?25l[97m[41mE492: Not an editor command: Q[70;33H[m[76;253H189,33[8C68%[70;33H[?25h[?25l[76;243H:[70;33H[76;1H[K[76;1H:[?2004h[?25hq[?25l[?25h[?25l [?25h[?25l[?25h[?25l[?2004l[76;1H[K[76;1H[?2004l[?1l>[?25h[?1049l[23;0;0t]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ vim fitscript.R Rscript fitscript.R 0 0 3 1 .85
Loading required package: stats4
Loading required package: lattice
[1] "initializing pars..."
[1] "fitting model..."
Iteration: 1, Log-Lik: -1151562.107, Max-Change: 23.54328Iteration: 2, Log-Lik: -283412.264, Max-Change: 8.16770Iteration: 3, Log-Lik: -251464.713, Max-Change: 5.76194Iteration: 4, Log-Lik: -243356.778, Max-Change: 7.71550Iteration: 5, Log-Lik: -238816.786, Max-Change: 6.66958Iteration: 6, Log-Lik: -235741.028, Max-Change: 3.02796Iteration: 7, Log-Lik: -234495.538, Max-Change: 3.85519Iteration: 8, Log-Lik: -233629.539, Max-Change: 2.91821Iteration: 9, Log-Lik: -233036.676, Max-Change: 3.26450Iteration: 10, Log-Lik: -232571.295, Max-Change: 1.20770
EM cycles terminated after 10 iterations.
Error in acc_f1_at_n(p_true = p.true[per.ind, item.ind], p_pred = p.pred[per.ind,  : 
  object 'true' not found
Calls: cv.mirt -> acc_f1_at_n
Execution halted
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ Rscript fitscript.R 0 0 3 1 .85[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[15Pvim fitscript.R 
[?2004h[?1049h[22;0;0t[?1h=[?2004h[1;76r[?12h[?12l[27m[23m[29m[m[H[2J[?25l[76;1H"fitscript.R" 248L, 8758C[2;1Hâ–½[6n[2;1H  [1;1H[>c]10;?]11;?[1;7Hemptycols [38;5;130m=[m [36mcolSums[m[35m([m[36mis.na[m[35m([mtrain[35m))[m [38;5;130m==[m [36mnrow[m[35m([mtrain[35m)[m[2;7H[38;5;130m[103mif[m[35m([m[36msum[m[35m([memptyrows[35m)[m[38;5;130m>[m[31m0[m[35m){[m[3;9Htrain [38;5;130m=[m train[35m[[m[38;5;130m![memptyrows[35m,[m [35m][m[4;9Hper.ind [38;5;130m=[m per.ind[35m[[m[38;5;130m![mper.ind [38;5;130m%in%[m [36mwhich[m[35m([memptyrows[35m)][5;7H}[m[6;7H[34m# do the same for columns[m[7;7H[38;5;130m[103mif[m[35m([m[36msum[m[35m([memptycols[35m)[m[38;5;130m>[m[31m0[m[35m){[m[8;9Htrain [38;5;130m=[m train[35m[,[m[38;5;130m![memptycols[35m][m[9;9Hitem.ind [38;5;130m=[m item.ind[35m[[m[38;5;130m![mitem.ind [38;5;130m%in%[m [36mwhich[m[35m([memptycols[35m)][10;7H}[m[12;7H[34m# fit model[m[13;7Hfit [38;5;130m<-[m [36mmirt[m[35m([mtrain[35m,[m model[35m,[m [31m'2PL'[m[35m,[m method[38;5;130m=[mmethod[35m,[m GenRandomPars[38;5;130m=[mrandompars[35m,[m lambda[38;5;130m=[mlambda[35m,[m pars[38;5;130m=[mpars[35m,[m technical [38;5;130m=[m [32mlist[m[35m([mNCYCLES[38;5;130m=[m[31m10[m[35m))[m[14;7H[34m# save parameters[m[15;7Hitempars [38;5;130m<-[m [36mcoef[m[35m([mfit[35m,[m simplify [38;5;130m=[m [31mTRUE[m[35m)$[mitems[16;7Ha [38;5;130m<-[m itempars[35m[,[m[31m1[m[35m:([m[36mncol[m[35m([mitempars[35m)[m[38;5;130m-[m[31m3[m[35m)][m[17;7Hd [38;5;130m<-[m itempars[35m[,[m [36mncol[m[35m([mitempars[35m)[m[38;5;130m-[m[31m2[m[35m][m[18;7Htheta [38;5;130m<-[m [36mfscores[m[35m([mfit[35m)[m[20;7H[34m# calculate true and predicted probablities[m[21;7Hp.pred [38;5;130m<-[m [36mpredict.mirt[m[35m([ma[35m,[m d[35m,[m theta[35m)[m[22;7Hp.true [38;5;130m<-[m [36mpredict.mirt[m[35m([ma_true[35m,[m [36mas.vector[m[35m([md_true[35m),[m theta_true[35m)[m[24;7H[34m# [m[34m[103mif[m[34m there are rows without responses, they have no theta estimates, so we have to fill in some empty rows to make the dimensions correct[m[25;7H[38;5;130m[103mif[m[35m([m[36msum[m[35m([memptyrows[35m)[m[38;5;130m>[m[31m0[m[35m){[m[26;9Hp.pred [38;5;130m=[m [36minsertEmptyRows[m[35m([mp.pred[35m,[m [36mwhich[m[35m([memptyrows[35m))[27;7H}[m[28;7H[38;5;130m[103mif[m[35m([m[36msum[m[35m([memptycols[35m)[m[38;5;130m>[m[31m0[m[35m){[m[29;9Hp.pred [38;5;130m=[m [36minsertEmptyCols[m[35m([mp.pred[35m,[m [36mwhich[m[35m([memptycols[35m))[30;7H}[m[32;7H[34m# calculate metrics and save them[m[33;7Hrmses [38;5;130m<-[m [36mc[m[35m([mrmses[35m,[m [36mRMSE[m[35m([mest[38;5;130m=[mp.pred[35m[[mper.ind[35m,[m item.ind[35m],[m par[38;5;130m=[mp.true[35m[[mper.ind[35m,[m item.ind[35m]))[m[34;7Hbiases [38;5;130m<-[m [36mc[m[35m([mbiases[35m,[m [36mbias[m[35m([mest[38;5;130m=[mp.pred[35m[[mper.ind[35m,[m item.ind[35m],[m par[38;5;130m=[mp.true[35m[[mper.ind[35m,[m item.ind[35m]))[m[35;7Htop10 [38;5;130m<-[m [36macc_f1_at_n[m[35m([mp_true[38;5;130m=[mp.true[35m[[mper.ind[35m,[m item.ind[35m],[m p_pred[38;5;130m=[mp.pred[35m[[mper.ind[35m,[m item.ind[35m],[m n[38;5;130m=[m[31m10[m[35m)[m[37;7Htop20 [38;5;130m<-[m [36macc_f1_at_n[m[35m([mp_true[38;5;130m=[mp.true[35m[[mper.ind[35m,[m item.ind[35m],[m p_pred[38;5;130m=[mp.pred[35m[[mper.ind[35m,[m item.ind[35m],[m n[38;5;130m=[m[31m20[m[35m)[m[38;7Hacc10 [38;5;130m<-[m [36mc[m[35m[106m([macc10[35m,[m top10[35m[[m[31m1[m[35m][m[35m[106m)[m[39;7Hf110 [38;5;130m<-[m [36mc[m[35m([mf110[35m,[m top10[35m[[m[31m2[m[35m])[m[40;7Hacc20 [38;5;130m<-[m [36mc[m[35m([macc20[35m,[m top20[35m[[m[31m1[m[35m])[m[41;7Hf120 [38;5;130m<-[m [36mc[m[35m([mf120[35m,[m top20[35m[[m[31m2[m[35m])[m[42;7Hndcg [38;5;130m<-[m [36mc[m[35m([mndcg[35m,[m top10[35m[[m[31m3[m[35m])[44;5H}
[m  [35m}[m
  [38;5;130mreturn[m[35m([m[36mc[m[35m([m[36mmean[m[35m([mrmses[35m),[m [36mmean[m[35m([mbiases[35m),[m [36mmean[m[35m([macc10[35m),[m [36mmean[m[35m([macc20[35m),[m [36mmean[m[35m([mf110[35m),[m [36mmean[m[35m([mf120[35m),[m [36mmean[m[35m([mndcg[35m)))
}[m

[34m# read appropriate data file[m
data1 [38;5;130m=[m [36mread.csv[m[35m([m[36mpaste[m[35m([m[31m'~/rgmirt/data/'[m[35m,[m ndim[35m,[m iteration[35m,[m sparsity[35m,[m [31m'.csv'[m[35m,[m sep[38;5;130m=[m[31m'_'[m[35m),[m row.names[38;5;130m=[m[31m1[m[35m)[m

[34m# load true parameter values[m
[36mload[m[35m([mfile[38;5;130m=[m[36mpaste[m[35m([m[31m'~/rgmirt/parameters/true/true'[m[35m,[m ndim[35m,[m iteration[35m,[m sparsity[35m,[m [31m'.RData'[m[35m,[m sep[38;5;130m=[m[31m'_'[m[35m))[m

[34m# initialize paramters[m
[36mprint[m[35m([m[31m'initializing pars...'[m[35m)[m
pars [38;5;130m<-[m [36mmirt[m[35m([mdata1[35m,[mndim[35m,[m pars [38;5;130m=[m [31m'values'[m[35m,[m technical [38;5;130m=[m [32mlist[m[35m())[m

[34m# set some loadings to zero[m
[38;5;130m[103mif[m[35m([mndim[38;5;130m==[m[31m1[m[35m){[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
[35m}[m [38;5;130melse[m [38;5;130m[103mif[m [35m([mndim[38;5;130m==[m[31m2[m[35m){[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m:[m[31m5[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m:[m[31m5[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a2'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m6[m[35m:[m[31m10[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a2'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m6[m[35m:[m[31m10[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
[35m}[m[38;5;130melse[m [38;5;130m[103mif[m [35m([mndim[38;5;130m==[m[31m3[m[35m){[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m:[m[31m10[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m:[m[31m10[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a2'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m11[m[35m:[m[31m20[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a2'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m11[m[35m:[m[31m20[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a3'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m21[m[35m:[m[31m30[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a3'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m21[m[35m:[m[31m30[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
[35m}[m[76;253H189,33[8C87%[38;33H[?25h[27m[23m[29m[m[H[2J[?25l[1;7Hemptycols [93m=[m [1m[96mcolSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mnrow[m[38;5;224m([mtrain[38;5;224m)[m[2;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[3;9Htrain [93m=[m train[38;5;224m[[m[93m![memptyrows[38;5;224m,[m [38;5;224m][m[4;9Hper.ind [93m=[m per.ind[38;5;224m[[m[93m![mper.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m)][5;7H}[m[6;7H[96m# do the same for columns[m[7;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[8;9Htrain [93m=[m train[38;5;224m[,[m[93m![memptycols[38;5;224m][m[9;9Hitem.ind [93m=[m item.ind[38;5;224m[[m[93m![mitem.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m)][10;7H}[m[12;7H[96m# fit model[m[13;7Hfit [93m<-[m [1m[96mmirt[m[38;5;224m([mtrain[38;5;224m,[m model[38;5;224m,[m [95m'2PL'[m[38;5;224m,[m method[93m=[mmethod[38;5;224m,[m GenRandomPars[93m=[mrandompars[38;5;224m,[m lambda[93m=[mlambda[38;5;224m,[m pars[93m=[mpars[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m([mNCYCLES[93m=[m[95m10[m[38;5;224m))[m[14;7H[96m# save parameters[m[15;7Hitempars [93m<-[m [1m[96mcoef[m[38;5;224m([mfit[38;5;224m,[m simplify [93m=[m [95mTRUE[m[38;5;224m)$[mitems[16;7Ha [93m<-[m itempars[38;5;224m[,[m[95m1[m[38;5;224m:([m[1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m3[m[38;5;224m)][m[17;7Hd [93m<-[m itempars[38;5;224m[,[m [1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m2[m[38;5;224m][m[18;7Htheta [93m<-[m [1m[96mfscores[m[38;5;224m([mfit[38;5;224m)[m[20;7H[96m# calculate true and predicted probablities[m[21;7Hp.pred [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)[m[22;7Hp.true [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma_true[38;5;224m,[m [1m[96mas.vector[m[38;5;224m([md_true[38;5;224m),[m theta_true[38;5;224m)[m[24;7H[96m# [m[30m[103mif[m[96m there are rows without responses, they have no theta estimates, so we have to fill in some empty rows to make the dimensions correct[m[25;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[26;9Hp.pred [93m=[m [1m[96minsertEmptyRows[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m))[27;7H}[m[28;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[29;9Hp.pred [93m=[m [1m[96minsertEmptyCols[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m))[30;7H}[m[32;7H[96m# calculate metrics and save them[m[33;7Hrmses [93m<-[m [1m[96mc[m[38;5;224m([mrmses[38;5;224m,[m [1m[96mRMSE[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[34;7Hbiases [93m<-[m [1m[96mc[m[38;5;224m([mbiases[38;5;224m,[m [1m[96mbias[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[35;7Htop10 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mp_true[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m p_pred[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m10[m[38;5;224m)[m[37;7Htop20 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mp_true[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m p_pred[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m20[m[38;5;224m)[m[38;7Hacc10 [93m<-[m [1m[96mc[m[38;5;224m[46m([macc10[38;5;224m,[m top10[38;5;224m[[m[95m1[m[38;5;224m][m[38;5;224m[46m)[m[39;7Hf110 [93m<-[m [1m[96mc[m[38;5;224m([mf110[38;5;224m,[m top10[38;5;224m[[m[95m2[m[38;5;224m])[m[40;7Hacc20 [93m<-[m [1m[96mc[m[38;5;224m([macc20[38;5;224m,[m top20[38;5;224m[[m[95m1[m[38;5;224m])[m[41;7Hf120 [93m<-[m [1m[96mc[m[38;5;224m([mf120[38;5;224m,[m top20[38;5;224m[[m[95m2[m[38;5;224m])[m[42;7Hndcg [93m<-[m [1m[96mc[m[38;5;224m([mndcg[38;5;224m,[m top10[38;5;224m[[m[95m3[m[38;5;224m])[44;5H}
[m  [38;5;224m}[m
  [93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([m[1m[96mmean[m[38;5;224m([mrmses[38;5;224m),[m [1m[96mmean[m[38;5;224m([mbiases[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc10[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc20[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf110[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf120[38;5;224m),[m [1m[96mmean[m[38;5;224m([mndcg[38;5;224m)))
}[m

[96m# read appropriate data file[m
data1 [93m=[m [1m[96mread.csv[m[38;5;224m([m[1m[96mpaste[m[38;5;224m([m[95m'~/rgmirt/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m

[96m# load true parameter values[m
[1m[96mload[m[38;5;224m([mfile[93m=[m[1m[96mpaste[m[38;5;224m([m[95m'~/rgmirt/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m))[m

[96m# initialize paramters[m
[1m[96mprint[m[38;5;224m([m[95m'initializing pars...'[m[38;5;224m)[m
pars [93m<-[m [1m[96mmirt[m[38;5;224m([mdata1[38;5;224m,[mndim[38;5;224m,[m pars [93m=[m [95m'values'[m[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m())[m

[96m# set some loadings to zero[m
[30m[103mif[m[38;5;224m([mndim[93m==[m[95m1[m[38;5;224m){[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
[38;5;224m}[m [93melse[m [30m[103mif[m [38;5;224m([mndim[93m==[m[95m2[m[38;5;224m){[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m5[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m5[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m6[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m6[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
[38;5;224m}[m[93melse[m [30m[103mif[m [38;5;224m([mndim[93m==[m[95m3[m[38;5;224m){[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m11[m[38;5;224m:[m[95m20[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m11[m[38;5;224m:[m[95m20[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a3'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m21[m[38;5;224m:[m[95m30[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a3'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m21[m[38;5;224m:[m[95m30[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
[38;5;224m}[m[76;253H189,33[8C87%"fitscript.R" 248L, 8758C[38;33H[?25h[?25l[76;243H~@k[38;33H[76;243H   [37;33H[38;17H[38;5;224m([15C)[m[76;255H8[37;33H[?25h[?25l[76;243H~@k[37;33H[76;243H   [36;1H[76;255H7,0-1[36;1H[?25h[?25l[76;255H6,33 [35;33H[?25h[?25l[76;255H5[34;33H[?25h[?25l[76;255H4[33;33H[?25h[?25l[76;243H~@k[33;33H[76;243H   [32;33H[76;255H3[32;33H[?25h[?25l[76;255H2,1 [31;1H[?25h[?25l[28;27H[38;5;224m[46m{[30;7H}[m[76;255H1,7[30;7H[?25h[?25l[28;27H[38;5;224m{[m[29;33H[38;5;224m[46m([24C)[m[30;7H[38;5;224m}[m[76;255H0,33[29;33H[?25h[?25l[28;27H[38;5;224m[46m{[m[29;33H[38;5;224m([24C)[m[30;7H[38;5;224m[46m}[m[76;254H79,27[28;27H[?25h[?25l[76;243H~@k[28;27H[76;243H   [27;7H[25;27H[38;5;224m[46m{[27;7H}[m[28;27H[38;5;224m{[30;7H}[m[76;255H8,7 [27;7H[?25h[?25l[25;27H[38;5;224m{[m[26;33H[38;5;224m[46m([24C)[m[27;7H[38;5;224m}[m[76;255H7,33[26;33H[?25h[?25l[25;27H[38;5;224m[46m{[m[26;33H[38;5;224m([24C)[m[27;7H[38;5;224m[46m}[m[76;255H6,27[25;27H[?25h[?25l[38;5;224m{[27;7H}[m[76;255H5,33[24;33H[?25h[?25l[76;255H4,6 [23;6H[?25h[?25l[76;243H~@k[23;6H[76;243H   [22;33H[76;255H3,33[22;33H[?25h[?25l[76;255H2[21;33H[?25h[?25l[76;255H1[20;33H[?25h[?25l[76;255H0,6 [19;6H[?25h[?25l[76;243H~@k[19;6H[76;243H   [18;27H[38;5;224m[46m([mfit[38;5;224m[46m)[m[76;254H69,27[18;27H[?25h[?25l[76;243H~@k[18;27H[76;243H   [17;33H[18;23H[38;5;224m([mfit[38;5;224m)[m[76;255H8,33[17;33H[?25h[?25l[76;255H7[16;33H[?25h[?25l[76;255H6[15;33H[?25h[?25l[76;243H~@k[15;33H[76;243H   [14;23H[76;255H5,2[14;23H[?25h[?25l[76;255H4,3[13;33H[?25h[?25l[76;255H3,17[12;17H[?25h[?25l[76;243H~@k[12;17H[76;243H   [11;6H[76;255H2,6 [11;6H[?25h[?25l[76;243H~@k[11;6H[76;243H   [10;7H[7;27H[38;5;224m[46m{[10;7H}[m[76;255H1,7[10;7H[?25h[?25l[76;243H~@k[10;7H[76;243H   [9;33H[7;27H[38;5;224m{[10;7H}[m[76;255H0,33[9;33H[?25h[?25l[76;243H~@k[9;33H[76;243H   [10;7H[7;27H[38;5;224m[46m{[10;7H}[m[76;255H1,7 [10;7H[?25h[?25l[7;27H[38;5;224m{[10;7H}[m[76;255H0,33[9;33H[?25h[?25l[76;254H59[8;33H[?25h[?25l[7;27H[38;5;224m[46m{[10;7H}[m[76;255H8,27[7;27H[?25h[?25l[76;243H~@k[7;27H[76;243H   [6;31H[7;27H[38;5;224m{[10;7H}[m[76;255H7,31[6;31H[?25h[?25l[7;27H[38;5;224m[46m{[10;7H}[m[76;255H8,27[7;27H[?25h[?25l[38;5;224m{[10;7H}[m[76;255H9,33[8;33H[?25h[?25l[76;254H60[9;33H[?25h[?25l[7;27H[38;5;224m[46m{[10;7H}[m[76;255H1,7 [10;7H[?25h[?25l[76;243H~@k[10;7H[76;243H   [11;6H[7;27H[38;5;224m{[10;7H}[m[76;255H2,6[11;6H[?25h[?25l[76;255H3,17[12;17H[?25h[?25l[76;255H4,33[13;33H[?25h[?25l[76;255H5,2[14;23H[?25h[?25l[76;243H~@k[14;23H[76;243H   [15;33H[76;255H6,3[15;33H[?25h[?25l[76;255H7[16;33H[?25h[?25l[76;255H8[17;33H[?25h[?25l[18;23H[38;5;224m[46m([mfit[38;5;224m[46m)[m[76;255H9,27[18;27H[?25h[?25l[38;5;224m([mfit[38;5;224m)[m[76;254H70,6 [19;6H[?25h[?25l[76;255H1,33[20;33H[?25h[?25l[76;243H~@k[20;33H[76;243H   [21;33H[76;255H2[21;33H[?25h[?25l[76;255H3[22;33H[?25h[?25l[76;243H~@k[22;33H[76;243H   [23;6H[76;255H4,6 [23;6H[?25h[?25l[76;255H5,33[24;33H[?25h[?25l[25;27H[38;5;224m[46m{[27;7H}[m[76;255H6,27[25;27H[?25h[?25l[38;5;224m{[m[26;33H[38;5;224m[46m([24C)[m[27;7H[38;5;224m}[m[76;255H7,33[26;33H[?25h[?25l[76;243H~@k[26;33H[76;243H   [27;7H[25;27H[38;5;224m[46m{[m[26;33H[38;5;224m([24C)[m[27;7H[38;5;224m[46m}[m[76;255H8,7 [27;7H[?25h[?25l[76;243H~@k[27;7H[76;243H   [28;27H[25;27H[38;5;224m{[27;7H}[m[28;27H[38;5;224m[46m{[30;7H}[m[76;255H9,27[28;27H[?25h[?25l[38;5;224m{[m[29;33H[38;5;224m[46m([24C)[m[30;7H[38;5;224m}[m[76;254H80,33[29;33H[?25h[?25l[28;27H[38;5;224m[46m{[m[29;33H[38;5;224m([24C)[m[30;7H[38;5;224m[46m}[m[76;255H1,7 [30;7H[?25h[?25l[28;27H[38;5;224m{[30;7H}[m[76;255H2,1[31;1H[?25h[?25l[76;255H3,33[32;33H[?25h[?25l[76;255H4[33;33H[?25h[?25l[76;243H~@k[33;33H[76;243H   [34;33H[76;255H5[34;33H[?25h[?25l[76;255H6[35;33H[?25h[?25l[76;255H7,0-1[36;1H[?25h[?25l[76;255H8,33 [37;33H[?25h[?25l[76;243H~@k[37;33H[76;243H   [38;33H[38;17H[38;5;224m[46m([15C)[m[76;255H9[38;33H[?25h[?25l[38;17H[38;5;224m([15C)[m[39;16H[38;5;224m[46m([14C)[m[76;254H90,31[39;31H[?25h[?25l[39;16H[38;5;224m([14C)[m[40;17H[38;5;224m[46m([15C)[m[76;255H1,33[40;33H[?25h[?25l[76;243H~@k[40;33H[76;243H   [41;31H[40;17H[38;5;224m([15C)[m[41;16H[38;5;224m[46m([14C)[m[76;255H2,31[41;31H[?25h[?25l[41;16H[38;5;224m([14C)[m[42;16H[38;5;224m[46m([14C)[m[76;255H3[42;31H[?25h[?25l[42;16H[38;5;224m([14C)[m[76;255H4,6 [43;6H[?25h[?25l[76;255H5,5[44;5H[?25h[?25l[76;255H6,3[45;3H[?25h[?25l[76;255H7,33[46;33H[?25h[?25l[76;255H8,1 [47;1H[?25h[?25l[76;255H9,0-1[48;1H[?25h[?25l[76;243H~@k[48;1H[76;243H   [49;28H[76;253H200,28 [49;28H[?25h[?25l[76;243H~@k[49;28H[76;243H   [48;1H[76;253H199,0-1[48;1H[?25h[?25l[76;243H~@k[48;1H[76;243H   [47;1H[76;255H8,1  [47;1H[?25h[?25l[76;243H~@k[47;1H[76;243H   [46;33H[76;255H7,33[46;33H[?25h[?25l[76;255H6,3 [45;3H[?25h[?25l[76;255H5,5[44;5H[?25h[?25l[76;255H4,6[43;6H[?25h[?25l[76;243H~@k[43;6H[76;243H   [42;31H[42;16H[38;5;224m[46m([14C)[m[76;255H3,31[42;31H[?25h[?25l[42;16H[38;5;224m([14C)[m[76;255H4,6 [43;6H[?25h[?25l[76;255H5,5[44;5H[?25h[?25l[76;255H6,3[45;3H[?25h[?25l[76;243H~@k[45;3H[76;243H   [46;33H[76;255H7,33[46;33H[?25h[?25l[76;255H6,3 [45;3H[?25h[?25l[76;255H5,5[44;5H[?25h[?25l[76;255H4,6[43;6H[?25h[?25l[76;243H~@k[43;6H[76;243H   [42;31H[42;16H[38;5;224m[46m([14C)[m[76;255H3,31[42;31H[?25h[?25l[41;16H[38;5;224m[46m([14C)[m[42;16H[38;5;224m([14C)[m[76;255H2[41;31H[?25h[?25l[40;17H[38;5;224m[46m([15C)[m[41;16H[38;5;224m([14C)[m[76;255H1,33[40;33H[?25h[?25l[39;16H[38;5;224m[46m([14C)[m[40;17H[38;5;224m([15C)[m[76;255H0,31[39;31H[?25h[?25l[76;243H~@k[39;31H[76;243H   [38;33H[38;17H[38;5;224m[46m([15C)[m[39;16H[38;5;224m([14C)[m[76;254H89,33[38;33H[?25h[?25l[38;17H[38;5;224m([15C)[m[76;255H8[37;33H[?25h[?25l[76;255H7,0-1[36;1H[?25h[?25l[76;255H6,33 [35;33H[?25h[?25l[76;243H~@k[35;33H[76;243H   [34;33H[76;255H5[34;33H[?25h[?25l[76;255H4[33;33H[?25h[?25l[76;255H3[32;33H[?25h[?25l[76;243H~@k[32;33H[76;243H   [31;1H[76;255H2,1 [31;1H[?25h[?25l[28;27H[38;5;224m[46m{[30;7H}[m[76;255H1,7[30;7H[?25h[?25l[28;27H[38;5;224m{[m[29;33H[38;5;224m[46m([24C)[m[30;7H[38;5;224m}[m[76;255H0,33[29;33H[?25h[?25l[28;27H[38;5;224m[46m{[m[29;33H[38;5;224m([24C)[m[30;7H[38;5;224m[46m}[m[76;254H79,27[28;27H[?25h[?25l[25;27H[38;5;224m[46m{[27;7H}[m[28;27H[38;5;224m{[30;7H}[m[76;255H8,7 [27;7H[?25h[?25l[25;27H[38;5;224m{[m[26;33H[38;5;224m[46m([24C)[m[27;7H[38;5;224m}[m[76;255H7,33[26;33H[?25h[?25l[76;243H~@k[26;33H[76;243H   [25;27H[38;5;224m[46m{[m[26;33H[38;5;224m([24C)[m[27;7H[38;5;224m[46m}[m[76;255H6,27[25;27H[?25h[?25l[38;5;224m{[27;7H}[m[76;255H5,33[24;33H[?25h[?25l[76;243H~@k[24;33H[76;243H   [23;6H[76;255H4,6 [23;6H[?25h[?25l[76;255H3,33[22;33H[?25h[?25l[76;255H2[21;33H[?25h[?25l[76;255H1[20;33H[?25h[?25l[76;255H0,6 [19;6H[?25h[?25l[76;243H~@k[19;6H[76;243H   [18;27H[38;5;224m[46m([mfit[38;5;224m[46m)[m[76;254H69,27[18;27H[?25h[?25l[38;5;224m([mfit[38;5;224m)[m[76;254H70,6 [19;6H[?25h[?25l[76;243H~@k[19;6H[76;243H   [20;33H[76;255H1,33[20;33H[?25h[?25l[76;255H2[21;33H[?25h[?25l[76;255H3[22;33H[?25h[?25l[76;243H~@k[22;33H[76;243H   [23;6H[76;255H4,6 [23;6H[?25h[?25l[76;255H5,33[24;33H[?25h[?25l[25;27H[38;5;224m[46m{[27;7H}[m[76;255H6,27[25;27H[?25h[?25l[38;5;224m{[m[26;33H[38;5;224m[46m([24C)[m[27;7H[38;5;224m}[m[76;255H7,33[26;33H[?25h[?25l[25;27H[38;5;224m[46m{[m[26;33H[38;5;224m([24C)[m[27;7H[38;5;224m[46m}[m[76;255H8,7 [27;7H[?25h[?25l[25;27H[38;5;224m{[27;7H}[m[28;27H[38;5;224m[46m{[30;7H}[m[76;255H9,27[28;27H[?25h[?25l[76;243H~@k[28;27H[76;243H   [29;33H[28;27H[38;5;224m{[m[29;33H[38;5;224m[46m([24C)[m[30;7H[38;5;224m}[m[76;254H80,33[29;33H[?25h[?25l[28;27H[38;5;224m[46m{[m[29;33H[38;5;224m([24C)[m[30;7H[38;5;224m[46m}[m[76;255H1,7 [30;7H[?25h[?25l[28;27H[38;5;224m{[30;7H}[m[76;255H2,1[31;1H[?25h[?25l[76;255H3,33[32;33H[?25h[?25l[76;255H4[33;33H[?25h[?25l[76;255H5[34;33H[?25h[?25l[76;255H6[35;33H[?25h[?25l[76;243H~@k[35;33H[76;243H   [36;1H[76;255H7,0-1[36;1H[?25h[?25l[76;243H~@k[36;1H[76;243H   [37;33H[76;255H8,33 [37;33H[?25h[?25l[38;17H[38;5;224m[46m([15C)[m[76;255H9[38;33H[?25h[?25l[38;17H[38;5;224m([15C)[m[39;16H[38;5;224m[46m([14C)[m[76;254H90,31[39;31H[?25h[?25l[39;16H[38;5;224m([14C)[m[40;17H[38;5;224m[46m([15C)[m[76;255H1,33[40;33H[?25h[?25l[40;17H[38;5;224m([15C)[m[41;16H[38;5;224m[46m([14C)[m[76;255H2,31[41;31H[?25h[?25l[41;16H[38;5;224m([14C)[m[42;16H[38;5;224m[46m([14C)[m[76;255H3[42;31H[?25h[?25l[42;16H[38;5;224m([14C)[m[76;255H4,6 [43;6H[?25h[?25l[76;243H~@k[43;6H[76;243H   [44;5H[76;255H5,5[44;5H[?25h[?25l[76;255H6,3[45;3H[?25h[?25l[76;255H7,33[46;33H[?25h[?25l[76;255H8,1 [47;1H[?25h[?25l[76;255H9,0-1[48;1H[?25h[?25l[76;253H200,28 [49;28H[?25h[?25l[76;255H1,33[50;33H[?25h[?25l[76;255H2,0-1[51;1H[?25h[?25l[76;243H~@k[51;1H[76;243H   [52;28H[76;255H3,28 [52;28H[?25h[?25l[76;243H~@k[52;28H[76;243H   [51;1H[76;255H2,0-1[51;1H[?25h[?25l[76;243H~@k[51;1H[76;243H   [50;33H[76;255H1,33 [50;33H[?25h[?25l[76;255H0,28[49;28H[?25h[?25l[76;253H199,0-1[48;1H[?25h[?25l[76;255H8,1  [47;1H[?25h[?25l[76;243H~@k[47;1H[76;243H   [46;33H[76;255H7,33[46;33H[?25h[?25l[76;255H6,3 [45;3H[?25h[?25l[76;255H5,5[44;5H[?25h[?25l[76;255H4,6[43;6H[?25h[?25l[42;16H[38;5;224m[46m([14C)[m[76;255H3,31[42;31H[?25h[?25l[76;243H~@k[42;31H[76;243H   [41;31H[41;16H[38;5;224m[46m([14C)[m[42;16H[38;5;224m([14C)[m[76;255H2[41;31H[?25h[?25l[40;17H[38;5;224m[46m([15C)[m[41;16H[38;5;224m([14C)[m[76;255H1,33[40;33H[?25h[?25l[39;16H[38;5;224m[46m([14C)[m[40;17H[38;5;224m([15C)[m[76;255H0,31[39;31H[?25h[?25l[38;17H[38;5;224m[46m([15C)[m[39;16H[38;5;224m([14C)[m[76;254H89,33[38;33H[?25h[?25l[38;17H[38;5;224m([15C)[m[76;255H8[37;33H[?25h[?25l[76;255H7,0-1[36;1H[?25h[?25l[76;243H~@k[36;1H[76;243H   [35;33H[76;255H6,33 [35;33H[?25h[?25l[76;255H5[34;33H[?25h[?25l[76;255H4[33;33H[?25h[?25l[76;243H~@k[33;33H[76;243H   [32;33H[76;255H3[32;33H[?25h[?25l[76;255H2,1 [31;1H[?25h[?25l[28;27H[38;5;224m[46m{[30;7H}[m[76;255H1,7[30;7H[?25h[?25l[28;27H[38;5;224m{[m[29;33H[38;5;224m[46m([24C)[m[30;7H[38;5;224m}[m[76;255H0,33[29;33H[?25h[?25l[76;243H~@k[29;33H[76;243H   [28;27H[38;5;224m[46m{[m[29;33H[38;5;224m([24C)[m[30;7H[38;5;224m[46m}[m[76;254H79,27[28;27H[?25h[?25l[25;27H[38;5;224m[46m{[27;7H}[m[28;27H[38;5;224m{[30;7H}[m[76;255H8,7 [27;7H[?25h[?25l[25;27H[38;5;224m{[m[26;33H[38;5;224m[46m([24C)[m[27;7H[38;5;224m}[m[76;255H7,33[26;33H[?25h[?25l[25;27H[38;5;224m[46m{[m[26;33H[38;5;224m([24C)[m[27;7H[38;5;224m[46m}[m[76;255H6,27[25;27H[?25h[?25l[38;5;224m{[27;7H}[m[76;255H5,33[24;33H[?25h[?25l[76;255H4,6 [23;6H[?25h[?25l[76;255H3,33[22;33H[?25h[?25l[76;243H~@k[22;33H[76;243H   [21;33H[76;255H2[21;33H[?25h[?25l[76;243H~@k[21;33H[76;243H   [20;33H[76;255H1[20;33H[?25h[?25l[76;243H~@k[20;33H[76;243H   [19;6H[76;255H0,6 [19;6H[?25h[?25l[18;23H[38;5;224m[46m([mfit[38;5;224m[46m)[m[76;254H69,27[18;27H[?25h[?25l[38;5;224m([mfit[38;5;224m)[m[76;255H8,33[17;33H[?25h[?25l[76;255H7[16;33H[?25h[?25l[76;243H~@k[16;33H[76;243H   [15;33H[76;255H6[15;33H[?25h[?25l[76;255H5,2[14;23H[?25h[?25l[76;255H4,3[13;33H[?25h[?25l[76;255H3,17[12;17H[?25h[?25l[76;255H2,6 [11;6H[?25h[?25l[7;27H[38;5;224m[46m{[10;7H}[m[76;255H1,7[10;7H[?25h[?25l[76;243H~@k[10;7H[76;243H   [9;33H[7;27H[38;5;224m{[10;7H}[m[76;255H0,33[9;33H[?25h[?25l[76;254H59[8;33H[?25h[?25l[7;27H[38;5;224m[46m{[10;7H}[m[76;255H8,27[7;27H[?25h[?25l[38;5;224m{[10;7H}[m[76;255H7,31[6;31H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hemptyrows [93m=[m [1m[96mrowSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mncol[m[38;5;224m([mtrain[38;5;224m)[m[3;27H[38;5;224m[46m{[6;7H}[m[76;1H[K[76;253H156,7[9C86%[6;7H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[96m# [m[30m[103mif[m[96m some rows contain no responses after the leave out set, remove them from the training set, and adjust person indices accordingly[m[4;27H[38;5;224m{[7;7H}[m[76;253H[K[76;253H155,33[8C86%[6;33H[?25h[?25l[76;243H~@k[6;33H[76;243H   [6;33H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H154,33[8C85%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Htrain[38;5;224m[[mper.ind[38;5;224m,[mitem.ind[38;5;224m][m [93m<-[m [95mNA[m[6;27H[38;5;224m[46m{[9;7H}[m[76;253H[K[76;253H153,27[8C84%[6;27H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Htrain [93m<-[m data[7;27H[38;5;224m{[10;7H}[m[76;253H[K[76;253H152,33[8C84%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Htest [93m<-[m data[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m][m[76;253H[K[76;253H151,33[8C83%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[96m# create train and test folds[m[76;253H[K[76;253H150,33[8C83%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H149,6[9C82%[6;6H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hitem.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.items[93m==[mj[38;5;224m)[m[76;253H[K[76;253H148,33[8C82%[6;33H[?25h[?25l[76;243H~@k[6;33H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;7Hper.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.persons[93m==[mi[38;5;224m)[m[76;253H[K[76;253H147,19[8C81%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [6;33H[1;75r[1;1H[L[1;76r[1;7H[96m# save the persons and items that belong to the hold out test set[m[76;253H[K[76;253H146,33[8C80%[6;33H[?25h[?25l[76;243H~@k[6;33H[76;243H   [6;33H[1;75r[1;1H[L[1;76r[1;5H[38;5;224m{[m[76;253H[K[76;253H145,33[8C80%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[93mfor[m [38;5;224m([mj [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H144,6[9C79%[6;6H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[38;5;224m{[m[76;253H[K[76;253H143,33[8C79%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H142,33[8C78%[6;33H[?25h[?25l[76;243H~@k[6;33H[76;243H   [6;33H[1;75r[1;1H[L[1;76r[1;3H[96m# loop though cross validation folds[m[76;253H[K[76;253H141,33[8C78%[6;33H[?25h[?25l[76;243H~@k[6;33H[76;243H   [6;5H[1;75r[1;1H[L[1;76r[6;5H[38;5;224m[46m{[61;5H}[m[76;253H[K[76;253H140,5[9C77%[6;5H[?25h[?25l[76;243H~@k[6;5H[76;243H   [6;21H[1;75r[1;1H[L[1;76r[1;3Hacc10 [93m=[m acc20 [93m=[m f110 [93m=[m f120 [93m=[m ndcg [93m=[m [1m[96mc[m[38;5;224m()[m[6;9H[38;5;224m[46m([11C)[m
    [38;5;224m{[62;5H}[m[76;253H[K[76;253H139,21[8C76%[6;21H[?25h[?25l[76;243H~@k[6;21H[76;243H   [6;3H[1;75r[1;1H[L[1;76r[1;3Hf1s [93m=[m [1m[96mc[m[38;5;224m()[m[6;3H[38;5;224m[46m{[m[7;9H[38;5;224m([11C)[m[64;3H[38;5;224m[46m}[m[76;253H[K[76;253H138,3[9C76%[6;3H[?25h[?25l[76;243H~@k[6;3H[76;243H   [6;19H[1;75r[1;1H[L[1;76r[1;3Haccuracies [93m=[m [1m[96mc[m[38;5;224m()[m[6;7H[38;5;224m[46m([11C)[m
  [38;5;224m{[65;3H}[m[76;253H[K[76;253H137,19[8C75%[6;19H[?25h[?25l[76;243H~@k[6;19H[76;243H   [7;3H[6;7H[38;5;224m([11C)[m
  [38;5;224m[46m{[65;3H}[m[76;255H8,3 [7;3H[?25h[?25l[76;243H~@k[7;3H[76;243H   [8;21H[7;3H[38;5;224m{[m[8;9H[38;5;224m[46m([11C)[m[65;3H[38;5;224m}[m[76;255H9,21[8;21H[?25h[?25l[8;9H[38;5;224m([11C)[m
    [38;5;224m[46m{[64;5H}[m[76;254H40,5 [9;5H[?25h[?25l[38;5;224m{[64;5H}[m[76;255H1,33[10;33H[?25h[?25l[76;255H2[11;33H[?25h[?25l[76;243H~@k[11;33H[76;243H   [12;33H[76;255H3[12;33H[?25h[?25l[76;255H4,6 [13;6H[?25h[?25l[76;255H5,33[14;33H[?25h[?25l[76;255H6[15;33H[?25h[?25l[76;243H~@k[15;33H[76;243H   [16;19H[76;255H7,19[16;19H[?25h[?25l[76;243H~@k[16;19H[76;243H   [17;33H[76;255H8,33[17;33H[?25h[?25l[76;255H9,6 [18;6H[?25h[?25l[76;254H50,33[19;33H[?25h[?25l[76;243H~@k[19;33H[76;243H   [20;33H[76;255H1[20;33H[?25h[?25l[76;255H2[21;33H[?25h[?25l[22;27H[38;5;224m[46m{[25;7H}[m[76;255H3,27[22;27H[?25h[?25l[76;243H~@k[22;27H[76;243H   [23;33H[22;27H[38;5;224m{[25;7H}[m[76;255H4,33[23;33H[?25h[?25l[22;27H[38;5;224m[46m{[25;7H}[m[76;255H3,27[22;27H[?25h[?25l[76;243H~@k[22;27H[76;243H   [21;33H[22;27H[38;5;224m{[25;7H}[m[76;255H2,33[21;33H[?25h[?25l[76;255H1[20;33H[?25h[?25l[76;255H0[19;33H[?25h[?25l[76;243H~@k[19;33H[76;243H   [18;6H[76;254H49,6 [18;6H[?25h[?25l[76;255H8,33[17;33H[?25h[?25l[76;255H7,19[16;19H[?25h[?25l[76;255H6,33[15;33H[?25h[?25l[76;243H~@k[15;33H[76;243H   [14;33H[76;255H5[14;33H[?25h[?25l[76;255H4,6 [13;6H[?25h[?25l[76;243H~@k[13;6H[76;243H   [12;33H[76;255H3,33[12;33H[?25h[?25l[76;255H2[11;33H[?25h[?25l[76;255H1[10;33H[?25h[?25l[9;5H[38;5;224m[46m{[64;5H}[m[76;255H0,5 [9;5H[?25h[?25l[8;9H[38;5;224m[46m([11C)[m
    [38;5;224m{[64;5H}[m[76;254H39,21[8;21H[?25h[?25l[7;3H[38;5;224m[46m{[m[8;9H[38;5;224m([11C)[m[65;3H[38;5;224m[46m}[m[76;255H8,3 [7;3H[?25h[?25l[6;7H[38;5;224m[46m([11C)[m
  [38;5;224m{[65;3H}[m[76;255H7,19[6;19H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hbiases [93m=[m [1m[96mc[m[38;5;224m()[7;7H([11C)[m[76;253H[K[76;253H136,33[8C75%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hrmses [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H135,2[9C74%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H134,33[8C73%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hfolds.items [93m<-[m [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mncol[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m2[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[6;10H[38;5;224m[46m()[m[76;253H[K[76;253H133,11[8C73%[6;11H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hfolds.persons [93m<-[m  [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mnrow[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m1[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[6;17H[38;5;224m[46m()[m[7;10H[38;5;224m()[m[76;253H[K[76;253H132,18[8C72%[6;18H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[96m# calculate to which fold each person and item belongs[m[6;13H[38;5;224m[46m()[m[7;17H[38;5;224m()[m[76;253H[K[76;253H131,14[8C72%[6;14H[?25h[?25l[1;75r[1;1H[L[1;76r[6;12H[38;5;224m[46m()[m[7;13H[38;5;224m()[m[76;253H[K[76;253H130,13[8C71%[6;13H[?25h[?25l[76;243H~@k[6;13H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;1H[38;5;224m{[7;12H()[m[76;253H[K[76;253H129,0-1[7C71%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hpars[38;5;224m)[m[10C[96m# parameters object from mirt[m[76;253H[K[76;253H128,33[8C70%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Htheta_true[38;5;224m,[m    [96m# true parameter values[m[76;253H[K[76;253H127,33[8C69%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hd_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H126,33[8C69%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Ha_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H125,2[9C68%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hlambda[38;5;224m,[m[8C[96m# l1 and l2 penalty[m[76;253H[K[76;253H124,1[9C68%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hk [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m    [96m# number of folds for 2d cross validation[m[76;253H[K[76;253H123,33[8C67%[6;33H[?25h[?25l[76;243H~@k[6;33H[76;243H   [6;33H[1;75r[1;1H[L[1;76r[1;21Hrandompars[38;5;224m,[m    [96m# mirt argument for whether to use random paramters values[m[76;253H[K[76;253H122,33[8C67%[6;33H[?25h[?25l[76;243H~@k[6;33H[76;243H   [6;33H[1;75r[1;1H[L[1;76r[1;21Hmethod[38;5;224m,[m[8C[96m# method of esitmation, e.g. EM[m[76;253H[K[76;253H121,33[8C66%[6;33H[?25h[?25l[76;243H~@k[6;33H[76;243H   [7;33H[76;255H2[7;33H[?25h[?25l[76;243H~@k[7;33H[76;243H   [8;33H[76;255H3[8;33H[?25h[?25l[76;255H4,1 [9;1H[?25h[?25l[76;255H5,2[10;2H[?25h[?25l[76;243H~@k[10;2H[76;243H   [11;33H[76;255H6,33[11;33H[?25h[?25l[76;255H7[12;33H[?25h[?25l[76;255H8[13;33H[?25h[?25l[76;243H~@k[13;33H[76;243H   [14;1H[76;255H9,0-1[14;1H[?25h[?25l[76;243H~@k[14;1H[76;243H   [15;13H[38;5;224m[46m()[m[76;254H30,13 [15;13H[?25h[?25l[76;243H~@k[15;13H[76;243H   [16;14H[15;12H[38;5;224m()[m[16;13H[38;5;224m[46m()[m[76;255H1,14[16;14H[?25h[?25l[38;5;224m()[m[17;17H[38;5;224m[46m()[m[76;255H2,18[17;18H[?25h[?25l[38;5;224m()[m[18;10H[38;5;224m[46m()[m[76;255H3,11[18;11H[?25h[?25l[38;5;224m()[m[76;255H4,33[19;33H[?25h[?25l[76;243H~@k[19;33H[76;243H   [20;2H[76;255H5,2 [20;2H[?25h[?25l[76;255H6,33[21;33H[?25h[?25l[22;7H[38;5;224m[46m([11C)[m[76;255H7,19[22;19H[?25h[?25l[22;7H[38;5;224m([11C)[m[76;255H8,3 [23;3H[?25h[?25l[24;9H[38;5;224m[46m([11C)[m[76;255H9,21[24;21H[?25h[?25l[24;9H[38;5;224m([11C)[m[76;254H40,5 [25;5H[?25h[?25l[76;243H~@k[25;5H[76;243H   [26;33H[76;255H1,33[26;33H[?25h[?25l[76;255H2[27;33H[?25h[?25l[76;255H3[28;33H[?25h[?25l[76;255H4,6 [29;6H[?25h[?25l[76;255H5,33[30;33H[?25h[?25l[76;255H6[31;33H[?25h[?25l[76;243H~@k[31;33H[76;243H   [32;19H[76;255H7,19[32;19H[?25h[?25l[76;243H~@k[32;19H[76;243H   [33;33H[76;255H8,33[33;33H[?25h[?25l[76;243H~@k[33;33H[76;243H   [34;6H[76;255H9,6 [34;6H[?25h[?25l[76;254H50,33[35;33H[?25h[?25l[76;255H1[36;33H[?25h[?25l[76;255H2[37;33H[?25h[?25l[76;243H~@k[37;33H[76;243H   [38;27H[38;5;224m[46m{[41;7H}[m[76;255H3,27[38;27H[?25h[?25l[38;5;224m{[41;7H}[m[76;255H4,33[39;33H[?25h[?25l[76;255H5[40;33H[?25h[?25l[38;27H[38;5;224m[46m{[41;7H}[m[76;255H6,7 [41;7H[?25h[?25l[38;27H[38;5;224m{[41;7H}[m[76;255H7,31[42;31H[?25h[?25l[76;243H~@k[42;31H[76;243H   [43;27H[38;5;224m[46m{[46;7H}[m[76;255H8,27[43;27H[?25h[?25l[38;5;224m{[46;7H}[m[76;255H9,33[44;33H[?25h[?25l[76;254H60[45;33H[?25h[?25l[43;27H[38;5;224m[46m{[46;7H}[m[76;255H1,7 [46;7H[?25h[?25l[43;27H[38;5;224m{[46;7H}[m[76;255H2,6[47;6H[?25h[?25l[76;243H~@k[47;6H[76;243H   [48;17H[76;255H3,17[48;17H[?25h[?25l[76;243H~@k[48;17H[76;243H   [49;33H[76;255H4,33[49;33H[?25h[?25l[76;243H~@k[49;33H[76;243H   [50;23H[76;255H5,2[50;23H[?25h[?25l[76;255H6,3[51;33H[?25h[?25l[76;255H7[52;33H[?25h[?25l[76;243H~@k[52;33H[76;243H   [53;33H[76;255H8[53;33H[?25h[?25l[54;23H[38;5;224m[46m([mfit[38;5;224m[46m)[m[76;255H9,27[54;27H[?25h[?25l[38;5;224m([mfit[38;5;224m)[m[76;254H70,6 [55;6H[?25h[?25l[76;255H1,33[56;33H[?25h[?25l[76;243H~@k[56;33H[76;243H   [57;33H[76;255H2[57;33H[?25h[?25l[76;243H~@k[57;33H[76;243H   [58;33H[76;255H3[58;33H[?25h[?25l[76;243H~@k[58;33H[76;243H   [59;6H[76;255H4,6 [59;6H[?25h[?25l[76;255H5,33[60;33H[?25h[?25l[61;27H[38;5;224m[46m{[63;7H}[m[76;255H6,27[61;27H[?25h[?25l[76;243H~@k[61;27H[76;243H   [62;33H[61;27H[38;5;224m{[m[62;33H[38;5;224m[46m([24C)[m[63;7H[38;5;224m}[m[76;255H7,33[62;33H[?25h[?25l[61;27H[38;5;224m[46m{[m[62;33H[38;5;224m([24C)[m[63;7H[38;5;224m[46m}[m[76;255H8,7 [63;7H[?25h[?25l[61;27H[38;5;224m{[63;7H}[m[64;27H[38;5;224m[46m{[66;7H}[m[76;255H9,27[64;27H[?25h[?25l[38;5;224m{[m[65;33H[38;5;224m[46m([24C)[m[66;7H[38;5;224m}[m[76;254H80,33[65;33H[?25h[?25l[64;27H[38;5;224m[46m{[m[65;33H[38;5;224m([24C)[m[66;7H[38;5;224m[46m}[m[76;255H1,7 [66;7H[?25h[?25l[76;243H~@k[66;7H[76;243H   [67;1H[64;27H[38;5;224m{[66;7H}[m[76;255H2,1[67;1H[?25h[?25l[76;255H3,33[68;33H[?25h[?25l[76;255H4[69;33H[?25h[?25l[76;255H5[70;33H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hacc20 [93m<-[m [1m[96mc[m[38;5;224m([macc20[38;5;224m,[m top20[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H186,33[8C67%[70;33H[?25h[?25l[76;243H~@k[70;33H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;7Hf120 [93m<-[m [1m[96mc[m[38;5;224m([mf120[38;5;224m,[m top20[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H187,0-1[7C67%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;33H[1;75r[75;1H
[1;76r[75;7Hndcg [93m<-[m [1m[96mc[m[38;5;224m([mndcg[38;5;224m,[m top10[38;5;224m[[m[95m3[m[38;5;224m])[m[76;253H[K[76;253H188,33[8C68%[70;33H[?25h[?25l[76;243H~@k[70;33H[76;243H   [70;33H[1;75r[75;1H
[1;76r[70;17H[38;5;224m[46m([15C)[m[76;253H[K[76;253H189,33[8C68%[70;33H[?25h[?25l[1;75r[75;1H
[1;76r[69;17H[38;5;224m([15C)[m[70;16H[38;5;224m[46m([14C)[m[75;5H[38;5;224m}[m[76;253H[K[76;253H190,31[8C69%[70;31H[?25h[?25l[76;243H~@k[70;31H[76;243H   [70;33H[1;75r[75;1H
[1;76r[69;16H[38;5;224m([14C)[m[70;17H[38;5;224m[46m([15C)[m[75;3H[38;5;224m}[m[76;253H[K[76;253H191,33[8C69%[70;33H[?25h[?25l[76;243H~@k[70;33H[76;243H   [69;31H[69;16H[38;5;224m[46m([14C)[m[70;17H[38;5;224m([15C)[m[76;255H0,31[69;31H[?25h[?25l[76;243H~@k[69;31H[76;243H   [68;33H[68;17H[38;5;224m[46m([15C)[m[69;16H[38;5;224m([14C)[m[76;254H89,33[68;33H[?25h[?25l[68;17H[38;5;224m([15C)[m[76;255H8[67;33H[?25h[?25l[76;255H7,0-1[66;1H[?25h[?25l[76;243H~@k[66;1H[76;243H   [65;33H[76;255H6,33 [65;33H[?25h[?25l[76;255H5[64;33H[?25h[?25l[76;255H4[63;33H[?25h[?25l[76;255H3[62;33H[?25h[?25l[76;243H~@k[62;33H[76;243H   [61;1H[76;255H2,1 [61;1H[?25h[?25l[76;243H~@k[61;1H[76;243H   [60;7H[58;27H[38;5;224m[46m{[60;7H}[m[76;255H1,7[60;7H[?25h[?25l[58;27H[38;5;224m{[m[59;33H[38;5;224m[46m([24C)[m[60;7H[38;5;224m}[m[76;255H0,33[59;33H[?25h[?25l[58;27H[38;5;224m[46m{[m[59;33H[38;5;224m([24C)[m[60;7H[38;5;224m[46m}[m[76;254H79,27[58;27H[?25h[?25l[55;27H[38;5;224m[46m{[57;7H}[m[58;27H[38;5;224m{[60;7H}[m[76;255H8,7 [57;7H[?25h[?25l[55;27H[38;5;224m{[m[56;33H[38;5;224m[46m([24C)[m[57;7H[38;5;224m}[m[76;255H7,33[56;33H[?25h[?25l[55;27H[38;5;224m[46m{[m[56;33H[38;5;224m([24C)[m[57;7H[38;5;224m[46m}[m[76;255H6,27[55;27H[?25h[?25l[76;243H~@k[55;27H[76;243H   [54;33H[55;27H[38;5;224m{[57;7H}[m[76;255H5,33[54;33H[?25h[?25l[76;255H4,6 [53;6H[?25h[?25l[76;255H3,33[52;33H[?25h[?25l[76;243H~@k[52;33H[76;243H   [51;33H[76;255H2[51;33H[?25h[?25l[76;255H1[50;33H[?25h[?25l[76;255H0,6 [49;6H[?25h[?25l[76;243H~@k[49;6H[76;243H   [48;27H[38;5;224m[46m([mfit[38;5;224m[46m)[m[76;254H69,27[48;27H[?25h[?25l[38;5;224m([mfit[38;5;224m)[m[76;255H8,33[47;33H[?25h[?25l[76;255H7[46;33H[?25h[?25l[76;243H~@k[46;33H[76;243H   [45;33H[76;255H6[45;33H[?25h[?25l[76;255H5,2[44;23H[?25h[?25l[76;255H4,3[43;33H[?25h[?25l[76;255H3,17[42;17H[?25h[?25l[76;243H~@k[42;17H[76;243H   [41;6H[76;255H2,6 [41;6H[?25h[?25l[76;243H~@k[41;6H[76;243H   [40;7H[37;27H[38;5;224m[46m{[40;7H}[m[76;255H1,7[40;7H[?25h[?25l[76;243H~@k[40;7H[76;243H   [39;33H[37;27H[38;5;224m{[40;7H}[m[76;255H0,33[39;33H[?25h[?25l[76;254H59[38;33H[?25h[?25l[37;27H[38;5;224m[46m{[40;7H}[m[76;255H8,27[37;27H[?25h[?25l[38;5;224m{[40;7H}[m[76;255H7,31[36;31H[?25h[?25l[76;243H~@k[36;31H[76;243H   [35;7H[32;27H[38;5;224m[46m{[35;7H}[m[76;255H6,7 [35;7H[?25h[?25l[32;27H[38;5;224m{[35;7H}[m[76;255H5,33[34;33H[?25h[?25l[76;255H4[33;33H[?25h[?25l[32;27H[38;5;224m[46m{[35;7H}[m[76;255H3,27[32;27H[?25h[?25l[38;5;224m{[35;7H}[m[76;255H2,33[31;33H[?25h[?25l[76;243H~@k[31;33H[76;243H   [30;33H[76;255H1[30;33H[?25h[?25l[76;255H0[29;33H[?25h[?25l[76;254H49,6 [28;6H[?25h[?25l[76;243H~@k[28;6H[76;243H   [27;33H[76;255H8,33[27;33H[?25h[?25l[76;255H7,19[26;19H[?25h[?25l[76;255H6,33[25;33H[?25h[?25l[76;243H~@k[25;33H[76;243H   [24;33H[76;255H5[24;33H[?25h[?25l[76;255H4,6 [23;6H[?25h[?25l[76;255H3,33[22;33H[?25h[?25l[76;243H~@k[22;33H[76;243H   [21;33H[76;255H2[21;33H[?25h[?25l[76;255H1[20;33H[?25h[?25l[19;5H[38;5;224m[46m{[74;5H}[m[76;255H0,5 [19;5H[?25h[?25l[18;9H[38;5;224m[46m([11C)[m
    [38;5;224m{[74;5H}[m[76;254H39,21[18;21H[?25h[?25l[17;3H[38;5;224m[46m{[m[18;9H[38;5;224m([11C)[m[75;3H[38;5;224m[46m}[m[76;255H8,3 [17;3H[?25h[?25l[16;7H[38;5;224m[46m([11C)[m
  [38;5;224m{[75;3H}[m[76;255H7,19[16;19H[?25h[?25l[16;7H[38;5;224m([11C)[m[76;255H6,33[15;33H[?25h[?25l[76;255H5,2 [14;2H[?25h[?25l[76;255H4,33[13;33H[?25h[?25l[12;10H[38;5;224m[46m()[m[76;255H3,11[12;11H[?25h[?25l[11;17H[38;5;224m[46m()[m[12;10H[38;5;224m()[m[76;255H2,18[11;18H[?25h[?25l[76;243H~@k[11;18H[76;243H   [10;14H[38;5;224m[46m()[m[11;17H[38;5;224m()[m[76;255H1,14[10;14H[?25h[?25l[9;12H[38;5;224m[46m()[m[10;13H[38;5;224m()[m[76;255H0,13[9;13H[?25h[?25l[38;5;224m()[m[76;254H29,0-1[8;1H[?25h[?25l[76;255H8,33 [7;33H[?25h[?25l[76;255H7[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hd_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H126,33[8C69%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Ha_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H125,2[9C68%[6;2H[?25h[?25l[76;243H~@k[6;2H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;21Hlambda[38;5;224m,[m[8C[96m# l1 and l2 penalty[m[76;253H[K[76;253H124,1[9C68%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;33H[1;75r[1;1H[L[1;76r[1;21Hk [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m    [96m# number of folds for 2d cross validation[m[76;253H[K[76;253H123,33[8C67%[6;33H[?25h[?25l[76;243H~@k[6;33H[76;243H   [6;33H[1;75r[1;1H[L[1;76r[1;21Hrandompars[38;5;224m,[m    [96m# mirt argument for whether to use random paramters values[m[76;253H[K[76;253H122,33[8C67%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hmethod[38;5;224m,[m[8C[96m# method of esitmation, e.g. EM[m[76;253H[K[76;253H121,33[8C66%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hmodel[38;5;224m,[m[9C[96m# model to be passed to mirt, can be number of dimensions[m[76;253H[K[76;253H120,33[8C65%[6;33H[?25h[?25l[76;243H~@k[6;33H[76;243H   [6;33H[1;75r[1;1H[L[1;76r[1;1Hcv.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([mdata[38;5;224m,[m[10C[96m# matrix of responses[m[76;253H[K[76;253H119,33[8C65%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# Function that fits rgmirt model using cross validation and returns the average RMSE and average bias[m[76;253H[K[76;253H118,33[8C64%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H117,33[8C64%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H116,33[8C63%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[m[76;253H[K[76;253H115,33[8C63%[6;33H[?25h[?25l[76;243H~@k[6;33H[76;243H   [6;33H[1;75r[1;1H[L[1;76r[1;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([mavg_topn_accuracy[38;5;224m,[m avg_topn_f1_score[38;5;224m,[m avg_ndcg[38;5;224m))[m[76;253H[K[76;253H114,33[8C62%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H113,33[8C61%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Havg_ndcg [93m<-[m [1m[96mmean[m[38;5;224m([mndcgs[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H112,0-1[7C61%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;3Havg_topn_f1_score [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_f1_scores[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H111,0-1[7C60%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Havg_topn_accuracy [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_accuracies[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H110,1[9C60%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[96m# Calculate the average top-n accuracy and top-n F1 score across all users[m[76;253H[K[76;253H109,33[8C59%[6;33H[?25h[?25l[76;243H~@k[6;33H[76;243H   [6;2H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H108,2[9C58%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[38;5;224m}[m[76;253H[K[76;253H107,33[8C58%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hndcgs[38;5;224m[[mi[38;5;224m][m [93m<-[m ndcg[76;253H[K[76;253H106,33[8C57%[6;33H[?25h[?25l[76;243H~@k[6;33H[76;243H   [6;33H[1;75r[1;1H[L[1;76r[1;5Htopn_f1_scores[38;5;224m[[mi[38;5;224m][m [93m<-[m f1_score[76;253H[K[76;253H105,33[8C57%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htopn_accuracies[38;5;224m[[mi[38;5;224m][m [93m<-[m topn_accuracy[76;253H[K[76;253H104,33[8C56%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H103,2[9C56%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hndcg [93m=[m [1m[96mNDCG[m[38;5;224m([mordered_true_probabilities[38;5;224m)[m[76;253H[K[76;253H102,3[9C55%[6;3H[?25h[?25l[76;243H~@k[6;3H[76;243H   [6;20H[1;75r[1;1H[L[1;76r[1;5Hordered_true_probabilities [93m=[m p_true[38;5;224m[[mi[38;5;224m,[m indices[38;5;224m][m[76;253H[K[76;253H101,20[8C54%[6;20H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H100,33[8C54%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hf1_score [93m<-[m [95m2[m [93m*[m precision [93m*[m recall [93m/[m [38;5;224m([mprecision [93m+[m recall[38;5;224m)[m[76;253H[K[76;253H99,33[9C53%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H98,4[10C53%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hrecall [93m<-[m true_positives [93m/[m actual_positives[76;253H[K[76;253H97,33[9C52%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hprecision [93m<-[m true_positives [93m/[m n[76;253H[K[76;253H96,33[9C52%[6;33H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H95,4[10C51%[6;4H[?25h[?25l[76;243H~@k[6;4H[76;243H   [6;33H[1;75r[1;1H[L[1;76r[1;5Hactual_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_response[38;5;224m[[mtopn_indices[38;5;224m])[m[76;253H[K[76;253H94,33[9C50%[6;33H[?25h[?25l[76;243H~@k[6;33H[76;243H   [7;4H[76;254H5,4 [7;4H[?25h[?25l[76;243H~@k[7;4H[76;243H   [8;33H[76;254H6,33[8;33H[?25h[?25l[76;254H7[9;33H[?25h[?25l[76;243H~@k[9;33H[76;243H   [10;4H[76;254H8,4 [10;4H[?25h[?25l[76;254H9,33[11;33H[?25h[?25l[76;253H100,33[12;33H[?25h[?25l[76;255H1,20[13;20H[?25h[?25l[76;243H~@k[13;20H[76;243H   [14;3H[76;255H2,3 [14;3H[?25h[?25l[76;255H3,2[15;2H[?25h[?25l[76;255H4,33[16;33H[?25h[?25l[76;243H~@k[16;33H[76;243H   [17;33H[76;255H5[17;33H[?25h[?25l[76;255H6[18;33H[?25h[?25l[76;243H~@k[18;33H[76;243H   [19;33H[76;255H7[19;33H[?25h[?25l[76;255H8,2 [20;2H[?25h[?25l[76;255H9,33[21;33H[?25h[?25l[76;243H~@k[21;33H[76;243H   [22;1H[76;254H10,1 [22;1H[?25h[?25l[76;255H1,0-1[23;1H[?25h[?25l[76;255H2[24;1H[?25h[?25l[76;243H~@k[24;1H[76;243H   [25;33H[76;255H3,33 [25;33H[?25h[?25l[76;255H4[26;33H[?25h[?25l[76;255H5[27;33H[?25h[?25l[76;255H6[28;33H[?25h[?25l[76;243H~@k[28;33H[76;243H   [29;33H[76;255H7[29;33H[?25h[?25l[76;255H8[30;33H[?25h[?25l[76;243H~@k[30;33H[76;243H   [31;33H[76;255H9[31;33H[?25h[?25l[76;254H20[32;33H[?25h[?25l[76;255H1[33;33H[?25h[?25l[76;243H~@k[33;33H[76;243H   [34;33H[76;255H2[34;33H[?25h[?25l[76;255H3[35;33H[?25h[?25l[76;255H4,1 [36;1H[?25h[?25l[76;255H5,2[37;2H[?25h[?25l[76;243H~@k[37;2H[76;243H   [38;33H[76;255H6,33[38;33H[?25h[?25l[76;243H~@k[38;33H[76;243H   [39;33H[76;255H7[39;33H[?25h[?25l[76;255H8[40;33H[?25h[?25l[76;243H~@k[40;33H[76;243H   [41;1H[76;255H9,0-1[41;1H[?25h[?25l[42;12H[38;5;224m[46m()[m[76;254H30,13 [42;13H[?25h[?25l[38;5;224m()[m[43;13H[38;5;224m[46m()[m[76;255H1,14[43;14H[?25h[?25l[38;5;224m()[m[44;17H[38;5;224m[46m()[m[76;255H2,18[44;18H[?25h[?25l[76;243H~@k[44;18H[76;243H   [45;11H[44;17H[38;5;224m()[m[45;10H[38;5;224m[46m()[m[76;255H3,11[45;11H[?25h[?25l[38;5;224m()[m[76;255H4,33[46;33H[?25h[?25l[76;255H5,2 [47;2H[?25h[?25l[76;243H~@k[47;2H[76;243H   [48;33H[76;255H6,33[48;33H[?25h[?25l[49;7H[38;5;224m[46m([11C)[m[76;255H7,19[49;19H[?25h[?25l[49;7H[38;5;224m([11C)[m[76;255H8,3 [50;3H[?25h[?25l[76;243H~@k[50;3H[76;243H   [51;21H[51;9H[38;5;224m[46m([11C)[m[76;255H9,21[51;21H[?25h[?25l[51;9H[38;5;224m([11C)[m[76;254H40,5 [52;5H[?25h[?25l[76;255H1,33[53;33H[?25h[?25l[76;255H2[54;33H[?25h[?25l[76;255H3[55;33H[?25h[?25l[76;255H4,6 [56;6H[?25h[?25l[76;243H~@k[56;6H[76;243H   [57;33H[76;255H5,33[57;33H[?25h[?25l[76;255H6[58;33H[?25h[?25l[76;255H7,19[59;19H[?25h[?25l[76;243H~@k[59;19H[76;243H   [60;33H[76;255H8,33[60;33H[?25h[?25l[76;255H9,6 [61;6H[?25h[?25l[76;254H50,33[62;33H[?25h[?25l[76;255H1[63;33H[?25h[?25l[76;243H~@k[63;33H[76;243H   [64;33H[76;255H2[64;33H[?25h[?25l[65;27H[38;5;224m[46m{[68;7H}[m[76;255H3,27[65;27H[?25h[?25l[38;5;224m{[68;7H}[m[76;255H4,33[66;33H[?25h[?25l[76;255H5[67;33H[?25h[?25l[65;27H[38;5;224m[46m{[68;7H}[m[76;255H6,7 [68;7H[?25h[?25l[65;27H[38;5;224m{[68;7H}[m[76;255H7,31[69;31H[?25h[?25l[70;27H[38;5;224m[46m{[73;7H}[m[76;255H8,27[70;27H[?25h[?25l[76;243H~@k[70;27H[76;243H   [70;33H[1;75r[75;1H
[1;76r[69;27H[38;5;224m{[72;7H}[m[75;7Hfit [93m<-[m [1m[96mmirt[m[38;5;224m([mtrain[38;5;224m,[m model[38;5;224m,[m [95m'2PL'[m[38;5;224m,[m method[93m=[mmethod[38;5;224m,[m GenRandomPars[93m=[mrandompars[38;5;224m,[m lambda[93m=[mlambda[38;5;224m,[m pars[93m=[mpars[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m([mNCYCLES[93m=[m[95m10[m[38;5;224m))[m[76;253H[K[76;253H159,33[8C51%[70;33H[?25h[?25l[76;243H~@k[70;33H[76;243H   [70;33H[1;75r[75;1H
[1;76r[75;7H[96m# save parameters[m[76;253H[K[76;253H160,33[8C52%[70;33H[?25h[?25l[76;254H59[69;33H[?25h[?25l[68;27H[38;5;224m[46m{[71;7H}[m[76;255H8,27[68;27H[?25h[?25l[38;5;224m{[71;7H}[m[76;255H7,31[67;31H[?25h[?25l[76;243H~@k[67;31H[76;243H   [66;7H[63;27H[38;5;224m[46m{[66;7H}[m[76;255H6,7 [66;7H[?25h[?25l[63;27H[38;5;224m{[66;7H}[m[76;255H7,31[67;31H[?25h[?25l[68;27H[38;5;224m[46m{[71;7H}[m[76;255H8,27[68;27H[?25h[?25l[38;5;224m{[71;7H}[m[76;255H9,33[69;33H[?25h[?25l[76;254H60[70;33H[?25h[?25l[76;243H~@k[70;33H[76;243H   [70;7H[1;75r[75;1H
[1;76r[67;27H[38;5;224m[46m{[70;7H}[m[75;7Hitempars [93m<-[m [1m[96mcoef[m[38;5;224m([mfit[38;5;224m,[m simplify [93m=[m [95mTRUE[m[38;5;224m)$[mitems[76;253H[K[76;253H161,7[9C52%[70;7H[?25h[?25l[1;75r[75;1H
[1;76r[66;27H[38;5;224m{[69;7H}[m[75;7Ha [93m<-[m itempars[38;5;224m[,[m[95m1[m[38;5;224m:([m[1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m3[m[38;5;224m)][m[76;253H[K[76;253H162,6[9C53%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hd [93m<-[m itempars[38;5;224m[,[m [1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m2[m[38;5;224m][m[76;253H[K[76;253H163,17[8C53%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htheta [93m<-[m [1m[96mfscores[m[38;5;224m([mfit[38;5;224m)[m[76;253H[K[76;253H164,33[8C54%[70;33H[?25h[?25l[76;243H~@k[70;33H[76;243H   [70;23H[1;75r[75;1H
[1;76r[76;253H[K[76;253H165,23[8C54%[70;23H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# calculate true and predicted probablities[m[76;253H[K[76;253H166,33[8C55%[70;33H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hp.pred [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)[m[76;253H[K[76;253H167,33[8C56%[70;33H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hp.true [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma_true[38;5;224m,[m [1m[96mas.vector[m[38;5;224m([md_true[38;5;224m),[m theta_true[38;5;224m)[m[76;253H[K[76;253H168,33[8C56%[70;33H[?25h[?25l[1;75r[75;1H
[1;76r[70;23H[38;5;224m[46m([mfit[38;5;224m[46m)[m[76;253H[K[76;253H169,27[8C57%[70;27H[?25h[?25l[1;75r[75;1H
[1;76r[69;23H[38;5;224m([mfit[38;5;224m)[m[75;7H[96m# [m[30m[103mif[m[96m there are rows without responses, they have no theta estimates, so we have to fill in some empty rows to make the dimensions correct[m[76;253H[K[76;253H170,6[9C57%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H171,33[8C58%[70;33H[?25h[?25l[76;243H~@k[70;33H[76;243H   [70;33H[1;75r[75;1H
[1;76r[75;9Hp.pred [93m=[m [1m[96minsertEmptyRows[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m))[m[76;253H[K[76;253H172,33[8C58%[70;33H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H173,33[8C59%[70;33H[?25h[?25l[76;243H~@k[70;33H[76;243H   [70;6H[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H174,6[9C60%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Hp.pred [93m=[m [1m[96minsertEmptyCols[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m))[m[76;253H[K[76;253H175,33[8C60%[70;33H[?25h[?25l[1;75r[75;1H
[1;76r[70;27H[38;5;224m[46m{[72;7H}[m[75;7H[38;5;224m}[m[76;253H[K[76;253H176,27[8C61%[70;27H[?25h[?25l[1;75r[75;1H
[1;76r[69;27H[38;5;224m{[m[70;33H[38;5;224m[46m([24C)[m[71;7H[38;5;224m}[m[76;253H[K[76;253H177,33[8C61%[70;33H[?25h[?25l[1;75r[75;1H
[1;76r[68;27H[38;5;224m[46m{[m[69;33H[38;5;224m([24C)[m[70;7H[38;5;224m[46m}[m[75;7H[96m# calculate metrics and save them[m[76;253H[K[76;253H178,7[9C62%[70;7H[?25h[?25l[76;243H~@k[70;7H[76;243H   [70;27H[1;75r[75;1H
[1;76r[67;27H[38;5;224m{[69;7H}[m[70;27H[38;5;224m[46m{[72;7H}[m[75;7Hrmses [93m<-[m [1m[96mc[m[38;5;224m([mrmses[38;5;224m,[m [1m[96mRMSE[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[76;253H[K[76;253H179,27[8C63%[70;27H[?25h[?25l[1;75r[75;1H
[1;76r[69;27H[38;5;224m{[m[70;33H[38;5;224m[46m([24C)[m[71;7H[38;5;224m}[m[75;7Hbiases [93m<-[m [1m[96mc[m[38;5;224m([mbiases[38;5;224m,[m [1m[96mbias[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[76;253H[K[76;253H180,33[8C63%[70;33H[?25h[?25l[1;75r[75;1H
[1;76r[68;27H[38;5;224m[46m{[m[69;33H[38;5;224m([24C)[m[70;7H[38;5;224m[46m}[m[75;7Htop10 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mp_true[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m p_pred[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m10[m[38;5;224m)[m[76;253H[K[76;253H181,7[9C64%[70;7H[?25h[?25l[1;75r[75;1H
[1;76r[67;27H[38;5;224m{[69;7H}[m[76;253H[K[76;253H182,1[9C64%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htop20 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mp_true[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m p_pred[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m20[m[38;5;224m)[m[76;253H[K[76;253H183,33[8C65%[70;33H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hacc10 [93m<-[m [1m[96mc[m[38;5;224m([macc10[38;5;224m,[m top10[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H184,33[8C65%[70;33H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hf110 [93m<-[m [1m[96mc[m[38;5;224m([mf110[38;5;224m,[m top10[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H185,33[8C66%[70;33H[?25h[?25l[76;243H~@k[70;33H[76;243H   [70;33H[1;75r[75;1H
[1;76r[75;7Hacc20 [93m<-[m [1m[96mc[m[38;5;224m([macc20[38;5;224m,[m top20[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H186,33[8C67%[70;33H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hf120 [93m<-[m [1m[96mc[m[38;5;224m([mf120[38;5;224m,[m top20[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H187,0-1[7C67%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hndcg [93m<-[m [1m[96mc[m[38;5;224m([mndcg[38;5;224m,[m top10[38;5;224m[[m[95m3[m[38;5;224m])[m[76;253H[K[76;253H188,33[8C68%[70;33H[?25h[?25l[1;75r[75;1H
[1;76r[70;17H[38;5;224m[46m([15C)[m[76;253H[K[76;253H189,33[8C68%[70;33H[?25h[?25l[1;75r[75;1H
[1;76r[69;17H[38;5;224m([15C)[m[70;16H[38;5;224m[46m([14C)[m[75;5H[38;5;224m}[m[76;253H[K[76;253H190,31[8C69%[70;31H[?25h[?25l[1;75r[75;1H
[1;76r[69;16H[38;5;224m([14C)[m[70;17H[38;5;224m[46m([15C)[m[75;3H[38;5;224m}[m[76;253H[K[76;253H191,33[8C69%[70;33H[?25h[?25l[1;75r[75;1H
[1;76r[69;17H[38;5;224m([15C)[m[70;16H[38;5;224m[46m([14C)[m[75;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([m[1m[96mmean[m[38;5;224m([mrmses[38;5;224m),[m [1m[96mmean[m[38;5;224m([mbiases[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc10[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc20[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf110[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf120[38;5;224m),[m [1m[96mmean[m[38;5;224m([mndcg[38;5;224m)))[m[76;253H[K[76;253H192,31[8C70%[70;31H[?25h[?25l[1;75r[75;1H
[1;76r[69;16H[38;5;224m([14C)[m[70;16H[38;5;224m[46m([14C)[m[75;1H[38;5;224m}[m[76;253H[K[76;253H193,31[8C71%[70;31H[?25h[?25l[76;243H~@k[70;31H[76;243H   [70;6H[1;75r[75;1H
[1;76r[69;16H[38;5;224m([14C)[m[76;253H[K[76;253H194,6[9C71%[70;6H[?25h[?25l[76;243H~@k[70;6H[76;243H   [70;5H[1;75r[75;1H
[1;76r[15;5H[38;5;224m[46m{[70;5H}[m[75;1H[96m# read appropriate data file[m[76;253H[K[76;253H195,5[9C72%[70;5H[?25h[?25l[76;243H~@k[70;5H[76;243H   [70;3H[1;75r[75;1H
[1;76r[12;3H[38;5;224m[46m{[m[14;5H[38;5;224m{[69;5H}[m
  [38;5;224m[46m}[m[75;1Hdata1 [93m=[m [1m[96mread.csv[m[38;5;224m([m[1m[96mpaste[m[38;5;224m([m[95m'~/rgmirt/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[76;253H[K[76;253H196,3[9C72%[70;3H[?25h[?25l[76;243H~@k[70;3H[76;243H   [70;33H[1;75r[75;1H
[1;76r[11;3H[38;5;224m{[69;3H}[m[76;253H[K[76;253H197,33[8C73%[70;33H[?25h[?25l[76;243H~@k[70;33H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;1H[96m# load true parameter values[m[76;253H[K[76;253H198,1[9C73%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;1H[1m[96mload[m[38;5;224m([mfile[93m=[m[1m[96mpaste[m[38;5;224m([m[95m'~/rgmirt/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m))[m[76;253H[K[76;253H199,0-1[7C74%[70;1H[?25h[?25l[76;243H:[70;1H[76;243H[K[76;1H:[?2004h[?25hq[?25l[?25h[?25l [?25h[?25l[?25h[?25l[?2004l[76;1H[K[76;1H[?2004l[?1l>[?25h[?1049l[23;0;0t]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ vim fitscript.R 
[?2004h[?1049h[22;0;0t[?1h=[?2004h[1;76r[?12h[?12l[27m[23m[29m[m[H[2J[?25l[76;1H"fitscript.R" 248L, 8758C[2;1Hâ–½[6n[2;1H  [1;1H[>c]10;?]11;?[2;7H[34m# fit model[m[3;7Hfit [38;5;130m<-[m [36mmirt[m[35m([mtrain[35m,[m model[35m,[m [31m'2PL'[m[35m,[m method[38;5;130m=[mmethod[35m,[m GenRandomPars[38;5;130m=[mrandompars[35m,[m lambda[38;5;130m=[mlambda[35m,[m pars[38;5;130m=[mpars[35m,[m technical [38;5;130m=[m [32mlist[m[35m([mNCYCLES[38;5;130m=[m[31m10[m[35m))[m[4;7H[34m# save parameters[m[5;7Hitempars [38;5;130m<-[m [36mcoef[m[35m([mfit[35m,[m simplify [38;5;130m=[m [31mTRUE[m[35m)$[mitems[6;7Ha [38;5;130m<-[m itempars[35m[,[m[31m1[m[35m:([m[36mncol[m[35m([mitempars[35m)[m[38;5;130m-[m[31m3[m[35m)][m[7;7Hd [38;5;130m<-[m itempars[35m[,[m [36mncol[m[35m([mitempars[35m)[m[38;5;130m-[m[31m2[m[35m][m[8;7Htheta [38;5;130m<-[m [36mfscores[m[35m([mfit[35m)[m[10;7H[34m# calculate true and predicted probablities[m[11;7Hp.pred [38;5;130m<-[m [36mpredict.mirt[m[35m([ma[35m,[m d[35m,[m theta[35m)[m[12;7Hp.true [38;5;130m<-[m [36mpredict.mirt[m[35m([ma_true[35m,[m [36mas.vector[m[35m([md_true[35m),[m theta_true[35m)[m[14;7H[34m# [m[34m[103mif[m[34m there are rows without responses, they have no theta estimates, so we have to fill in some empty rows to make the dimensions correct[m[15;7H[38;5;130m[103mif[m[35m([m[36msum[m[35m([memptyrows[35m)[m[38;5;130m>[m[31m0[m[35m){[m[16;9Hp.pred [38;5;130m=[m [36minsertEmptyRows[m[35m([mp.pred[35m,[m [36mwhich[m[35m([memptyrows[35m))[17;7H}[m[18;7H[38;5;130m[103mif[m[35m([m[36msum[m[35m([memptycols[35m)[m[38;5;130m>[m[31m0[m[35m){[m[19;9Hp.pred [38;5;130m=[m [36minsertEmptyCols[m[35m([mp.pred[35m,[m [36mwhich[m[35m([memptycols[35m))[20;7H}[m[22;7H[34m# calculate metrics and save them[m[23;7Hrmses [38;5;130m<-[m [36mc[m[35m([mrmses[35m,[m [36mRMSE[m[35m([mest[38;5;130m=[mp.pred[35m[[mper.ind[35m,[m item.ind[35m],[m par[38;5;130m=[mp.true[35m[[mper.ind[35m,[m item.ind[35m]))[m[24;7Hbiases [38;5;130m<-[m [36mc[m[35m([mbiases[35m,[m [36mbias[m[35m([mest[38;5;130m=[mp.pred[35m[[mper.ind[35m,[m item.ind[35m],[m par[38;5;130m=[mp.true[35m[[mper.ind[35m,[m item.ind[35m]))[m[25;7Htop10 [38;5;130m<-[m [36macc_f1_at_n[m[35m([mp_true[38;5;130m=[mp.true[35m[[mper.ind[35m,[m item.ind[35m],[m p_pred[38;5;130m=[mp.pred[35m[[mper.ind[35m,[m item.ind[35m],[m n[38;5;130m=[m[31m10[m[35m)[m[27;7Htop20 [38;5;130m<-[m [36macc_f1_at_n[m[35m([mp_true[38;5;130m=[mp.true[35m[[mper.ind[35m,[m item.ind[35m],[m p_pred[38;5;130m=[mp.pred[35m[[mper.ind[35m,[m item.ind[35m],[m n[38;5;130m=[m[31m20[m[35m)[m[28;7Hacc10 [38;5;130m<-[m [36mc[m[35m([macc10[35m,[m top10[35m[[m[31m1[m[35m])[m[29;7Hf110 [38;5;130m<-[m [36mc[m[35m([mf110[35m,[m top10[35m[[m[31m2[m[35m])[m[30;7Hacc20 [38;5;130m<-[m [36mc[m[35m([macc20[35m,[m top20[35m[[m[31m1[m[35m])[m[31;7Hf120 [38;5;130m<-[m [36mc[m[35m([mf120[35m,[m top20[35m[[m[31m2[m[35m])[m[32;7Hndcg [38;5;130m<-[m [36mc[m[35m([mndcg[35m,[m top10[35m[[m[31m3[m[35m])[34;5H}
[m  [35m}[m
  [38;5;130mreturn[m[35m([m[36mc[m[35m([m[36mmean[m[35m([mrmses[35m),[m [36mmean[m[35m([mbiases[35m),[m [36mmean[m[35m([macc10[35m),[m [36mmean[m[35m([macc20[35m),[m [36mmean[m[35m([mf110[35m),[m [36mmean[m[35m([mf120[35m),[m [36mmean[m[35m([mndcg[35m)))
}[m

[34m# read appropriate data file[m
data1 [38;5;130m=[m [36mread.csv[m[35m([m[36mpaste[m[35m([m[31m'~/rgmirt/data/'[m[35m,[m ndim[35m,[m iteration[35m,[m sparsity[35m,[m [31m'.csv'[m[35m,[m sep[38;5;130m=[m[31m'_'[m[35m),[m row.names[38;5;130m=[m[31m1[m[35m)[m

[34m# load true parameter values[m
[36mload[m[35m([mfile[38;5;130m=[m[36mpaste[m[35m([m[31m'~/rgmirt/parameters/true/true'[m[35m,[m ndim[35m,[m iteration[35m,[m sparsity[35m,[m [31m'.RData'[m[35m,[m sep[38;5;130m=[m[31m'_'[m[35m))[m

[34m# initialize paramters[m
[36mprint[m[35m([m[31m'initializing pars...'[m[35m)[m
pars [38;5;130m<-[m [36mmirt[m[35m([mdata1[35m,[mndim[35m,[m pars [38;5;130m=[m [31m'values'[m[35m,[m technical [38;5;130m=[m [32mlist[m[35m())[m

[34m# set some loadings to zero[m
[38;5;130m[103mif[m[35m([mndim[38;5;130m==[m[31m1[m[35m){[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
[35m}[m [38;5;130melse[m [38;5;130m[103mif[m [35m([mndim[38;5;130m==[m[31m2[m[35m){[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m:[m[31m5[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m:[m[31m5[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a2'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m6[m[35m:[m[31m10[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a2'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m6[m[35m:[m[31m10[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
[35m}[m[38;5;130melse[m [38;5;130m[103mif[m [35m([mndim[38;5;130m==[m[31m3[m[35m){[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m:[m[31m10[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a1'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m1[m[35m:[m[31m10[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a2'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m11[m[35m:[m[31m20[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a2'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m11[m[35m:[m[31m20[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a3'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m21[m[35m:[m[31m30[m[35m),[m [35m]$[mvalue [38;5;130m=[m [31m0[m
  pars[35m[[mpars[35m$[mname [38;5;130m==[m [31m'a3'[m [38;5;130m&[m pars[35m$[mitem [38;5;130m%in%[m [36mpaste0[m[35m([m[31m'Item_'[m[35m,[m [31m21[m[35m:[m[31m30[m[35m),[m [35m]$[mest [38;5;130m=[m [31mFALSE[m
[35m}[m

[34m# fit model[m
[36mprint[m[35m([m[31m'fitting model...'[m[35m)[m
start [38;5;130m=[m [36mSys.time[m[35m()[m
metrics [38;5;130m<-[m [36mcv.mirt[m[35m([mdata1[35m,[m ndim[35m,[m[71;17Hmethod [38;5;130m=[m [31m'EM'[m[35m,[m[72;17Hrandompars [38;5;130m=[m [31mF[m[35m,[m k [38;5;130m=[m [36mc[m[35m([m[31m3[m[35m,[m[31m2[m[35m),[m[73;17Hlambda [38;5;130m=[m [36mc[m[35m([mlambda1[35m,[mlambda2[35m),[m[74;17Ha_true [38;5;130m=[m a1[35m,[m[75;17Hd_true [38;5;130m=[m d1[35m,[m[76;253H199,0-1[7C93%[38;1H[?25h[27m[23m[29m[m[H[2J[?25l[2;7H[96m# fit model[m[3;7Hfit [93m<-[m [1m[96mmirt[m[38;5;224m([mtrain[38;5;224m,[m model[38;5;224m,[m [95m'2PL'[m[38;5;224m,[m method[93m=[mmethod[38;5;224m,[m GenRandomPars[93m=[mrandompars[38;5;224m,[m lambda[93m=[mlambda[38;5;224m,[m pars[93m=[mpars[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m([mNCYCLES[93m=[m[95m10[m[38;5;224m))[m[4;7H[96m# save parameters[m[5;7Hitempars [93m<-[m [1m[96mcoef[m[38;5;224m([mfit[38;5;224m,[m simplify [93m=[m [95mTRUE[m[38;5;224m)$[mitems[6;7Ha [93m<-[m itempars[38;5;224m[,[m[95m1[m[38;5;224m:([m[1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m3[m[38;5;224m)][m[7;7Hd [93m<-[m itempars[38;5;224m[,[m [1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m2[m[38;5;224m][m[8;7Htheta [93m<-[m [1m[96mfscores[m[38;5;224m([mfit[38;5;224m)[m[10;7H[96m# calculate true and predicted probablities[m[11;7Hp.pred [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)[m[12;7Hp.true [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma_true[38;5;224m,[m [1m[96mas.vector[m[38;5;224m([md_true[38;5;224m),[m theta_true[38;5;224m)[m[14;7H[96m# [m[30m[103mif[m[96m there are rows without responses, they have no theta estimates, so we have to fill in some empty rows to make the dimensions correct[m[15;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[16;9Hp.pred [93m=[m [1m[96minsertEmptyRows[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m))[17;7H}[m[18;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[19;9Hp.pred [93m=[m [1m[96minsertEmptyCols[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m))[20;7H}[m[22;7H[96m# calculate metrics and save them[m[23;7Hrmses [93m<-[m [1m[96mc[m[38;5;224m([mrmses[38;5;224m,[m [1m[96mRMSE[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[24;7Hbiases [93m<-[m [1m[96mc[m[38;5;224m([mbiases[38;5;224m,[m [1m[96mbias[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[25;7Htop10 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mp_true[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m p_pred[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m10[m[38;5;224m)[m[27;7Htop20 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mp_true[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m p_pred[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m20[m[38;5;224m)[m[28;7Hacc10 [93m<-[m [1m[96mc[m[38;5;224m([macc10[38;5;224m,[m top10[38;5;224m[[m[95m1[m[38;5;224m])[m[29;7Hf110 [93m<-[m [1m[96mc[m[38;5;224m([mf110[38;5;224m,[m top10[38;5;224m[[m[95m2[m[38;5;224m])[m[30;7Hacc20 [93m<-[m [1m[96mc[m[38;5;224m([macc20[38;5;224m,[m top20[38;5;224m[[m[95m1[m[38;5;224m])[m[31;7Hf120 [93m<-[m [1m[96mc[m[38;5;224m([mf120[38;5;224m,[m top20[38;5;224m[[m[95m2[m[38;5;224m])[m[32;7Hndcg [93m<-[m [1m[96mc[m[38;5;224m([mndcg[38;5;224m,[m top10[38;5;224m[[m[95m3[m[38;5;224m])[34;5H}
[m  [38;5;224m}[m
  [93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([m[1m[96mmean[m[38;5;224m([mrmses[38;5;224m),[m [1m[96mmean[m[38;5;224m([mbiases[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc10[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc20[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf110[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf120[38;5;224m),[m [1m[96mmean[m[38;5;224m([mndcg[38;5;224m)))
}[m

[96m# read appropriate data file[m
data1 [93m=[m [1m[96mread.csv[m[38;5;224m([m[1m[96mpaste[m[38;5;224m([m[95m'~/rgmirt/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m

[96m# load true parameter values[m
[1m[96mload[m[38;5;224m([mfile[93m=[m[1m[96mpaste[m[38;5;224m([m[95m'~/rgmirt/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m))[m

[96m# initialize paramters[m
[1m[96mprint[m[38;5;224m([m[95m'initializing pars...'[m[38;5;224m)[m
pars [93m<-[m [1m[96mmirt[m[38;5;224m([mdata1[38;5;224m,[mndim[38;5;224m,[m pars [93m=[m [95m'values'[m[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m())[m

[96m# set some loadings to zero[m
[30m[103mif[m[38;5;224m([mndim[93m==[m[95m1[m[38;5;224m){[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
[38;5;224m}[m [93melse[m [30m[103mif[m [38;5;224m([mndim[93m==[m[95m2[m[38;5;224m){[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m5[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m5[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m6[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m6[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
[38;5;224m}[m[93melse[m [30m[103mif[m [38;5;224m([mndim[93m==[m[95m3[m[38;5;224m){[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m11[m[38;5;224m:[m[95m20[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m11[m[38;5;224m:[m[95m20[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a3'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m21[m[38;5;224m:[m[95m30[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m
  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a3'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m21[m[38;5;224m:[m[95m30[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m
[38;5;224m}[m

[96m# fit model[m
[1m[96mprint[m[38;5;224m([m[95m'fitting model...'[m[38;5;224m)[m
start [93m=[m [1m[96mSys.time[m[38;5;224m()[m
metrics [93m<-[m [1m[96mcv.mirt[m[38;5;224m([mdata1[38;5;224m,[m ndim[38;5;224m,[m[71;17Hmethod [93m=[m [95m'EM'[m[38;5;224m,[m[72;17Hrandompars [93m=[m [95mF[m[38;5;224m,[m k [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m[73;17Hlambda [93m=[m [1m[96mc[m[38;5;224m([mlambda1[38;5;224m,[mlambda2[38;5;224m),[m[74;17Ha_true [93m=[m a1[38;5;224m,[m[75;17Hd_true [93m=[m d1[38;5;224m,[m[76;253H199,0-1[7C93%"fitscript.R" 248L, 8758C[38;1H[?25h[?25l[76;243H~@k[38;1H[76;243H   [37;1H[76;255H8,1  [37;1H[?25h[?25l[76;243H~@k[37;1H[76;243H   [36;1H[76;255H7[36;1H[?25h[?25l[76;255H6[35;1H[?25h[?25l[76;255H5[34;1H[?25h[?25l[76;255H4[33;1H[?25h[?25l[76;243H~@k[33;1H[76;243H   [32;1H[76;255H3[32;1H[?25h[?25l[76;255H2[31;1H[?25h[?25l[76;255H1[30;1H[?25h[?25l[76;255H0[29;1H[?25h[?25l[76;243H~@k[29;1H[76;243H   [28;1H[76;254H89[28;1H[?25h[?25l[76;255H8[27;1H[?25h[?25l[76;243H~@k[27;1H[76;243H   [26;1H[76;255H7,0-1[26;1H[?25h[?25l[76;255H6,1  [25;1H[?25h[?25l[76;255H5[24;1H[?25h[?25l[76;255H4[23;1H[?25h[?25l[76;255H3[22;1H[?25h[?25l[76;243H~@k[22;1H[76;243H   [21;1H[76;255H2[21;1H[?25h[?25l[76;255H1[20;1H[?25h[?25l[76;243H~@k[20;1H[76;243H   [19;1H[76;255H0[19;1H[?25h[?25l[76;254H79[18;1H[?25h[?25l[76;255H8[17;1H[?25h[?25l[76;255H7[16;1H[?25h[?25l[76;243H~@k[16;1H[76;243H   [15;1H[76;255H6[15;1H[?25h[?25l[76;255H5[14;1H[?25h[?25l[76;255H4[13;1H[?25h[?25l[76;243H~@k[13;1H[76;243H   [12;1H[76;255H3[12;1H[?25h[?25l[76;243H~@k[12;1H[76;243H   [11;1H[76;255H2[11;1H[?25h[?25l[76;255H3[12;1H[?25h[?25l[76;255H4[13;1H[?25h[?25l[76;255H5[14;1H[?25h[?25l[76;243H~@k[14;1H[76;243H   [15;1H[76;255H6[15;1H[?25h[?25l[76;255H5[14;1H[?25h[?25l[76;255H4[13;1H[?25h[?25l[76;243H~@k[13;1H[76;243H   [12;1H[76;255H3[12;1H[?25h[?25l[76;255H2[11;1H[?25h[?25l[76;243H~@k[11;1H[76;243H   [10;1H[76;255H1[10;1H[?25h[?25l[76;255H0[9;1H[?25h[?25l[76;254H69[8;1H[?25h[?25l[76;243H~@k[8;1H[76;243H   [7;1H[76;255H8[7;1H[?25h[?25l[76;243H~@k[7;1H[76;243H   [6;1H[76;255H7[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[38;5;224m}[m[76;1H[K[76;253H166,1[9C92%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;9Hitem.ind [93m=[m item.ind[38;5;224m[[m[93m![mitem.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m)][m[76;253H[K[76;253H165,1[9C91%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;9Htrain [93m=[m train[38;5;224m[,[m[93m![memptycols[38;5;224m][m[76;253H[K[76;253H164,1[9C91%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H163,1[9C90%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[96m# do the same for columns[m[76;253H[K[76;253H162,1[9C90%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[38;5;224m}[m[76;253H[K[76;253H161,1[9C89%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;9Hper.ind [93m=[m per.ind[38;5;224m[[m[93m![mper.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m)][m[76;253H[K[76;253H160,1[9C89%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;9Htrain [93m=[m train[38;5;224m[[m[93m![memptyrows[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H159,1[9C88%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H158,1[9C87%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hemptycols [93m=[m [1m[96mcolSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mnrow[m[38;5;224m([mtrain[38;5;224m)[m[76;253H[K[76;253H157,1[9C87%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hemptyrows [93m=[m [1m[96mrowSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mncol[m[38;5;224m([mtrain[38;5;224m)[m[76;253H[K[76;253H156,1[9C86%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[96m# [m[30m[103mif[m[96m some rows contain no responses after the leave out set, remove them from the training set, and adjust person indices accordingly[m[76;253H[K[76;253H155,1[9C86%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H154,1[9C85%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;7Htrain[38;5;224m[[mper.ind[38;5;224m,[mitem.ind[38;5;224m][m [93m<-[m [95mNA[m[76;253H[K[76;253H153,1[9C84%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Htrain [93m<-[m data[76;253H[K[76;253H152,1[9C84%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Htest [93m<-[m data[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m][m[76;253H[K[76;253H151,1[9C83%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[96m# create train and test folds[m[76;253H[K[76;253H150,1[9C83%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H149,1[9C82%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hitem.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.items[93m==[mj[38;5;224m)[m[76;253H[K[76;253H148,1[9C82%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7Hper.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.persons[93m==[mi[38;5;224m)[m[76;253H[K[76;253H147,1[9C81%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;7H[96m# save the persons and items that belong to the hold out test set[m[76;253H[K[76;253H146,1[9C80%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;5H[38;5;224m{[m[76;253H[K[76;253H145,1[9C80%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[93mfor[m [38;5;224m([mj [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H144,1[9C79%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[38;5;224m{[m[76;253H[K[76;253H143,1[9C79%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H142,1[9C78%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[96m# loop though cross validation folds[m[76;253H[K[76;253H141,1[9C78%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H140,1[9C77%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hacc10 [93m=[m acc20 [93m=[m f110 [93m=[m f120 [93m=[m ndcg [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H139,1[9C76%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hf1s [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H138,1[9C76%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;3Haccuracies [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H137,1[9C75%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hbiases [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H136,1[9C75%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hrmses [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H135,1[9C74%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H134,1[9C73%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hfolds.items [93m<-[m [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mncol[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m2[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[76;253H[K[76;253H133,1[9C73%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hfolds.persons [93m<-[m  [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mnrow[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m1[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[76;253H[K[76;253H132,1[9C72%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[96m# calculate to which fold each person and item belongs[m[76;253H[K[76;253H131,1[9C72%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H130,1[9C71%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;1H[38;5;224m{[m[76;253H[K[76;253H129,0-1[7C71%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;21Hpars[38;5;224m)[m[10C[96m# parameters object from mirt[m[76;253H[K[76;253H128,1[9C70%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;21Htheta_true[38;5;224m,[m    [96m# true parameter values[m[76;253H[K[76;253H127,1[9C69%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hd_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H126,1[9C69%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Ha_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H125,1[9C68%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hlambda[38;5;224m,[m[8C[96m# l1 and l2 penalty[m[76;253H[K[76;253H124,1[9C68%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;21Hk [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m    [96m# number of folds for 2d cross validation[m[76;253H[K[76;253H123,1[9C67%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hrandompars[38;5;224m,[m    [96m# mirt argument for whether to use random paramters values[m[76;253H[K[76;253H122,1[9C67%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hmethod[38;5;224m,[m[8C[96m# method of esitmation, e.g. EM[m[76;253H[K[76;253H121,1[9C66%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hmodel[38;5;224m,[m[9C[96m# model to be passed to mirt, can be number of dimensions[m[76;253H[K[76;253H120,1[9C65%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hcv.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([mdata[38;5;224m,[m[10C[96m# matrix of responses[m[76;253H[K[76;253H119,1[9C65%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# Function that fits rgmirt model using cross validation and returns the average RMSE and average bias[m[76;253H[K[76;253H118,1[9C64%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H117,1[9C64%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H116,1[9C63%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[m[76;253H[K[76;253H115,1[9C63%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([mavg_topn_accuracy[38;5;224m,[m avg_topn_f1_score[38;5;224m,[m avg_ndcg[38;5;224m))[m[76;253H[K[76;253H114,1[9C62%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H113,1[9C61%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Havg_ndcg [93m<-[m [1m[96mmean[m[38;5;224m([mndcgs[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H112,0-1[7C61%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Havg_topn_f1_score [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_f1_scores[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H111,0-1[7C60%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;3Havg_topn_accuracy [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_accuracies[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H110,1[9C60%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[96m# Calculate the average top-n accuracy and top-n F1 score across all users[m[76;253H[K[76;253H109,1[9C59%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H108,1[9C58%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[38;5;224m}[m[76;253H[K[76;253H107,1[9C58%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hndcgs[38;5;224m[[mi[38;5;224m][m [93m<-[m ndcg[76;253H[K[76;253H106,1[9C57%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htopn_f1_scores[38;5;224m[[mi[38;5;224m][m [93m<-[m f1_score[76;253H[K[76;253H105,1[9C57%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htopn_accuracies[38;5;224m[[mi[38;5;224m][m [93m<-[m topn_accuracy[76;253H[K[76;253H104,1[9C56%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H103,1[9C56%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hndcg [93m=[m [1m[96mNDCG[m[38;5;224m([mordered_true_probabilities[38;5;224m)[m[76;253H[K[76;253H102,1[9C55%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hordered_true_probabilities [93m=[m p_true[38;5;224m[[mi[38;5;224m,[m indices[38;5;224m][m[76;253H[K[76;253H101,1[9C54%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H100,1[9C54%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hf1_score [93m<-[m [95m2[m [93m*[m precision [93m*[m recall [93m/[m [38;5;224m([mprecision [93m+[m recall[38;5;224m)[m[76;253H[K[76;253H99,1[10C53%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H98,1[10C53%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hrecall [93m<-[m true_positives [93m/[m actual_positives[76;253H[K[76;253H97,1[10C52%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hprecision [93m<-[m true_positives [93m/[m n[76;253H[K[76;253H96,1[10C52%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H95,1[10C51%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hactual_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_response[38;5;224m[[mtopn_indices[38;5;224m])[m[76;253H[K[76;253H94,1[10C50%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hpredicted_positives [93m<-[m [1m[96msum[m[38;5;224m([mpred_response[38;5;224m[[mtopn_indices[38;5;224m])[m[76;253H[K[76;253H93,1[10C50%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htrue_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_response[38;5;224m[[mtopn_indices[38;5;224m][m[93m*[mpred_response[38;5;224m[[mtopn_indices[38;5;224m])[m[76;253H[K[76;253H92,1[10C49%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[96m# Calculate the top-n F1 score for the current user[m[76;253H[K[76;253H91,1[10C49%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H90,1[10C48%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htopn_accuracy [93m<-[m [1m[96msum[m[38;5;224m([mtrue_response[38;5;224m[[mtopn_indices[38;5;224m])[m [93m/[m n[76;253H[K[76;253H89,1[10C47%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[96m# Calculate the top-n accuracy for the current user[m[76;253H[K[76;253H88,1[10C47%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H87,1[10C46%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htopn_indices [93m<-[m indices[38;5;224m[[m[95m1[m[38;5;224m:[mn[38;5;224m][m[76;253H[K[76;253H86,1[10C46%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hindices [93m<-[m [1m[96morder[m[38;5;224m([m[93m-[mpred_relevance[38;5;224m)[m[76;253H[K[76;253H85,1[10C45%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[96m# Get the indices of the top-n predicted relevance[m[76;253H[K[76;253H84,1[10C45%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H83,1[10C44%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hpred_relevance [93m<-[m p_pred[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H82,1[10C43%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H81,1[10C43%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hpred_response [93m<-[m pred_resp_matrix[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H80,1[10C42%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htrue_response [93m<-[m true_resp_matrix[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H79,1[10C42%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;3H[93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mnum_users[38;5;224m)[m [38;5;224m{[m[76;253H[K[76;253H78,1[10C41%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;3H[96m# for each user[m[76;253H[K[76;253H77,1[10C41%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H76,1[10C40%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hndcgs [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m[76;253H[K[76;253H75,1[10C39%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Htopn_f1_scores [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m[76;253H[K[76;253H74,1[10C39%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;3Htopn_accuracies [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m[76;253H[K[76;253H73,1[10C38%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H72,1[10C38%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hnum_movies [93m<-[m [1m[96mdim[m[38;5;224m([mtrue[38;5;224m)[[m[95m2[m[38;5;224m][m[76;253H[K[76;253H71,1[10C37%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;3Hnum_users [93m<-[m [1m[96mdim[m[38;5;224m([mtrue[38;5;224m)[[m[95m1[m[38;5;224m][m[76;253H[K[76;253H70,1[10C36%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H69,1[10C36%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;3Hpred_resp_matrix [93m<-[m [1m[96mround[m[38;5;224m([mp_pred[38;5;224m,[m [95m0[m[38;5;224m)[m[76;253H[K[76;253H68,1[10C35%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Htrue_resp_matrix [93m<-[m [1m[96mround[m[38;5;224m([mp_true[38;5;224m,[m [95m0[m[38;5;224m)[m[76;253H[K[76;253H67,1[10C35%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[96m# binarise probabilities to 0/1[m[76;253H[K[76;253H66,1[10C34%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hacc_f1_at_n [93m<-[m [38;5;121mfunction[m[38;5;224m([mp_true[38;5;224m,[m p_pred[38;5;224m,[m n[38;5;224m)[m [38;5;224m{[m[76;253H[K[76;253H65,1[10C34%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H64,1[10C33%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[m[76;253H[K[76;253H63,1[10C32%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mreturn[m[38;5;224m([mNDCG[38;5;224m)[m[76;253H[K[76;253H62,1[10C32%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3HNDCG [93m=[m [1m[96mDCG[m[38;5;224m([mr[38;5;224m)[m[93m/[m[1m[96mDCG[m[38;5;224m([m[1m[96msort[m[38;5;224m([mr[38;5;224m,[m decreasing[93m=[m[95mT[m[38;5;224m))[m[76;253H[K[76;253H61,1[10C31%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1HNDCG [93m=[m [38;5;121mfunction[m[38;5;224m([mr[38;5;224m){[m[76;253H[K[76;253H60,1[10C31%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# NDCG[m[76;253H[K[76;253H59,0-1[8C30%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[3;19H[38;5;224m[46m{


}[m[76;253H[K[76;253H58,1[10C30%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[4;19H{


}[m[76;253H[K[76;253H57,1[10C29%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mreturn[m[38;5;224m([mDCG[38;5;224m)[m[76;253H[K[76;253H56,1[10C28%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3HDCG [93m=[m [1m[96msum[m[38;5;224m([mr[93m/[mD[38;5;224m)[m[76;253H[K[76;253H55,1[10C28%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3HD [93m=[m [1m[96mlog[m[38;5;224m([mk[93m+[m[95m1[m[38;5;224m,[m base [93m=[m [95m2[m[38;5;224m)[m[76;253H[K[76;253H54,1[10C27%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H53,0-1[8C27%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;3Hk [93m=[m [95m1[m[38;5;224m:[m[1m[96mlength[m[38;5;224m([mr[38;5;224m)[m[76;253H[K[76;253H52,1[10C26%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1HDCG [93m=[m [38;5;121mfunction[m[38;5;224m([mr[38;5;224m){[m[76;253H[K[76;253H51,1[10C26%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# calcualte DCG based on relevance grades (ordered)[m[76;253H[K[76;253H50,1[10C25%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H49,1[10C24%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m}[m[76;253H[K[76;253H48,1[10C24%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[1m[96mmean[m[38;5;224m([mest[93m-[mpar[38;5;224m)[m[76;253H[K[76;253H47,1[10C23%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;1H[38;5;224m{[m[76;253H[K[76;253H46,1[10C23%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [7;1H[76;254H7[7;1H[?25h[?25l[76;243H~@k[7;1H[76;243H   [8;1H[76;254H8[8;1H[?25h[?25l[76;243H~@k[8;1H[76;243H   [9;1H[76;254H9[9;1H[?25h[?25l[76;243H~@k[9;1H[76;243H   [10;1H[76;253H50[10;1H[?25h[?25l[76;243H~@k[10;1H[76;243H   [11;1H[76;254H1[11;1H[?25h[?25l[76;243H~@k[11;1H[76;243H   [12;1H[6;18H[38;5;224m[46m{[12;1H}[m[76;254H2[12;1H[?25h[?25l[76;243H~@k[12;1H[76;243H   [13;1H[6;18H[38;5;224m{[12;1H}[m[76;254H3,0-1[13;1H[?25h[?25l[76;243H~@k[13;1H[76;243H   [14;1H[76;254H4,1  [14;1H[?25h[?25l[76;243H~@k[14;1H[76;243H   [15;1H[76;254H5[15;1H[?25h[?25l[76;243H~@k[15;1H[76;243H   [16;1H[76;254H6[16;1H[?25h[?25l[76;243H~@k[16;1H[76;243H   [17;1H[76;254H7[17;1H[?25h[?25l[76;243H~@k[17;1H[76;243H   [18;1H[15;19H[38;5;224m[46m{


}[m[76;254H8[18;1H[?25h[?25l[76;243H~@k[18;1H[76;243H   [19;1H[15;19H[38;5;224m{


}[m[76;254H9,0-1[19;1H[?25h[?25l[76;243H~@k[19;1H[76;243H   [20;1H[76;253H60,1  [20;1H[?25h[?25l[76;243H~@k[20;1H[76;243H   [21;1H[76;254H1[21;1H[?25h[?25l[76;243H~@k[21;1H[76;243H   [22;1H[76;254H2[22;1H[?25h[?25l[76;243H~@k[22;1H[76;243H   [23;1H[76;254H3[23;1H[?25h[?25l[76;243H~@k[23;1H[76;243H   [24;1H[76;254H4[24;1H[?25h[?25l[76;243H~@k[24;1H[76;243H   [25;1H[76;254H5[25;1H[?25h[?25l[76;243H~@k[25;1H[76;243H   [25;2H[76;256H2[25;2H[?25h[?25l[76;243H~@k[25;2H[76;243H   [25;3H[76;256H3[25;3H[?25h[?25l[76;243H~@k[25;3H[76;243H   [25;4H[76;256H4[25;4H[?25h[?25l[76;243H~@k[25;4H[76;243H   [25;5H[76;256H5[25;5H[?25h[?25l[76;243H~@k[25;5H[76;243H   [25;6H[76;256H6[25;6H[?25h[?25l[76;243H~@k[25;6H[76;243H   [25;7H[76;256H7[25;7H[?25h[?25l[76;243H~@k[25;7H[76;243H   [25;8H[76;256H8[25;8H[?25h[?25l[76;243H~@k[25;8H[76;243H   [25;9H[76;256H9[25;9H[?25h[?25l[76;243H~@k[25;9H[76;243H   [25;10H[76;256H10[25;10H[?25h[?25l[76;243H~@k[25;10H[76;243H   [25;11H[76;257H1[25;11H[?25h[?25l[76;243H~@k[25;11H[76;243H   [25;12H[76;257H2[25;12H[?25h[?25l[76;243H~@k[25;12H[76;243H   [25;13H[76;257H3[25;13H[?25h[?25l[76;243H~@k[25;13H[76;243H   [25;14H[76;257H4[25;14H[?25h[?25l[76;243H~@k[25;14H[76;243H   [25;15H[76;257H5[25;15H[?25h[?25l[76;243H~@k[25;15H[76;243H   [25;16H[76;257H6[25;16H[?25h[?25l[76;243H~@k[25;16H[76;243H   [25;17H[76;257H7[25;17H[?25h[?25l[76;243H~@k[25;17H[76;243H   [25;18H[76;257H8[25;18H[?25h[?25l[76;243H~@k[25;18H[76;243H   [25;19H[38;5;224m[46m([mtrue[38;5;224m[46m)[m[76;257H9[25;19H[?25h[?25l[76;243Hp[25;19H[76;243H [26;1H[26;75r[26;1H[L[1;76r[25;19H[38;5;224m([mtrue[38;5;224m)[m[76;253H[K[76;253H66,0-1[8C22%[26;1H[?25h[?25l[76;243H~@k[26;1H[76;243H   [25;27H[38;5;224m[46m[[1C][m[76;254H5,27 [25;27H[?25h[?25l[76;243H~@k[25;27H[76;243H   [25;26H[38;5;224m[[1C][m[76;257H6[25;26H[?25h[?25l[76;243H~@k[25;26H[76;243H   [25;25H[38;5;224m[46m[[1C][m[76;257H5[25;25H[?25h[?25l[76;243Hi[25;25H[76;243H [25;25H[76;1H[1m-- INSERT --[m[76;253H[K[76;253H65,25[9C22%[25;25H[?25h[?25l[38;5;224m[46m([mtrue[38;5;224m[46m)[m[38;5;224m[[1C][m[76;257H4[25;24H[?25h[?25l[38;5;224m([mtrue[38;5;224m)[m[76;257H3[25;23H[?25h[?25l[76;257H2[25;22H[?25h[?25l[76;257H1[25;21H[?25h[?25l[38;5;224m[46m([mtrue[38;5;224m[46m)[m[76;257H0[25;20H[?25h[?25lptru[46me[m[38;5;224m)[[m[95m1[m[38;5;224m][25;19H([mptrue[76;257H1[25;21H[?25h[?25l_true[38;5;224m)[[m[95m1[m[38;5;224m][m[76;257H2[25;22H[?25h[?25l[76;254H6,1 [26;1H[?25h[?25l[25;75r[75;1H
[1;76r[25;3Hnum_users [93m<-[m [1m[96mdim[m[38;5;224m([mp_true[38;5;224m)[[m[95m1[m[38;5;224m][m[75;21Hmodel[38;5;224m,[m[9C[96m# model to be passed to mirt, can be number of dimensions[m[76;253H[K[76;253H65,30[9C23%[25;27H[38;5;224m[46m[[1C][?25h[?25l[m[38;5;224m[[1C][m[26;26H[38;5;224m[46m[[1C][m[76;254H6,29[26;29H[?25h[?25l[76;257H8[26;28H[?25h[?25l[76;257H7[26;27H[?25h[?25l[76;257H6[26;26H[?25h[?25l[38;5;224m[46m([mtrue[38;5;224m[46m)[m[38;5;224m[[1C][m[76;257H5[26;25H[?25h[?25l[38;5;224m([mtrue[38;5;224m)[m[76;257H4[26;24H[?25h[?25l[76;257H3[26;23H[?25h[?25l[76;257H2[26;22H[?25h[?25l[38;5;224m[46m([mtrue[38;5;224m[46m)[m[76;257H1[26;21H[?25h[?25lptru[46me[m[38;5;224m)[[m[95m2[m[38;5;224m][26;20H([mptrue[76;257H2[26;22H[?25h[?25l_true[38;5;224m)[[m[95m2[m[38;5;224m][m[76;257H3[26;23H[?25h[?25l[38;5;224m:[mtrue[38;5;224m)[[m[95m2[m[38;5;224m][m[76;257H4[26;24H[?25h[?25lqtrue[38;5;224m)[[m[95m2[m[38;5;224m][m[76;257H5[26;25H[?25h[?25l true[38;5;224m)[[m[95m2[m[38;5;224m][m[76;257H6[26;26H[?25h[?25ltrue[38;5;224m)[[m[95m2[m[38;5;224m][m[26;33H[K[76;257H5[26;25H[?25h[?25ltrue[38;5;224m)[[m[95m2[m[38;5;224m][m[26;32H[K[76;257H4[26;24H[?25h[?25ltrue[38;5;224m)[[m[95m2[m[38;5;224m][m[26;31H[K[76;257H3[26;23H[?25h[76;1H[K[26;22H[?25l[76;243H^[[26;22H[76;243H  [26;23H[76;253H66,22[9C23%[26;22H[?25h[?25l[76;243H:[26;22H[76;243H[K[76;1H:[?2004h[?25hw[?25l[?25h[?25l [?25h[?25l[?25h[?25l"fitscript.R" 248L, 8762C written[26;22H[76;253H66,22[9C23%[76;253H[K[76;253H66,22[9C23%[26;22H[?25h[?25l[76;243H:[26;22H[76;1H[K[76;1H:[?2004h[?25hq[?25l[?25h[?25l [?25h[?25l[?25h[?25l[?2004l[76;1H[K[76;1H[?2004l[?1l>[?25h[?1049l[23;0;0t]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ vim fitscript.R Rscript fitscript.R 0 0 3 1 .85
Loading required package: stats4
Loading required package: lattice
[1] "initializing pars..."
[1] "fitting model..."
Iteration: 1, Log-Lik: -1151562.107, Max-Change: 23.54328Iteration: 2, Log-Lik: -283412.264, Max-Change: 8.16770Iteration: 3, Log-Lik: -251464.713, Max-Change: 5.76194Iteration: 4, Log-Lik: -243356.778, Max-Change: 7.71550Iteration: 5, Log-Lik: -238816.786, Max-Change: 6.66958Iteration: 6, Log-Lik: -235741.028, Max-Change: 3.02796Iteration: 7, Log-Lik: -234495.538, Max-Change: 3.85519Iteration: 8, Log-Lik: -233629.539, Max-Change: 2.91821Iteration: 9, Log-Lik: -233036.676, Max-Change: 3.26450Iteration: 10, Log-Lik: -232571.295, Max-Change: 1.20770
EM cycles terminated after 10 iterations.
Iteration: 1, Log-Lik: -1153891.849, Max-Change: 25.04452Iteration: 2, Log-Lik: -284392.489, Max-Change: 7.09703Iteration: 3, Log-Lik: -252667.681, Max-Change: 4.53886Iteration: 4, Log-Lik: -244633.384, Max-Change: 6.93663Iteration: 5, Log-Lik: -240956.355, Max-Change: 8.94854Iteration: 6, Log-Lik: -238015.093, Max-Change: 3.09802Iteration: 7, Log-Lik: -236568.398, Max-Change: 2.91318Iteration: 8, Log-Lik: -235704.300, Max-Change: 1.93976Iteration: 9, Log-Lik: -235152.897, Max-Change: 3.02155Iteration: 10, Log-Lik: -234642.307, Max-Change: 2.62664
EM cycles terminated after 10 iterations.
Iteration: 1, Log-Lik: -1156791.088, Max-Change: 25.56425^C
Execution halted
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ Rscript fitscript.R 0 0 3 1 .85[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[15Pvim fitscript.R 
[?2004h[?1049h[22;0;0t[?1h=[?2004h[1;76r[?12h[?12l[27m[23m[29m[m[H[2J[?25l[76;1H"fitscript.R" 248L, 8762C[2;1Hâ–½[6n[2;1H  [1;1H[>c]10;?]11;?[1;1H[34m# read command line arguments[m
args [38;5;130m=[m [36mcommandArgs[m[35m([mtrailingOnly[38;5;130m=[m[31mTRUE[m[35m)[m
lambda1 [38;5;130m=[m [36mas.numeric[m[35m([margs[35m[[m[31m1[m[35m])[m   [34m# l1 penalty [m
lambda2 [38;5;130m=[m [36mas.numeric[m[35m([margs[35m[[m[31m2[m[35m])[m   [34m# l2 penalty[m
ndim [38;5;130m=[m [36mas.numeric[m[35m([margs[35m[[m[31m3[m[35m])[m      [34m# number of latent dimensions[m
iteration [38;5;130m=[m [36mas.numeric[m[35m([margs[35m[[m[31m4[m[35m])[m [34m# number of the current iteration[m
sparsity [38;5;130m=[m [36mas.numeric[m[35m([margs[35m[[m[31m5[m[35m])[m  [34m# sparsity of the dataset 

# load adapted version of mirt library (rgmirt)[m
[35mlibrary[m[35m([mmirt[35m)[m

[34m# predict probabilities based on mirt parameters[m
predict.mirt [38;5;130m<-[m [32mfunction[m[35m([ma[35m,[m d[35m,[m theta[35m)
{[m
  prob [38;5;130m<-[m [36mt[m[35m([m[36mexp[m[35m([ma [38;5;130m%*%[m [36mt[m[35m([mtheta[35m)[m [38;5;130m+[md[35m)[m [38;5;130m/[m [35m([m[31m1[m [38;5;130m+[m [36mexp[m[35m([ma [38;5;130m%*%[m [36mt[m[35m([mtheta[35m)[m[38;5;130m+[md[35m)))[m

  [38;5;130mreturn[m[35m([mprob[35m)
}[m

[34m# function that inserts NA rows at each index specified in m[m
insertEmptyRows [38;5;130m<-[m [32mfunction[m[35m([mm[35m,[m rs[35m){[m
  new [38;5;130m=[m [32mmatrix[m[35m([m[31mNA[m[35m,[m nrow[38;5;130m=[m[36mnrow[m[35m([mm[35m)[m[38;5;130m+[m[36mlength[m[35m([mrs[35m),[m ncol[38;5;130m=[m[36mncol[m[35m([mm[35m))[m
  new[35m[[m[38;5;130m-[mrs[35m,][m [38;5;130m<-[m m
  [38;5;130mreturn[m[35m([mnew[35m)
}[m
[34m# function that inserts NA rows at each index specified in m[m
insertEmptyCols [38;5;130m<-[m [32mfunction[m[35m([mm[35m,[m cs[35m){[m
  new [38;5;130m=[m [32mmatrix[m[35m([m[31mNA[m[35m,[m nrow[38;5;130m=[m[36mnrow[m[35m([mm[35m),[m ncol[38;5;130m=[m[36mncol[m[35m([mm[35m)[m[38;5;130m+[m[36mlength[m[35m([mcs[35m))[m
  new[35m[[m[38;5;130m-[mcs[35m,][m [38;5;130m<-[m m
  [38;5;130mreturn[m[35m([mnew[35m)
}[m

[34m# Root mean square error[m
RMSE [38;5;130m<-[m [32mfunction[m[35m([mpar[35m,[m est[35m)
{[m
  [36msqrt[m[35m([m[36msum[m[35m(([mest[38;5;130m-[mpar[35m)[m[38;5;130m^[m[31m2[m[35m)[m [38;5;130m/[m [36mlength[m[35m([mpar[35m))
}[m

[34m# bias [m
bias [38;5;130m<-[m [32mfunction[m[35m([mpar[35m,[m est[35m)
{[m
  [36mmean[m[35m([mest[38;5;130m-[mpar[35m)
}[m

[34m# calcualte DCG based on relevance grades (ordered)[m
DCG [38;5;130m=[m [32mfunction[m[35m([mr[35m){[m
  k [38;5;130m=[m [31m1[m[35m:[m[36mlength[m[35m([mr[35m)[m

  D [38;5;130m=[m [36mlog[m[35m([mk[38;5;130m+[m[31m1[m[35m,[m base [38;5;130m=[m [31m2[m[35m)[m
  DCG [38;5;130m=[m [36msum[m[35m([mr[38;5;130m/[mD[35m)[m
  [38;5;130mreturn[m[35m([mDCG[35m)
}[m

[34m# NDCG[m
NDCG [38;5;130m=[m [32mfunction[m[35m([mr[35m){[m
  NDCG [38;5;130m=[m [36mDCG[m[35m([mr[35m)[m[38;5;130m/[m[36mDCG[m[35m([m[36msort[m[35m([mr[35m,[m decreasing[38;5;130m=[m[31mT[m[35m))[m
  [38;5;130mreturn[m[35m([mNDCG[35m)
}[m

acc_f1_at_n [38;5;130m<-[m [32mfunction[m[35m([mp_true[35m,[m p_pred[35m,[m n[35m)[m [35m{[m
  [34m# binarise probabilities to 0/1[m
  true_resp_matrix [38;5;130m<-[m [36mround[m[35m([mp_true[35m,[m [31m0[m[35m)[m
  pred_resp_matrix [38;5;130m<-[m [36mround[m[35m([mp_pred[35m,[m [31m0[m[35m)[m

  num_users [38;5;130m<-[m [36mdim[m[35m([mp_true[35m)[[m[31m1[m[35m][m
  num_movies [38;5;130m<-[m [36mdim[m[35m([mp_true[35m)[[m[31m2[m[35m][m

  topn_accuracies [38;5;130m<-[m [32mvector[m[35m([m[31m"numeric"[m[35m,[m num_users[35m)[m
  topn_f1_scores [38;5;130m<-[m [32mvector[m[35m([m[31m"numeric"[m[35m,[m num_users[35m)[m
  ndcgs [38;5;130m<-[m [32mvector[m[35m([m[31m"numeric"[m[35m,[m num_users[35m)[m

  [34m# for each user[m
  [38;5;130mfor[m [35m([mi [38;5;130min[m [31m1[m[35m:[mnum_users[35m)[m [35m{[m
    true_response [38;5;130m<-[m true_resp_matrix[35m[[mi[35m,[m [35m][m
    pred_response [38;5;130m<-[m pred_resp_matrix[35m[[mi[35m,[m [35m][m[76;253H66,22[9CTop[66;22H[?25h[27m[23m[29m[m[H[2J[?25l[1;1H[96m# read command line arguments[m
args [93m=[m [1m[96mcommandArgs[m[38;5;224m([mtrailingOnly[93m=[m[95mTRUE[m[38;5;224m)[m
lambda1 [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m1[m[38;5;224m])[m   [96m# l1 penalty [m
lambda2 [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m2[m[38;5;224m])[m   [96m# l2 penalty[m
ndim [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m3[m[38;5;224m])[m      [96m# number of latent dimensions[m
iteration [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m4[m[38;5;224m])[m [96m# number of the current iteration[m
sparsity [93m=[m [1m[96mas.numeric[m[38;5;224m([margs[38;5;224m[[m[95m5[m[38;5;224m])[m  [96m# sparsity of the dataset 

# load adapted version of mirt library (rgmirt)[m
[38;5;81mlibrary[m[38;5;224m([mmirt[38;5;224m)[m

[96m# predict probabilities based on mirt parameters[m
predict.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)
{[m
  prob [93m<-[m [1m[96mt[m[38;5;224m([m[1m[96mexp[m[38;5;224m([ma [93m%*%[m [1m[96mt[m[38;5;224m([mtheta[38;5;224m)[m [93m+[md[38;5;224m)[m [93m/[m [38;5;224m([m[95m1[m [93m+[m [1m[96mexp[m[38;5;224m([ma [93m%*%[m [1m[96mt[m[38;5;224m([mtheta[38;5;224m)[m[93m+[md[38;5;224m)))[m

  [93mreturn[m[38;5;224m([mprob[38;5;224m)
}[m

[96m# function that inserts NA rows at each index specified in m[m
insertEmptyRows [93m<-[m [38;5;121mfunction[m[38;5;224m([mm[38;5;224m,[m rs[38;5;224m){[m
  new [93m=[m [38;5;121mmatrix[m[38;5;224m([m[95mNA[m[38;5;224m,[m nrow[93m=[m[1m[96mnrow[m[38;5;224m([mm[38;5;224m)[m[93m+[m[1m[96mlength[m[38;5;224m([mrs[38;5;224m),[m ncol[93m=[m[1m[96mncol[m[38;5;224m([mm[38;5;224m))[m
  new[38;5;224m[[m[93m-[mrs[38;5;224m,][m [93m<-[m m
  [93mreturn[m[38;5;224m([mnew[38;5;224m)
}[m
[96m# function that inserts NA rows at each index specified in m[m
insertEmptyCols [93m<-[m [38;5;121mfunction[m[38;5;224m([mm[38;5;224m,[m cs[38;5;224m){[m
  new [93m=[m [38;5;121mmatrix[m[38;5;224m([m[95mNA[m[38;5;224m,[m nrow[93m=[m[1m[96mnrow[m[38;5;224m([mm[38;5;224m),[m ncol[93m=[m[1m[96mncol[m[38;5;224m([mm[38;5;224m)[m[93m+[m[1m[96mlength[m[38;5;224m([mcs[38;5;224m))[m
  new[38;5;224m[[m[93m-[mcs[38;5;224m,][m [93m<-[m m
  [93mreturn[m[38;5;224m([mnew[38;5;224m)
}[m

[96m# Root mean square error[m
RMSE [93m<-[m [38;5;121mfunction[m[38;5;224m([mpar[38;5;224m,[m est[38;5;224m)
{[m
  [1m[96msqrt[m[38;5;224m([m[1m[96msum[m[38;5;224m(([mest[93m-[mpar[38;5;224m)[m[93m^[m[95m2[m[38;5;224m)[m [93m/[m [1m[96mlength[m[38;5;224m([mpar[38;5;224m))
}[m

[96m# bias [m
bias [93m<-[m [38;5;121mfunction[m[38;5;224m([mpar[38;5;224m,[m est[38;5;224m)
{[m
  [1m[96mmean[m[38;5;224m([mest[93m-[mpar[38;5;224m)
}[m

[96m# calcualte DCG based on relevance grades (ordered)[m
DCG [93m=[m [38;5;121mfunction[m[38;5;224m([mr[38;5;224m){[m
  k [93m=[m [95m1[m[38;5;224m:[m[1m[96mlength[m[38;5;224m([mr[38;5;224m)[m

  D [93m=[m [1m[96mlog[m[38;5;224m([mk[93m+[m[95m1[m[38;5;224m,[m base [93m=[m [95m2[m[38;5;224m)[m
  DCG [93m=[m [1m[96msum[m[38;5;224m([mr[93m/[mD[38;5;224m)[m
  [93mreturn[m[38;5;224m([mDCG[38;5;224m)
}[m

[96m# NDCG[m
NDCG [93m=[m [38;5;121mfunction[m[38;5;224m([mr[38;5;224m){[m
  NDCG [93m=[m [1m[96mDCG[m[38;5;224m([mr[38;5;224m)[m[93m/[m[1m[96mDCG[m[38;5;224m([m[1m[96msort[m[38;5;224m([mr[38;5;224m,[m decreasing[93m=[m[95mT[m[38;5;224m))[m
  [93mreturn[m[38;5;224m([mNDCG[38;5;224m)
}[m

acc_f1_at_n [93m<-[m [38;5;121mfunction[m[38;5;224m([mp_true[38;5;224m,[m p_pred[38;5;224m,[m n[38;5;224m)[m [38;5;224m{[m
  [96m# binarise probabilities to 0/1[m
  true_resp_matrix [93m<-[m [1m[96mround[m[38;5;224m([mp_true[38;5;224m,[m [95m0[m[38;5;224m)[m
  pred_resp_matrix [93m<-[m [1m[96mround[m[38;5;224m([mp_pred[38;5;224m,[m [95m0[m[38;5;224m)[m

  num_users [93m<-[m [1m[96mdim[m[38;5;224m([mp_true[38;5;224m)[[m[95m1[m[38;5;224m][m
  num_movies [93m<-[m [1m[96mdim[m[38;5;224m([mp_true[38;5;224m)[[m[95m2[m[38;5;224m][m

  topn_accuracies [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m
  topn_f1_scores [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m
  ndcgs [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m

  [96m# for each user[m
  [93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mnum_users[38;5;224m)[m [38;5;224m{[m
    true_response [93m<-[m true_resp_matrix[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m
    pred_response [93m<-[m pred_resp_matrix[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m[76;253H66,22[9CTop"fitscript.R" 248L, 8762C[66;22H[?25h[?25l[76;243H~@k[66;22H[76;243H   [67;2H[76;254H7,2 [67;2H[?25h[?25l[76;243H~@k[67;2H[76;243H   [68;2H[76;254H8[68;2H[?25h[?25l[76;243H~@k[68;2H[76;243H   [69;2H[76;254H9[69;2H[?25h[?25l[76;253H70[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[76;1H[K[76;253H71,2[11C0%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;5Hpred_relevance [93m<-[m p_pred[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H72,2[11C1%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H73,2[11C1%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;5H[96m# Get the indices of the top-n predicted relevance[m[76;253H[K[76;253H74,2[11C2%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;5Hindices [93m<-[m [1m[96morder[m[38;5;224m([m[93m-[mpred_relevance[38;5;224m)[m[76;253H[K[76;253H75,2[11C2%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;5Htopn_indices [93m<-[m indices[38;5;224m[[m[95m1[m[38;5;224m:[mn[38;5;224m][m[76;253H[K[76;253H76,2[11C3%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H77,2[11C4%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;5H[96m# Calculate the top-n accuracy for the current user[m[76;253H[K[76;253H78,2[11C4%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;5Htopn_accuracy [93m<-[m [1m[96msum[m[38;5;224m([mtrue_response[38;5;224m[[mtopn_indices[38;5;224m])[m [93m/[m n[76;253H[K[76;253H79,2[11C5%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H80,2[11C5%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;5H[96m# Calculate the top-n F1 score for the current user[m[76;253H[K[76;253H81,2[11C6%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;5Htrue_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_response[38;5;224m[[mtopn_indices[38;5;224m][m[93m*[mpred_response[38;5;224m[[mtopn_indices[38;5;224m])[m[76;253H[K[76;253H82,2[11C6%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;5Hpredicted_positives [93m<-[m [1m[96msum[m[38;5;224m([mpred_response[38;5;224m[[mtopn_indices[38;5;224m])[m[76;253H[K[76;253H83,2[11C7%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;5Hactual_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_response[38;5;224m[[mtopn_indices[38;5;224m])[m[76;253H[K[76;253H84,2[11C8%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H85,2[11C8%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;5Hprecision [93m<-[m true_positives [93m/[m n[76;253H[K[76;253H86,2[11C9%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;5Hrecall [93m<-[m true_positives [93m/[m actual_positives[76;253H[K[76;253H87,2[11C9%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[76;253H[K[76;253H88,2[10C10%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;5Hf1_score [93m<-[m [95m2[m [93m*[m precision [93m*[m recall [93m/[m [38;5;224m([mprecision [93m+[m recall[38;5;224m)[m[76;253H[K[76;253H89,2[10C10%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H90,2[10C11%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;5Hordered_true_probabilities [93m=[m p_true[38;5;224m[[mi[38;5;224m,[m indices[38;5;224m][m[76;253H[K[76;253H91,2[10C12%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;5Hndcg [93m=[m [1m[96mNDCG[m[38;5;224m([mordered_true_probabilities[38;5;224m)[m[76;253H[K[76;253H92,2[10C12%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[76;253H[K[76;253H93,2[10C13%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;5Htopn_accuracies[38;5;224m[[mi[38;5;224m][m [93m<-[m topn_accuracy[76;253H[K[76;253H94,2[10C13%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;5Htopn_f1_scores[38;5;224m[[mi[38;5;224m][m [93m<-[m f1_score[76;253H[K[76;253H95,2[10C14%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;5Hndcgs[38;5;224m[[mi[38;5;224m][m [93m<-[m ndcg[76;253H[K[76;253H96,2[10C15%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;3H[38;5;224m}[m[76;253H[K[76;253H97,2[10C15%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H98,2[10C16%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;3H[96m# Calculate the average top-n accuracy and top-n F1 score across all users[m[76;253H[K[76;253H99,2[10C16%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Havg_topn_accuracy [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_accuracies[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H100,2[9C17%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;3Havg_topn_f1_score [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_f1_scores[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H101,2[9C17%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Havg_ndcg [93m<-[m [1m[96mmean[m[38;5;224m([mndcgs[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H102,2[9C18%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H103,2[9C19%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([mavg_topn_accuracy[38;5;224m,[m avg_topn_f1_score[38;5;224m,[m avg_ndcg[38;5;224m))[m[76;253H[K[76;253H104,2[9C19%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m[76;253H[K[76;253H105,2[9C20%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H106,2[9C20%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[76;253H[K[76;253H107,2[9C21%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# Function that fits rgmirt model using cross validation and returns the average RMSE and average bias[m[76;253H[K[76;253H108,2[9C21%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;1Hcv.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([mdata[38;5;224m,[m[10C[96m# matrix of responses[m[76;253H[K[76;253H109,2[9C22%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[20;44H[38;5;224m[46m{[70;1H}[m[75;21Hmodel[38;5;224m,[m[9C[96m# model to be passed to mirt, can be number of dimensions[m[76;253H[K[76;253H110,1[9C23%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[19;44H[38;5;224m{[69;1H}[m[75;21Hmethod[38;5;224m,[m[8C[96m# method of esitmation, e.g. EM[m[76;253H[K[76;253H111,0-1[7C23%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;21Hrandompars[38;5;224m,[m    [96m# mirt argument for whether to use random paramters values[m[76;253H[K[76;253H112,0-1[7C24%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;21Hk [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m    [96m# number of folds for 2d cross validation[m[76;253H[K[76;253H113,2[9C24%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;21Hlambda[38;5;224m,[m[8C[96m# l1 and l2 penalty[m[76;253H[K[76;253H114,2[9C25%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;21Ha_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H115,2[9C26%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;21Hd_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H116,2[9C26%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;21Htheta_true[38;5;224m,[m    [96m# true parameter values[m[76;253H[K[76;253H117,2[9C27%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;21Hpars[38;5;224m)[m[10C[96m# parameters object from mirt[m[76;253H[K[76;253H118,2[9C27%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[38;5;224m{[m[76;253H[K[76;253H119,2[9C28%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H120,2[9C28%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;3H[96m# calculate to which fold each person and item belongs[m[76;253H[K[76;253H121,2[9C29%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hfolds.persons [93m<-[m  [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mnrow[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m1[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[76;253H[K[76;253H122,2[9C30%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;3Hfolds.items [93m<-[m [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mncol[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m2[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[76;253H[K[76;253H123,2[9C30%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;1H[1;75r[75;1H
[1;76r[76;253H[K[76;253H124,1[9C31%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hrmses [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H125,2[9C31%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hbiases [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H126,2[9C32%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Haccuracies [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H127,2[9C32%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hf1s [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H128,2[9C33%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;3Hacc10 [93m=[m acc20 [93m=[m f110 [93m=[m f120 [93m=[m ndcg [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H129,0-1[7C34%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H130,2[9C34%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;3H[96m# loop though cross validation folds[m[76;253H[K[76;253H131,2[9C35%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;3H[93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H132,2[9C35%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;3H[38;5;224m{[m[76;253H[K[76;253H133,2[9C36%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;5H[93mfor[m [38;5;224m([mj [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H134,2[9C36%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;5H[38;5;224m{[m[76;253H[K[76;253H135,2[9C37%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# save the persons and items that belong to the hold out test set[m[76;253H[K[76;253H136,2[9C38%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hper.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.persons[93m==[mi[38;5;224m)[m[76;253H[K[76;253H137,2[9C38%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hitem.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.items[93m==[mj[38;5;224m)[m[76;253H[K[76;253H138,2[9C39%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[76;253H[K[76;253H139,2[9C39%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# create train and test folds[m[76;253H[K[76;253H140,2[9C40%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htest [93m<-[m data[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m][m[76;253H[K[76;253H141,2[9C41%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;7Htrain [93m<-[m data[76;253H[K[76;253H142,2[9C41%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htrain[38;5;224m[[mper.ind[38;5;224m,[mitem.ind[38;5;224m][m [93m<-[m [95mNA[m[76;253H[K[76;253H143,2[9C42%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H144,2[9C42%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# [m[30m[103mif[m[96m some rows contain no responses after the leave out set, remove them from the training set, and adjust person indices accordingly[m[76;253H[K[76;253H145,2[9C43%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hemptyrows [93m=[m [1m[96mrowSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mncol[m[38;5;224m([mtrain[38;5;224m)[m[76;253H[K[76;253H146,2[9C43%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hemptycols [93m=[m [1m[96mcolSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mnrow[m[38;5;224m([mtrain[38;5;224m)[m[76;253H[K[76;253H147,2[9C44%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H148,2[9C45%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;9Htrain [93m=[m train[38;5;224m[[m[93m![memptyrows[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H149,2[9C45%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;9Hper.ind [93m=[m per.ind[38;5;224m[[m[93m![mper.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m)][m[76;253H[K[76;253H150,2[9C46%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H151,2[9C46%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# do the same for columns[m[76;253H[K[76;253H152,2[9C47%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H153,2[9C47%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Htrain [93m=[m train[38;5;224m[,[m[93m![memptycols[38;5;224m][m[76;253H[K[76;253H154,2[9C48%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;9Hitem.ind [93m=[m item.ind[38;5;224m[[m[93m![mitem.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m)][m[76;253H[K[76;253H155,2[9C49%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H156,2[9C49%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H157,2[9C50%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# fit model[m[76;253H[K[76;253H158,2[9C50%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;7Hfit [93m<-[m [1m[96mmirt[m[38;5;224m([mtrain[38;5;224m,[m model[38;5;224m,[m [95m'2PL'[m[38;5;224m,[m method[93m=[mmethod[38;5;224m,[m GenRandomPars[93m=[mrandompars[38;5;224m,[m lambda[93m=[mlambda[38;5;224m,[m pars[93m=[mpars[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m([mNCYCLES[93m=[m[95m10[m[38;5;224m))[m[76;253H[K[76;253H159,2[9C51%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# save parameters[m[76;253H[K[76;253H160,2[9C52%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;7Hitempars [93m<-[m [1m[96mcoef[m[38;5;224m([mfit[38;5;224m,[m simplify [93m=[m [95mTRUE[m[38;5;224m)$[mitems[76;253H[K[76;253H161,2[9C52%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Ha [93m<-[m itempars[38;5;224m[,[m[95m1[m[38;5;224m:([m[1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m3[m[38;5;224m)][m[76;253H[K[76;253H162,2[9C53%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hd [93m<-[m itempars[38;5;224m[,[m [1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m2[m[38;5;224m][m[76;253H[K[76;253H163,2[9C53%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htheta [93m<-[m [1m[96mfscores[m[38;5;224m([mfit[38;5;224m)[m[76;253H[K[76;253H164,2[9C54%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H165,2[9C54%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# calculate true and predicted probablities[m[76;253H[K[76;253H166,2[9C55%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hp.pred [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)[m[76;253H[K[76;253H167,2[9C56%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;7Hp.true [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma_true[38;5;224m,[m [1m[96mas.vector[m[38;5;224m([md_true[38;5;224m),[m theta_true[38;5;224m)[m[76;253H[K[76;253H168,2[9C56%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H169,2[9C57%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# [m[30m[103mif[m[96m there are rows without responses, they have no theta estimates, so we have to fill in some empty rows to make the dimensions correct[m[76;253H[K[76;253H170,2[9C57%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H171,2[9C58%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Hp.pred [93m=[m [1m[96minsertEmptyRows[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m))[m[76;253H[K[76;253H172,2[9C58%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H173,2[9C59%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H174,2[9C60%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;9Hp.pred [93m=[m [1m[96minsertEmptyCols[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m))[m[76;253H[K[76;253H175,2[9C60%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H176,2[9C61%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H177,2[9C61%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# calculate metrics and save them[m[76;253H[K[76;253H178,2[9C62%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hrmses [93m<-[m [1m[96mc[m[38;5;224m([mrmses[38;5;224m,[m [1m[96mRMSE[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[76;253H[K[76;253H179,2[9C63%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hbiases [93m<-[m [1m[96mc[m[38;5;224m([mbiases[38;5;224m,[m [1m[96mbias[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[76;253H[K[76;253H180,2[9C63%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htop10 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mp_true[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m p_pred[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m10[m[38;5;224m)[m[76;253H[K[76;253H181,2[9C64%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H182,1[9C64%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;7Htop20 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mp_true[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m p_pred[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m20[m[38;5;224m)[m[76;253H[K[76;253H183,2[9C65%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hacc10 [93m<-[m [1m[96mc[m[38;5;224m([macc10[38;5;224m,[m top10[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H184,2[9C65%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hf110 [93m<-[m [1m[96mc[m[38;5;224m([mf110[38;5;224m,[m top10[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H185,2[9C66%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;7Hacc20 [93m<-[m [1m[96mc[m[38;5;224m([macc20[38;5;224m,[m top20[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H186,2[9C67%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hf120 [93m<-[m [1m[96mc[m[38;5;224m([mf120[38;5;224m,[m top20[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H187,0-1[7C67%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hndcg [93m<-[m [1m[96mc[m[38;5;224m([mndcg[38;5;224m,[m top10[38;5;224m[[m[95m3[m[38;5;224m])[m[76;253H[K[76;253H188,2[9C68%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H189,2[9C68%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;5H[38;5;224m}[m[76;253H[K[76;253H190,2[9C69%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;3H[38;5;224m}[m[76;253H[K[76;253H191,2[9C69%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([m[1m[96mmean[m[38;5;224m([mrmses[38;5;224m),[m [1m[96mmean[m[38;5;224m([mbiases[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc10[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc20[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf110[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf120[38;5;224m),[m [1m[96mmean[m[38;5;224m([mndcg[38;5;224m)))[m[76;253H[K[76;253H192,2[9C70%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m[76;253H[K[76;253H193,2[9C71%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H194,2[9C71%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# read appropriate data file[m[76;253H[K[76;253H195,2[9C72%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;1Hdata1 [93m=[m [1m[96mread.csv[m[38;5;224m([m[1m[96mpaste[m[38;5;224m([m[95m'~/rgmirt/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[76;253H[K[76;253H196,2[9C72%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H197,2[9C73%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# load true parameter values[m[76;253H[K[76;253H198,1[9C73%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[1m[96mload[m[38;5;224m([mfile[93m=[m[1m[96mpaste[m[38;5;224m([m[95m'~/rgmirt/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m))[m[76;253H[K[76;253H199,0-1[7C74%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H200,2[9C75%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;1H[96m# initialize paramters[m[76;253H[K[76;253H201,2[9C75%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[1m[96mprint[m[38;5;224m([m[95m'initializing pars...'[m[38;5;224m)[m[76;253H[K[76;253H202,0-1[7C76%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1Hpars [93m<-[m [1m[96mmirt[m[38;5;224m([mdata1[38;5;224m,[mndim[38;5;224m,[m pars [93m=[m [95m'values'[m[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m())[m[76;253H[K[76;253H203,2[9C76%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H204,2[9C77%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# set some loadings to zero[m[76;253H[K[76;253H205,2[9C78%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[30m[103mif[m[38;5;224m([mndim[93m==[m[95m1[m[38;5;224m){[m[76;253H[K[76;253H206,2[9C78%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H207,2[9C79%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H208,2[9C79%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m [93melse[m [30m[103mif[m [38;5;224m([mndim[93m==[m[95m2[m[38;5;224m){[m[76;253H[K[76;253H209,0-1[7C80%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m5[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H210,2[9C80%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m5[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H211,2[9C81%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m6[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H212,2[9C82%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m6[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H213,2[9C82%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m[93melse[m [30m[103mif[m [38;5;224m([mndim[93m==[m[95m3[m[38;5;224m){[m[76;253H[K[76;253H214,2[9C83%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H215,2[9C83%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H216,2[9C84%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m11[m[38;5;224m:[m[95m20[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H217,2[9C84%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m11[m[38;5;224m:[m[95m20[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H218,2[9C85%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a3'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m21[m[38;5;224m:[m[95m30[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H219,2[9C86%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a3'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m21[m[38;5;224m:[m[95m30[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H220,2[9C86%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m[76;253H[K[76;253H221,2[9C87%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[76;253H[K[76;253H222,2[9C87%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;1H[96m# fit model[m[76;253H[K[76;253H223,2[9C88%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;1H[1m[96mprint[m[38;5;224m([m[95m'fitting model...'[m[38;5;224m)[m[76;253H[K[76;253H224,2[9C89%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;1Hstart [93m=[m [1m[96mSys.time[m[38;5;224m()[m[76;253H[K[76;253H225,2[9C89%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[63;19H[38;5;224m[46m{[70;1H}[m[75;1Hmetrics [93m<-[m [1m[96mcv.mirt[m[38;5;224m([mdata1[38;5;224m,[m ndim[38;5;224m,[m[76;253H[K[76;253H226,1[9C90%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;1H[1;75r[75;1H
[1;76r[62;19H[38;5;224m{[69;1H}[m[75;17Hmethod [93m=[m [95m'EM'[m[38;5;224m,[m[76;253H[K[76;253H227,0-1[7C90%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;17Hrandompars [93m=[m [95mF[m[38;5;224m,[m k [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m[76;253H[K[76;253H228,2[9C91%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;17Hlambda [93m=[m [1m[96mc[m[38;5;224m([mlambda1[38;5;224m,[mlambda2[38;5;224m),[m[76;253H[K[76;253H229,2[9C91%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;17Ha_true [93m=[m a1[38;5;224m,[m[76;253H[K[76;253H230,2[9C92%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;17Hd_true [93m=[m d1[38;5;224m,[m[76;253H[K[76;253H231,2[9C93%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;17Htheta_true [93m=[m theta1[38;5;224m,[m[76;253H[K[76;253H232,2[9C93%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;17Hpars [93m=[m pars[38;5;224m)[m[76;253H[K[76;253H233,2[9C94%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;1Hend [93m=[m [1m[96mSys.time[m[38;5;224m()[m[76;253H[K[76;253H234,2[9C94%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;1Htime [93m=[m end[93m-[mstart[76;253H[K[76;253H235,2[9C95%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;1H[1m[96mprint[m[38;5;224m([mtime[38;5;224m)[m[76;253H[K[76;253H236,2[9C95%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H237,2[9C96%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# save results[m[76;253H[K[76;253H238,2[9C97%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;1HfileConn[93m<-[m[1m[96mfile[m[38;5;224m([m[1m[96mpaste0[m[38;5;224m([m[95m'~/rgmirt/results/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[38;5;224m))[m[76;253H[K[76;253H239,2[9C97%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[1m[96mwriteLines[m[38;5;224m([m[1m[96mc[m[38;5;224m([m[1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m1[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m2[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m3[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m4[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m5[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m6[m[38;5;224m])),[m fileConn[38;5;224m)[m[76;253H[K[76;253H240,2[9C98%[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [70;2H[1;75r[75;1H
[1;76r[75;1H[1m[96mclose[m[38;5;224m([mfileConn[38;5;224m)[m[76;253H[K[76;253H241,2[9C98%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H242,0-1[7C99%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H243,2[9CBot[70;2H[?25h[?25l[76;255H4[71;2H[?25h[?25l[76;255H5[72;2H[?25h[?25l[76;243H~@k[72;2H[76;243H   [73;2H[76;255H6[73;2H[?25h[?25l[76;255H7,0-1[74;1H[?25h[?25l[76;255H8[75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [74;1H[76;255H7[74;1H[?25h[?25l[76;243H~@k[74;1H[76;243H   [73;2H[76;255H6,2  [73;2H[?25h[?25l[76;255H5[72;2H[?25h[?25l[76;255H4[71;2H[?25h[?25l[76;255H3[70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [69;1H[76;255H2,0-1[69;1H[?25h[?25l[76;243H~@k[69;1H[76;243H   [70;2H[76;255H3,2  [70;2H[?25h[?25l[76;243H~@k[70;2H[76;243H   [71;2H[76;255H4[71;2H[?25h[?25l[76;243H~@k[71;2H[76;243H   [72;2H[76;255H5[72;2H[?25h[?25l[76;243H~@k[72;2H[76;243H   [71;2H[76;255H4[71;2H[?25h[?25l[76;243H~@k[71;2H[76;243H   [71;3H[76;257H3[71;3H[?25h[?25l[76;243H~@k[71;3H[76;243H   [71;4H[76;257H4[71;4H[?25h[?25l[76;243H~@k[71;4H[76;243H   [71;5H[76;257H5[71;5H[?25h[?25l[76;243H~@k[71;5H[76;243H   [72;5H[76;255H5[72;5H[?25h[?25l[76;243H~@k[72;5H[76;243H   [71;5H[76;255H4[71;5H[?25h[?25l[76;243H~@k[71;5H[76;243H   [71;6H[76;257H6[71;6H[?25h[?25l[76;243H~@k[71;6H[76;243H   [71;7H[76;257H7[71;7H[?25h[?25l[76;243H~@k[71;7H[76;243H   [71;8H[76;257H8[71;8H[?25h[?25l[76;243H~@k[71;8H[76;243H   [71;9H[76;257H9[71;9H[?25h[?25l[76;243H~@k[71;9H[76;243H   [71;10H[76;257H10[71;10H[?25h[?25l[76;243H~@k[71;10H[76;243H   [71;11H[76;258H1[71;11H[?25h[?25l[76;243H~@k[71;11H[76;243H   [71;12H[76;258H2[71;12H[?25h[?25l[76;243H~@k[71;12H[76;243H   [71;13H[76;258H3[71;13H[?25h[?25l[76;243H~@k[71;13H[76;243H   [71;14H[76;258H4[71;14H[?25h[?25l[76;243H~@k[71;14H[76;243H   [71;15H[38;5;224m[46m([94C)[m[76;258H5[71;15H[?25h[?25l[76;243H~@k[71;15H[76;243H   [71;16H[38;5;224m([94C)[m[76;258H6[71;16H[?25h[?25l[76;243H~@k[71;16H[76;243H   [71;17H[76;258H7[71;17H[?25h[?25l[76;243H~@k[71;17H[76;243H   [71;18H[76;258H8[71;18H[?25h[?25l[76;243H~@k[71;18H[76;243H   [71;19H[76;258H9[71;19H[?25h[?25l[76;243H~@k[71;19H[76;243H   [71;20H[76;257H20[71;20H[?25h[?25l[76;243H~@k[71;20H[76;243H   [71;21H[76;258H1[71;21H[?25h[?25l[76;243H~@k[71;21H[76;243H   [71;22H[38;5;224m[46m([86C)[m[76;258H2[71;22H[?25h[?25l[76;243H~@k[71;22H[76;243H   [71;23H[38;5;224m([86C)[m[76;258H3[71;23H[?25h[?25l[76;243H~@k[71;23H[76;243H   [71;24H[76;258H4[71;24H[?25h[?25l[76;243H~@k[71;24H[76;243H   [71;25H[76;258H5[71;25H[?25h[?25l[76;243H~@k[71;25H[76;243H   [71;26H[76;258H6[71;26H[?25h[?25l[76;243H~@k[71;26H[76;243H   [71;27H[76;258H7[71;27H[?25h[?25l[76;243H~@k[71;27H[76;243H   [71;28H[76;258H8[71;28H[?25h[?25l[76;243H~@k[71;28H[76;243H   [71;29H[76;258H9[71;29H[?25h[?25l[76;243H~@k[71;29H[76;243H   [71;30H[76;257H30[71;30H[?25h[?25l[76;243H~@k[71;30H[76;243H   [71;31H[76;258H1[71;31H[?25h[?25l[76;243H~@k[71;31H[76;243H   [71;32H[76;258H2[71;32H[?25h[?25l[76;243H~@k[71;32H[76;243H   [71;33H[76;258H3[71;33H[?25h[?25l[76;243H~@k[71;33H[76;243H   [71;34H[76;258H4[71;34H[?25h[?25l[76;243H~@k[71;34H[76;243H   [71;35H[76;258H5[71;35H[?25h[?25l[76;243Hi[71;35H[76;243H [71;35H[76;1H[1m-- INSERT --[m[76;253H[K[76;253H244,35[8CBot[71;35H[?25h[?25l[76;258H6[71;36H[?25h[?25l[76;258H7[71;37H[?25h[?25l[76;258H8[71;38H[?25h[?25l[76;258H9[71;39H[?25h[?25l[76;257H40[71;40H[?25h[?25l[76;258H1[71;41H[?25h[?25l[76;258H2[71;42H[?25h[?25l[76;258H3[71;43H[?25h[?25l[76;258H4[71;44H[?25h[?25l[76;258H5[71;45H[?25h[?25l[76;258H6[71;46H[?25h[?25l[76;258H7[71;47H[?25h[?25l[76;258H8[71;48H[?25h[?25l[76;258H9[71;49H[?25h[?25l[76;257H50[71;50H[?25h[?25l[76;258H1[71;51H[?25h[?25l[76;258H2[71;52H[?25h[?25l[76;258H3[71;53H[?25h[?25l[76;258H4[71;54H[?25h[?25l[76;258H5[71;55H[?25h[?25l[76;258H6[71;56H[?25h[?25l[76;258H7[71;57H[?25h[?25l[76;258H8[71;58H[?25h[?25l[76;258H9[71;59H[?25h[?25l[76;257H60[71;60H[?25h[?25l[76;258H1[71;61H[?25h[?25l[76;258H2[71;62H[?25h[?25l[76;258H3[71;63H[?25h[?25l[76;258H4[71;64H[?25h[?25l[76;258H5[71;65H[?25h[?25l[76;258H6[71;66H[?25h[?25l[76;258H7[71;67H[?25h[?25l[76;258H8[71;68H[?25h[?25l[76;258H9[71;69H[?25h[?25l[76;257H70[71;70H[?25h[?25l[76;258H1[71;71H[?25h[?25l[76;258H2[71;72H[?25h[?25l[76;258H3[71;73H[?25h[?25l[76;258H4[71;74H[?25h[?25l[76;258H5[71;75H[?25h[?25l[76;258H6[71;76H[?25h[?25l[76;258H7[71;77H[?25h[?25l[76;258H8[71;78H[?25h[?25l[76;258H9[71;79H[?25h[?25l[76;257H80[71;80H[?25h[?25l[76;258H1[71;81H[?25h[?25l[76;258H2[71;82H[?25h[?25l[76;258H3[71;83H[?25h[?25l[76;258H4[71;84H[?25h[?25l[76;258H5[71;85H[?25h[?25l[76;258H6[71;86H[?25h[?25l[76;258H7[71;87H[?25h[?25l[76;258H8[71;88H[?25h[?25l[76;258H9[71;89H[?25h[?25l[76;257H90[71;90H[?25h[?25l[76;258H1[71;91H[?25h[?25l[76;258H2[71;92H[?25h[?25l[76;258H3[71;93H[?25h[?25l[76;258H4[71;94H[?25h[?25l[76;258H5[71;95H[?25h[?25l[76;258H6[71;96H[?25h[?25l[76;258H7[71;97H[?25h[?25l[76;258H8[71;98H[?25h[?25l[76;258H9[71;99H[?25h[?25l[76;257H100[71;100H[?25h[?25l[76;259H1[71;101H[?25h[?25l[76;259H2[71;102H[?25h[?25l[76;259H3[71;103H[?25h[?25l[76;259H4[71;104H[?25h[?25l[76;259H5[71;105H[?25h[?25l[76;259H6[71;106H[?25h[?25l[76;259H7[71;107H[?25h[?25l[76;259H8[71;108H[?25h[?25l[71;22H[38;5;224m[46m([86C)[m[76;259H9[71;109H[?25h[?25l[71;22H[38;5;224m([86C)[m[76;255H5[72;109H[?25h[?25l[76;258H10[72;110H[?25h[?25l[76;259H1[72;111H[?25h[?25ls[38;5;224m[46m[[1C][m[76;259H2[72;112H[?25h[?25l[76;259H3[72;113H[?25h[?25l[76;259H4[72;114H[?25h[?25l[72;104H[38;5;224m[46m([m[7C[38;5;224m[[1C][m[38;5;224m[46m)[m[76;259H5[72;115H[?25h[?25l[76;259H6[72;116H[?25h[?25l[72;104H[38;5;224m([10C)[m[76;259H7[72;117H[?25h[?25l[76;259H8[72;118H[?25h[?25l[76;259H9[72;119H[?25h[?25l[76;258H20[72;120H[?25h[?25l[76;259H1[72;121H[?25h[?25l[76;259H2[72;122H[?25h[?25l[76;259H3[72;123H[?25h[?25l[76;259H4[72;124H[?25h[?25l[76;259H5[72;125H[?25h[?25l[76;259H6[72;126H[?25h[?25l[76;259H7[72;127H[?25h[?25l[76;259H8[72;128H[?25h[?25l[76;259H9[72;129H[?25h[?25l[1C[38;5;224m[46m([10C)[m[76;258H30[72;130H[?25h[?25l[76;259H1[72;131H[?25h[?25l[38;5;224m([10C)[m[76;259H2[72;132H[?25h[?25l[76;259H3[72;133H[?25h[?25l[76;259H4[72;134H[?25h[?25l[76;259H5[72;135H[?25h[?25l[76;259H6[72;136H[?25h[?25l[76;259H7[72;137H[?25h[?25ls[38;5;224m[46m[[1C][m[76;259H8[72;138H[?25h[?25l[76;259H9[72;139H[?25h[?25l[76;258H40[72;140H[?25h[?25l[72;130H[38;5;224m[46m([m[7C[38;5;224m[[1C][m[38;5;224m[46m)[m[76;259H1[72;141H[?25h[?25l[76;259H2[72;142H[?25h[?25l[72;130H[38;5;224m([10C)[m[76;259H3[72;143H[?25h[?25l[76;259H4[72;144H[?25h[?25l[76;259H5[72;145H[?25h[?25l[76;259H6[72;146H[?25h[?25l[76;259H7[72;147H[?25h[?25l[76;259H8[72;148H[?25h[?25l[76;259H9[72;149H[?25h[?25l[76;258H50[72;150H[?25h[?25l[76;259H1[72;151H[?25h[?25l[76;259H2[72;152H[?25h[?25l[76;259H3[72;153H[?25h[?25l[76;259H4[72;154H[?25h[?25l[76;259H5[72;155H[?25h[?25l[1C[38;5;224m[46m([10C)[m[76;259H6[72;156H[?25h[?25l[76;259H7[72;157H[?25h[?25l[38;5;224m([10C)[m[76;259H8[72;158H[?25h[?25l[76;259H9[72;159H[?25h[?25l[76;258H60[72;160H[?25h[?25l[76;259H1[72;161H[?25h[?25l[76;259H2[72;162H[?25h[?25l[76;259H3[72;163H[?25h[?25ls[38;5;224m[46m[[1C][m[76;259H4[72;164H[?25h[?25l[76;259H5[72;165H[?25h[?25l[76;259H6[72;166H[?25h[?25l[72;156H[38;5;224m[46m([m[7C[38;5;224m[[1C][m[38;5;224m[46m)[m[76;259H7[72;167H[?25h[?25l[72;13H[38;5;224m[46m([m[142C[38;5;224m([10C)[m[38;5;224m[46m)[m[76;259H8[72;168H[?25h[?25l[38;5;224m[46m,[m[38;5;224m),[m fileConn[38;5;224m)[72;168H,[m[38;5;224m[46m)[m[76;259H9[72;169H[?25h[?25l[46m [m[38;5;224m),[m fileConn[38;5;224m)[m[72;169H [38;5;224m[46m)[m[76;258H70[72;170H[?25h[?25l[46ma[m[38;5;224m),[m fileConn[38;5;224m)[m[72;170Ha[38;5;224m[46m)[m[76;259H1[72;171H[?25h[?25l[46ms[m[38;5;224m),[m fileConn[38;5;224m)[m[72;171Hs[38;5;224m[46m)[m[76;259H2[72;172H[?25h[?25l[46m.[m[38;5;224m),[m fileConn[38;5;224m)[m[72;172H.[38;5;224m[46m)[m[76;259H3[72;173H[?25h[?25l[46mc[m[38;5;224m),[m fileConn[38;5;224m)[m[72;173Hc[38;5;224m[46m)[m[76;259H4[72;174H[?25h[?25l[46mh[m[38;5;224m),[m fileConn[38;5;224m)[m[72;174Hh[38;5;224m[46m)[m[76;259H5[72;175H[?25h[?25l[46ma[m[38;5;224m),[m fileConn[38;5;224m)[m[72;175Ha[38;5;224m[46m)[m[76;259H6[72;176H[?25h[?25l[46mr[m[38;5;224m),[m fileConn[38;5;224m)[m[72;176Hr[38;5;224m[46m)[m[76;259H7[72;177H[?25h[?25l[46ma[m[38;5;224m),[m fileConn[38;5;224m)[m[72;177Ha[38;5;224m[46m)[m[76;259H8[72;178H[?25h[?25l[46mc[m[38;5;224m),[m fileConn[38;5;224m)[m[72;178Hc[38;5;224m[46m)[m[76;259H9[72;179H[?25h[?25l[46mt[m[38;5;224m),[m fileConn[38;5;224m)[m[72;179Ht[38;5;224m[46m)[m[76;258H80[72;180H[?25h[?25l[46me[m[38;5;224m),[m fileConn[38;5;224m)[m[72;180He[38;5;224m[46m)[m[76;259H1[72;181H[?25h[?25l[46mr[m[38;5;224m),[m fileConn[38;5;224m)[m[72;181Hr[38;5;224m[46m)[m[76;259H2[72;182H[?25h[?25l[46m [m[38;5;224m),[m fileConn[38;5;224m)[m[72;182H [38;5;224m[46m)[m[76;259H3[72;183H[?25h[?25l[38;5;224m)[m[38;5;224m[46m,[m fileConn[38;5;224m)[m[72;194H[K[72;182H[38;5;224m[46m)[m[38;5;224m,[m[76;259H2[72;182H[?25h[?25l[72;170H[1m[96mas.character[m[38;5;224m[46m([m[38;5;224m),[m fileConn[38;5;224m)[72;13H([m[169C[38;5;224m[46m)[m[76;259H3[72;183H[?25h[?25l[46mm[m[38;5;224m),[m fileConn[38;5;224m)[m[72;183Hm[38;5;224m[46m)[m[76;259H4[72;184H[?25h[?25l[46me[m[38;5;224m),[m fileConn[38;5;224m)[m[72;184He[38;5;224m[46m)[m[76;259H5[72;185H[?25h[?25l[46mt[m[38;5;224m),[m fileConn[38;5;224m)[m[72;185Ht[38;5;224m[46m)[m[76;259H6[72;186H[?25h[?25l[46mr[m[38;5;224m),[m fileConn[38;5;224m)[m[72;186Hr[38;5;224m[46m)[m[76;259H7[72;187H[?25h[?25l[46mi[m[38;5;224m),[m fileConn[38;5;224m)[m[72;187Hi[38;5;224m[46m)[m[76;259H8[72;188H[?25h[?25l[46mc[m[38;5;224m),[m fileConn[38;5;224m)[m[72;188Hc[38;5;224m[46m)[m[76;259H9[72;189H[?25h[?25l[46ms[m[38;5;224m),[m fileConn[38;5;224m)[m[72;189Hs[38;5;224m[46m)[m[76;258H90[72;190H[?25h[?25l[46m [m[38;5;224m),[m fileConn[38;5;224m)[m[72;190H [38;5;224m[46m)[m[76;259H1[72;191H[?25h[?25l[38;5;224m)[m[38;5;224m[46m,[m fileConn[38;5;224m)[m[72;202H[K[72;190H[38;5;224m[46m)[m[38;5;224m,[m[76;259H0[72;190H[?25h[?25l[38;5;224m[46m[[m[38;5;231m[101m)[m[38;5;224m,[m fileConn[38;5;231m[101m)[m[72;190H[38;5;224m[[m[38;5;231m[46m)[m[76;259H1[72;191H[?25h[?25l[95m[46m7[m[38;5;231m[101m)[m[38;5;224m,[m fileConn[38;5;231m[101m)[m[72;191H[95m7[m[38;5;231m[46m)[m[76;259H2[72;192H[?25h[?25l[38;5;224m[46m][m[38;5;224m),[m fileConn[38;5;224m)[72;192H][m[38;5;224m[46m)[m[76;259H3[72;193H[?25h[?25l[76;259H4[72;194H[?25h[?25l[72;182H[38;5;224m([10C)[m[76;259H5[72;195H[?25h[?25l[72;182H[38;5;224m[46m([10C)[m[76;259H4[72;194H[?25h[?25l[38;5;224m),[m fileConn[38;5;224m)[m[72;13H[38;5;224m[46m([m[168C[38;5;224m([10C)[m[38;5;224m[46m)[m[76;259H5[72;195H[?25h[?25l[72;13H[38;5;224m([180C)[m[76;259H6[72;196H[?25h[?25l[76;259H7[72;197H[?25h[?25l[76;259H8[72;198H[?25h[?25l[76;259H9[72;199H[?25h[?25l[76;257H200[72;200H[?25h[?25l[76;259H1[72;201H[?25h[?25l[76;259H2[72;202H[?25h[?25l[76;259H3[72;203H[?25h[?25l[76;259H4[72;204H[?25h[?25l[72;11H[38;5;224m[46m([193C)[m[76;259H5[72;205H[?25h[76;1H[K[72;204H[?25l[76;243H^[[72;204H[76;243H  [72;205H[72;11H[38;5;224m([193C)[m[76;253H245,204[7CBot[72;204H[?25h[?25l[76;243H:[72;204H[76;243H[K[76;1H:[?2004h[?25h [?25l[72;204H[76;253H245,204[7CBot[72;204H[?25h[?25l[76;243H~@k[72;204H[76;243H   [71;110H[71;15H[38;5;224m[46m([94C)[m[76;255H4,110[71;110H[?25h[?25l[76;243H~@k[71;110H[76;243H   [70;14H[71;15H[38;5;224m([94C)[m[76;255H3,14 [70;14H[?25h[?25l[76;243H~@k[70;14H[76;243H   [69;1H[76;255H2,0-1[69;1H[?25h[?25l[76;243H~@k[69;1H[76;243H   [68;11H[38;5;224m[46m([mtime[38;5;224m[46m)[m[76;255H1,11 [68;11H[?25h[?25l[76;243H~@k[68;11H[76;243H   [67;16H[68;6H[38;5;224m([mtime[38;5;224m)[m[76;255H0,16[67;16H[?25h[?25l[76;243H~@k[67;16H[76;243H   [66;16H[38;5;224m[46m()[m[76;254H39[66;16H[?25h[?25l[76;243H~@k[66;16H[76;243H   [65;28H[58;19H[38;5;224m[46m([65;28H)[m[66;15H[38;5;224m()[m[76;255H8,28[65;28H[?25h[?25l[76;243H~@k[65;28H[76;243H   [64;36H[58;19H[38;5;224m([65;28H)[m[76;255H7,36[64;36H[?25h[?25l[76;243H~@k[64;36H[76;243H   [63;29H[76;255H6,29[63;29H[?25h[?25l[76;243H~@k[63;29H[76;243H   [62;29H[76;255H5[62;29H[?25h[?25l[76;243H~@k[62;29H[76;243H   [61;45H[76;255H4,45[61;45H[?25h[?25l[76;243H~@k[61;45H[76;243H   [60;44H[76;255H3,44[60;44H[?25h[?25l[76;243H~@k[60;44H[76;243H   [59;30H[76;255H2,30[59;30H[?25h[?25l[76;243H~@k[59;30H[76;243H   [58;32H[76;255H1,32[58;32H[?25h[?25l[76;243H~@k[58;32H[76;243H   [57;18H[38;5;224m[46m()[m[76;255H0,18[57;18H[?25h[?25l[76;243H~@k[57;18H[76;243H   [56;25H[56;6H[38;5;224m[46m([18C)[m[57;17H[38;5;224m()[m[76;254H29,25[56;25H[?25h[?25l[76;243H~@k[56;25H[76;243H   [55;11H[56;6H[38;5;224m([18C)[m[76;255H8,11[55;11H[?25h[?25l[76;243H~@k[55;11H[76;243H   [54;1H[76;255H7,0-1[54;1H[?25h[?25l[76;243H~@k[54;1H[76;243H   [53;1H[46;19H[38;5;224m[46m{[53;1H}[m[76;255H6,1  [53;1H[?25h[?25l[76;243H~@k[53;1H[76;243H   [52;79H[46;19H[38;5;224m{[53;1H}[m[76;255H5,79[52;79H[?25h[?25l[76;243H~@k[52;79H[76;243H   [51;77H[76;255H4,77[51;77H[?25h[?25l[76;243H~@k[51;77H[76;243H   [50;79H[76;255H3,79[50;79H[?25h[?25l[76;243H~@k[50;79H[76;243H   [49;77H[76;255H2,77[49;77H[?25h[?25l[76;243H~@k[49;77H[76;243H   [48;78H[76;255H1,78[48;78H[?25h[?25l[76;243H~@k[48;78H[76;243H   [47;76H[76;255H0,76[47;76H[?25h[?25l[76;243H~@k[47;76H[76;243H   [46;19H[38;5;224m[46m{[53;1H}[m[76;254H19,19[46;19H[?25h[?25l[76;243H~@k[46;19H[76;243H   [45;78H[46;19H[38;5;224m{[53;1H}[m[76;255H8,78[45;78H[?25h[?25l[76;243H~@k[45;78H[76;243H   [44;76H[76;255H7,76[44;76H[?25h[?25l[76;243H~@k[44;76H[76;243H   [43;77H[76;255H6,77[43;77H[?25h[?25l[76;243H~@k[43;77H[76;243H   [42;75H[76;255H5,75[42;75H[?25h[?25l[76;243H~@k[42;75H[76;243H   [41;20H[38;5;224m[46m{[46;1H}[m[76;255H4,20[41;20H[?25h[?25l[76;243H~@k[41;20H[76;243H   [40;75H[41;20H[38;5;224m{[46;1H}[m[76;255H3,75[40;75H[?25h[?25l[76;243H~@k[40;75H[76;243H   [39;73H[76;255H2,73[39;73H[?25h[?25l[76;243H~@k[39;73H[76;243H   [38;12H[38;5;224m[46m{


}[m[76;255H1,12[38;12H[?25h[?25l[76;243H~@k[38;12H[76;243H   [37;27H[38;12H[38;5;224m{


}[m[76;255H0,27[37;27H[?25h[?25l[76;243H~@k[37;27H[76;243H   [36;1H[76;254H09,0-1[36;1H[?25h[?25l[76;243H~@k[36;1H[76;243H   [35;61H[35;13H[38;5;224m[46m([47C)[m[76;255H8,61 [35;61H[?25h[?25l[76;243H~@k[35;61H[76;243H   [34;29H[34;6H[38;5;224m[46m([22C)[m[35;13H[38;5;224m([47C)[m[76;255H7,29[34;29H[?25h[?25l[76;243H~@k[34;29H[76;243H   [33;22H[34;6H[38;5;224m([22C)[m[76;255H6,22[33;22H[?25h[?25l[76;243H~@k[33;22H[76;243H   [32;6H[76;255H5,6 [32;6H[?25h[?25l[76;243H~@k[32;6H[76;243H   [31;95H[31;5H[38;5;224m[46m([89C)[m[76;255H4,95[31;95H[?25h[?25l[76;243H~@k[31;95H[76;243H   [30;28H[31;5H[38;5;224m([89C)[m[76;255H3,28[30;28H[?25h[?25l[76;243H~@k[30;28H[76;243H   [29;1H[76;255H2,0-1[29;1H[?25h[?25l[76;243H~@k[29;1H[76;243H   [28;98H[28;17H[38;5;224m[46m([80C)[m[76;255H1,98 [28;98H[?25h[?25l[76;243H~@k[28;98H[76;243H   [27;28H[28;17H[38;5;224m([80C)[m[76;255H0,2[27;28H[?25h[?25l[76;243H~@k[27;28H[76;243H   [26;1H[76;253H199,0-1[26;1H[?25h[?25l[76;243H~@k[26;1H[76;243H   [25;1H[76;255H8,1  [25;1H[?25h[?25l[76;243H~@k[25;1H[76;243H   [24;100H[24;9H[38;5;224m[46m([90C)[m[76;255H7,100[24;100H[?25h[?25l[76;243H~@k[24;100H[76;243H   [23;3H[24;9H[38;5;224m([90C)[m[76;255H6,3  [23;3H[?25h[?25l[76;243H~@k[23;3H[76;243H   [22;5H[76;255H5,5[22;5H[?25h[?25l[76;243H~@k[22;5H[76;243H   [21;6H[76;255H4,6[21;6H[?25h[?25l[76;243H~@k[21;6H[76;243H   [20;31H[20;16H[38;5;224m[46m([14C)[m[76;255H3,31[20;31H[?25h[?25l[76;243H~@k[20;31H[76;243H   [19;31H[19;16H[38;5;224m[46m([14C)[m[20;16H[38;5;224m([14C)[m[76;255H2[19;31H[?25h[?25l[76;243H~@k[19;31H[76;243H   [18;33H[18;17H[38;5;224m[46m([15C)[m[19;16H[38;5;224m([14C)[m[76;255H1,33[18;33H[?25h[?25l[76;243H~@k[18;33H[76;243H   [17;31H[17;16H[38;5;224m[46m([14C)[m[18;17H[38;5;224m([15C)[m[76;255H0,31[17;31H[?25h[?25l[76;243H~@k[17;31H[76;243H   [16;33H[16;17H[38;5;224m[46m([15C)[m[17;16H[38;5;224m([14C)[m[76;254H89,33[16;33H[?25h[?25l[76;243H~@k[16;33H[76;243H   [15;100H[15;27H[38;5;224m[46m([72C)[m[16;17H[38;5;224m([15C)[m[76;255H8,100[15;100H[?25h[?25l[76;243H~@k[15;100H[76;243H   [14;1H[15;27H[38;5;224m([72C)[m[76;255H7,0-1[14;1H[?25h[?25l[76;243H~@k[14;1H[76;243H   [13;100H[13;27H[38;5;224m[46m([72C)[m[76;255H6,100[13;100H[?25h[?25l[76;243H~@k[13;100H[76;243H   [12;93H[12;18H[38;5;224m[46m([74C)[m[13;27H[38;5;224m([72C)[m[76;255H5,93 [12;93H[?25h[?25l[76;243H~@k[12;93H[76;243H   [11;91H[11;17H[38;5;224m[46m([73C)[m[12;18H[38;5;224m([74C)[m[76;255H4,91[11;91H[?25h[?25l[76;243H~@k[11;91H[76;243H   [10;39H[11;17H[38;5;224m([73C)[m[76;255H3,39[10;39H[?25h[?25l[76;243H~@k[10;39H[76;243H   [9;1H[76;255H2,1 [9;1H[?25h[?25l[76;243H~@k[9;1H[76;243H   [8;7H[6;27H[38;5;224m[46m{[8;7H}[m[76;255H1,7[8;7H[?25h[?25l[76;243H~@k[8;7H[76;243H   [7;58H[6;27H[38;5;224m{[m[7;33H[38;5;224m[46m([24C)[m[8;7H[38;5;224m}[m[76;255H0,58[7;58H[?25h[?25l[76;243H~@k[7;58H[76;243H   [6;27H[38;5;224m[46m{[m[7;33H[38;5;224m([24C)[m[8;7H[38;5;224m[46m}[m[76;254H79,27[6;27H[?25h[?25l[76;243H~@k[6;27H[76;243H   [6;7H[1;75r[1;1H[L[1;76r[1;7Hp.true [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma_true[38;5;224m,[m [1m[96mas.vector[m[38;5;224m([md_true[38;5;224m),[m theta_true[38;5;224m)[m[4;27H[38;5;224m[46m{[6;7H}[m[7;27H[38;5;224m{[9;7H}[m[76;253H[K[76;253H178,7[9C99%[6;7H[?25h[?25l[76;243H~@k[6;7H[76;243H   [6;58H[1;75r[1;1H[L[1;76r[1;7Hp.pred [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)[5;27H{[m[6;33H[38;5;224m[46m([24C)[m[7;7H[38;5;224m}[m[76;253H[K[76;253H177,58[8C98%[6;58H[?25h[?25l[76;243H~@k[6;58H[76;243H   [6;27H[1;75r[1;1H[L[1;76r[1;7H[96m# calculate true and predicted probablities[m[6;27H[38;5;224m[46m{[m[7;33H[38;5;224m([24C)[m[8;7H[38;5;224m[46m}[m[76;253H[K[76;253H176,27[8C98%[6;27H[?25h[?25l[76;243H~@k[6;27H[76;243H   [6;143H[1;75r[1;1H[L[1;76r[7;27H[38;5;224m{[9;7H}[m[76;253H[K[76;253H175,143[7C97%[6;143H[?25h[?25l[76;243H~@k[6;143H[76;243H   [6;6H[1;75r[1;1H[L[1;76r[1;7Htheta [93m<-[m [1m[96mfscores[m[38;5;224m([mfit[38;5;224m)[m[76;253H[K[76;253H174,6[9C97%[6;6H[?25h[?25l[76;243H~@k[6;6H[76;243H   [6;67H[1;75r[1;1H[L[1;76r[1;7Hd [93m<-[m itempars[38;5;224m[,[m [1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m2[m[38;5;224m][m[6;29H[38;5;224m[46m([37C)[m[76;253H[K[76;253H173,67[8C96%[6;67H[?25h[?25l[76;243H~@k[6;67H[76;243H   [6;41H[1;75r[1;1H[L[1;76r[1;7Ha [93m<-[m itempars[38;5;224m[,[m[95m1[m[38;5;224m:([m[1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m3[m[38;5;224m)][m[6;29H[38;5;224m[46m([11C)[m[7;29H[38;5;224m([37C)[m[76;253H[K[76;253H172,41[8C95%[6;41H[?25h[?25l[76;243H~@k[6;41H[76;243H   [6;49H[1;75r[1;1H[L[1;76r[1;7Hitempars [93m<-[m [1m[96mcoef[m[38;5;224m([mfit[38;5;224m,[m simplify [93m=[m [95mTRUE[m[38;5;224m)$[mitems[7;29H[38;5;224m([11C)[m[76;253H[K[76;253H171,49[8C95%[6;49H[?25h[?25l[76;243H~@k[6;49H[76;243H   [6;6H[1;75r[1;1H[L[1;76r[1;7H[96m# save parameters[m[76;253H[K[76;253H170,6[9C94%[6;6H[?25h[?25l[76;243H~@k[6;6H[76;243H   [6;27H[1;75r[1;1H[L[1;76r[1;7Hfit [93m<-[m [1m[96mmirt[m[38;5;224m([mtrain[38;5;224m,[m model[38;5;224m,[m [95m'2PL'[m[38;5;224m,[m method[93m=[mmethod[38;5;224m,[m GenRandomPars[93m=[mrandompars[38;5;224m,[m lambda[93m=[mlambda[38;5;224m,[m pars[93m=[mpars[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m([mNCYCLES[93m=[m[95m10[m[38;5;224m))[m[6;23H[38;5;224m[46m([mfit[38;5;224m[46m)[m[76;253H[K[76;253H169,27[8C94%[6;27H[?25h[?25l[76;243H~@k[6;27H[76;243H   [6;39H[1;75r[1;1H[L[1;76r[1;7H[96m# fit model[m[6;20H[38;5;224m[46m[[18C][m[7;23H[38;5;224m([mfit[38;5;224m)[m[76;253H[K[76;253H168,39[8C93%[6;39H[?25h[?25l[76;243H~@k[6;39H[76;243H   [6;42H[1;75r[1;1H[L[1;76r[6;20H[38;5;224m[46m[[21C][m[7;20H[38;5;224m[[18C][m[76;253H[K[76;253H167,42[8C93%[6;42H[?25h[?25l[76;243H~@k[6;42H[76;243H   [6;50H[1;75r[1;1H[L[1;76r[1;7H[38;5;224m}[7;20H[[21C][m[76;253H[K[76;253H166,50[8C92%[6;50H[?25h[?25l[76;243H~@k[6;50H[76;243H   [6;23H[1;75r[1;1H[L[1;76r[1;9Hitem.ind [93m=[m item.ind[38;5;224m[[m[93m![mitem.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m)][m[76;253H[K[76;253H165,23[8C91%[6;23H[?25h[?25l[76;243H~@k[6;23H[76;243H   [6;135H[1;75r[1;1H[L[1;76r[1;9Htrain [93m=[m train[38;5;224m[,[m[93m![memptycols[38;5;224m][m[6;18H[38;5;224m[46m([116C)[m[76;253H[K[76;253H164,135[7C91%[6;135H[?25h[?25l[76;243H~@k[6;135H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[1;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[7;18H([116C)[m[76;253H[K[76;253H163,17[8C90%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;6H[1;75r[1;1H[L[1;76r[1;7H[96m# do the same for columns[m[76;253H[K[76;253H162,6[9C90%[6;6H[?25h[?25l[76;243H~@k[6;6H[76;243H   [6;7H[1;75r[1;1H[L[1;76r[1;7H[38;5;224m}[m[3;27H[38;5;224m[46m{[6;7H}[m[76;253H[K[76;253H161,7[9C89%[6;7H[?25h[?25l[76;243H~@k[6;7H[76;243H   [6;60H[1;75r[1;1H[L[1;76r[1;9Hper.ind [93m=[m per.ind[38;5;224m[[m[93m![mper.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m)][4;27H{[m[6;28H[38;5;224m[46m[[31C][m[7;7H[38;5;224m}[m[76;253H[K[76;253H160,60[8C89%[6;60H[?25h[?25l[76;243H~@k[6;60H[76;243H   [6;34H[1;75r[1;1H[L[1;76r[1;9Htrain [93m=[m train[38;5;224m[[m[93m![memptyrows[38;5;224m,[m [38;5;224m][m[6;22H[38;5;224m[46m[[11C][m[7;28H[38;5;224m[[31C][m[76;253H[K[76;253H159,34[8C88%[6;34H[?25h[?25l[76;243H~@k[6;34H[76;243H   [6;27H[1;75r[1;1H[L[1;76r[1;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[6;27H[38;5;224m[46m{[m[7;22H[38;5;224m[[11C][m[9;7H[38;5;224m[46m}[m[76;253H[K[76;253H158,27[8C87%[6;27H[?25h[?25l[76;243H~@k[6;27H[76;243H   [6;31H[1;75r[1;1H[L[1;76r[1;7Hemptycols [93m=[m [1m[96mcolSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mnrow[m[38;5;224m([mtrain[38;5;224m)[7;27H{[10;7H}[m[76;253H[K[76;253H157,31[8C87%[6;31H[?25h[?25l[76;243H~@k[6;31H[76;243H   [6;7H[1;75r[1;1H[L[1;76r[1;7Hemptyrows [93m=[m [1m[96mrowSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mncol[m[38;5;224m([mtrain[38;5;224m)[m[3;27H[38;5;224m[46m{[6;7H}[m[76;253H[K[76;253H156,7[9C86%[6;7H[?25h[?25l[76;243H~@k[6;7H[76;243H   [7;31H[3;27H[38;5;224m{[6;7H}[m[76;255H7,31[7;31H[?25h[?25l[76;243H~@k[7;31H[76;243H   [8;27H[38;5;224m[46m{[11;7H}[m[76;255H8,27[8;27H[?25h[?25l[76;243H~@k[8;27H[76;243H   [9;34H[8;27H[38;5;224m{[m[9;22H[38;5;224m[46m[[11C][m[11;7H[38;5;224m}[m[76;255H9,34[9;34H[?25h[?25l[76;243H~@k[9;34H[76;243H   [10;60H[9;22H[38;5;224m[[11C][m[10;28H[38;5;224m[46m[[31C][m[76;254H60,60[10;60H[?25h[?25l[76;243H~@k[10;60H[76;243H   [11;7H[8;27H[38;5;224m[46m{[m[10;28H[38;5;224m[[31C][m[11;7H[38;5;224m[46m}[m[76;255H1,7 [11;7H[?25h[?25l[76;243H~@k[11;7H[76;243H   [12;6H[8;27H[38;5;224m{[11;7H}[m[76;255H2,6[12;6H[?25h[?25l[76;243H~@k[12;6H[76;243H   [13;17H[76;255H3,17[13;17H[?25h[?25l[76;243H~@k[13;17H[76;243H   [14;135H[14;18H[38;5;224m[46m([116C)[m[76;255H4,135[14;135H[?25h[?25l[76;243H~@k[14;135H[76;243H   [14;135H[?25h[?25l[76;243H~@k[14;135H[76;243H   [14;135H[?25h[?25l[76;243H~@k[14;135H[76;243H   [14;135H[?25h[?25l[76;243H~@k[14;135H[76;243H   [14;135H[?25h[?25l[76;243H~@k[14;135H[76;243H   [14;135H[?25h[?25l[76;243H~@k[14;135H[76;243H   [14;135H[?25h[?25l[76;243H~@k[14;135H[76;243H   [14;135H[?25h[?25l[76;243H~@k[14;135H[76;243H   [14;135H[?25h[?25l[76;243H~@k[14;135H[76;243H   [14;135H[?25h[?25l[76;243H~@k[14;135H[76;243H   [14;135H[?25h[?25l[76;243H~@k[14;135H[76;243H   [13;17H[14;18H[38;5;224m([116C)[m[76;255H3,17 [13;17H[?25h[?25l[76;243H~@k[13;17H[76;243H   [13;17H[?25h[?25l[76;243H~@k[13;17H[76;243H   [14;135H[14;18H[38;5;224m[46m([116C)[m[76;255H4,135[14;135H[?25h[?25l[76;243H~@k[14;135H[76;243H   [14;135H[?25h[?25l[76;243H~@k[14;135H[76;243H   [14;135H[?25h[?25l[76;243H~@k[14;135H[76;243H   [14;135H[?25h[?25l[76;243H~@k[14;135H[76;243H   [14;134H[14;18H[38;5;224m([m[104C[38;5;224m[46m([10C)[m[38;5;224m)[m[76;259H4[14;134H[?25h[?25l[76;243H~@k[14;134H[76;243H   [14;135H[14;18H[38;5;224m[46m([m[104C[38;5;224m([10C)[m[38;5;224m[46m)[m[76;259H5[14;135H[?25h[?25l[76;243H~@k[14;135H[76;243H   [14;134H[14;18H[38;5;224m([m[104C[38;5;224m[46m([10C)[m[38;5;224m)[m[76;259H4[14;134H[?25h[?25l[76;243H~@k[14;134H[76;243H   [14;133H[14;123H[38;5;224m([10C)[m[76;259H3[14;133H[?25h[?25l[76;243Hi[14;133H[76;243H [14;133H[76;1H[1m-- INSERT --[m[76;253H[K[76;253H164,133[7C86%[14;133H[?25h[?25l[14;123H[38;5;224m[46m([10C)[m[76;259H4[14;134H[?25h[?25l[38;5;224m)[m[14;135H[K[14;133H[38;5;224m[46m)[m[38;5;224m)[m[76;259H3[14;133H[?25h[76;1H[K[14;132H[?25l[76;243H^[[14;132H[76;243H  [14;133H[14;123H[38;5;224m([9C)[m[76;253H164,132[7C86%[14;132H[?25h[?25l[76;243H:[14;132H[76;243H[K[76;1H:[?2004h[?25hw[?25l[?25h[?25l [?25h[?25l[?25h[?25l"fitscript.R" 248L, 8787C written[14;132H[76;253H164,132[7C86%[76;253H[K[76;253H164,132[7C86%[14;132H[?25h[?25l[76;243H:[14;132H[76;1H[K[76;1H:[?2004h[?25hq[?25l[?25h[?25l [?25h[?25l[?25h[?25l[?2004l[76;1H[K[76;1H[?2004l[?1l>[?25h[?1049l[23;0;0t]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ vim fitscript.R Rscript fitscript.R 0 0 3 1 .85
Loading required package: stats4
Loading required package: lattice
[1] "initializing pars..."
[1] "fitting model..."
Iteration: 1, Log-Lik: -1151562.107, Max-Change: 23.54328
EM cycles terminated after 1 iterations.
Iteration: 1, Log-Lik: -1153891.849, Max-Change: 25.04452
EM cycles terminated after 1 iterations.
Iteration: 1, Log-Lik: -1156791.088, Max-Change: 25.56425
EM cycles terminated after 1 iterations.
Iteration: 1, Log-Lik: -1155972.745, Max-Change: 26.02839
EM cycles terminated after 1 iterations.
Iteration: 1, Log-Lik: -1158016.823, Max-Change: 24.78922
EM cycles terminated after 1 iterations.
Iteration: 1, Log-Lik: -1158695.277, Max-Change: 25.40901
EM cycles terminated after 1 iterations.
Time difference of 5.688006 mins
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ ls [K
catscript.R  fitscript.R  mlfitscript.R
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ cd ..
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT[kveldkamp49@int5 EN-MIRT]$ ls [K
[0m[38;5;33mdata[0m  [38;5;33mmirt[0m  Movielens_results.csv  README.md  [38;5;33mscripts[0m  typescript
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT[kveldkamp49@int5 EN-MIRT]$ cd res[K[K[K[K[K[Kcd ../results/
]0;kveldkamp49@int5:~/rgmirt/results[kveldkamp49@int5 results]$ ls [K
0_0_3_1_0.85.txt
]0;kveldkamp49@int5:~/rgmirt/results[kveldkamp49@int5 results]$ cat 0_0_3_1_0.85.txt 
0.25134098154155
0.113506751062207
0.706824932643234
0.680365126344668
0.827301132282571
0.793739923311414
0.938765384751258
]0;kveldkamp49@int5:~/rgmirt/results[kveldkamp49@int5 results]$ rm *
]0;kveldkamp49@int5:~/rgmirt/results[kveldkamp49@int5 results]$ vim mirr[Kt[K[K[K[K[K[K[K[Kcd ../EN[K[KEN-MIRT/scripts/
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ vim fitscript.R 
[?2004h[?1049h[22;0;0t[?1h=[?2004h[1;76r[?12h[?12l[27m[23m[29m[m[H[2J[?25l[76;1H"fitscript.R" 248L, 8787C[2;1Hâ–½[6n[2;1H  [1;1H[>c]10;?]11;?[1;3Hfolds.persons [38;5;130m<-[m  [36mcut[m[35m([m[36mseq[m[35m([m[31m1[m[35m,[m[36mnrow[m[35m([mdata[35m)),[mbreaks[38;5;130m=[mk[35m[[m[31m1[m[35m],[mlabels[38;5;130m=[m[31mFALSE[m[35m)[m
  folds.items [38;5;130m<-[m [36mcut[m[35m([m[36mseq[m[35m([m[31m1[m[35m,[m[36mncol[m[35m([mdata[35m)),[mbreaks[38;5;130m=[mk[35m[[m[31m2[m[35m],[mlabels[38;5;130m=[m[31mFALSE[m[35m)[m

  rmses [38;5;130m=[m [36mc[m[35m()[m
  biases [38;5;130m=[m [36mc[m[35m()[m
  accuracies [38;5;130m=[m [36mc[m[35m()[m
  f1s [38;5;130m=[m [36mc[m[35m()[m
  acc10 [38;5;130m=[m acc20 [38;5;130m=[m f110 [38;5;130m=[m f120 [38;5;130m=[m ndcg [38;5;130m=[m [36mc[m[35m()[m

  [34m# loop though cross validation folds[m
  [38;5;130mfor[m [35m([mi [38;5;130min[m [31m1[m[35m:[mk[35m[[m[31m1[m[35m])
[m  [35m{[m
    [38;5;130mfor[m [35m([mj [38;5;130min[m [31m1[m[35m:[mk[35m[[m[31m2[m[35m])
[m    [35m{[m[15;7H[34m# save the persons and items that belong to the hold out test set[m[16;7Hper.ind [38;5;130m<-[m [36mwhich[m[35m([mfolds.persons[38;5;130m==[mi[35m)[m[17;7Hitem.ind [38;5;130m<-[m [36mwhich[m[35m([mfolds.items[38;5;130m==[mj[35m)[m[19;7H[34m# create train and test folds[m[20;7Htest [38;5;130m<-[m data[35m[[mper.ind[35m,[m item.ind[35m][m[21;7Htrain [38;5;130m<-[m data[22;7Htrain[35m[[mper.ind[35m,[mitem.ind[35m][m [38;5;130m<-[m [31mNA[m[24;7H[34m# [m[34m[103mif[m[34m some rows contain no responses after the leave out set, remove them from the training set, and adjust person indices accordingly[m[25;7Hemptyrows [38;5;130m=[m [36mrowSums[m[35m([m[36mis.na[m[35m([mtrain[35m))[m [38;5;130m==[m [36mncol[m[35m([mtrain[35m)[m[26;7Hemptycols [38;5;130m=[m [36mcolSums[m[35m([m[36mis.na[m[35m([mtrain[35m))[m [38;5;130m==[m [36mnrow[m[35m([mtrain[35m)[m[27;7H[38;5;130m[103mif[m[35m([m[36msum[m[35m([memptyrows[35m)[m[38;5;130m>[m[31m0[m[35m){[m[28;9Htrain [38;5;130m=[m train[35m[[m[38;5;130m![memptyrows[35m,[m [35m][m[29;9Hper.ind [38;5;130m=[m per.ind[35m[[m[38;5;130m![mper.ind [38;5;130m%in%[m [36mwhich[m[35m([memptyrows[35m)][30;7H}[m[31;7H[34m# do the same for columns[m[32;7H[38;5;130m[103mif[m[35m([m[36msum[m[35m([memptycols[35m)[m[38;5;130m>[m[31m0[m[35m){[m[33;9Htrain [38;5;130m=[m train[35m[,[m[38;5;130m![memptycols[35m][m[34;9Hitem.ind [38;5;130m=[m item.ind[35m[[m[38;5;130m![mitem.ind [38;5;130m%in%[m [36mwhich[m[35m([memptycols[35m)][35;7H}[m[37;7H[34m# fit model[m[38;7Hfit [38;5;130m<-[m [36mmirt[m[35m([mtrain[35m,[m model[35m,[m [31m'2PL'[m[35m,[m method[38;5;130m=[mmethod[35m,[m GenRandomPars[38;5;130m=[mrandompars[35m,[m lambda[38;5;130m=[mlambda[35m,[m pars[38;5;130m=[mpars[35m,[m technical [38;5;130m=[m [32mlist[m[35m([mNCYCLES[38;5;130m=[m[31m1[m[35m))[m[39;7H[34m# save parameters[m[40;7Hitempars [38;5;130m<-[m [36mcoef[m[35m([mfit[35m,[m simplify [38;5;130m=[m [31mTRUE[m[35m)$[mitems[41;7Ha [38;5;130m<-[m itempars[35m[,[m[31m1[m[35m:([m[36mncol[m[35m([mitempars[35m)[m[38;5;130m-[m[31m3[m[35m)][m[42;7Hd [38;5;130m<-[m itempars[35m[,[m [36mncol[m[35m([mitempars[35m)[m[38;5;130m-[m[31m2[m[35m][m[43;7Htheta [38;5;130m<-[m [36mfscores[m[35m([mfit[35m)[m[45;7H[34m# calculate true and predicted probablities[m[46;7Hp.pred [38;5;130m<-[m [36mpredict.mirt[m[35m([ma[35m,[m d[35m,[m theta[35m)[m[47;7Hp.true [38;5;130m<-[m [36mpredict.mirt[m[35m([ma_true[35m,[m [36mas.vector[m[35m([md_true[35m),[m theta_true[35m)[m[49;7H[34m# [m[34m[103mif[m[34m there are rows without responses, they have no theta estimates, so we have to fill in some empty rows to make the dimensions correct[m[50;7H[38;5;130m[103mif[m[35m([m[36msum[m[35m([memptyrows[35m)[m[38;5;130m>[m[31m0[m[35m){[m[51;9Hp.pred [38;5;130m=[m [36minsertEmptyRows[m[35m([mp.pred[35m,[m [36mwhich[m[35m([memptyrows[35m))[52;7H}[m[53;7H[38;5;130m[103mif[m[35m([m[36msum[m[35m([memptycols[35m)[m[38;5;130m>[m[31m0[m[35m){[m[54;9Hp.pred [38;5;130m=[m [36minsertEmptyCols[m[35m([mp.pred[35m,[m [36mwhich[m[35m([memptycols[35m))[55;7H}[m[57;7H[34m# calculate metrics and save them[m[58;7Hrmses [38;5;130m<-[m [36mc[m[35m([mrmses[35m,[m [36mRMSE[m[35m([mest[38;5;130m=[mp.pred[35m[[mper.ind[35m,[m item.ind[35m],[m par[38;5;130m=[mp.true[35m[[mper.ind[35m,[m item.ind[35m]))[m[59;7Hbiases [38;5;130m<-[m [36mc[m[35m([mbiases[35m,[m [36mbias[m[35m([mest[38;5;130m=[mp.pred[35m[[mper.ind[35m,[m item.ind[35m],[m par[38;5;130m=[mp.true[35m[[mper.ind[35m,[m item.ind[35m]))[m[60;7Htop10 [38;5;130m<-[m [36macc_f1_at_n[m[35m([mp_true[38;5;130m=[mp.true[35m[[mper.ind[35m,[m item.ind[35m],[m p_pred[38;5;130m=[mp.pred[35m[[mper.ind[35m,[m item.ind[35m],[m n[38;5;130m=[m[31m10[m[35m)[m[62;7Htop20 [38;5;130m<-[m [36macc_f1_at_n[m[35m([mp_true[38;5;130m=[mp.true[35m[[mper.ind[35m,[m item.ind[35m],[m p_pred[38;5;130m=[mp.pred[35m[[mper.ind[35m,[m item.ind[35m],[m n[38;5;130m=[m[31m20[m[35m)[m[63;7Hacc10 [38;5;130m<-[m [36mc[m[35m([macc10[35m,[m top10[35m[[m[31m1[m[35m])[m[64;7Hf110 [38;5;130m<-[m [36mc[m[35m([mf110[35m,[m top10[35m[[m[31m2[m[35m])[m[65;7Hacc20 [38;5;130m<-[m [36mc[m[35m([macc20[35m,[m top20[35m[[m[31m1[m[35m])[m[66;7Hf120 [38;5;130m<-[m [36mc[m[35m([mf120[35m,[m top20[35m[[m[31m2[m[35m])[m[67;7Hndcg [38;5;130m<-[m [36mc[m[35m([mndcg[35m,[m top10[35m[[m[31m3[m[35m])[69;5H}
[m  [35m}[m
  [38;5;130mreturn[m[35m([m[36mc[m[35m([m[36mmean[m[35m([mrmses[35m),[m [36mmean[m[35m([mbiases[35m),[m [36mmean[m[35m([macc10[35m),[m [36mmean[m[35m([macc20[35m),[m [36mmean[m[35m([mf110[35m),[m [36mmean[m[35m([mf120[35m),[m [36mmean[m[35m([mndcg[35m)))
}[m

[34m# read appropriate data file[m
data1 [38;5;130m=[m [36mread.csv[m[35m([m[36mpaste[m[35m([m[31m'~/rgmirt/data/'[m[35m,[m ndim[35m,[m iteration[35m,[m sparsity[35m,[m [31m'.csv'[m[35m,[m sep[38;5;130m=[m[31m'_'[m[35m),[m row.names[38;5;130m=[m[31m1[m[35m)[m[76;253H164,132[7C72%[38;132H[?25h[27m[23m[29m[m[H[2J[?25l[1;3Hfolds.persons [93m<-[m  [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mnrow[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m1[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m
  folds.items [93m<-[m [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mncol[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m2[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m

  rmses [93m=[m [1m[96mc[m[38;5;224m()[m
  biases [93m=[m [1m[96mc[m[38;5;224m()[m
  accuracies [93m=[m [1m[96mc[m[38;5;224m()[m
  f1s [93m=[m [1m[96mc[m[38;5;224m()[m
  acc10 [93m=[m acc20 [93m=[m f110 [93m=[m f120 [93m=[m ndcg [93m=[m [1m[96mc[m[38;5;224m()[m

  [96m# loop though cross validation folds[m
  [93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m1[m[38;5;224m])
[m  [38;5;224m{[m
    [93mfor[m [38;5;224m([mj [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m2[m[38;5;224m])
[m    [38;5;224m{[m[15;7H[96m# save the persons and items that belong to the hold out test set[m[16;7Hper.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.persons[93m==[mi[38;5;224m)[m[17;7Hitem.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.items[93m==[mj[38;5;224m)[m[19;7H[96m# create train and test folds[m[20;7Htest [93m<-[m data[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m][m[21;7Htrain [93m<-[m data[22;7Htrain[38;5;224m[[mper.ind[38;5;224m,[mitem.ind[38;5;224m][m [93m<-[m [95mNA[m[24;7H[96m# [m[30m[103mif[m[96m some rows contain no responses after the leave out set, remove them from the training set, and adjust person indices accordingly[m[25;7Hemptyrows [93m=[m [1m[96mrowSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mncol[m[38;5;224m([mtrain[38;5;224m)[m[26;7Hemptycols [93m=[m [1m[96mcolSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mnrow[m[38;5;224m([mtrain[38;5;224m)[m[27;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[28;9Htrain [93m=[m train[38;5;224m[[m[93m![memptyrows[38;5;224m,[m [38;5;224m][m[29;9Hper.ind [93m=[m per.ind[38;5;224m[[m[93m![mper.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m)][30;7H}[m[31;7H[96m# do the same for columns[m[32;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[33;9Htrain [93m=[m train[38;5;224m[,[m[93m![memptycols[38;5;224m][m[34;9Hitem.ind [93m=[m item.ind[38;5;224m[[m[93m![mitem.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m)][35;7H}[m[37;7H[96m# fit model[m[38;7Hfit [93m<-[m [1m[96mmirt[m[38;5;224m([mtrain[38;5;224m,[m model[38;5;224m,[m [95m'2PL'[m[38;5;224m,[m method[93m=[mmethod[38;5;224m,[m GenRandomPars[93m=[mrandompars[38;5;224m,[m lambda[93m=[mlambda[38;5;224m,[m pars[93m=[mpars[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m([mNCYCLES[93m=[m[95m1[m[38;5;224m))[m[39;7H[96m# save parameters[m[40;7Hitempars [93m<-[m [1m[96mcoef[m[38;5;224m([mfit[38;5;224m,[m simplify [93m=[m [95mTRUE[m[38;5;224m)$[mitems[41;7Ha [93m<-[m itempars[38;5;224m[,[m[95m1[m[38;5;224m:([m[1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m3[m[38;5;224m)][m[42;7Hd [93m<-[m itempars[38;5;224m[,[m [1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m2[m[38;5;224m][m[43;7Htheta [93m<-[m [1m[96mfscores[m[38;5;224m([mfit[38;5;224m)[m[45;7H[96m# calculate true and predicted probablities[m[46;7Hp.pred [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)[m[47;7Hp.true [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma_true[38;5;224m,[m [1m[96mas.vector[m[38;5;224m([md_true[38;5;224m),[m theta_true[38;5;224m)[m[49;7H[96m# [m[30m[103mif[m[96m there are rows without responses, they have no theta estimates, so we have to fill in some empty rows to make the dimensions correct[m[50;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[51;9Hp.pred [93m=[m [1m[96minsertEmptyRows[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m))[52;7H}[m[53;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[54;9Hp.pred [93m=[m [1m[96minsertEmptyCols[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m))[55;7H}[m[57;7H[96m# calculate metrics and save them[m[58;7Hrmses [93m<-[m [1m[96mc[m[38;5;224m([mrmses[38;5;224m,[m [1m[96mRMSE[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[59;7Hbiases [93m<-[m [1m[96mc[m[38;5;224m([mbiases[38;5;224m,[m [1m[96mbias[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[60;7Htop10 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mp_true[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m p_pred[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m10[m[38;5;224m)[m[62;7Htop20 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mp_true[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m p_pred[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m20[m[38;5;224m)[m[63;7Hacc10 [93m<-[m [1m[96mc[m[38;5;224m([macc10[38;5;224m,[m top10[38;5;224m[[m[95m1[m[38;5;224m])[m[64;7Hf110 [93m<-[m [1m[96mc[m[38;5;224m([mf110[38;5;224m,[m top10[38;5;224m[[m[95m2[m[38;5;224m])[m[65;7Hacc20 [93m<-[m [1m[96mc[m[38;5;224m([macc20[38;5;224m,[m top20[38;5;224m[[m[95m1[m[38;5;224m])[m[66;7Hf120 [93m<-[m [1m[96mc[m[38;5;224m([mf120[38;5;224m,[m top20[38;5;224m[[m[95m2[m[38;5;224m])[m[67;7Hndcg [93m<-[m [1m[96mc[m[38;5;224m([mndcg[38;5;224m,[m top10[38;5;224m[[m[95m3[m[38;5;224m])[69;5H}
[m  [38;5;224m}[m
  [93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([m[1m[96mmean[m[38;5;224m([mrmses[38;5;224m),[m [1m[96mmean[m[38;5;224m([mbiases[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc10[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc20[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf110[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf120[38;5;224m),[m [1m[96mmean[m[38;5;224m([mndcg[38;5;224m)))
}[m

[96m# read appropriate data file[m
data1 [93m=[m [1m[96mread.csv[m[38;5;224m([m[1m[96mpaste[m[38;5;224m([m[95m'~/rgmirt/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[76;253H164,132[7C72%"fitscript.R" 248L, 8787C[38;132H[?25h[?25l[76;243H~@k[38;132H[76;243H   [37;17H[76;255H3,17 [37;17H[?25h[?25l[76;243H~@k[37;17H[76;243H   [36;6H[76;255H2,6 [36;6H[?25h[?25l[76;243H~@k[36;6H[76;243H   [35;7H[32;27H[38;5;224m[46m{[35;7H}[m[76;255H1,7[35;7H[?25h[?25l[76;243H~@k[35;7H[76;243H   [36;6H[32;27H[38;5;224m{[35;7H}[m[76;255H2,6[36;6H[?25h[?25l[76;243H~@k[36;6H[76;243H   [37;17H[76;255H3,17[37;17H[?25h[?25l[76;243H~@k[37;17H[76;243H   [38;17H[76;255H4[38;17H[?25h[?25l[76;243H~@k[38;17H[76;243H   [39;17H[76;255H5[39;17H[?25h[?25l[76;255H6[40;17H[?25h[?25l[76;255H7[41;17H[?25h[?25l[76;243H~@k[41;17H[76;243H   [42;17H[76;255H8[42;17H[?25h[?25l[76;255H9[43;17H[?25h[?25l[76;254H70,6 [44;6H[?25h[?25l[76;243H~@k[44;6H[76;243H   [45;17H[76;255H1,17[45;17H[?25h[?25l[76;243H~@k[45;17H[76;243H   [46;17H[76;255H2[46;17H[?25h[?25l[76;243H~@k[46;17H[76;243H   [47;17H[76;255H3[47;17H[?25h[?25l[76;243H~@k[47;17H[76;243H   [48;6H[76;255H4,6 [48;6H[?25h[?25l[76;243H~@k[48;6H[76;243H   [49;17H[76;255H5,17[49;17H[?25h[?25l[76;255H6[50;17H[?25h[?25l[76;255H7[51;17H[?25h[?25l[76;243H~@k[51;17H[76;243H   [52;7H[50;27H[38;5;224m[46m{[52;7H}[m[76;255H8,7 [52;7H[?25h[?25l[50;27H[38;5;224m{[52;7H}[m[76;255H9,17[53;17H[?25h[?25l[76;254H80[54;17H[?25h[?25l[53;27H[38;5;224m[46m{[55;7H}[m[76;255H1,7 [55;7H[?25h[?25l[76;243H~@k[55;7H[76;243H   [56;1H[53;27H[38;5;224m{[55;7H}[m[76;255H2,1[56;1H[?25h[?25l[76;243H~@k[56;1H[76;243H   [57;17H[76;255H3,17[57;17H[?25h[?25l[76;243H~@k[57;17H[76;243H   [58;17H[38;5;224m[46m([73C)[m[76;255H4[58;17H[?25h[?25l[38;5;224m([73C)[m[76;255H5[59;17H[?25h[?25l[76;255H6[60;17H[?25h[?25l[76;243H~@k[60;17H[76;243H   [61;1H[76;255H7,0-1[61;1H[?25h[?25l[76;255H8,17 [62;17H[?25h[?25l[63;17H[38;5;224m[46m([15C)[m[76;255H9[63;17H[?25h[?25l[38;5;224m([15C)[m[76;254H90[64;17H[?25h[?25l[65;17H[38;5;224m[46m([15C)[m[76;255H1[65;17H[?25h[?25l[76;243H~@k[65;17H[76;243H   [66;17H[65;17H[38;5;224m([15C)[m[76;255H2[66;17H[?25h[?25l[76;243H~@k[66;17H[76;243H   [67;17H[76;255H3[67;17H[?25h[?25l[76;255H4,6 [68;6H[?25h[?25l[14;5H[38;5;224m[46m{[69;5H}[m[76;255H5,5[69;5H[?25h[?25l[12;3H[38;5;224m[46m{[m[14;5H[38;5;224m{[69;5H}[m
  [38;5;224m[46m}[m[76;255H6,3[70;3H[?25h[?25l[1;75r[75;1H
[1;76r[11;3H[38;5;224m{[69;3H}[m[76;1H[K[76;253H197,17[8C73%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;1H[1;75r[75;1H
[1;76r[75;1H[96m# load true parameter values[m[76;253H[K[76;253H198,1[9C73%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [69;17H[76;255H7,17[69;17H[?25h[?25l[76;243H~@k[69;17H[76;243H   [68;3H[10;3H[38;5;224m[46m{[68;3H}[m[76;255H6,3 [68;3H[?25h[?25l[10;3H[38;5;224m{[m[12;5H[38;5;224m[46m{[67;5H}[m
  [38;5;224m}[m[76;255H5,5[67;5H[?25h[?25l[76;243H~@k[67;5H[76;243H   [66;6H[12;5H[38;5;224m{[67;5H}[m[76;255H4,6[66;6H[?25h[?25l[76;255H3,17[65;17H[?25h[?25l[76;255H2[64;17H[?25h[?25l[76;243H~@k[64;17H[76;243H   [63;17H[38;5;224m[46m([15C)[m[76;255H1[63;17H[?25h[?25l[38;5;224m([15C)[m[76;255H0[62;17H[?25h[?25l[61;17H[38;5;224m[46m([15C)[m[76;254H89[61;17H[?25h[?25l[38;5;224m([15C)[m[76;255H8[60;17H[?25h[?25l[76;255H7,0-1[59;1H[?25h[?25l[76;243H~@k[59;1H[76;243H   [58;17H[76;255H6,17 [58;17H[?25h[?25l[76;255H5[57;17H[?25h[?25l[56;17H[38;5;224m[46m([73C)[m[76;255H4[56;17H[?25h[?25l[38;5;224m([73C)[m[76;255H3[55;17H[?25h[?25l[76;255H2,1 [54;1H[?25h[?25l[76;243H~@k[54;1H[76;243H   [53;7H[51;27H[38;5;224m[46m{[53;7H}[m[76;255H1,7[53;7H[?25h[?25l[51;27H[38;5;224m{[53;7H}[m[76;255H0,17[52;17H[?25h[?25l[76;254H79[51;17H[?25h[?25l[48;27H[38;5;224m[46m{[50;7H}[m[76;255H8,7 [50;7H[?25h[?25l[48;27H[38;5;224m{[50;7H}[m[76;255H7,17[49;17H[?25h[?25l[76;255H6[48;17H[?25h[?25l[76;243H~@k[48;17H[76;243H   [47;17H[76;255H5[47;17H[?25h[?25l[76;255H4,6 [46;6H[?25h[?25l[76;255H3,17[45;17H[?25h[?25l[76;255H2[44;17H[?25h[?25l[76;255H1[43;17H[?25h[?25l[76;255H0,6 [42;6H[?25h[?25l[76;243H~@k[42;6H[76;243H   [41;17H[76;254H69,17[41;17H[?25h[?25l[76;243H~@k[41;17H[76;243H   [42;6H[76;254H70,6 [42;6H[?25h[?25l[76;243H~@k[42;6H[76;243H   [43;17H[76;255H1,17[43;17H[?25h[?25l[76;255H2[44;17H[?25h[?25l[76;255H3[45;17H[?25h[?25l[76;243H~@k[45;17H[76;243H   [46;6H[76;255H4,6 [46;6H[?25h[?25l[76;255H5,17[47;17H[?25h[?25l[76;255H6[48;17H[?25h[?25l[76;255H7[49;17H[?25h[?25l[48;27H[38;5;224m[46m{[50;7H}[m[76;255H8,7 [50;7H[?25h[?25l[76;243H~@k[50;7H[76;243H   [51;17H[48;27H[38;5;224m{[50;7H}[m[76;255H9,17[51;17H[?25h[?25l[76;254H80[52;17H[?25h[?25l[51;27H[38;5;224m[46m{[53;7H}[m[76;255H1,7 [53;7H[?25h[?25l[51;27H[38;5;224m{[53;7H}[m[76;255H2,1[54;1H[?25h[?25l[76;255H3,17[55;17H[?25h[?25l[56;17H[38;5;224m[46m([73C)[m[76;255H4[56;17H[?25h[?25l[76;243H~@k[56;17H[76;243H   [57;17H[56;17H[38;5;224m([73C)[m[76;255H5[57;17H[?25h[?25l[76;255H6[58;17H[?25h[?25l[76;243H~@k[58;17H[76;243H   [59;1H[76;255H7,0-1[59;1H[?25h[?25l[76;255H8,17 [60;17H[?25h[?25l[61;17H[38;5;224m[46m([15C)[m[76;255H9[61;17H[?25h[?25l[38;5;224m([15C)[m[76;254H90[62;17H[?25h[?25l[76;243H~@k[62;17H[76;243H   [63;17H[38;5;224m[46m([15C)[m[76;255H1[63;17H[?25h[?25l[38;5;224m([15C)[m[76;255H2[64;17H[?25h[?25l[76;255H3[65;17H[?25h[?25l[76;243H~@k[65;17H[76;243H   [66;6H[76;255H4,6 [66;6H[?25h[?25l[12;5H[38;5;224m[46m{[67;5H}[m[76;255H5,5[67;5H[?25h[?25l[10;3H[38;5;224m[46m{[m[12;5H[38;5;224m{[67;5H}[m
  [38;5;224m[46m}[m[76;255H6,3[68;3H[?25h[?25l[76;243H~@k[68;3H[76;243H   [69;17H[10;3H[38;5;224m{[68;3H}[m[76;255H7,17[69;17H[?25h[?25l[76;243H~@k[69;17H[76;243H   [68;3H[10;3H[38;5;224m[46m{[68;3H}[m[76;255H6,3 [68;3H[?25h[?25l[76;243H~@k[68;3H[76;243H   [67;5H[10;3H[38;5;224m{[m[12;5H[38;5;224m[46m{[67;5H}[m
  [38;5;224m}[m[76;255H5,5[67;5H[?25h[?25l[12;5H[38;5;224m{[67;5H}[m[76;255H4,6[66;6H[?25h[?25l[76;255H3,17[65;17H[?25h[?25l[76;255H2[64;17H[?25h[?25l[76;243H~@k[64;17H[76;243H   [63;17H[38;5;224m[46m([15C)[m[76;255H1[63;17H[?25h[?25l[38;5;224m([15C)[m[76;255H0[62;17H[?25h[?25l[76;243H~@k[62;17H[76;243H   [61;17H[38;5;224m[46m([15C)[m[76;254H89[61;17H[?25h[?25l[38;5;224m([15C)[m[76;255H8[60;17H[?25h[?25l[76;255H7,0-1[59;1H[?25h[?25l[76;243H~@k[59;1H[76;243H   [58;17H[76;255H6,17 [58;17H[?25h[?25l[76;255H5[57;17H[?25h[?25l[56;17H[38;5;224m[46m([73C)[m[76;255H4[56;17H[?25h[?25l[38;5;224m([73C)[m[76;255H3[55;17H[?25h[?25l[76;255H2,1 [54;1H[?25h[?25l[51;27H[38;5;224m[46m{[53;7H}[m[76;255H1,7[53;7H[?25h[?25l[76;243H~@k[53;7H[76;243H   [52;17H[51;27H[38;5;224m{[53;7H}[m[76;255H0,17[52;17H[?25h[?25l[76;254H79[51;17H[?25h[?25l[48;27H[38;5;224m[46m{[50;7H}[m[76;255H8,7 [50;7H[?25h[?25l[48;27H[38;5;224m{[50;7H}[m[76;255H7,17[49;17H[?25h[?25l[76;255H6[48;17H[?25h[?25l[76;255H5[47;17H[?25h[?25l[76;243H~@k[47;17H[76;243H   [46;6H[76;255H4,6 [46;6H[?25h[?25l[76;243H~@k[46;6H[76;243H   [45;17H[76;255H3,17[45;17H[?25h[?25l[76;243H~@k[45;17H[76;243H   [44;17H[76;255H2[44;17H[?25h[?25l[76;255H1[43;17H[?25h[?25l[76;255H0,6 [42;6H[?25h[?25l[76;243H~@k[42;6H[76;243H   [41;17H[76;254H69,17[41;17H[?25h[?25l[76;255H8[40;17H[?25h[?25l[76;255H7[39;17H[?25h[?25l[76;243H~@k[39;17H[76;243H   [38;17H[76;255H6[38;17H[?25h[?25l[76;243H~@k[38;17H[76;243H   [37;17H[76;255H5[37;17H[?25h[?25l[76;255H4[36;17H[?25h[?25l[76;255H3[35;17H[?25h[?25l[76;243H~@k[35;17H[76;243H   [34;6H[76;255H2,6 [34;6H[?25h[?25l[30;27H[38;5;224m[46m{[33;7H}[m[76;255H1,7[33;7H[?25h[?25l[76;243H~@k[33;7H[76;243H   [32;17H[30;27H[38;5;224m{[33;7H}[m[76;255H0,17[32;17H[?25h[?25l[76;254H59[31;17H[?25h[?25l[76;255H8[30;17H[?25h[?25l[76;255H7[29;17H[?25h[?25l[25;27H[38;5;224m[46m{[28;7H}[m[76;255H6,7 [28;7H[?25h[?25l[76;243H~@k[28;7H[76;243H   [27;17H[25;27H[38;5;224m{[28;7H}[m[76;255H5,17[27;17H[?25h[?25l[76;255H4[26;17H[?25h[?25l[76;255H3[25;17H[?25h[?25l[76;243H~@k[25;17H[76;243H   [24;17H[76;255H2[24;17H[?25h[?25l[76;255H1[23;17H[?25h[?25l[76;255H0[22;17H[?25h[?25l[76;243H~@k[22;17H[76;243H   [21;6H[76;254H49,6 [21;6H[?25h[?25l[76;255H8,17[20;17H[?25h[?25l[76;255H7[19;17H[?25h[?25l[76;243H~@k[19;17H[76;243H   [18;17H[76;255H6[18;17H[?25h[?25l[76;255H5[17;17H[?25h[?25l[76;255H4,6 [16;6H[?25h[?25l[76;243H~@k[16;6H[76;243H   [15;17H[76;255H3,17[15;17H[?25h[?25l[76;243H~@k[15;17H[76;243H   [16;6H[76;255H4,6 [16;6H[?25h[?25l[76;243H~@k[16;6H[76;243H   [17;17H[76;255H5,17[17;17H[?25h[?25l[76;243H~@k[17;17H[76;243H   [18;17H[76;255H6[18;17H[?25h[?25l[76;255H7[19;17H[?25h[?25l[76;243H~@k[19;17H[76;243H   [20;17H[76;255H8[20;17H[?25h[?25l[76;255H9,6 [21;6H[?25h[?25l[76;243H~@k[21;6H[76;243H   [22;17H[76;254H50,17[22;17H[?25h[?25l[76;243H~@k[22;17H[76;243H   [23;17H[76;255H1[23;17H[?25h[?25l[76;243H~@k[23;17H[76;243H   [24;17H[76;255H2[24;17H[?25h[?25l[76;243H~@k[24;17H[76;243H   [25;17H[76;255H3[25;17H[?25h[?25l[76;255H4[26;17H[?25h[?25l[76;255H5[27;17H[?25h[?25l[76;243H~@k[27;17H[76;243H   [28;7H[25;27H[38;5;224m[46m{[28;7H}[m[76;255H6,7 [28;7H[?25h[?25l[76;243H~@k[28;7H[76;243H   [29;17H[25;27H[38;5;224m{[28;7H}[m[76;255H7,17[29;17H[?25h[?25l[76;243H~@k[29;17H[76;243H   [30;17H[76;255H8[30;17H[?25h[?25l[76;255H9[31;17H[?25h[?25l[76;243H~@k[31;17H[76;243H   [32;17H[76;254H60[32;17H[?25h[?25l[76;243H~@k[32;17H[76;243H   [31;17H[76;254H59[31;17H[?25h[?25l[76;243H~@k[31;17H[76;243H   [30;17H[76;255H8[30;17H[?25h[?25l[76;255H7[29;17H[?25h[?25l[76;243H~@k[29;17H[76;243H   [28;7H[25;27H[38;5;224m[46m{[28;7H}[m[76;255H6,7 [28;7H[?25h[?25l[25;27H[38;5;224m{[28;7H}[m[76;255H5,17[27;17H[?25h[?25l[76;243H~@k[27;17H[76;243H   [26;17H[76;255H4[26;17H[?25h[?25l[76;255H3[25;17H[?25h[?25l[76;255H2[24;17H[?25h[?25l[76;255H1[23;17H[?25h[?25l[76;243H~@k[23;17H[76;243H   [22;17H[76;255H0[22;17H[?25h[?25l[76;254H49,6 [21;6H[?25h[?25l[76;255H8,17[20;17H[?25h[?25l[76;255H7[19;17H[?25h[?25l[76;243H~@k[19;17H[76;243H   [18;17H[76;255H6[18;17H[?25h[?25l[76;243H~@k[18;17H[76;243H   [17;17H[76;255H5[17;17H[?25h[?25l[76;255H4,6 [16;6H[?25h[?25l[76;255H3,17[15;17H[?25h[?25l[76;243H~@k[15;17H[76;243H   [14;17H[76;255H2[14;17H[?25h[?25l[76;255H1[13;17H[?25h[?25l[12;5H[38;5;224m[46m{[67;5H}[m[76;255H0,5 [12;5H[?25h[?25l[76;243H~@k[12;5H[76;243H   [11;17H
    [38;5;224m{[67;5H}[m[76;254H39,17[11;17H[?25h[?25l[10;3H[38;5;224m[46m{[68;3H}[m[76;255H8,3 [10;3H[?25h[?25l[38;5;224m{[68;3H}[m[76;255H7,17[9;17H[?25h[?25l[76;255H6[8;17H[?25h[?25l[76;255H5,2 [7;2H[?25h[?25l[76;255H4,17[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hfolds.items [93m<-[m [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mncol[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m2[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[6;10H[38;5;224m[46m()[m[76;253H[K[76;253H133,11[8C73%[6;11H[?25h[?25l[76;243H~@k[6;11H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[1;3Hfolds.persons [93m<-[m  [1m[96mcut[m[38;5;224m([m[1m[96mseq[m[38;5;224m([m[95m1[m[38;5;224m,[m[1m[96mnrow[m[38;5;224m([mdata[38;5;224m)),[mbreaks[93m=[mk[38;5;224m[[m[95m1[m[38;5;224m],[mlabels[93m=[m[95mFALSE[m[38;5;224m)[m[6;17H[38;5;224m[46m()[m[7;10H[38;5;224m()[m[76;253H[K[76;253H132,17[8C72%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;14H[1;75r[1;1H[L[1;76r[1;3H[96m# calculate to which fold each person and item belongs[m[6;13H[38;5;224m[46m()[m[7;17H[38;5;224m()[m[76;253H[K[76;253H131,14[8C72%[6;14H[?25h[?25l[76;243H~@k[6;14H[76;243H   [6;13H[1;75r[1;1H[L[1;76r[6;12H[38;5;224m[46m()[m[7;13H[38;5;224m()[m[76;253H[K[76;253H130,13[8C71%[6;13H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;224m{[7;12H()[m[76;253H[K[76;253H129,0-1[7C71%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[1;21Hpars[38;5;224m)[m[10C[96m# parameters object from mirt[m[76;253H[K[76;253H128,17[8C70%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Htheta_true[38;5;224m,[m    [96m# true parameter values[m[76;253H[K[76;253H127,17[8C69%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[1;21Hd_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H126,17[8C69%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Ha_true[38;5;224m,[m[8C[96m# true parameter values[m[76;253H[K[76;253H125,2[9C68%[6;2H[?25h[?25l[76;243H~@k[6;2H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;21Hlambda[38;5;224m,[m[8C[96m# l1 and l2 penalty[m[76;253H[K[76;253H124,1[9C68%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hk [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m    [96m# number of folds for 2d cross validation[m[76;253H[K[76;253H123,17[8C67%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hrandompars[38;5;224m,[m    [96m# mirt argument for whether to use random paramters values[m[76;253H[K[76;253H122,17[8C67%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[1;21Hmethod[38;5;224m,[m[8C[96m# method of esitmation, e.g. EM[m[76;253H[K[76;253H121,17[8C66%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;21Hmodel[38;5;224m,[m[9C[96m# model to be passed to mirt, can be number of dimensions[m[76;253H[K[76;253H120,17[8C65%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hcv.mirt [93m<-[m [38;5;121mfunction[m[38;5;224m([mdata[38;5;224m,[m[10C[96m# matrix of responses[m[76;253H[K[76;253H119,17[8C65%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[96m# Function that fits rgmirt model using cross validation and returns the average RMSE and average bias[m[76;253H[K[76;253H118,17[8C64%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H117,17[8C64%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H116,17[8C63%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1H[38;5;231m[101m}[m[76;253H[K[76;253H115,17[8C63%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([mavg_topn_accuracy[38;5;224m,[m avg_topn_f1_score[38;5;224m,[m avg_ndcg[38;5;224m))[m[76;253H[K[76;253H114,17[8C62%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H113,17[8C61%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;3Havg_ndcg [93m<-[m [1m[96mmean[m[38;5;224m([mndcgs[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H112,0-1[7C61%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;3Havg_topn_f1_score [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_f1_scores[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H111,0-1[7C60%[6;1H[?25h[?25l[76;243H~@k[6;1H[76;243H   [6;1H[1;75r[1;1H[L[1;76r[1;3Havg_topn_accuracy [93m<-[m [1m[96mmean[m[38;5;224m([mtopn_accuracies[38;5;224m,[m na.rm [93m=[m [95mTRUE[m[38;5;224m)[m[76;253H[K[76;253H110,1[9C60%[6;1H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[96m# Calculate the average top-n accuracy and top-n F1 score across all users[m[76;253H[K[76;253H109,17[8C59%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H108,2[9C58%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[38;5;224m}[m[76;253H[K[76;253H107,17[8C58%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[1;5Hndcgs[38;5;224m[[mi[38;5;224m][m [93m<-[m ndcg[76;253H[K[76;253H106,17[8C57%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htopn_f1_scores[38;5;224m[[mi[38;5;224m][m [93m<-[m f1_score[76;253H[K[76;253H105,17[8C57%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htopn_accuracies[38;5;224m[[mi[38;5;224m][m [93m<-[m topn_accuracy[76;253H[K[76;253H104,17[8C56%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H103,2[9C56%[6;2H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hndcg [93m=[m [1m[96mNDCG[m[38;5;224m([mordered_true_probabilities[38;5;224m)[m[76;253H[K[76;253H102,3[9C55%[6;3H[?25h[?25l[76;243H~@k[6;3H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[1;5Hordered_true_probabilities [93m=[m p_true[38;5;224m[[mi[38;5;224m,[m indices[38;5;224m][m[76;253H[K[76;253H101,17[8C54%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H100,17[8C54%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hf1_score [93m<-[m [95m2[m [93m*[m precision [93m*[m recall [93m/[m [38;5;224m([mprecision [93m+[m recall[38;5;224m)[m[76;253H[K[76;253H99,17[9C53%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H98,4[10C53%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hrecall [93m<-[m true_positives [93m/[m actual_positives[76;253H[K[76;253H97,17[9C52%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[1;5Hprecision [93m<-[m true_positives [93m/[m n[76;253H[K[76;253H96,17[9C52%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H95,4[10C51%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hactual_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_response[38;5;224m[[mtopn_indices[38;5;224m])[m[76;253H[K[76;253H94,17[9C50%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hpredicted_positives [93m<-[m [1m[96msum[m[38;5;224m([mpred_response[38;5;224m[[mtopn_indices[38;5;224m])[m[76;253H[K[76;253H93,4[10C50%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htrue_positives [93m<-[m [1m[96msum[m[38;5;224m([mtrue_response[38;5;224m[[mtopn_indices[38;5;224m][m[93m*[mpred_response[38;5;224m[[mtopn_indices[38;5;224m])[m[76;253H[K[76;253H92,17[9C49%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[1;5H[96m# Calculate the top-n F1 score for the current user[m[76;253H[K[76;253H91,17[9C49%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H90,4[10C48%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htopn_accuracy [93m<-[m [1m[96msum[m[38;5;224m([mtrue_response[38;5;224m[[mtopn_indices[38;5;224m])[m [93m/[m n[76;253H[K[76;253H89,17[9C47%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[96m# Calculate the top-n accuracy for the current user[m[76;253H[K[76;253H88,17[9C47%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H87,17[9C46%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Htopn_indices [93m<-[m indices[38;5;224m[[m[95m1[m[38;5;224m:[mn[38;5;224m][m[76;253H[K[76;253H86,17[9C46%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;4H[1;75r[1;1H[L[1;76r[1;5Hindices [93m<-[m [1m[96morder[m[38;5;224m([m[93m-[mpred_relevance[38;5;224m)[m[76;253H[K[76;253H85,4[10C45%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5H[96m# Get the indices of the top-n predicted relevance[m[76;253H[K[76;253H84,17[9C45%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H83,17[9C44%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hpred_relevance [93m<-[m p_pred[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H82,4[10C43%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H81,17[9C43%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;5Hpred_response [93m<-[m pred_resp_matrix[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H80,17[9C42%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[1;5Htrue_response [93m<-[m true_resp_matrix[38;5;224m[[mi[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H79,17[9C42%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mnum_users[38;5;224m)[m [38;5;224m{[m[76;253H[K[76;253H78,4[10C41%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3H[96m# for each user[m[76;253H[K[76;253H77,17[9C41%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H76,4[10C40%[6;4H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hndcgs [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m[76;253H[K[76;253H75,17[9C39%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Htopn_f1_scores [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m[76;253H[K[76;253H74,17[9C39%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Htopn_accuracies [93m<-[m [38;5;121mvector[m[38;5;224m([m[95m"numeric"[m[38;5;224m,[m num_users[38;5;224m)[m[76;253H[K[76;253H73,17[9C38%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H72,17[9C38%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;2H[1;75r[1;1H[L[1;76r[1;3Hnum_movies [93m<-[m [1m[96mdim[m[38;5;224m([mp_true[38;5;224m)[[m[95m2[m[38;5;224m][m[76;253H[K[76;253H71,2[10C37%[6;2H[?25h[?25l[76;243H~@k[6;2H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[1;3Hnum_users [93m<-[m [1m[96mdim[m[38;5;224m([mp_true[38;5;224m)[[m[95m1[m[38;5;224m][m[76;253H[K[76;253H70,17[9C36%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[76;253H[K[76;253H69,17[9C36%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;3Hpred_resp_matrix [93m<-[m [1m[96mround[m[38;5;224m([mp_pred[38;5;224m,[m [95m0[m[38;5;224m)[m[76;253H[K[76;253H68,17[9C35%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;2H[1;75r[1;1H[L[1;76r[1;3Htrue_resp_matrix [93m<-[m [1m[96mround[m[38;5;224m([mp_true[38;5;224m,[m [95m0[m[38;5;224m)[m[76;253H[K[76;253H67,2[10C35%[6;2H[?25h[?25l[76;243H~@k[6;2H[76;243H   [7;17H[76;254H8,17[7;17H[?25h[?25l[76;243H~@k[7;17H[76;243H   [8;17H[76;254H9[8;17H[?25h[?25l[76;253H70[9;17H[?25h[?25l[76;254H1,2 [10;2H[?25h[?25l[76;243H~@k[10;2H[76;243H   [11;17H[76;254H2,17[11;17H[?25h[?25l[76;243H~@k[11;17H[76;243H   [12;17H[76;254H3[12;17H[?25h[?25l[76;254H4[13;17H[?25h[?25l[76;254H5[14;17H[?25h[?25l[76;254H6,4 [15;4H[?25h[?25l[76;254H7,17[16;17H[?25h[?25l[76;243H~@k[16;17H[76;243H   [17;4H[76;254H8,4 [17;4H[?25h[?25l[76;254H9,17[18;17H[?25h[?25l[76;253H80[19;17H[?25h[?25l[76;243H~@k[19;17H[76;243H   [20;17H[76;254H1[20;17H[?25h[?25l[76;254H2,4 [21;4H[?25h[?25l[76;254H3,17[22;17H[?25h[?25l[76;243H~@k[22;17H[76;243H   [23;17H[76;254H4[23;17H[?25h[?25l[76;243H~@k[23;17H[76;243H   [24;4H[76;254H5,4 [24;4H[?25h[?25l[76;243H~@k[24;4H[76;243H   [25;17H[76;254H6,17[25;17H[?25h[?25l[76;243H~@k[25;17H[76;243H   [26;17H[76;254H7[26;17H[?25h[?25l[76;243H~@k[26;17H[76;243H   [27;17H[76;254H8[27;17H[?25h[?25l[76;243H~@k[27;17H[76;243H   [26;17H[76;254H7[26;17H[?25h[?25l[76;243H~@k[26;17H[76;243H   [25;17H[76;254H6[25;17H[?25h[?25l[76;254H5,4 [24;4H[?25h[?25l[76;254H4,17[23;17H[?25h[?25l[76;243H~@k[23;17H[76;243H   [22;17H[76;254H3[22;17H[?25h[?25l[76;254H2,4 [21;4H[?25h[?25l[76;254H1,17[20;17H[?25h[?25l[76;254H0[19;17H[?25h[?25l[76;243H~@k[19;17H[76;243H   [18;17H[76;253H79[18;17H[?25h[?25l[76;254H8,4 [17;4H[?25h[?25l[76;254H7,17[16;17H[?25h[?25l[76;254H6,4 [15;4H[?25h[?25l[76;254H5,17[14;17H[?25h[?25l[76;243H~@k[14;17H[76;243H   [13;17H[76;254H4[13;17H[?25h[?25l[76;254H3[12;17H[?25h[?25l[76;254H2[11;17H[?25h[?25l[76;254H1,2 [10;2H[?25h[?25l[76;254H0,17[9;17H[?25h[?25l[76;243H~@k[9;17H[76;243H   [8;17H[76;253H69[8;17H[?25h[?25l[76;254H8[7;17H[?25h[?25l[76;254H7,2 [6;2H[?25h[?25l[76;243H~@k[6;2H[76;243H   [6;17H[1;75r[1;1H[L[1;76r[1;3H[96m# binarise probabilities to 0/1[m[76;253H[K[76;253H66,17[9C34%[6;17H[?25h[?25l[1;75r[1;1H[L[1;76r[1;1Hacc_f1_at_n [93m<-[m [38;5;121mfunction[m[38;5;224m([mp_true[38;5;224m,[m p_pred[38;5;224m,[m n[38;5;224m)[m [38;5;224m{[m[76;253H[K[76;253H65,17[9C34%[6;17H[?25h[?25l[76;243H~@k[6;17H[76;243H   [6;2H[1;75r[1;1H[L[1;76r[76;253H[K[76;253H64,2[10C33%[6;2H[?25h[?25l[76;243H~@k[6;2H[76;243H   [7;17H[76;254H5,17[7;17H[?25h[?25l[76;243H~@k[7;17H[76;243H   [8;17H[76;254H6[8;17H[?25h[?25l[76;254H7,2 [9;2H[?25h[?25l[76;254H8,17[10;17H[?25h[?25l[76;254H9[11;17H[?25h[?25l[76;243H~@k[11;17H[76;243H   [12;17H[76;253H70[12;17H[?25h[?25l[76;254H1,2 [13;2H[?25h[?25l[76;254H2,17[14;17H[?25h[?25l[76;254H3[15;17H[?25h[?25l[76;254H4[16;17H[?25h[?25l[76;254H5[17;17H[?25h[?25l[76;243H~@k[17;17H[76;243H   [18;4H[76;254H6,4 [18;4H[?25h[?25l[76;243H~@k[18;4H[76;243H   [19;17H[76;254H7,17[19;17H[?25h[?25l[76;254H8,4 [20;4H[?25h[?25l[76;254H9,17[21;17H[?25h[?25l[76;253H80[22;17H[?25h[?25l[76;254H1[23;17H[?25h[?25l[76;243H~@k[23;17H[76;243H   [24;4H[76;254H2,4 [24;4H[?25h[?25l[76;243H~@k[24;4H[76;243H   [25;17H[76;254H3,17[25;17H[?25h[?25l[76;243H~@k[25;17H[76;243H   [26;17H[76;254H4[26;17H[?25h[?25l[76;254H5,4 [27;4H[?25h[?25l[76;254H6,17[28;17H[?25h[?25l[76;243H~@k[28;17H[76;243H   [29;17H[76;254H7[29;17H[?25h[?25l[76;243H~@k[29;17H[76;243H   [30;17H[76;254H8[30;17H[?25h[?25l[76;254H9[31;17H[?25h[?25l[76;253H90,4 [32;4H[?25h[?25l[76;243H~@k[32;4H[76;243H   [33;17H[76;254H1,17[33;17H[?25h[?25l[76;254H2[34;17H[?25h[?25l[76;243H~@k[34;17H[76;243H   [35;4H[76;254H3,4 [35;4H[?25h[?25l[76;254H4,17[36;17H[?25h[?25l[76;254H5,4 [37;4H[?25h[?25l[76;243H~@k[37;4H[76;243H   [38;17H[76;254H6,17[38;17H[?25h[?25l[76;254H7[39;17H[?25h[?25l[76;254H8,4 [40;4H[?25h[?25l[76;243H~@k[40;4H[76;243H   [41;17H[76;254H9,17[41;17H[?25h[?25l[76;253H100,17[42;17H[?25h[?25l[76;255H1[43;17H[?25h[?25l[76;243H~@k[43;17H[76;243H   [44;3H[15;26H[38;5;224m[46m{[44;3H}[m[76;255H2,3 [44;3H[?25h[?25l[15;26H[38;5;224m{[44;3H}[m[76;255H3,2[45;2H[?25h[?25l[76;255H4,17[46;17H[?25h[?25l[76;255H5[47;17H[?25h[?25l[76;255H6[48;17H[?25h[?25l[76;255H7[49;17H[?25h[?25l[76;255H8,2 [50;2H[?25h[?25l[76;243H~@k[50;2H[76;243H   [51;17H[76;255H9,17[51;17H[?25h[?25l[2;44H[38;5;224m[46m{[52;1H}[m[76;254H10,1 [52;1H[?25h[?25l[2;44H[38;5;224m{[52;1H}[m[76;255H1,0-1[53;1H[?25h[?25l[76;255H2[54;1H[?25h[?25l[76;255H3,17 [55;17H[?25h[?25l[76;255H4[56;17H[?25h[?25l[76;255H5[57;17H[?25h[?25l[76;243H~@k[57;17H[76;243H   [58;17H[76;255H6[58;17H[?25h[?25l[76;243H~@k[58;17H[76;243H   [59;17H[76;255H7[59;17H[?25h[?25l[76;243H~@k[59;17H[76;243H   [60;17H[76;255H8[60;17H[?25h[?25l[76;255H9[61;17H[?25h[?25l[76;254H20[62;17H[?25h[?25l[76;243H~@k[62;17H[76;243H   [63;17H[76;255H1[63;17H[?25h[?25l[76;255H2[64;17H[?25h[?25l[76;255H3[65;17H[?25h[?25l[76;243H~@k[65;17H[76;243H   [66;1H[76;255H4,1 [66;1H[?25h[?25l[76;255H5,2[67;2H[?25h[?25l[76;243H~@k[67;2H[76;243H   [68;17H[76;255H6,17[68;17H[?25h[?25l[76;255H7[69;17H[?25h[?25l[76;255H8[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hacc10 [93m=[m acc20 [93m=[m f110 [93m=[m f120 [93m=[m ndcg [93m=[m [1m[96mc[m[38;5;224m()[m[76;253H[K[76;253H129,0-1[7C34%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[70;12H[38;5;224m[46m()[m[76;253H[K[76;253H130,13[8C34%[70;13H[?25h[?25l[1;75r[75;1H
[1;76r[69;12H[38;5;224m()[m[70;13H[38;5;224m[46m()[m[75;3H[96m# loop though cross validation folds[m[76;253H[K[76;253H131,14[8C35%[70;14H[?25h[?25l[76;243H~@k[70;14H[76;243H   [70;17H[1;75r[75;1H
[1;76r[69;13H[38;5;224m()[m[70;17H[38;5;224m[46m()[m[75;3H[93mfor[m [38;5;224m([mi [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H132,17[8C35%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[69;17H[38;5;224m()[m[70;10H[38;5;224m[46m()[m[75;3H[38;5;224m{[m[76;253H[K[76;253H133,11[8C36%[70;11H[?25h[?25l[1;75r[75;1H
[1;76r[69;10H[38;5;224m()[m[75;5H[93mfor[m [38;5;224m([mj [93min[m [95m1[m[38;5;224m:[mk[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H134,17[8C36%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;5H[38;5;224m{[m[76;253H[K[76;253H135,2[9C37%[70;2H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# save the persons and items that belong to the hold out test set[m[76;253H[K[76;253H136,17[8C38%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hper.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.persons[93m==[mi[38;5;224m)[m[76;253H[K[76;253H137,17[8C38%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hitem.ind [93m<-[m [1m[96mwhich[m[38;5;224m([mfolds.items[93m==[mj[38;5;224m)[m[76;253H[K[76;253H138,3[9C39%[70;3H[?25h[?25l[76;243H~@k[70;3H[76;243H   [70;17H[1;75r[75;1H
[1;76r[76;253H[K[76;253H139,17[8C39%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# create train and test folds[m[76;253H[K[76;253H140,5[9C40%[70;5H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htest [93m<-[m data[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m][m[76;253H[K[76;253H141,17[8C41%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htrain [93m<-[m data[76;253H[K[76;253H142,17[8C41%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htrain[38;5;224m[[mper.ind[38;5;224m,[mitem.ind[38;5;224m][m [93m<-[m [95mNA[m[76;253H[K[76;253H143,17[8C42%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H144,6[9C42%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# [m[30m[103mif[m[96m some rows contain no responses after the leave out set, remove them from the training set, and adjust person indices accordingly[m[76;253H[K[76;253H145,17[8C43%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;7Hemptyrows [93m=[m [1m[96mrowSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mncol[m[38;5;224m([mtrain[38;5;224m)[m[76;253H[K[76;253H146,17[8C43%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hemptycols [93m=[m [1m[96mcolSums[m[38;5;224m([m[1m[96mis.na[m[38;5;224m([mtrain[38;5;224m))[m [93m==[m [1m[96mnrow[m[38;5;224m([mtrain[38;5;224m)[m[76;253H[K[76;253H147,17[8C44%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H148,17[8C45%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Htrain [93m=[m train[38;5;224m[[m[93m![memptyrows[38;5;224m,[m [38;5;224m][m[76;253H[K[76;253H149,6[9C45%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Hper.ind [93m=[m per.ind[38;5;224m[[m[93m![mper.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m)][m[76;253H[K[76;253H150,17[8C46%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H151,17[8C46%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# do the same for columns[m[76;253H[K[76;253H152,17[8C47%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H153,17[8C47%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Htrain [93m=[m train[38;5;224m[,[m[93m![memptycols[38;5;224m][m[76;253H[K[76;253H154,17[8C48%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Hitem.ind [93m=[m item.ind[38;5;224m[[m[93m![mitem.ind [93m%in%[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m)][m[76;253H[K[76;253H155,17[8C49%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;7H[1;75r[75;1H
[1;76r[67;27H[38;5;224m[46m{[70;7H}[m[75;7H[38;5;224m}[m[76;253H[K[76;253H156,7[9C49%[70;7H[?25h[?25l[1;75r[75;1H
[1;76r[66;27H[38;5;224m{[69;7H}[m[76;253H[K[76;253H157,17[8C50%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# fit model[m[76;253H[K[76;253H158,17[8C50%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hfit [93m<-[m [1m[96mmirt[m[38;5;224m([mtrain[38;5;224m,[m model[38;5;224m,[m [95m'2PL'[m[38;5;224m,[m method[93m=[mmethod[38;5;224m,[m GenRandomPars[93m=[mrandompars[38;5;224m,[m lambda[93m=[mlambda[38;5;224m,[m pars[93m=[mpars[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m([mNCYCLES[93m=[m[95m1[m[38;5;224m))[m[76;253H[K[76;253H159,17[8C51%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# save parameters[m[76;253H[K[76;253H160,17[8C52%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;7H[1;75r[75;1H
[1;76r[67;27H[38;5;224m[46m{[70;7H}[m[75;7Hitempars [93m<-[m [1m[96mcoef[m[38;5;224m([mfit[38;5;224m,[m simplify [93m=[m [95mTRUE[m[38;5;224m)$[mitems[76;253H[K[76;253H161,7[9C52%[70;7H[?25h[?25l[76;243H~@k[70;7H[76;243H   [70;6H[1;75r[75;1H
[1;76r[66;27H[38;5;224m{[69;7H}[m[75;7Ha [93m<-[m itempars[38;5;224m[,[m[95m1[m[38;5;224m:([m[1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m3[m[38;5;224m)][m[76;253H[K[76;253H162,6[9C53%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hd [93m<-[m itempars[38;5;224m[,[m [1m[96mncol[m[38;5;224m([mitempars[38;5;224m)[m[93m-[m[95m2[m[38;5;224m][m[76;253H[K[76;253H163,17[8C53%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htheta [93m<-[m [1m[96mfscores[m[38;5;224m([mfit[38;5;224m)[m[76;253H[K[76;253H164,17[8C54%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[76;253H[K[76;253H165,17[8C54%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[96m# calculate true and predicted probablities[m[76;253H[K[76;253H166,17[8C55%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hp.pred [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma[38;5;224m,[m d[38;5;224m,[m theta[38;5;224m)[m[76;253H[K[76;253H167,17[8C56%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hp.true [93m<-[m [1m[96mpredict.mirt[m[38;5;224m([ma_true[38;5;224m,[m [1m[96mas.vector[m[38;5;224m([md_true[38;5;224m),[m theta_true[38;5;224m)[m[76;253H[K[76;253H168,17[8C56%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[76;253H[K[76;253H169,17[8C57%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;6H[1;75r[75;1H
[1;76r[75;7H[96m# [m[30m[103mif[m[96m there are rows without responses, they have no theta estimates, so we have to fill in some empty rows to make the dimensions correct[m[76;253H[K[76;253H170,6[9C57%[70;6H[?25h[?25l[76;243H~@k[70;6H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptyrows[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H171,17[8C58%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;9Hp.pred [93m=[m [1m[96minsertEmptyRows[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptyrows[38;5;224m))[m[76;253H[K[76;253H172,17[8C58%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H173,17[8C59%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[30m[103mif[m[38;5;224m([m[1m[96msum[m[38;5;224m([memptycols[38;5;224m)[m[93m>[m[95m0[m[38;5;224m){[m[76;253H[K[76;253H174,6[9C60%[70;6H[?25h[?25l[76;243H~@k[70;6H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;9Hp.pred [93m=[m [1m[96minsertEmptyCols[m[38;5;224m([mp.pred[38;5;224m,[m [1m[96mwhich[m[38;5;224m([memptycols[38;5;224m))[m[76;253H[K[76;253H175,17[8C60%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7H[38;5;224m}[m[76;253H[K[76;253H176,17[8C61%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H177,17[8C61%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[68;27H[38;5;224m[46m{[70;7H}[m[75;7H[96m# calculate metrics and save them[m[76;253H[K[76;253H178,7[9C62%[70;7H[?25h[?25l[1;75r[75;1H
[1;76r[67;27H[38;5;224m{[69;7H}[m[75;7Hrmses [93m<-[m [1m[96mc[m[38;5;224m([mrmses[38;5;224m,[m [1m[96mRMSE[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[76;253H[K[76;253H179,17[8C63%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;7Hbiases [93m<-[m [1m[96mc[m[38;5;224m([mbiases[38;5;224m,[m [1m[96mbias[m[38;5;224m([mest[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m par[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m]))[m[76;253H[K[76;253H180,17[8C63%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[68;27H[38;5;224m[46m{[70;7H}[m[75;7Htop10 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mp_true[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m p_pred[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m10[m[38;5;224m)[m[76;253H[K[76;253H181,7[9C64%[70;7H[?25h[?25l[1;75r[75;1H
[1;76r[67;27H[38;5;224m{[69;7H}[m[76;253H[K[76;253H182,1[9C64%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Htop20 [93m<-[m [1m[96macc_f1_at_n[m[38;5;224m([mp_true[93m=[mp.true[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m p_pred[93m=[mp.pred[38;5;224m[[mper.ind[38;5;224m,[m item.ind[38;5;224m],[m n[93m=[m[95m20[m[38;5;224m)[m[76;253H[K[76;253H183,17[8C65%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[70;17H[38;5;224m[46m([73C)[m[75;7Hacc10 [93m<-[m [1m[96mc[m[38;5;224m([macc10[38;5;224m,[m top10[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H184,17[8C65%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[69;17H[38;5;224m([73C)[m[75;7Hf110 [93m<-[m [1m[96mc[m[38;5;224m([mf110[38;5;224m,[m top10[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H185,17[8C66%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;7Hacc20 [93m<-[m [1m[96mc[m[38;5;224m([macc20[38;5;224m,[m top20[38;5;224m[[m[95m1[m[38;5;224m])[m[76;253H[K[76;253H186,17[8C67%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hf120 [93m<-[m [1m[96mc[m[38;5;224m([mf120[38;5;224m,[m top20[38;5;224m[[m[95m2[m[38;5;224m])[m[76;253H[K[76;253H187,0-1[7C67%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;7Hndcg [93m<-[m [1m[96mc[m[38;5;224m([mndcg[38;5;224m,[m top10[38;5;224m[[m[95m3[m[38;5;224m])[m[76;253H[K[76;253H188,17[8C68%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[70;17H[38;5;224m[46m([15C)[m[76;253H[K[76;253H189,17[8C68%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[69;17H[38;5;224m([15C)[75;5H}[m[76;253H[K[76;253H190,17[8C69%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[70;17H[38;5;224m[46m([15C)[m[75;3H[38;5;224m}[m[76;253H[K[76;253H191,17[8C69%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[69;17H[38;5;224m([15C)[m[75;3H[93mreturn[m[38;5;224m([m[1m[96mc[m[38;5;224m([m[1m[96mmean[m[38;5;224m([mrmses[38;5;224m),[m [1m[96mmean[m[38;5;224m([mbiases[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc10[38;5;224m),[m [1m[96mmean[m[38;5;224m([macc20[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf110[38;5;224m),[m [1m[96mmean[m[38;5;224m([mf120[38;5;224m),[m [1m[96mmean[m[38;5;224m([mndcg[38;5;224m)))[m[76;253H[K[76;253H192,17[8C70%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m[76;253H[K[76;253H193,17[8C71%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H194,6[9C71%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[15;5H[38;5;224m[46m{[70;5H}[m[75;1H[96m# read appropriate data file[m[76;253H[K[76;253H195,5[9C72%[70;5H[?25h[?25l[1;75r[75;1H
[1;76r[12;3H[38;5;224m[46m{[m[14;5H[38;5;224m{[69;5H}[m
  [38;5;224m[46m}[m[75;1Hdata1 [93m=[m [1m[96mread.csv[m[38;5;224m([m[1m[96mpaste[m[38;5;224m([m[95m'~/rgmirt/data/'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.csv'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m),[m row.names[93m=[m[95m1[m[38;5;224m)[m[76;253H[K[76;253H196,3[9C72%[70;3H[?25h[?25l[1;75r[75;1H
[1;76r[11;3H[38;5;224m{[69;3H}[m[76;253H[K[76;253H197,17[8C73%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# load true parameter values[m[76;253H[K[76;253H198,1[9C73%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[1m[96mload[m[38;5;224m([mfile[93m=[m[1m[96mpaste[m[38;5;224m([m[95m'~/rgmirt/parameters/true/true'[m[38;5;224m,[m ndim[38;5;224m,[m iteration[38;5;224m,[m sparsity[38;5;224m,[m [95m'.RData'[m[38;5;224m,[m sep[93m=[m[95m'_'[m[38;5;224m))[m[76;253H[K[76;253H199,0-1[7C74%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;17H[1;75r[75;1H
[1;76r[76;253H[K[76;253H200,17[8C75%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[70;17H[38;5;224m[46m([80C)[m[75;1H[96m# initialize paramters[m[76;253H[K[76;253H201,17[8C75%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[69;17H[38;5;224m([80C)[m[75;1H[1m[96mprint[m[38;5;224m([m[95m'initializing pars...'[m[38;5;224m)[m[76;253H[K[76;253H202,0-1[7C76%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;1Hpars [93m<-[m [1m[96mmirt[m[38;5;224m([mdata1[38;5;224m,[mndim[38;5;224m,[m pars [93m=[m [95m'values'[m[38;5;224m,[m technical [93m=[m [38;5;121mlist[m[38;5;224m())[m[76;253H[K[76;253H203,17[8C76%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H204,17[8C77%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# set some loadings to zero[m[76;253H[K[76;253H205,6[9C78%[70;6H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[30m[103mif[m[38;5;224m([mndim[93m==[m[95m1[m[38;5;224m){[m[76;253H[K[76;253H206,17[8C78%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H207,17[8C79%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H208,17[8C79%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m [93melse[m [30m[103mif[m [38;5;224m([mndim[93m==[m[95m2[m[38;5;224m){[m[76;253H[K[76;253H209,0-1[7C80%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m5[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H210,17[8C80%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[70;12H[38;5;224m[46m{


}[m

  pars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m5[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H211,12[8C81%[70;12H[?25h[?25l[1;75r[75;1H
[1;76r[69;12H[38;5;224m{


}[m[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m6[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H212,17[8C82%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m6[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H213,17[8C82%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m[93melse[m [30m[103mif[m [38;5;224m([mndim[93m==[m[95m3[m[38;5;224m){[m[76;253H[K[76;253H214,17[8C83%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H215,17[8C83%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a1'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m1[m[38;5;224m:[m[95m10[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H216,17[8C84%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m11[m[38;5;224m:[m[95m20[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H217,17[8C84%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a2'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m11[m[38;5;224m:[m[95m20[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H218,17[8C85%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a3'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m21[m[38;5;224m:[m[95m30[m[38;5;224m),[m [38;5;224m]$[mvalue [93m=[m [95m0[m[76;253H[K[76;253H219,17[8C86%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;3Hpars[38;5;224m[[mpars[38;5;224m$[mname [93m==[m [95m'a3'[m [93m&[m pars[38;5;224m$[mitem [93m%in%[m [1m[96mpaste0[m[38;5;224m([m[95m'Item_'[m[38;5;224m,[m [95m21[m[38;5;224m:[m[95m30[m[38;5;224m),[m [38;5;224m]$[mest [93m=[m [95mFALSE[m[76;253H[K[76;253H220,17[8C86%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[38;5;224m}[m[76;253H[K[76;253H221,17[8C87%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[76;253H[K[76;253H222,17[8C87%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[96m# fit model[m[76;253H[K[76;253H223,17[8C88%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;1H[1m[96mprint[m[38;5;224m([m[95m'fitting model...'[m[38;5;224m)[m[76;253H[K[76;253H224,17[8C89%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;1Hstart [93m=[m [1m[96mSys.time[m[38;5;224m()[m[76;253H[K[76;253H225,17[8C89%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[63;19H[38;5;224m[46m{[70;1H}[m[75;1Hmetrics [93m<-[m [1m[96mcv.mirt[m[38;5;224m([mdata1[38;5;224m,[m ndim[38;5;224m,[m[76;253H[K[76;253H226,1[9C90%[70;1H[?25h[?25l[1;75r[75;1H
[1;76r[62;19H[38;5;224m{[69;1H}[m[75;17Hmethod [93m=[m [95m'EM'[m[38;5;224m,[m[76;253H[K[76;253H227,0-1[7C90%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;11H[1;75r[75;1H
[1;76r[75;17Hrandompars [93m=[m [95mF[m[38;5;224m,[m k [93m=[m [1m[96mc[m[38;5;224m([m[95m3[m[38;5;224m,[m[95m2[m[38;5;224m),[m[76;253H[K[76;253H228,11[8C91%[70;11H[?25h[?25l[1;75r[75;1H
[1;76r[75;17Hlambda [93m=[m [1m[96mc[m[38;5;224m([mlambda1[38;5;224m,[mlambda2[38;5;224m),[m[76;253H[K[76;253H229,17[8C91%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[70;17H[38;5;224m[46m()[m[75;17Ha_true [93m=[m a1[38;5;224m,[m[76;253H[K[76;253H230,17[8C92%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[69;17H[38;5;224m()[m[75;17Hd_true [93m=[m d1[38;5;224m,[m[76;253H[K[76;253H231,17[8C93%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;17Htheta_true [93m=[m theta1[38;5;224m,[m[76;253H[K[76;253H232,17[8C93%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;17Hpars [93m=[m pars[38;5;224m)[m[76;253H[K[76;253H233,17[8C94%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;1Hend [93m=[m [1m[96mSys.time[m[38;5;224m()[m[76;253H[K[76;253H234,17[8C94%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;1Htime [93m=[m end[93m-[mstart[76;253H[K[76;253H235,17[8C95%[70;17H[?25h[?25l[1;75r[75;1H
[1;76r[75;1H[1m[96mprint[m[38;5;224m([mtime[38;5;224m)[m[76;253H[K[76;253H236,17[8C95%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[76;253H[K[76;253H237,17[8C96%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;17H[1;75r[75;1H
[1;76r[75;1H[96m# save results[m[76;253H[K[76;253H238,17[8C97%[70;17H[?25h[?25l[76;243H~@k[70;17H[76;243H   [70;16H[1;75r[75;1H
[1;76r[70;15H[38;5;224m[46m()[m[75;1HfileConn[93m<-[m[1m[96mfile[m[38;5;224m([m[1m[96mpaste0[m[38;5;224m([m[95m'~/rgmirt/results/'[m[38;5;224m,[m lambda1[38;5;224m,[m[95m'_'[m[38;5;224m,[mlambda2[38;5;224m,[m[95m'_'[m[38;5;224m,[mndim[38;5;224m,[m [95m'_'[m[38;5;224m,[miteration[38;5;224m,[m[95m'_'[m[38;5;224m,[m sparsity[38;5;224m,[m [95m'.txt'[m[38;5;224m))[m[76;253H[K[76;253H239,16[8C97%[70;16H[?25h[?25l[1;75r[75;1H
[1;76r[69;15H[38;5;224m()[m[75;1H[1m[96mwriteLines[m[38;5;224m([m[1m[96mc[m[38;5;224m([m[1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m1[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m2[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m3[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m4[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m5[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m6[m[38;5;224m]),[m [1m[96mas.character[m[38;5;224m([mmetrics[38;5;224m[[m[95m7[m[38;5;224m])),[m fileConn[38;5;224m)[m[76;253H[K[76;253H240,16[8C98%[70;16H[?25h[?25l[76;243H~@k[70;16H[76;243H   [70;11H[1;75r[75;1H
[1;76r[70;6H[38;5;224m[46m([mtime[38;5;224m[46m)[m[75;1H[1m[96mclose[m[38;5;224m([mfileConn[38;5;224m)[m[76;253H[K[76;253H241,11[8C98%[70;11H[?25h[?25l[1;75r[75;1H
[1;76r[69;6H[38;5;224m([mtime[38;5;224m)[m[76;253H[K[76;253H242,0-1[7C99%[70;1H[?25h[?25l[76;243H~@k[70;1H[76;243H   [70;14H[1;75r[75;1H
[1;76r[76;253H[K[76;253H243,14[8CBot[70;14H[?25h[?25l[76;255H4,17[71;17H[?25h[?25l[76;255H5[72;17H[?25h[?25l[76;243H~@k[72;17H[76;243H   [73;15H[73;6H[38;5;224m[46m([8C)[m[76;255H6,15[73;15H[?25h[?25l[73;6H[38;5;224m([8C)[m[76;255H7,0-1[74;1H[?25h[?25l[76;243H~@k[74;1H[76;243H   [75;1H[76;255H8[75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [74;1H[76;255H7[74;1H[?25h[?25l[76;255H8[75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H~@k[75;1H[76;243H   [75;1H[?25h[?25l[76;243H:[75;1H[76;243H[K[76;1H:[?2004h[?25hq[?25l[?25h[?25l [?25h[?25l[?25h[?25l[?2004l[76;1H[K[76;1H[?2004l[?1l>[?25h[?1049l[23;0;0t]0;kveldkamp49@int5:~/rgmirt/EN-MIRT/scripts[kveldkamp49@int5 scripts]$ ls [K[K[Kcd
]0;kveldkamp49@int5:~[kveldkamp49@int5 ~]$ ls [K
[0m[38;5;9mmirt_1.37.1.tar.gz[0m  [38;5;33mrgmirt[0m  [38;5;33mrpackages[0m  [38;5;33mvae[0m
]0;kveldkamp49@int5:~[kveldkamp49@int5 ~]$ [K[kveldkamp49@int5 ~]$ ls [K
[0m[38;5;9mmirt_1.37.1.tar.gz[0m  [38;5;33mrgmirt[0m  [38;5;33mrpackages[0m  [38;5;33mvae[0m
]0;kveldkamp49@int5:~[kveldkamp49@int5 ~]$ cd rgmirt/[K[K[K[K[K[K[K[K[K[Kcd rgmirt/
]0;kveldkamp49@int5:~/rgmirt[kveldkamp49@int5 rgmirt]$ ls [K
[0m[38;5;33mdata[0m  [38;5;33mEN-MIRT[0m  [38;5;33mparameters[0m  [38;5;33mresults[0m
]0;kveldkamp49@int5:~/rgmirt[kveldkamp49@int5 rgmirt]$ cd EN-MIRT/
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT[kveldkamp49@int5 EN-MIRT]$ ls [K
[0m[38;5;33mdata[0m  [38;5;33mmirt[0m  Movielens_results.csv  README.md  [38;5;33mscripts[0m  typescript
]0;kveldkamp49@int5:~/rgmirt/EN-MIRT[kveldkamp49@int5 EN-MIRT]$ cd mirt/[K[K[K[K[K[K[K[KR C[K[K[Kcd ..
]0;kveldkamp49@int5:~/rgmirt[kveldkamp49@int5 rgmirt]$ ls [K
[0m[38;5;33mdata[0m  [38;5;33mEN-MIRT[0m  [38;5;33mparameters[0m  [38;5;33mresults[0m
]0;kveldkamp49@int5:~/rgmirt[kveldkamp49@int5 rgmirt]$ [K[kveldkamp49@int5 rgmirt]$ [K[kveldkamp49@int5 rgmirt]$ [K[kveldkamp49@int5 rgmirt]$ exit
